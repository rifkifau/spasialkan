// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"themes/PlateauTheme/widgets/HeaderController/PopupTileNodes":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/keys dojo/dom-construct dojo/query dijit/_WidgetBase dijit/_TemplatedMixin jimu/dijit/ViewStack dojox/gesture/swipe dojox/gesture/tap jimu/utils".split(" "),function(n,c,r,a,m,b,f,k,w,e,u,l,x,y){var v=0;return n([w,e],{baseClass:"jimu-header-more-popup",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"close" tabindex\x3d"0" data-dojo-attach-point\x3d"closeNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"pages" data-dojo-attach-point\x3d"pagesNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"points jimu-corner-bottom"\x3e\x3cdiv class\x3d"points-inner"data-dojo-attach-point\x3d"pointsNode"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
margin:4,postCreate:function(){this.nodes=[];this.pages=[];this.createCloseBtn();this.own(m(this.domNode,"keydown",c.hitch(this,function(g){a.hasClass(g.target,"close-btn")||g.keyCode!==b.ESCAPE||this.closeNode.focus()})))},startup:function(){this.viewStack=new u({views:[],viewType:"dom"},this.pagesNode);this.viewStack.startup();m(this.pagesNode,l.end,c.hitch(this,function(a){v<this.maximumPages-1&&a.dx&&0>a.dx?(v++,this._selectPage(v)):a.dx&&0<a.dx&&0<v&&(v--,this._selectPage(v))}));this.resize();
this.nodes.length&&this.nodes[0].focus()},resize:function(){var b=this._calculateGridParam(),e;null!==b?(a.setStyle(this.domNode,y.getPositionStyle(b.position)),this.nodeWidth=b.cellSize-this.margin,this.oldGridParam&&this.oldGridParam.rows===b.rows&&this.oldGridParam.cols===b.cols||(this.clearPages(),this.createPages(b)),this.nodes.forEach(c.hitch(this,function(a,g){this.setItemNodePosition(a,g,b)})),this.oldGridParam=b,e=k("div.close",this.domNode)[0],a.setStyle(e,{width:.25*this.nodeWidth+"px",
height:.25*this.nodeWidth+"px"})):(this.oldGridParam=null,a.setStyle(this.domNode,y.getPositionStyle({left:0,top:0,width:0,height:0,zIndex:111})),this.nodeWidth=0);!window.appInfo.isRunInMobile&&760<window.innerWidth&&this.numWidget&&8>=this.numWidget.length&&this.hide()},setItemNodePosition:function(b,e,p){var g,f,c=48,m=16;g=0===e%p.cols?0:this.margin/2;f=e%(p.rows*p.cols)<p.cols?0:this.margin/2;e={};"number"===typeof this.nodeWidth&&(e.width=this.nodeWidth+"px",e.height=this.nodeWidth+"px");"number"===
typeof g&&(window.isRTL?e.marginRight=g+"px":e.marginLeft=g+"px");"number"===typeof f&&(e.marginTop=f+"px");if(g=k("img",b)[0])p.iconScaled&&(c*=this.nodeWidth/120),a.setStyle(g,{width:c+"px",height:c+"px"});if(c=k("div.node-label",b)[0])p.showLabel?(p.iconScaled&&(m*=this.nodeWidth/120),a.setStyle(c,{"font-size":m+"px",display:"block"})):a.setStyle(c,{"font-size":m+"px",display:"none"});a.setStyle(b,e)},clearPages:function(){r.forEach(this.pages,function(a){this.viewStack.removeView(a.pageNode)},
this);f.empty(this.pointsNode);this.pages=[];this.nodes=[]},createPages:function(a){var e,g,l,u;this.maximumPages=e=Math.ceil(this.items.length/(a.rows*a.cols));for(g=0;g<e;g++){l=f.create("div",{"class":"page"});this.createPageItems(g,l,a);this.viewStack.addView(l);if(1<e){var x=g===e-1;u=f.create("div",{"class":"point",role:"button",tabindex:0},this.pointsNode);this.own(m(u,"click",c.hitch(this,this._onPageNodeClick,g)));this.own(m(u,"keydown",c.hitch(this,function(a,g,d){d.keyCode===b.ENTER||d.keyCode===
b.SPACE?(this._onPageNodeClick(a),k(".page.view",this.viewStack.domNode)[a].children[0].focus()):g&&!d.shiftKey&&d.keyCode===b.TAB&&d.preventDefault()},g,x)))}this.pages.push({pageNode:l,pointNode:u})}0<this.viewStack.views.length&&this._selectPage(0)},_onPageNodeClick:function(a){this._selectPage(a)},_selectPage:function(b){1<this.pages.length&&(k(".point",this.domNode).removeClass("point-selected jimu-main-background"),a.addClass(this.pages[b].pointNode,"point-selected jimu-main-background"));this.viewStack.switchView(this.pages[b].pageNode)},
createPageItems:function(a,b,e){var g,f,c;g=this.items.length;f=e.rows*e.cols;e=(a+1)*f;c=e-g;e=Math.min(e,g);for(a*=f;a<e;a++)this.createItemNode(a,b);for(a=g;a<g+c;a++)this.createEmptyItemNode(b)},createItemNode:function(e,l){var g;e=this.items[e];g=f.create("div",{"class":"icon-node jimu-float-leading jimu-main-background",title:e.label,"aria-label":e.label,settingId:e.id,"data-widget-name":e.name,role:"button",tabindex:0},l);l=f.create("img",{src:e.icon},g);window.isRTL&&e.mirrorIconForRTL&&a.addClass(l,
"jimu-flipx");f.create("div",{"class":"node-label",title:e.label,innerHTML:y.stripHTML(e.label)},g);g.config=e;this.own(m(g,x,c.hitch(this,function(){this.onNodeClicked(g)})));this.own(m(g,"keydown",c.hitch(this,function(a){if(a.keyCode===b.ENTER||a.keyCode===b.SPACE)this.onNodeClicked(g)})));this.nodes.push(g)},createEmptyItemNode:function(a){a=f.create("div",{"class":"icon-node jimu-float-leading jimu-main-background",tabindex:0},a);this.own(m(a,"focus",c.hitch(this,function(a){y.isInNavMode()&&
(1===this.viewStack.domNode.children.length?a.target.parentNode.children[0].focus():k(".point-selected",this.pointsNode)[0].previousSibling.focus())})));this.nodes.push(a);return a},createCloseBtn:function(){f.create("div",{role:"button","class":"close-inner jimu-main-background"},this.closeNode);this.own(m(this.closeNode,"click",c.hitch(this,function(){this.hide()})));this.own(m(this.closeNode,"keydown",c.hitch(this,function(a){a.keyCode===b.ENTER||a.keyCode===b.SPACE||a.keyCode===b.ESCAPE?this.hide():
a.shiftKey&&a.keyCode===b.TAB&&a.preventDefault()})));return this.closeNode},hide:function(){v=0;a.setStyle(this.domNode,"display","none")},show:function(){a.setStyle(this.domNode,"display","block")},onNodeClicked:function(a){this.hide()},openNodebyId:function(b){for(var e=0,f=this.nodes.length;e<f;e++){var c=this.nodes[e];if(b&&b===a.getAttr(c,"settingId"))return this.onNodeClicked(c),c}},_calculateGridParam:function(){var b,e,f,c,l=!1,m=!0;b=a.getContentBox(jimuConfig.mapId);e=Math.min(b.w,b.h)-
40;if(360<=e)c=120;else{c=Math.floor(e/3);if(10>c)return null;l=!0;80>c&&(m=!1)}e=Math.floor((b.h-40)/c);f=Math.floor((b.w-40)/c);e=4<e?4:e;e=3>e?3:e;f=3>e?3:4<f?4:f;return{rows:e,cols:f,cellSize:c,iconScaled:l,showLabel:m,position:{top:(b.h-c*e)/2,bottom:(b.h-c*e)/2,left:(b.w-c*f)/2,right:(b.w-c*f)/2,width:c*f-this.margin*(f-1)/2,height:c*e-this.margin*(e-1)/2,zIndex:111}}}})})},"dojox/gesture/swipe":function(){define(["dojo/_base/kernel","dojo/_base/declare","./Base","../main"],function(n,c,r,a){n.experimental("dojox.gesture.swipe");
n=c(r,{defaultEvent:"swipe",subEvents:["end"],press:function(a,b){b.touches&&2<=b.touches.length?delete a.context:(a.context||(a.context={x:0,y:0,t:0}),a.context.x=b.screenX,a.context.y=b.screenY,a.context.t=(new Date).getTime(),this.lock(b.currentTarget))},move:function(a,b){this._recognize(a,b,"swipe")},release:function(a,b){this._recognize(a,b,"swipe.end");delete a.context;this.unLock()},cancel:function(a,b){delete a.context;this.unLock()},_recognize:function(a,b,c){a.context&&(a=this._getSwipeInfo(a,
b))&&(a.type=c,this.fire(b.target,a))},_getSwipeInfo:function(a,b){var c={},k=a.context;c.time=(new Date).getTime()-k.t;a=b.screenX-k.x;b=b.screenY-k.y;if(0===a&&0===b)return null;c.dx=a;c.dy=b;return c}});a.gesture.swipe=new n;a.gesture.swipe.Swipe=n;return a.gesture.swipe})},"dojox/gesture/Base":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom dojo/on dojo/touch dojo/has ../main".split(" "),function(n,c,r,a,m,b,f,k,w){n.experimental("dojox.gesture.Base");
a.getObject("gesture",!0,w);return c(null,{defaultEvent:" ",subEvents:[],touchOnly:!1,_elements:null,constructor:function(b){a.mixin(this,b);this.init()},init:function(){this._elements=[];if(!k("touch")&&this.touchOnly)console.warn("Gestures:[",this.defaultEvent,"] is only supported on touch devices!");else{var a=this.defaultEvent;this.call=this._handle(a);this._events=[a];r.forEach(this.subEvents,function(b){this[b]=this._handle(a+"."+b);this._events.push(a+"."+b)},this)}},_handle:function(a){var e=
this;return function(c,f){var l=arguments;2<l.length&&(c=l[1],f=l[2]);if(c&&(c.nodeType||c.attachEvent||c.addEventListener)){var k=e._add(c,a,f);return{remove:function(){k.remove();e._remove(c,a)}}}return b(c,a,f)}},_add:function(e,c,l){var k=this._getGestureElement(e);if(!k){var k={target:e,data:{},handles:{}},u=a.hitch(this,"_process",k,"press"),m=a.hitch(this,"_process",k,"move"),g=a.hitch(this,"_process",k,"release"),n=a.hitch(this,"_process",k,"cancel"),p=k.handles;this.touchOnly?(p.press=b(e,
"touchstart",u),p.move=b(e,"touchmove",m),p.release=b(e,"touchend",g),p.cancel=b(e,"touchcancel",n)):(p.press=f.press(e,u),p.move=f.move(e,m),p.release=f.release(e,g),p.cancel=f.cancel(e,n));this._elements.push(k)}k.handles[c]=k.handles[c]?++k.handles[c]:1;return b(e,c,l)},_getGestureElement:function(a){for(var b=0,e;b<this._elements.length;b++)if(e=this._elements[b],e.target===a)return e},_process:function(a,b,c){c._locking=c._locking||{};c._locking[this.defaultEvent]||this.isLocked(c.currentTarget)||
("INPUT"==c.target.tagName&&"radio"!=c.target.type&&"checkbox"!=c.target.type||"TEXTAREA"==c.target.tagName||c.preventDefault(),c._locking[this.defaultEvent]=!0,this[b](a.data,c))},press:function(a,b){},move:function(a,b){},release:function(a,b){},cancel:function(a,b){},fire:function(a,c){a&&c&&(c.bubbles=!0,c.cancelable=!0,b.emit(a,c.type,c))},_remove:function(a,b){if((a=this._getGestureElement(a))&&a.handles){a.handles[b]--;var c=a.handles;r.some(this._events,function(a){return 0<c[a]})||(this._cleanHandles(c),
b=r.indexOf(this._elements,a),0<=b&&this._elements.splice(b,1))}},_cleanHandles:function(a){for(var b in a)a[b].remove&&a[b].remove(),delete a[b]},lock:function(a){this._lock=a},unLock:function(){this._lock=null},isLocked:function(a){return this._lock&&a?this._lock!==a&&m.isDescendant(a,this._lock):!1},destroy:function(){r.forEach(this._elements,function(a){this._cleanHandles(a.handles)},this);this._elements=null}})})},"dojox/gesture/tap":function(){define(["dojo/_base/kernel","dojo/_base/declare",
"dojo/_base/lang","./Base","../main"],function(n,c,r,a,m){n.experimental("dojox.gesture.tap");n=c(a,{defaultEvent:"tap",subEvents:["hold","doubletap"],holdThreshold:500,doubleTapTimeout:250,tapRadius:10,press:function(a,c){if(c.touches&&2<=c.touches.length)clearTimeout(a.tapTimeOut),delete a.context;else{var b=c.target;this._initTap(a,c);a.tapTimeOut=setTimeout(r.hitch(this,function(){this._isTap(a,c)&&this.fire(b,{type:"tap.hold"});delete a.context}),this.holdThreshold)}},release:function(a,c){if(a.context&&
this._isTap(a,c))switch(a.context.c){case 1:this.fire(c.target,{type:"tap"});break;case 2:this.fire(c.target,{type:"tap.doubletap"})}clearTimeout(a.tapTimeOut)},_initTap:function(a,c){a.context||(a.context={x:0,y:0,t:0,c:0});var b=(new Date).getTime();b-a.context.t<=this.doubleTapTimeout?a.context.c++:(a.context.c=1,a.context.x=c.screenX,a.context.y=c.screenY);a.context.t=b},_isTap:function(a,c){if(!a.context)return!1;var b=Math.abs(a.context.y-c.screenY);return Math.abs(a.context.x-c.screenX)<=this.tapRadius&&
b<=this.tapRadius}});m.gesture.tap=new n;m.gesture.tap.Tap=n;return m.gesture.tap})},"themes/PlateauTheme/widgets/HeaderController/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:themes/PlateauTheme/widgets/HeaderController/Widget.html":'\x3cdiv data-a11y-label-by\x3d"plateau_label plateau_title plateau_subtitle"\x3e\r\n  \x3c!-- solve the bug of style delay loading --\x3e\r\n  \x3cdiv class\x3d"header-section jimu-float-leading" data-dojo-attach-point\x3d"headerNode"\x3e\r\n    \x3ca role\x3d"link" data-dojo-attach-point\x3d"logoLinkNode" target\x3d"_blank"\x3e\r\n      \x3cimg class\x3d"logo jimu-float-leading jimu-leading-margin1" data-dojo-attach-point\x3d"logoNode" data-dojo-attach-event\x3d"onload:_onLogoLoad"\x3e\r\n    \x3c/a\x3e\r\n    \x3cdiv class\x3d"titles jimu-float-leading jimu-leading-margin1" data-dojo-attach-point\x3d"titlesNode"\x3e\r\n      \x3cdiv class\x3d"screen-readers-only" data-a11y-label-id\x3d"plateau_label"\x3e${label}\x3c/div\x3e\r\n      \x3ch1 class\x3d"jimu-title jimu-float-leading" data-dojo-attach-point\x3d"titleNode" data-a11y-label-id\x3d"plateau_title"\x3e\x3c/h1\x3e\r\n      \x3ch2 class\x3d"jimu-subtitle jimu-float-leading jimu-leading-margin2" data-dojo-attach-point\x3d"subtitleNode" data-a11y-label-id\x3d"plateau_subtitle"\x3e\x3c/h2\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"links jimu-float-leading jimu-leading-margin1" data-dojo-attach-point\x3d"linksNode"\x3e\r\n      \x3cdiv class\x3d"dynamic-section jimu-float-leading" data-dojo-attach-point\x3d"dynamicLinksNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"signin-section jimu-float-leading" data-dojo-attach-point\x3d"signInSectionNode"\x3e\r\n        \x3ca role\x3d"link" href\x3d"#" class\x3d"jimu-link" data-dojo-attach-event\x3d"onclick:_onSigninClick" data-dojo-attach-point\x3d"signinLinkNode"\x3e${nls.signin}\x3c/a\x3e\r\n        \x3ca role\x3d"link" href\x3d"" target\x3d"_blank" class\x3d"jimu-link" data-dojo-attach-event\x3d"onclick:_onUserNameClick" data-dojo-attach-point\x3d"userNameLinkNode"\x3e\x3c/a\x3e\r\n        \x3ca role\x3d"link" href\x3d"#" class\x3d"jimu-link" data-dojo-attach-event\x3d"onclick:_onSignoutClick" data-dojo-attach-point\x3d"signoutLinkNode"\x3e${nls.signout}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"container-section jimu-float-leading jimu-main-background" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:themes/PlateauTheme/widgets/HeaderController/css/style.css":'.jimu-widget-header-controller {box-shadow: 0px 1px 8px 0px rgba(0, 0, 0, 0.4);}.jimu-widget-header-controller .header-section {height: 100%; overflow: hidden; width: calc(100% - 360px);}.jimu-widget-header-controller .container-section {height: 100%; min-width: 80px;}.jimu-widget-header-controller .logo {cursor: pointer;}.jimu-widget-header-controller .hide-logo {display: none;}.jimu-widget-header-controller .titles {height: 100%; overflow: hidden;}.jimu-widget-header-controller .jimu-title {text-align: center; height: 100%; margin-top: 0;}.jimu-widget-header-controller .jimu-subtitle {text-align: center; height: 100%; margin-top: 0;}.jimu-widget-header-controller .links {height: 100%; overflow: hidden;}.jimu-widget-header-controller .dynamic-section, .jimu-widget-header-controller .signin-section {height: 100%; display: flex;}.jimu-widget-header-controller .links .jimu-link {height: 100%;}.jimu-widget-header-controller .signin-section .jimu-link {color: #d9dde0;}.jimu-widget-header-controller .dynamic-section .jimu-link:last-child,.jimu-widget-header-controller .signin-section .jimu-link:last-child{margin-right: 1em;}.jimu-rtl .jimu-widget-header-controller .dynamic-section .jimu-link:last-child,.jimu-rtl .jimu-widget-header-controller .signin-section .jimu-link:last-child{margin-left: 1em;}.jimu-widget-header-controller .icon-node {cursor: pointer; opacity: 1; text-align: center; border-right: 1px solid #323e4f;}.jimu-widget-header-controller .icon-node img {height: 20px; width: 20px;}.jimu-widget-header-controller .icon-node:first-child {border: none;}.jimu-widget-header-controller .icon-node:hover {opacity: 1;}.jimu-widget-header-controller .icon-node.jimu-state-selected {background-color: #697a8c; opacity: 1; border: none; border-top: 2px solid #8491a1;}.jimu-widget-header-controller .drop-triangle {position: absolute; width: 0px; height: 0px; bottom: 1px; border-left: 4px solid transparent; border-right: 4px solid transparent; border-top: 4px solid white;}.jimu-widget-header-controller .jimu-drop-menu {box-shadow: 0px 1px 8px 0px rgba(0, 0, 0, 0.4);}.jimu-widget-header-controller .jimu-drop-menu .menu-item {overflow: hidden; border-top: 1px solid rgba(0, 0, 0, 0.2);}.jimu-widget-header-controller .jimu-drop-menu .menu-item:hover {background-color: rgba(0, 0, 0, 0.2);}.jimu-widget-header-controller .jimu-drop-menu .menu-item img {width: 24px; height: 24px; cursor: pointer; margin: 8px;}.jimu-widget-header-controller .jimu-drop-menu .menu-item .label {cursor: pointer; margin-top: 12px; font-size: 14px; color: white; min-width: 50px; text-align: center; white-space: nowrap; max-width: 300px; text-overflow: ellipsis; overflow: hidden; padding-right: 8px;}.jimu-rtl .jimu-widget-header-controller .jimu-drop-menu .menu-item .label{padding-left: 8px;}.popup-links .popup-title {}.popup-links .logo {height: 30px;}.popup-links .title {color: #fff; text-align: center; font-size: 16px; width: 71.42857142857143%; overflow: hidden; white-space: nowrap; height: 100%;}.popup-links .line {width: 100%; height: 4px; border-bottom: 1px solid #393c40;}.popup-links .link-section {width: 100%; height: 66px;}.popup-links a {color: #fff; margin-left: 20px; font-size: 14px; height: 100%; width: 95%; overflow: hidden; display: inline-block;}.popup-links .link-section.signin a {color: #d9dde0;}.jimu-header-more-popup {position: absolute; border-radius: 2px; z-index: 111; background-color: #FFFFFF;}.jimu-header-more-popup .pages {position: relative; overflow: hidden; padding: 2px;}.jimu-header-more-popup .points {position: absolute; overflow: hidden; bottom: -15px; left: 0px; right: 0px; text-align: center; background-color: #bababa;}.jimu-header-more-popup .points-inner{overflow: hidden; display: flex; height: 20px; width: 100%; align-items: center; justify-content: center;}.jimu-header-more-popup .point {float: left; width: 8px; height: 8px; margin-left: 5px; border-radius: 4px; background-color: #f2f6f9; cursor: pointer;}.jimu-header-more-popup .point-selected {background-color: #485566;}.jimu-nav-mode .jimu-header-more-popup .point:focus{outline: none !important; border: 2px solid #24B5CC;}.jimu-header-more-popup .page {position: relative; overflow: hidden;}.jimu-header-more-popup .close {position: absolute; top: -04.46428571428571%; right: -04.46428571428571%; border-radius: 50%; background-color: #FFFFFF; cursor: pointer;}.jimu-rtl .jimu-header-more-popup .close {left: -04.46428571428571%; right: auto;}.jimu-header-more-popup .close-inner {width: 80%; height: 80%; margin-left: 10%; margin-top: 10%; border-radius: 50%; background-image: url("images/close.png"); background-repeat: no-repeat; background-position: center center; background-size: 13px;}.jimu-rtl .jimu-header-more-popup .close-inner{margin-left: 0; margin-right: 10%;}.jimu-header-more-popup .icon-node {cursor: pointer;}.jimu-header-more-popup .icon-node.jimu-state-selected {background-color: red;}.jimu-header-more-popup img {width: 48px; height: 48px; margin: auto; margin-top: 25%; display: block;}.jimu-header-more-popup .node-label {width: 100%; text-align: center; font-size: 16px; margin-top: 5px; color: white; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; display: inline-block; height: 20px;}@media screen and (max-width:320px){.jimu-header-more-popup .close-inner {background-size: 9px;}}@media screen and (max-width:760px) {.jimu-header-more-popup .node-label {font-size: 13px !important; height: 17px;} .jimu-widget-header-controller .header-section {width: calc(100% - 90px) !important;}}.jimu-more-icon-cover {z-index: 110; position: absolute; left: 0; top: 0; width: 100%; height: 100%;}.jimu-widget-header-controller .esriCTHidden {display: none;}.jimu-widget-header-controller .widget-open-symbol {height: 4px; width: 4px; border-radius: 4px; margin: auto; color: #FFF; background-color: #FFF;}.jimu-widget-frame.jimu-foldable-dijit\x3e.jimu-panel-content {padding: 14px;}',
"*now":function(n){n(['dojo/i18n!*preload*themes/PlateauTheme/widgets/HeaderController/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/aspect dojo/query dojo/on dojo/keys dojo/Deferred dijit/Tooltip dojo/mouse dojo/topic dojo/dom-construct dojo/dom-geometry jimu/BaseWidget jimu/PoolControllerMixin jimu/tokenUtils jimu/portalUtils jimu/portalUrlUtils jimu/utils jimu/dijit/Message ./PopupTileNodes dijit/registry dojo/NodeList-manipulate".split(" "),function(n,c,r,a,m,b,f,k,w,e,u,l,x,y,v,g,z,p,A,q,B,C,D){return n([v,g],{baseClass:"jimu-widget-header-controller jimu-main-background",
maxIconCount:-1,createMoreIcon:!1,switchableElements:{},height:40,openedId:"",moveTopOnActive:!1,postMixInProperties:function(){this.inherited(arguments);this.isRenderIdForAttrs=!0;this.nls.common=c.mixin(this.nls,window.jimuNls.common)},postCreate:function(){this.inherited(arguments);a.setAttr(this.domNode,"aria-label",this.nls._widgetLabel);this._processGroupSetting();this.switchableElements.title=this.titleNode;this.position&&this.position.height&&(this.height=this.position.height);a.setStyle(this.signInSectionNode,
"display","none");this.appConfig&&this.appConfig.logo?(this.logoNode.src=this.appConfig.logo,a.removeClass(this.logoNode,"hide-logo")):(this.logoNode.src="",a.addClass(this.logoNode,"hide-logo"));this.appConfig.title&&(this.appConfig.title=q.sanitizeHTML(this.appConfig.title));this.appConfig.subtitle&&(this.appConfig.subtitle=q.sanitizeHTML(this.appConfig.subtitle));this.switchableElements.title.innerHTML=this.appConfig.title?this.appConfig.title:"";this.switchableElements.title.title=this.appConfig.title?
this.appConfig.title:"";this.appConfig.subtitle&&""!==c.trim(this.appConfig.subtitle)?(this.switchableElements.subtitle=this.subtitleNode,this.switchableElements.subtitle.innerHTML=this.appConfig.subtitle):(this.subtitleNode.innerHTML="",a.setStyle(this.subtitleNode,"display","none"));this._createDynamicLinks(this.appConfig.links);this._setElementsSize();this.own(f(this.domNode,u.enter,c.hitch(this,function(){var a="",h=A.getServerByUrl(this.appConfig&&this.appConfig.portalUrl||"");A.isArcGIScom(h)&&
(h="ArcGIS.com");h&&(a=this.nls.signInTo+" "+h);this.signinLinkNode.title=a})));this._handleLogoLink(this.appConfig)},startup:function(){this.inherited(arguments);this.resize()},onAction:function(a,h){"highLight"===a&&h&&(h=b('div[settingid\x3d"'+h.widgetId+'"]',this.domNode)[0],this._highLight(h));"removeHighLight"===a&&this._removeHighLight()},onSignIn:function(d){this.inherited(arguments);a.setStyle(this.signinLinkNode,"display","none");a.setStyle(this.userNameLinkNode,"display","");a.setStyle(this.signoutLinkNode,
"display","");this.userNameLinkNode.innerHTML=d.userId;a.setAttr(this.userNameLinkNode,"href",this.appConfig.portalUrl+"home/user.html");this.popupLinkNode&&(a.setStyle(this.popupSigninNode,"display","none"),a.setStyle(this.popupUserNameNode,"display",""),a.setStyle(this.popupSignoutNode,"display",""),b("a",this.popupUserNameNode).html(d.userId).attr("href",this.appConfig.portalUrl+"home/user.html"));this.resize()},onSignOut:function(){this.inherited(arguments);this._onSignOut(this.nls.signin);p.getPortal(this.appConfig.portalUrl).loadSelfInfo().then(c.hitch(this,
function(a){this._onSignOut(this.nls.signInTo+" "+a.name)}),c.hitch(this,function(a){console.error(a)}))},_onSignOut:function(d){a.setStyle(this.signinLinkNode,"display","");a.setAttr(this.signinLinkNode,"innerHTML",d);a.setStyle(this.userNameLinkNode,"display","none");a.setStyle(this.signoutLinkNode,"display","none");this.userNameLinkNode.innerHTML="";this.popupLinkNode&&(a.setStyle(this.popupSigninNode,"display",""),a.setAttr(this.popupSigninNode,"innerHTML",d),a.setStyle(this.popupUserNameNode,
"display","none"),a.setStyle(this.popupSignoutNode,"display","none"),b("a",this.popupUserNameNode).html(""));this.resize()},resize:function(){var d=0,h=a.getStyle(this.headerNode,"float"),e=a.getStyle(this.logoNode,"float"),t=a.getStyle(this.titlesNode,"float"),f=a.getStyle(this.linksNode,"float");h&&"none"!==h&&e&&"none"!==e&&t&&"none"!==t&&f&&"none"!==f?this._resize():setTimeout(c.hitch(this,this.resize),200);b(".jimu-widget-attributetable")[0]&&(d=b(".jimu-widget-attributetable")[0].clientHeight);
d?l.publish("changeMapPosition",{bottom:d}):l.publish("changeMapPosition",{bottom:"0px"})},_resize:function(){var d=a.getContentBox(this.domNode);this._showSwitchableElements(["title","links","subtitle"]);this._updateTitleNodeWidth();this._getTitleContainerWidth(d);this._createIconNodes(d);this._updateTitleNodeWidth();this.morePane&&this.morePane.resize();this.popupLinkNode&&a.setStyle(jimuConfig.layoutId,{left:a.getContentBox(this.popupLinkNode).w+"px"})},_updateTitleNodeWidth:function(){var d;d=
a.getContentBox(this.domNode);d=this._getHeaderContainerWidth(d)-this._getLogoWidth()-this._getTitlesWidth()-this._getSubtitleWidth()-this._getLinkWidth();d=this._getTitlesWidth()+d+40;"none"===a.getStyle(this.subtitleNode,"display")&&(d+=20,"none"===a.getStyle(this.linksNode,"display")&&(d+=20));150>d?a.setStyle(this.titleNode,"max-width","150px"):a.setStyle(this.titleNode,"max-width",d+"px")},destroy:function(){this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=null);this.morePane&&
this.morePane.destroy();this.moreIconPaneCoverNode&&(a.destroy(this.moreIconPaneCoverNode),this.moreIconPaneCoverNode=null);this.popupLinkNode&&this.popupLinksVisible&&this._hidePopupLink();a.destroy(this.popupLinkNode);this.inherited(arguments)},onAppConfigChanged:function(a,h,b){switch(h){case "attributeChange":this._onAttributeChange(a,b);break;default:return}this.appConfig=a;this.resize()},getOpenedIds:function(){this.inherited(arguments);return""===this.openedId?[]:[this.openedId]},setOpenedIds:function(a){if(0!==
a.length){var d=this.getConfigById(a[0]);d&&(this.openedId&&this._switchNodeToClose(this.openedId),this.openedId=a[0],d.widgets&&"openAll"===d.openType?this._switchNodeToOpen(d.id):d.widgets||(this._getIconNodeById(d.id)?this._switchNodeToOpen(d.id):this._showIconContent(d)))}},_onLogoLoad:function(){this.resize()},_highLight:function(a){this.hlDiv&&this._removeHighLight();if(a){var d=y.getMarginBox(a);this.hlDiv=x.create("div",{style:{position:"absolute",left:d.l+"px",top:d.t+"px",width:d.w+"px",
height:d.h+"px"},"class":"icon-highlight"},a,"before")}},_removeHighLight:function(){this.hlDiv&&(x.destroy(this.hlDiv),this.hlDiv=null)},_onAttributeChange:function(d,b){var c;"title"in b&&b.title!==this.appConfig.title&&(c=q.sanitizeHTML(b.title),this.titleNode.innerHTML=c,this.titleNode.title=c);"subtitle"in b&&b.subtitle!==this.appConfig.subtitle&&(this.subtitleNode.innerHTML=q.sanitizeHTML(b.subtitle));"logo"in b&&b.logo!==this.appConfig.logo&&(b.logo?(a.setAttr(this.logoNode,"src",b.logo),a.removeClass(this.logoNode,
"hide-logo")):(a.removeAttr(this.logoNode,"src"),a.addClass(this.logoNode,"hide-logo")));"links"in b&&this._createDynamicLinks(b.links);this._handleLogoLink(d)},_handleLogoLink:function(a){q.themesHeaderLogoA11y(a,this.tabIndex,{link:this.logoLinkNode,logo:this.logoNode,icon:this.logoNode})},_setElementsSize:function(){a.setStyle(this.logoNode,{height:"30px",marginTop:(this.height-30)/2+"px"});a.setStyle(this.titleNode,{lineHeight:this.height+"px"});a.setStyle(this.subtitleNode,{lineHeight:this.height+
"px"});b(".jimu-link",this.domNode).style({lineHeight:this.height+"px"})},_processGroupSetting:function(){this._setMapCanvasAreaToDefault();r.forEach(this.appConfig.widgetPool.groups,function(a){var d;a:{if(this.config.groupSetting)for(d=0;d<this.config.groupSetting.length;d++)if(this.config.groupSetting[d].label===a.label){d=this.config.groupSetting[d].type;break a}d="openAll"}a.openType=d},this)},_createDynamicLinks:function(d){var b=this.tabIndex+1;a.empty(this.dynamicLinksNode);0>=d.length?(a.setStyle(this.linksNode,
"display","none"),this.switchableElements.hasOwnProperty("links")&&delete this.switchableElements.links):(this.switchableElements.links=this.linksNode,r.forEach(d,function(d){a.create("a",{href:d.url,target:"_blank",innerHTML:q.sanitizeHTML(d.label),"class":"jimu-link jimu-align-leading jimu-leading-margin1",style:{lineHeight:this.height+"px"},tabindex:b++},this.dynamicLinksNode)},this))},_showSwitchableElements:function(d){var b=this.switchableElements,e;for(e in b)if(b.hasOwnProperty(e))if(-1<d.indexOf(e)){var t=
a.hasClass(b[e],"links")?"flex":"block";a.setStyle(b[e],"display",t);b[e].visible=!0}else a.setStyle(b[e],"display","none"),b[e].visible=!1;this.logoClickHandle&&this.logoClickHandle.remove();this.logoKeydownHandle&&this.logoKeydownHandle.remove();0>d.indexOf("links")?(a.setAttr(this.logoLinkNode,"tabIndex",this.tabIndex),this.logoClickHandle=f(this.logoNode,"click",c.hitch(this,this._onLogoClick)),this.logoKeydownHandle=f(this.logoLinkNode,"keydown",c.hitch(this,this._onLogoKeydown))):(this.popupLinksVisible&&
this._hidePopupLink(),this.appConfig.logoLink?a.setStyle(this.logoNode,"cursor","pointer"):a.setStyle(this.logoNode,"cursor","default"))},_switchSignin:function(){var a=z.getPortalCredential(this.appConfig.portalUrl);if(a)this.onSignIn(a);else this.onSignOut()},_onLogoClick:function(){this.popupLinkNode&&a.destroy(this.popupLinkNode);this.popupLinkNode=this._createPopupLinkNode();this.popupLinksVisible?this._hidePopupLink():this._showPopupLink()},_onLogoKeydown:function(a){a.keyCode===k.ENTER&&this._onLogoClick()},
_hidePopupLink:function(){a.setStyle(this.popupLinkNode,"display","none");window.isRTL?a.setStyle(jimuConfig.layoutId,{right:0}):a.setStyle(jimuConfig.layoutId,{left:0});this.popupLinksVisible=!1},_showPopupLink:function(){a.setStyle(this.popupLinkNode,"display","");window.isRTL?a.setStyle(jimuConfig.layoutId,{right:a.getContentBox(this.popupLinkNode).w+"px"}):a.setStyle(jimuConfig.layoutId,{left:a.getContentBox(this.popupLinkNode).w+"px"});q.isInNavMode()&&(this.appConfig.links?b(".jimu-link a",
this.popupLinkNode)[0].focus():b(".jimu-popup-link-close-btn",this.popupLinkNode)[0].focus());this.popupLinksVisible=!0},_createPopupLinkNode:function(){var d,h;a.getContentBox(jimuConfig.mainPageId);d=a.create("div",{"class":"popup-links jimu-main-background",style:{position:"absolute",zIndex:100,top:0,bottom:0}},jimuConfig.mainPageId);window.isRTL?a.setStyle(d,{right:0,left:"50px"}):a.setStyle(d,{left:0,right:"50px"});h=a.create("div",{"class":"popup-title",style:{height:this.height+"px",width:"100%"}},
d);var e=a.create("div",{"class":"jimu-float-leading jimu-leading-margin1 jimu-popup-link-close-btn",role:"button",tabindex:"0","aria-label":this.nls.common.close,style:{width:"30px",height:"30px",marginTop:(this.height-30)/2+"px"}},h);this.own(f(e,"click",c.hitch(this,function(){this._hidePopupLink()})));this.own(f(e,"keydown",c.hitch(this,function(a){q.isInNavMode()&&(a.keyCode===k.ENTER||a.keyCode===k.SPACE||a.keyCode===k.ESCAPE?(this._hidePopupLink(),this.logoLinkNode.focus()):a.keyCode===k.TAB&&
!a.shiftKey&&0<this.appConfig.links.length||a.preventDefault())})));this.own(f(d,"keydown",c.hitch(this,function(b){q.isInNavMode()&&b.keyCode===k.ESCAPE&&!a.hasClass(d,"jimu-popup-link-close-btn")&&e.focus()})));a.create("div",{"class":"title jimu-float-leading jimu-leading-margin1",innerHTML:q.sanitizeHTML(this.appConfig.title),style:{lineHeight:this.height+"px"}},h);var t=[];r.forEach(this.appConfig.links,function(a){a=this._createLinkNode(d,a,!1);t.push(a)},this);t.length&&this.own(f(t[t.length-
1],"keydown",c.hitch(this,function(a){q.isInNavMode()&&a.keyCode===k.TAB&&!a.shiftKey&&(a.preventDefault(),b("a",t[0])[0].focus())})));return d},_createLinkNode:function(d,b,c){d=a.place('\x3cdiv class\x3d"jimu-link"\x3e\x3c/div\x3e',d);a.place('\x3cdiv class\x3d"line"\x3e\x3c/div\x3e',d);c=a.place('\x3cdiv class\x3d"'+(c?"link-section signin":"link-section")+'"\x3e\x3c/div\x3e',d);a.create("a",{href:b.url,tabindex:"0","class":"jimu-ellipsis",target:"_blank",rel:"noopener noreferrer",innerHTML:q.sanitizeHTML(b.label),
title:q.sanitizeHTML(b.label),style:{lineHeight:"66px"}},c);return d},_onSigninClick:function(){z.signInPortal(this.appConfig.portalUrl,this.appConfig.appId)},_onSignoutClick:function(){this.appConfig.mode?new B({message:this.nls.cantSignOutTip}):z.signOutAll()},_onUserNameClick:function(){},_getHeaderSectionWidth:function(){return a.getMarginBox(this.headerNode).w},_getIconContainerWidth:function(){return a.getMarginBox(this.containerNode).w},_getTitlesWidth:function(){return a.getMarginBox(this.titlesNode).w},
_getLinkWidth:function(){return a.getMarginBox(this.linksNode).w},_getLogoWidth:function(){return a.getMarginBox(this.logoNode).w+12},_getSubtitleWidth:function(){return a.getMarginBox(this.subtitleNode).w},_getHeaderContainerWidth:function(a){var d=this._getIconContainerWidth(),b=this._getLogoWidth();return a.w-d-b},_getTitleContainerWidth:function(a){a=this._getHeaderContainerWidth(a);var d=this._getTitlesWidth(),b=this._getLinkWidth();a<d+b&&(this.switchableElements.hasOwnProperty("links")&&this.switchableElements.links.visible?
(this._showSwitchableElements(["title","subtitle"]),d=this._getTitlesWidth(),a<d&&this._showSwitchableElements(["title"])):this._showSwitchableElements(["title"]))},_createIconNodes:function(d,c){var e=this.tabIndex+20;b(".icon-node",this.containerNode).remove();var h,f=this.getAllConfigs(),k;this.iconWidth=d.h;this._getTitleContainerWidth(d);h=360;h=760>=window.innerWidth?90:360;d=[];var g;a.setStyle(this.containerNode,{width:h+"px"});this.maxIconCount=760>=window.innerWidth?2:Math.floor(8);this.maxIconCount>=
f.length?(this.headerIconCount=f.length,this.createMoreIcon=!1):(this.headerIconCount=this.maxIconCount-1,this.createMoreIcon=!0);if(this.createMoreIcon){g=this._createIconNode({label:this.nls.more});d.push(g);if(!this.openAtStartWidget)for(h=0;h<f.length;h++)f[h].openAtStart&&(k=f[h]);!c&&this.openedId&&this.getConfigById(this.openedId)&&(k=this.getConfigById(this.openedId));k&&this._moveConfigToHeader(k)}var l;for(h=this.headerIconCount-1;0<=h;h--)c=f[h],g=this._createIconNode(c),c.openAtStart&&
(l=g),d.push(g);d.reverse().forEach(function(d){e+=200;a.setAttr(d,"tabindex",e);d.config.inPanel||(d.config.tabIndex=e)});l&&!this.openAtStartWidget&&(this.openAtStartWidget=l.config.id,this._onIconClick(l,!0));this.openedId&&this.getConfigById(this.openedId)&&!1===this.getConfigById(this.openedId).inPanel&&(f=this._getIconNodeById(this.openedId),l=this.widgetManager.getWidgetById(this.openedId),f&&l?this._setOffPanelWidgetPosition(f,l):(this.widgetManager.closeWidget(this.openedId),this.openedId=
""))},_createIconNode:function(d){var h,g,t;g=d.label===this.nls.more?this.folderUrl+"images/more_icon.png":d.icon;h=a.create("div",{"class":"icon-node jimu-float-trailing",title:d.label,"aria-label":d.label,settingId:d.id,role:"button",style:{width:"45px",height:this.height+"px",textAlign:"center"}},this.containerNode);t=a.create("div",{"class":"widget-symbol-div",style:{width:"100%"}},h);g=a.create("img",{src:g,alt:d.label,style:{marginTop:(this.height-30)/2+3+"px",marginBottom:"3px"}},t);window.isRTL&&
d.mirrorIconForRTL&&a.addClass(g,"jimu-flipx");g=a.create("div",{"class":"widget-open-symbol esriCTHidden"},h);d.label===this.nls.more?(this._morePaneNode=h,f(h,"click",c.hitch(this,this._showMorePane,d)),f(h,"keydown",c.hitch(this,function(a){a.keyCode!==k.ENTER&&a.keyCode!==k.SPACE||this._showMorePane()}))):(f(h,"click",c.hitch(this,function(){this._onIconClick(h)})),f(h,"keydown",c.hitch(this,function(a){a.keyCode!==k.ENTER&&a.keyCode!==k.SPACE||this._onIconClick(h)})),q.addTooltipByDomNode(e,
h,d.label));h.config=d;h.config.widgets&&1<h.config.widgets.length&&"dropDown"===h.config.openType&&this._createDropTriangle(h);this.openedId===d.id&&(a.addClass(h,"jimu-state-selected"),b(".widget-open-symbol",this.domNode).addClass("esriCTHidden"),a.removeClass(g,"esriCTHidden"),h.config.widgets&&1<h.config.widgets.length&&"dropDown"===h.config.openType&&this._openDropMenu(h));return h},_createDropTriangle:function(d){var b=a.getMarginBox(d);a.create("div",{"class":"drop-triangle",style:{left:b.l+
b.w/2-4+"px"}},d)},_onIconClick:function(a,b){a.config.widgets&&1!==a.config.widgets.length&&"openAll"!==a.config.openType?this.dropMenuNode?this._closeDropMenu():this._openDropMenu(a,b):this.openedId&&this.openedId===a.config.id?this._switchNodeToClose(this.openedId):this.openedId?this._switchNodeToClose(this.openedId).then(c.hitch(this,function(){this._closeDropMenu();this._switchNodeToOpen(a.config.id)})):this._switchNodeToOpen(a.config.id)},_closeDropMenu:function(){this.dropMenuNode&&(a.destroy(this.dropMenuNode),
this.dropMenuNode=null)},_openDropMenu:function(d,b){this.dropMenuNode=a.create("div",{"class":"jimu-drop-menu jimu-main-background",title:d.config.label,style:{position:"absolute",zIndex:"101"}});a.place(this.dropMenuNode,this.containerNode);r.forEach(d.config.widgets,function(a){this._createDropMenuItem(a,d)},this);this._setDropMenuPosition(d);this.morePane&&this.morePane.hide();this._initDropMenuEvent(d,b)},_initDropMenuEvent:function(a,e){var d=b(".menu-item",this.dropMenuNode);this.own(f(d,"keydown",
c.hitch(this,function(b){if(b.keyCode===k.TAB||b.keyCode===k.ESCAPE)b.stopPropagation(),b.preventDefault(),this._closeDropMenu(),a.focus();else{var c;b.keyCode===k.DOWN_ARROW?c=b.target.nextSibling?b.target.nextSibling:b.target:b.keyCode===k.UP_ARROW?c=b.target.previousSibling?b.target.previousSibling:b.target:b.keyCode===k.HOME?c=d[0]:b.keyCode===k.END&&(c=d[d.length-1]);c&&c.focus()}})));e||d[0].focus()},_createDropMenuItem:function(d,b){var e=a.create("div",{"class":"menu-item",tabindex:"-1",title:q.sanitizeHTML(d.label),
style:{height:this.height+"px"}},this.dropMenuNode);a.create("img",{"class":"jimu-float-leading",src:d.icon},e);a.create("div",{"class":"label jimu-float-leading",innerHTML:q.sanitizeHTML(d.label)},e);this.own(f(e,"click",c.hitch(this,function(){this._dropMenuItemClick(e)})));this.own(f(e,"keydown",c.hitch(this,function(a){a.keyCode!==k.ENTER&&a.keyCode!==k.SPACE||this._dropMenuItemClick(e)})));e.config=d;e.config.groupNode=b;return e},_dropMenuItemClick:function(a){this._closeDropMenu();this.openedId?
this._switchNodeToClose(this.openedId).then(c.hitch(this,function(){this._showIconContent(a.config)})):this._showIconContent(a.config)},_setDropMenuPosition:function(d){var b={},b=a.getMarginBox(this.dropMenuNode),b=this._getDropdownPosition(d,b);b.zIndex=101;a.setStyle(this.dropMenuNode,q.getPositionStyle(b))},_getDropdownPosition:function(b,c){var d={};b=a.getMarginBox(b);var e=a.getMarginBox(this.domNode);d.top=this.height+1;window.isRTL?d.right=0>b.l+b.w-c.w?0:b.l+b.w-c.w:b.l+c.w>e.w?d.right=
0:d.left=b.l;return d},_switchNodeToOpen:function(d){d=this._getIconNodeById(d);b(".icon-node",this.domNode).removeClass("jimu-state-selected");b(".widget-open-symbol",this.domNode).addClass("esriCTHidden");a.addClass(d,"jimu-state-selected");a.removeClass(d.children[1],"esriCTHidden");this._showIconContent(d.config)},_switchNodeToClose:function(a){b(".icon-node",this.domNode).removeClass("jimu-state-selected");this._setMapCanvasAreaToDefault();b(".widget-open-symbol",this.domNode).addClass("esriCTHidden");
var d=this.appConfig.getConfigElementById(a);if(d)return!1===d.inPanel?(this.widgetManager.closeWidget(a),this.openedId="",a=new w,a.resolve(),a):this.panelManager.closePanel(a+"_panel");a=new w;a.resolve();return a},_setMapCanvasAreaToDefault:function(){if(window.appInfo.isRunInMobile){var a=0;b(".jimu-widget-attributetable")[0]&&(a=b(".jimu-widget-attributetable")[0].clientHeight);a?l.publish("changeMapPosition",{bottom:a}):l.publish("changeMapPosition",{bottom:"0px"})}else l.publish("changeMapPosition",
{right:"0px"})},_setMapCanvasArea:function(){if(window.appInfo.isRunInMobile){var a=0;b(".jimu-widget-attributetable")[0]&&(a=b(".jimu-widget-attributetable")[0].clientHeight);if(this.panelManager&&this.panelManager.panels&&this.panelManager.panels[0]&&"normal"===this.panelManager.panels[0].windowState){var c=this.panelManager.getPositionOnMobile(this);a&&a>c.top?l.publish("changeMapPosition",{bottom:a}):l.publish("changeMapPosition",{bottom:c.top})}else 36<a?l.publish("changeMapPosition",{bottom:a}):
window.hasOwnProperty("ontouchstart")||void 0!==window.ontouchstart||760>=window.innerWidth?l.publish("changeMapPosition",{bottom:"36px"}):l.publish("changeMapPosition",{bottom:"0px"})}else this.panelManager&&this.panelManager.activePanel&&"minimized"===this.panelManager.activePanel.windowState?l.publish("changeMapPosition",{right:"0px"}):(l.publish("changeMapPosition",{right:"360px"}),this._resizeAttributeTableinRTL())},_resizeAttributeTableinRTL:function(){b(".jimu-widget-attributetable")[0]&&(window.isRTL?
a.setStyle(b(".jimu-widget-attributetable")[0],"right","0px"):a.setStyle(b(".jimu-widget-attributetable")[0],"left","0px"),b(".dijitTabContainer",b(".jimu-widget-attributetable")[0])[0]&&D.byId(b(".dijitTabContainer",b(".jimu-widget-attributetable")[0])[0].id).resize())},_getIconNodeById:function(a){a=b('.icon-node[settingId\x3d"'+a+'"]',this.domNode);if(0!==a.length)return a[0]},_unSelectIcon:function(a){b('.icon-node[settingId\x3d"'+a+'"]',this.domNode).removeClass("jimu-state-selected");this.openedId=
""},_showIconContent:function(d){var e=this._getIconNodeById(d.id);!1===d.inPanel?this.widgetManager.loadWidget(d).then(c.hitch(this,function(e){this.openedId=d.id;var f=this._getIconNodeById(d.id);a.setStyle(e.domNode,"zIndex",101);this._setOffPanelWidgetPosition(f,e);this.widgetManager.openWidget(e);this.own(m.after(e,"onClose",c.hitch(this,function(){b(".widget-open-symbol",this.domNode).addClass("esriCTHidden");this._setMapCanvasAreaToDefault();this._unSelectIcon(d.id);this._switchNodeToClose(f.config.id);
f.focus()})))})):(this._setMapCanvasArea(),this.panelManager.showPanel(d).then(c.hitch(this,function(h){var g;this.openedId=d.id;g=this._getIconNodeById(this.openedId);b(".icon-node",this.domNode).removeClass("jimu-state-selected");b(".widget-open-symbol",this.domNode).addClass("esriCTHidden");g&&(a.addClass(g,"jimu-state-selected"),a.removeClass(g.children[1],"esriCTHidden"));this.own(m.after(h,"onClose",c.hitch(this,function(){d.groupNode?(d.groupNode.focus(),this._setMapCanvasAreaToDefault()):
(this._unSelectIcon(d.id),this._setMapCanvasAreaToDefault(),this._switchNodeToClose(e.config.id))})));this.own(f(h.closeNode,"keydown",c.hitch(this,function(a){a.keyCode!==k.ESCAPE&&a.keyCode!==k.ENTER&&a.keyCode!==k.SPACE||(d.groupNode?d.groupNode:e).focus()})))})))},_setOffPanelWidgetPosition:function(a,b){a=this._getDropdownPosition(a,this.widgetManager.getWidgetMarginBox(b));b.setPosition(a,this.containerNode)},_showMorePane:function(){var b,e,f=[],g=this.getAllConfigs();for(b=this.headerIconCount;b<
g.length;b++)e=g[b],e.id!==this.openedId&&f.push(e);this.morePane&&this.morePane.destroy();this.moreIconPaneCoverNode&&a.destroy(this.moreIconPaneCoverNode);this._closeDropMenu();this.morePane=new C({openedId:this.openedId,items:f,numWidget:g});this._createCoverNode();a.place(this.morePane.domNode,jimuConfig.mapId);this.morePane.startup();m.after(this.morePane,"onNodeClicked",c.hitch(this,function(b){this._moveConfigToHeader(b.config);this._createIconNodes(a.getContentBox(this.domNode),b.config.id);
this._onIconClick(this._getIconNodeById(b.config.id))}),!0);m.after(this.morePane,"hide",c.hitch(this,function(){a.destroy(this.moreIconPaneCoverNode);this._morePaneNode.focus()}),!0)},_moveConfigToHeader:function(a){var b=this.getAllConfigs(),c=a.index;a.index=b[this.headerIconCount-1].index;b[this.headerIconCount-1].index=c},_createCoverNode:function(){this.moreIconPaneCoverNode=a.create("div",{"class":"jimu-more-icon-cover"},jimuConfig.layoutId)}})});