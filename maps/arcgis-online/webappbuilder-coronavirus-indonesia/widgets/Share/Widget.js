// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/ShareLink":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/array dojo/dom-class dojo/_base/html dojo/on dojo/keys dijit/Tooltip dojo/topic dojo/query jimu/utils jimu/shareUtils dojo/_base/config dojo/cookie dojo/text!./templates/ShareLink.html dojo/string dijit/form/Select dijit/form/NumberTextBox dojo/dom-attr dojo/Deferred esri/request jimu/dijit/FilterParameters esri/symbols/jsonUtils esri/InfoTemplate jimu/LayerInfos/LayerInfos esri/symbols/PictureMarkerSymbol esri/graphic esri/layers/GraphicsLayer jimu/dijit/FeaturelayerChooserFromMap jimu/dijit/LayerChooserFromMapWithDropbox dijit/form/TextBox dijit/form/Textarea dijit/form/RadioButton jimu/dijit/CheckBox dijit/form/SimpleTextarea dijit/form/ValidationTextBox".split(" "),
function(k,n,q,l,a,h,c,g,e,m,v,d,f,r,p,t,w,D,u,M,E,A,B,I,J,F,K,N,L,G,O,P,R){return k([n,q,l],{templateString:D,declaredClass:"jimu.dijit.ShareLink",bitlyUrl:"https://arcg.is/prod/shorten",share:{shareEmailSubject:"",shareTwitterTxt:"",languages:"ar cs da de en el es et fi fr he hr it ja ko lt lv nb nl pl pt-br pt-pt ro ru sr sv th tr zh-cn vi zh-hk zh-tw".split(" "),DEFAULT_MOBILE_LAYOUT:600},_hasZoomLevelMarkerAdded:!1,_hasMapScaleMarkerAdded:!1,_hasAddMarkerMarkerAdded:!1,HAS_INIT_URL:!1,MAX_LAYER_VISIBILITY_LEN:2048,
postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.shareLink;this.nls.symbol=window.jimuNls.common.symbol;this.nls.label=window.jimuNls.common.label;this.nls.WKID=window.jimuNls.common.wkid||"wkid";this.nls.popupTitle=window.jimuNls.shareLink.popupTitle||"Pop-up title";this.nls.zoomLevel=window.jimuNls.shareLink.zoomLevel||"Zoom level";this.nls.asc=window.jimuNls.common.asc;this.nls.desc=window.jimuNls.common.desc;this.share.shareEmailSubject=this.nls.shareEmailSubject+
" ${appTitle} ";this.share.shareTwitterTxt=this.nls.shareEmailSubject+"${appTitle}\n"},postCreate:function(){this.inherited(arguments);this._initUI();this._initMap();this._showSocialMediaLinksByConfig()},constructor:function(b){b&&(this._portalUrl=b.portalUrl,this._isOnline=b.isOnline,this._appTitle=b.appTitle,this._isShowBackBtn=b.isShowBackBtn,this._isShowSocialMediaLinks=b.isShowSocialMediaLinks,this._isSharedToPublic=b.isSharedToPublic,this._isShowFindLocation=b.isShowFindLocation,this._config=
b.config)},startup:function(){this.baseHrefUrl=p.getBaseHrefUrl(this._portalUrl);"undefined"===typeof this.optionSrc&&(this.optionSrc="currentMapExtent");this.updateUrl(null);this._initOptions();this._initOptionsEvent();var b=f(".shareLinkOptionsWrapper",this.domNode);this.own(e(b,"keydown",a.hitch(this,function(b){b.keyCode===m.ESCAPE&&(b.stopPropagation(),this.backBtn.focus())})));this.own(e(this.preview,"keydown",a.hitch(this,function(b){b.shiftKey||b.keyCode!==m.TAB||(b.preventDefault(),this.backBtn.focus())})))},
destroy:function(){this._cleanMarkerStatus();this._mapClickHandler&&(this._mapClickHandler=null);this.inherited(arguments)},onShareToPublicChanged:function(b){this._isSharedToPublic=b;this.updateUrl(null);this._isSharedToPublic?c.add(this.shareTips,"displaynone"):c.remove(this.shareTips,"displaynone")},onCloseContainer:function(){this._cleanMarkerStatus()},updateShareLinkOptionsUI:function(b){b&&"undefined"!==typeof b.isShowFindLocation&&this.findLocationRow&&(!1===b.isShowFindLocation?c.add(this.findLocationRow,
"displaynone"):!0===b.isShowFindLocation&&c.remove(this.findLocationRow,"displaynone"))},_initMap:function(){this.layerInfosObj=N.getInstanceSync();this.own(e(this.layerInfosObj,"layerInfosIsVisibleChanged",a.hitch(this,this._watchLayerChange)));window.isBuilder?(this.own(d.subscribe("app/mapLoaded",a.hitch(this,this._onMapLoaded))),this.own(d.subscribe("app/mapChanged",a.hitch(this,this._onMapLoaded)))):(this.own(d.subscribe("mapLoaded",a.hitch(this,this._onMapLoaded))),this.own(d.subscribe("mapChanged",
a.hitch(this,this._onMapLoaded))));window._widgetManager.map&&(this.map=window._widgetManager.map,this._mapEventUpdateUrls(),this._addGraphicsLayer())},_onMapLoaded:function(b){this.map=b;this._mapEventUpdateUrls();this._addGraphicsLayer()},_mapEventUpdateUrls:function(){this.map&&(this.own(e(this.map,"pan-end",a.hitch(this,function(){this._mapEventHandler("pan-end")}))),this.own(e(this.map,"resize",a.hitch(this,function(){this._mapEventHandler("resize")}))),this.own(e(this.map,"zoom-end",a.hitch(this,
function(){this._mapEventHandler("zoom-end")}))))},_mapEventHandler:function(){this._isShareLinkOptionsShow()&&this.updateUrl()},_showSocialMediaLinksByConfig:function(){this._config&&this._config.socialMedias&&("undefined"!==typeof this._config.socialMedias.email&&!1===this._config.socialMedias.email&&c.add(this.emailShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.facebook&&!1===this._config.socialMedias.facebook&&c.add(this.FacebookShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.twitter&&
!1===this._config.socialMedias.twitter&&c.add(this.TwitterShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.googlePlus&&!1===this._config.socialMedias.googlePlus&&c.add(this.googlePlusShare,"displaynone"))},_initUI:function(){this._isShowBackBtn?(A.set(this.backBtn,"title",window.jimuNls.common.back),this.own(e(this.backBtn,"click",a.hitch(this,this._toggleLinkOptions))),this.own(e(this.backBtn,"keydown",a.hitch(this,function(b){b.keyCode===m.ENTER||b.keyCode===m.SPACE||b.keyCode===
m.ESCAPE?(this._toggleLinkOptions(),this.linkOptions.focus()):b.shiftKey&&b.keyCode===m.TAB&&(b.preventDefault(),this.preview.textbox.focus())})))):c.add(this.backBtn,"displaynone");!1===this._isShowSocialMediaLinks&&c.toggle(this.socialNetworkLinks,"displaynone");!0===this._isSharedToPublic&&c.toggle(this.shareTips,"displaynone");this.own(e(this.linkOptions,"click",a.hitch(this,this._toggleLinkOptions)));this.own(e(this.linkOptions,"keydown",a.hitch(this,this._toggleLinkOptionsKeydown)));this._setInputsClicktoSelect(this._linkUrlTextBox);
r.addTooltipByDomNode(v,this.emailShare,this.nls.shareEmail);r.addTooltipByDomNode(v,this.FacebookShare,this.nls.shareFacebook);r.addTooltipByDomNode(v,this.TwitterShare,this.nls.shareTwitter);r.addTooltipByDomNode(v,this.googlePlusShare,this.nls.shareGooglePlus);this.own(e(this.googlePlusShare,"click",a.hitch(this,this._toGooglePlus)));this.own(e(this.googlePlusShare,"keydown",a.hitch(this,this._toGooglePlusKeyDown)));this._setInputsClicktoSelect(this._embedCodeTextArea);this.own(e(this.MoreOptionsContainer,
"keydown",a.hitch(this,function(b){b.keyCode===m.ESCAPE&&(b.stopPropagation(),this._moreOptionsExpandCollapse(),this.MoreOptions.focus())})));this._sizeOptions=new M({options:[{label:this.nls.smallSize,value:"small",selected:!0},{label:this.nls.mediumSize,value:"medium",selected:!1},{label:this.nls.largeSize,value:"large",selected:!1},{label:this.nls.customSize,value:"custom",selected:!1}],"class":"sizeOptionsSelect"});this._sizeOptions.placeAt(this.SizeSelect);this.own(e(this._sizeOptions,"change",
function(b){switch(b){case "small":this._widthTextBox.set("value",300);this._heightTextBox.set("value",200);c.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "medium":this._widthTextBox.set("value",800);this._heightTextBox.set("value",600);c.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "large":this._widthTextBox.set("value",1080);this._heightTextBox.set("value",720);c.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();
break;case "custom":c.remove(this.CustomSizeContainer,"disable")}}.bind(this)));this.own(e(this._sizeOptions,"keydown",function(b){b.shiftKey&&b.keyCode===m.TAB&&(b.preventDefault(),this._moreOptionsExpandCollapse(),this.MoreOptions.focus())}.bind(this)));this._widthTextBox=new E({"class":"sizeTextBox inputsText",value:300,constraints:{pattern:"#",places:0}});this._widthTextBox.placeAt(this.CustomSizeContainer,1);this.own(e(this._widthTextBox,"change",function(b){200>b?this._widthTextBox.set("value",
200>b?200:b):this._updateEmbedCodeFrameSize()}.bind(this)));this._heightTextBox=new E({"class":"sizeTextBox inputsText",value:200,constraints:{pattern:"#",places:0}});this._heightTextBox.placeAt(this.CustomSizeContainer,3);this.own(e(this._heightTextBox,"change",function(b){200>b?this._heightTextBox.set("value",200>b?200:b):this._updateEmbedCodeFrameSize()}.bind(this)));this.own(e(this._heightTextBox,"keydown",function(b){b.shiftKey||b.keyCode!==m.TAB||(b.preventDefault(),this._moreOptionsExpandCollapse(),
this.MoreOptions.focus())}.bind(this)));this.mobileLayout.set("value",this.share.DEFAULT_MOBILE_LAYOUT);this.updateShareLinkOptionsUI({isShowFindLocation:this._isShowFindLocation});this._setInputsClicktoSelect(this.preview)},_setLinkUrl:function(b){this._linkUrlTextBox.set("value",b);g.hasClass(this._linkUrlTextBox.domNode,"dijitFocused")&&this._linkUrlTextBox.textbox.select();A.set(this._linkUrlTextBox.domNode,"data-old",b)},_setEmbedCode:function(b){this._embedCodeTextArea.set("value",'\x3ciframe width\x3d"'+
this._widthTextBox.value+'" height\x3d"'+this._heightTextBox.value+'" frameborder\x3d"0" scrolling\x3d"no" allowfullscreen src\x3d"'+b+'"\x3e\x3c/iframe\x3e');A.set(this._embedCodeTextArea.domNode,"data-old-shortened",b)},_updateEmbedCodeFrameSize:function(b){b=this._embedCodeTextArea.get("value");b=b.replace(/width=\"[0-9]*\"/i,'width\x3d"'+this._widthTextBox.value+'"');b=b.replace(/height=\"[0-9]*\"/i,'height\x3d"'+this._heightTextBox.value+'"');this._embedCodeTextArea.set("value",b)},_initOptions:function(){var b=
[],d=this.map.getLevel();"number"===typeof d&&-1!==d?c.remove(this.chooseCenterWithLevelRow,"displaynone"):c.add(this.chooseCenterWithLevelRow,"displaynone");b=[];this.setlanguage_languages.removeOption(this.setlanguage_languages.getOptions());h.forEach(this.share.languages,function(a){var d={label:a,value:a};d.selected=a===t.locale?!0:!1;b.push(d)});this.setlanguage_languages.addOption(b);d="";try{var f=w("esri_auth");f&&(d=JSON.parse(f).token)}catch(H){console.log("ShareLink can't parse Auth:"+
H)}d&&this.authtoken.set("value",d);f=new P({createMapResponse:this.map.webMapResponse,showLayerFromFeatureSet:!1,onlyShowVisible:!1,updateWhenLayerInfosIsShowInMapChanged:!1});c.add(f.domNode,"share-layerChooser-dropbox");this.layerChooserFromMapWithDropbox=new R({layerChooser:f,customClass:"jimu-shareLink-dropbox-popup"});this.layerChooserFromMapWithDropbox.placeAt(this.queryFeature_layer);this.own(e(this.layerChooserFromMapWithDropbox,"selection-change",a.hitch(this,this._updateQueryFeature_Layer)));
this.queryFeature_valueFilter.filterParams=new J;this.queryFeature_valueFilter.filterParams.placeAt(this.queryFeature_valueFilter);this.own(e(this.queryFeature_valueFilter.filterParams,"change",a.hitch(this,function(){this._updateUrlByQueryFeatures();this.updateUrl()})));"undefined"!==typeof this.map.spatialReference&&"undefined"!==typeof this.map.spatialReference.wkid&&this.addMarker_spatialReference.set("value",this.map.spatialReference.wkid)},_initOptionsEvent:function(){var b=r.has("ie")||r.has("edge")?
"change":"KeyUp",d=f(".shareRadios",this.domNode);this.own(e(d,"click",a.hitch(this,function(b){this.optionSrc=A.get(b.srcElement||b.target,"data-id");this.updateUrl()})));d=f(".shareCheckBoxes",this.domNode);this.own(e(d,"click",a.hitch(this,function(){this.updateUrl()})));this.own(e(this.chooseCenterWithLevel_levels,"change",a.hitch(this,function(){this.updateUrl()})));this.own(e(this.chooseCenterWithScale_scales,"change",a.hitch(this,function(){this.updateUrl()})));this.own(e(this.setlanguage_languages,
"change",a.hitch(this,function(){this.updateUrl()})));this.own(e(this.findLocation_input,b,a.hitch(this,this.updateUrl)));this.own(e(this.queryFeature_field,"change",a.hitch(this,this._updateQueryFeature_Value)));this.own(e(this.mobileLayout,b,a.hitch(this,this.updateUrl)));this.own(e(this.authtoken,b,a.hitch(this,this.updateUrl)));this.own(e(this.addMarker_marker,"click",a.hitch(this,function(b){this._onMarkersClick(b)})));this.own(e(this.addMarker_spatialReference,"change",a.hitch(this,this.updateUrl)));
this.own(e(this.addMarker_title,b,a.hitch(this,this.updateUrl)));this.own(e(this.addMarker_symbolURL,b,a.hitch(this,this.updateUrl)));this.own(e(this.addMarker_label,b,a.hitch(this,this.updateUrl)));this.own(e(this.addMarker_level,"change",a.hitch(this,this.updateUrl)));this.own(e(this.chooseCenterWithLevel_marker,"click",a.hitch(this,function(b){this._onMarkersClick(b)})));this.own(e(this.chooseCenterWithScale_marker,"click",a.hitch(this,function(b){this._onMarkersClick(b)})))},_onMarkersClick:function(b){p.disableWebMapPopup(this.map);
this._unselectMarkerBtn();this._selectMarkerBtn(b);this._hidePopup();this._removeGraphicsLayer();this._mapClickHandler=e.once(this.map,"click",a.hitch(this,this._onMapClick))},_onMapClick:function(b){var a=b.mapPoint;this._addGraphicsLayerMarker(b);"chooseCenterWithLevel"===this.optionSrc?this._hasZoomLevelMarkerAdded=!1:"chooseCenterWithScale"===this.optionSrc?this._hasMapScaleMarkerAdded=!1:"addMarker"===this.optionSrc&&(this._hasAddMarkerMarkerAdded=!1);this._unselectMarkerBtn();this.updateUrl(a);
this._showPopup();p.enableWebMapPopup(this.map)},_hidePopup:function(){d.publish("ShareLink/onHideContainer")},_showPopup:function(){d.publish("ShareLink/onShowContainer")},_updateResUrls:function(b){"currentMapExtent"===this.optionSrc?(b=this.getMapExtent(this.map),this.resultUrl=p.addQueryParamToUrl(this.baseHrefUrl,"extent",b,!0)):"chooseCenterWithLevel"===this.optionSrc?(!1===this._hasZoomLevelMarkerAdded&&(this.resultUrl=p.addQueryParamToUrl(this.baseHrefUrl,"center",this.getMapCenter(this.map,
b),!0),b&&b.x&&b.y&&(this._hasZoomLevelMarkerAdded=!0)),this.resultUrl=p.addQueryParamToUrl(this.resultUrl,"level",this._getMapLevel(),!0)):"chooseCenterWithScale"===this.optionSrc?(!1===this._hasMapScaleMarkerAdded&&(this.resultUrl=p.addQueryParamToUrl(this.baseHrefUrl,"center",this.getMapCenter(this.map,b),!0),b&&b.x&&b.y&&(this._hasMapScaleMarkerAdded=!0)),this.resultUrl=p.addQueryParamToUrl(this.resultUrl,"scale",this._getMapScale(),!0)):"findLocation"===this.optionSrc?(b=this.findLocation_input.get("value"),
this.resultUrl=p.addQueryParamToUrl(this.baseHrefUrl,"find",b,!0)):"queryFeature"===this.optionSrc?this._updateUrlByQueryFeatures():"addMarker"===this.optionSrc&&(!1===this._hasAddMarkerMarkerAdded?(this.resultUrl=p.addQueryParamToUrl(this.baseHrefUrl,"marker",this.getMapCenter(this.map,b,null,this._getWkid()),!0),this.resultUrl+=",",b&&b.x&&b.y&&(this._hasAddMarkerMarkerAdded=!0,this._lastAddMarkerParamObj=b)):(this.resultUrl=p.addQueryParamToUrl(this.baseHrefUrl,"marker",this.getMapCenter(this.map,
this._lastAddMarkerParamObj,null,this._getWkid()),!0),this.resultUrl+=","),this.resultUrl+=encodeURIComponent(this.addMarker_title.get("value")||""),this.resultUrl+=",",this.resultUrl+=encodeURIComponent(this.addMarker_symbolURL.get("value")||""),this.resultUrl+=",",this.resultUrl+=encodeURIComponent(this.addMarker_label.get("value")||""),b=this._getMapLevel(),this.resultUrl="number"===typeof b&&-1!==b?p.addQueryParamToUrl(this.resultUrl,"level",this._getMapLevel(),!0):p.addQueryParamToUrl(this.resultUrl,
"scale",this._getMapScale(),!0));this.resultUrl=p.removeQueryParamFromUrl(this.resultUrl,"mobileBreakPoint",!0);this.resultUrl=p.removeQueryParamFromUrl(this.resultUrl,"locale",!0);this.resultUrl=p.removeQueryParamFromUrl(this.resultUrl,"token",!0);this.resultUrl=p.removeQueryParamFromUrl(this.resultUrl,"layers",!0);this.overwirteMobileLayout.checked&&(this.resultUrl=p.addQueryParamToUrl(this.resultUrl,"mobileBreakPoint",this.mobileLayout.getValue(),!0));this.setlanguage.checked&&(this.resultUrl=
p.addQueryParamToUrl(this.resultUrl,"locale",this.setlanguage_languages.getValue(),!0));this.auth.checked&&(this.resultUrl=p.addQueryParamToUrl(this.resultUrl,"token",this.authtoken.getValue(),!0));if(this.setLayerVisibility.checked){b=this.resultUrl;for(var a=!1,d=["showLayers","hideLayers","showLayersEncoded","hideLayersEncoded"],c,f=0,z=d.length;f<z;f++)if(c=d[f],c=p.addQueryParamToUrl(b,c,this._getLayersVisibility(c),!0),!this._isResultURLTooLong(c,this.resultUrl)){a=!0;this.resultUrl=c;break}a||
(c=d[0],this.resultUrl=p.addQueryParamToUrl(b,c,this._getLayersVisibility(c),!0))}this.cleanUrlLengthWarning();(p.getQueryParamFromUrl(this.resultUrl,"showLayersEncoded")||p.getQueryParamFromUrl(this.resultUrl,"hideLayersEncoded"))&&this.setUrlEncodeWarning();this._isResultURLTooLong(this.resultUrl)&&this.setUrlToolongWarning()},setUrlEncodeWarning:function(){this._setUrlLengthWarning(this.nls.urlEncodedTips)},setUrlToolongWarning:function(){this._setUrlLengthWarning(this.nls.urlTooLongTips)},_setUrlLengthWarning:function(b){g.removeClass(this.urlLengthTips1,
"displaynone");g.removeClass(this.urlLengthTips2,"displaynone");b&&(this.urlLengthTips1.innerHTML=b,this.urlLengthTips2.innerHTML=b)},cleanUrlLengthWarning:function(){g.addClass(this.urlLengthTips1,"displaynone");g.addClass(this.urlLengthTips2,"displaynone");this.urlLengthTips1.innerHTML="";this.urlLengthTips2.innerHTML=""},_isResultURLTooLong:function(b,a){if(!b||!b.length)return!1;var d=0;a&&a.length&&(d=a.length);return b.length>=this.MAX_LAYER_VISIBILITY_LEN-d?!0:!1},_getLayersVisibility:function(b){var a;
(b=this.layerInfosObj.getSimplificationState()[b])&&b.join&&(a=b.join(";"));return a},_updateUrlByQueryFeatures:function(){var b=this._getIdFromLayerChoose()||"",a=this.queryFeature_field.get("value"),d=this._getQueryFeatureFilterValue();this.resultUrl=p.addQueryParamToUrl(this.baseHrefUrl,"query",b,!0);a&&(this.resultUrl+=",",this.resultUrl+=a,d&&(this.resultUrl+=",",this.resultUrl+=d))},_updateQueryFeature_Layer:function(){this._updateUrlByQueryFeatures();this._updateQueryFeature_Field();this._updateQueryFeature_Value();
this.updateUrl()},_updateQueryFeature_Field:function(){var b=this._getFieldsFromLayerChoose(),d=[];this.queryFeature_field.removeOption(this.queryFeature_field.getOptions());h.forEach(b,a.hitch(this,function(b){-1<"esriFieldTypeString esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble".split(" ").indexOf(b.type)&&d.push({label:b.name,value:b.name,type:b.type})}));this.queryFeature_field.addOption(d);this._updateUrlByQueryFeatures();this._updateQueryFeature_Value();
this.updateUrl()},_updateQueryFeature_Value:function(){var b=[];if(""!==this.queryFeature_field.get("value")){for(var a=this.queryFeature_field.options,d=0,c=a.length;d<c;d++){var f=a[d];f.selected&&b.push(f)}this._query(b)}},_updateQueryFeature_Sort:function(){c.contains(this.queryFeature_sortBtn,"ASC")?g.setAttr(this.queryFeature_sortBtn,"title",this.nls.desc):g.setAttr(this.queryFeature_sortBtn,"title",this.nls.asc);c.toggle(this.queryFeature_sortBtn,"DESC");c.toggle(this.queryFeature_sortBtn,
"ASC");this._updateQueryFeature_Value()},_getSortFromBtn:function(b){c.contains(this.queryFeature_sortBtn,"DESC")&&(b+=" DESC");return[b]},_getIdFromLayerChoose:function(){var b=null,a=this.layerChooserFromMapWithDropbox.getSelectedItem();a&&a.layerInfo&&a.layerInfo.id&&(b=a.layerInfo.id);return b},_getFieldsFromLayerChoose:function(){var b=[],a=this.layerChooserFromMapWithDropbox.getSelectedItem();a&&a.layerInfo&&a.layerInfo.layerObject&&a.layerInfo.layerObject.fields&&(b=a.layerInfo.layerObject.fields);
return b},_getUrlFromLayerChoose:function(){var b="",a=this.layerChooserFromMapWithDropbox.getSelectedItem();a&&a.url&&(b=a.url);return b},_updateLinkOptionsUI:function(){f(".optionsMore",this.domNode).style("display","none");f("."+this.optionSrc+"_optionsMore",this.domNode).style("display","block");this.overwirteMobileLayout.checked&&f(".share-options-overwirteMobileLayout_optionsMore",this.domNode).style("display","block");this.setlanguage.checked&&f(".share-options-language_optionsMore",this.domNode).style("display",
"block");this.auth.checked&&f(".share-options-auth_optionsMore",this.domNode).style("display","block")},_fixUrlIfIsOnline:function(b){if(this._isOnline&&this._isSharedToPublic){var a="",a=window.isBuilder?window.top.location.protocol:window.location.protocol,d=this._getUrlQueryString(b);b=this._getOnlinePublicUrl(b);b=a+"//"+b+"/apps/webappviewer/index.html"+d}return b},updateUrl:function(b){this._updateResUrls(b);this._updateLinkOptionsUI();!0!==this.config.useOrgUrl&&(this.resultUrl=this._fixUrlIfIsOnline(this.resultUrl));
this.preview.set("value",this.resultUrl);null===b&&this._generateShortenUrl();this._updateEmailHref()},_generateShortenUrl:function(){var b=this.preview.get("value");try{this.isUseShortenUrl()?this.shortenUrl(b,this.bitlyUrl).then(a.hitch(this,function(b){this._useShortenUrl(b);this.HAS_INIT_URL=!0}),a.hitch(this,function(a){this._useLengthenUrl(b,a);this.HAS_INIT_URL=!0})):(this._useLengthenUrl(b),this.HAS_INIT_URL=!0)}catch(Q){console.error(Q),this.HAS_INIT_URL=!0}},_useShortenUrl:function(b){this.shortenedUrl=
b;this._setLinkUrl(b);this._setEmbedCode(b)},_useLengthenUrl:function(b){b=b||"";this._setLinkUrl(b);this._setEmbedCode(b)},_toFacebook:function(){var b="http://www.facebook.com/sharer/sharer.php?u\x3d"+encodeURIComponent(this._linkUrlTextBox.get("value"))+"\x26t\x3d"+encodeURIComponent(r.stripHTML(this.socialNetworkTitle(this._appTitle)));window.open(b,"","toolbar\x3d0,status\x3d0,width\x3d626,height\x3d436")},_toFacebookKeyDown:function(b){b.keyCode===m.ENTER&&this._toFacebook()},_toTwitter:function(){var b=
u.substitute(this.share.shareTwitterTxt,{appTitle:r.stripHTML(this._appTitle)}),a=this._linkUrlTextBox.get("value");window.open("http://twitter.com/home?status\x3d"+encodeURIComponent(b+a+"\n@ArcGISOnline"),"","toolbar\x3d0,status\x3d0,width\x3d626,height\x3d436")},_toTwitterKeyDown:function(b){b.keyCode===m.ENTER&&this._toTwitter()},_updateEmailHref:function(){var b="mailto:?subject\x3d"+u.substitute(this.share.shareEmailSubject,{appTitle:r.stripHTML(this._appTitle)}),a=this.preview.get("value"),
b=b+("\x26body\x3d"+encodeURIComponent(this.nls.shareEmailTxt1)+"%0D%0A%0D%0A"+r.stripHTML(this._appTitle)),b=b+("%0D%0A"+encodeURIComponent(a)),b=b+("%0D%0A%0D%0A"+encodeURIComponent(this.nls.shareEmailTxt2)),b=b+("%0D%0A%0D%0A"+encodeURIComponent(this.nls.shareEmailTxt3));g.setAttr(this.emailShare,"href",b)},_toGooglePlus:function(){var b=this._linkUrlTextBox.get("value"),b="http://plus.google.com/share?url\x3d"+encodeURIComponent(b);window.open(b,"","toolbar\x3d0,status\x3d0,width\x3d626,height\x3d436")},
_toGooglePlusKeyDown:function(b){b.keyCode===m.ENTER&&this._toGooglePlus()},_toggleLinkOptions:function(){p.enableWebMapPopup(this.map);var b=f(".shareOptionsWrapper",this.domNode.parentNode||this.domNode.parentElement),a=f(".shareUrlsWrapper",this.domNode),e=f(".shareLinkOptionsWrapper",this.domNode);this._isShareLinkOptionsShow()?(d.publish("ShareLink/onHideLinkOptions"),this._cleanMarkerStatus(),this._generateShortenUrl()):d.publish("ShareLink/onShowLinkOptions");b&&b[0]&&c.toggle(b[0],"displaynone");
c.toggle(a[0],"displaynone");c.toggle(e[0],"displaynone")},_toggleLinkOptionsKeydown:function(b){if(b.keyCode===m.ENTER&&(this._toggleLinkOptions(),this._isShareLinkOptionsShow())){b=f(".shareRadios input",this.shareOptionsRadios);for(var a=0,d=b.length;a<d;a++){var c=b[a];c.checked&&c.focus()}}},_moreOptionsExpandCollapse:function(){c.toggle(this.MoreOptionsContainer,"displaynone");c.toggle(this.MoreOptionsIcon,"rotate")},_moreOptionsExpandCollapseKeyDown:function(b){b.keyCode===m.ENTER&&(this._moreOptionsExpandCollapse(),
g.hasClass(this.MoreOptionsContainer,"displaynone")||this._sizeOptions.focus())},_setInputsClicktoSelect:function(b){A.set(b,"onclick","this.select()");A.set(b,"onmouseup","return false;");A.set(b,"onfocus","this.select()");A.set(b,"onblur","return false;")},isUseShortenUrl:function(){return location.hostname.endWith("esri.com")||location.hostname.endWith("arcgis.com")?!0:!1},shortenUrl:function(b,d){var c=new B;b=p.addQueryParamToUrl(d,"longUrl",b,!0);b=p.addQueryParamToUrl(b,"format","json",!0);
I({url:b,handleAs:"json",callbackParamName:"callback"}).then(a.hitch(this,function(b){b&&200===b.status_code&&b.data&&b.data.url&&0<b.data.url.length?c.resolve(b.data.url):c.reject(b)}),a.hitch(this,function(b){console.log("can't fetch shortenUrl "+b);c.reject(b)}));return c},socialNetworkTitle:function(b){100<b.length&&(b=b.substring(0,97)+"...");return b},getMapExtent:function(b){b=b.extent;var a="";b.spatialReference.wkid?a=b.spatialReference.wkid:!b.spatialReference.wkid&&b.spatialReference.wkt&&
(a="wkt\x3d"+b.spatialReference.wkt);return null!==b?this._roundValue(b.xmin,1E4)+","+this._roundValue(b.ymin,1E4)+","+this._roundValue(b.xmax,1E4)+","+this._roundValue(b.ymax,1E4)+","+a:""},_roundValue:function(b,a){return Math.round(b*a)/a},getMapCenter:function(b,a,d,c){d=d?d:",";var f=null;a&&a.x&&a.y?f=a:b.extent.getCenter()&&(f=b.extent.getCenter());b=c||f.spatialReference.wkid;return null!==f?this._roundValue(f.x,1E4)+d+this._roundValue(f.y,1E4)+d+b:""},_getMapLevel:function(){return this.map.getLevel()},
_getMapScale:function(){return this.map.getScale()},_getWkid:function(){return this.addMarker_spatialReference.get("value")||""},_getQueryedValues:function(b,d){var c=[];h.forEach(d.features,a.hitch(this,function(a){a=a.attributes[b]+"";c.push({label:a,value:a})}));return c},_addGraphicsLayer:function(){window.isBuilder||"undefined"!==typeof this._graphicsLayer||(this.map.getLayer("marker-feature-action-layer")?this._graphicsLayer=this.map.getLayer("marker-feature-action-layer"):(this._graphicsLayer=
new O({id:"marker-feature-action-layer"}),this.map.addLayer(this._graphicsLayer)))},_removeGraphicsLayer:function(){window.isBuilder||"undefined"===typeof this._graphicsLayer||(this.map.infoWindow&&this.map.infoWindow.features&&this.map.infoWindow.features[0]===this._markerGraphic&&this.map.infoWindow.hide(),this._markerGraphic&&this._markerGraphic._textSymbol&&this._graphicsLayer.remove(this._markerGraphic._textSymbol),this._graphicsLayer.remove(this._markerGraphic),this._markerGraphic=null)},_addGraphicsLayerMarker:function(b){if(!window.isBuilder&&
"undefined"!==typeof this._graphicsLayer)if("addMarker"!==this.optionSrc)this._markerGraphic=this._getMarkerGraphic(b.mapPoint),this._graphicsLayer.add(this._markerGraphic);else{var a=new K("",this.addMarker_title.get("value")||""),d=F.fromJson({type:"esriPMS",url:require.toUrl("jimu")+"/images/EsriBluePinCircle26.png",contentType:"image/png"});d.width=26;d.height=26;d.setOffset(0,12);this._markerGraphic=new G(b.mapPoint,d,null,a);this._graphicsLayer.add(this._markerGraphic);if(a=F.fromJson({color:[0,
0,0,255],type:"esriTS",verticalAlignment:"baseline",horizontalAlignment:"left",angle:0,xoffset:0,yoffset:0,rotated:!1,kerning:!0,font:{size:12,style:"normal",weight:"bold",family:"Arial"},text:this.addMarker_label.get("value")||""}))a.xoffset=d.width/2,a.yoffset=d.height/2+d.yoffset,b=new G(b.mapPoint,a),this._graphicsLayer.add(b),this._markerGraphic._textSymbol=b}},_getMarkerGraphic:function(b){var a=new L(require.toUrl("jimu")+"/images/EsriBluePinCircle26.png",26,26);a.setOffset(0,12);return new G(b,
a)},_unselectMarkerBtn:function(){for(var b=f(".markers",this.domNode),a=0,d=b.length;a<d;a++)c.remove(b[a],"selected")},_selectMarkerBtn:function(b){c.add(b.srcElement||b.target,"selected")},_cleanMarkerStatus:function(){this._mapClickHandler&&this._mapClickHandler.remove&&this._mapClickHandler.remove();this._unselectMarkerBtn();this._removeGraphicsLayer()},_isShareLinkOptionsShow:function(){var b=f(".shareLinkOptionsWrapper",this.domNode);return!c.contains(b[0],"displaynone")},_getUrlQueryString:function(b){var a=
"";-1!==b.indexOf("?")&&(a=b.substring(b.indexOf("?")));return a},_getOnlinePublicUrl:function(){var b="www.arcgis.com",a=this._portalUrl;a&&"string"===typeof a&&(-1<a.indexOf("devext.arcgis.com")?b="devext.arcgis.com":-1<a.indexOf("qaext.arcgis.com")&&(b="qaext.arcgis.com"));return b},_watchLayerChange:function(){this.setLayerVisibility.checked&&this.updateUrl()},_query:function(b){if(b&&b[0]){b=b[0];var d=this._getFieldShortType(b),c=this.layerChooserFromMapWithDropbox.getSelectedItem(),f=c.layerInfo.id,
e=c.url,z={logicalOperator:"AND",parts:[{fieldObj:{name:b.value,label:b.label,dateFormat:"",shortType:d,type:b.type},operator:d+"OperatorIs",valueObj:{isValid:!0,type:"unique",value:null},interactiveObj:{prompt:"...",hint:"",cascade:"none"}}],expr:"",displaySQL:""};(b=this.layerInfosObj.getLayerInfoById(f))&&b.getLayerObject().then(a.hitch(this,function(b){var x=a.clone(z);x.wId=this.id+"_"+b.id+"_"+g.getAttr(this.queryFeature_valueFilter,"data-index");this.queryFeature_valueFilter.filterParams.build(e,
b,x,f,this.id);this.queryFeature_valueFilter.expr=this.queryFeature_valueFilter.filterParams.getFilterExpr()}));this._updateUrlByQueryFeatures();this.updateUrl()}},_getFieldShortType:function(b){return"esriFieldTypeString"===b.type?"string":"number"},_getQueryFeatureFilterValue:function(){var b="";this.queryFeature_valueFilter.filterParams.partsObj&&this.queryFeature_valueFilter.filterParams.getValueProviders()[0].getValueObject()&&(b=this.queryFeature_valueFilter.filterParams.getValueProviders()[0].getValueObject().value,
b.toFixed&&(b=b.toString()));return b}})})},"jimu/dijit/FeaturelayerChooserFromMap":function(){define(["dojo/_base/declare","dojo/Deferred","dojo/_base/html","dojo/_base/lang","./LayerChooserFromMap"],function(k,n,q,l,a){return k([a],{baseClass:"jimu-featurelayer-chooser-from-map",declaredClass:"jimu.dijit.FeaturelayerChooserFromMap",types:null,showLayerFromFeatureSet:!1,showTable:!1,onlyShowVisible:!1,ignoredFeaturelayerIds:null,mustSupportStatistics:!1,ignoreVirtualLayer:!1,postMixInProperties:function(){this.inherited(arguments);
this.ignoredFeaturelayerIds||(this.ignoredFeaturelayerIds=[]);this.basicFilter=l.hitch(this,this.basicFilter);this.filter=a.createFeaturelayerFilter(this.types,this.showLayerFromFeatureSet,this.showTable,this.mustSupportStatistics);this.ignoreVirtualLayer&&(this.filter=a.andCombineFilters([this.filter,l.hitch(this,this._ignoreVirtualLayerFilter)]))},postCreate:function(){this.inherited(arguments);q.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},_ignoreVirtualLayerFilter:function(a){return a.getLayerType().then(function(a){return!("ArcGISDynamicMapServiceLayer"===
a||"ArcGISTiledMapServiceLayer"===a||"GroupLayer"===a)})},basicFilter:function(a){var c=new n;0<=this.ignoredFeaturelayerIds.indexOf(a.id)?c.resolve(!1):this.onlyShowVisible&&"Table"!==a.getLayerType()?c.resolve(a.isShowInMap()):c.resolve(!0);return c},getHandledItem:function(a){var c=this.inherited(arguments),g=a&&a.layerInfo,g=g&&g.layerObject;c.url=g&&g.url||"";return c}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(k,n,q,l,a,h,c,g,e,m,v,d,f,r,p,t,w,D){var u=q([l,a,h,n],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,
updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,displayTooltipForTreeNode:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);f.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new D({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=d.hitch(this,this.basicFilter);this.filter=u.andCombineFilters([this.basicFilter,
this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(a){var d=new g;this.onlyShowVisible?d.resolve(a.isShowInMap()):d.resolve(!0);return d},filter:function(a){a=new g;a.resolve(!0);return a},getSelectedItems:function(){var a=this.tree.getSelectedItems();return r.map(a,d.hitch(this,function(a){return this.getHandledItem(a)}))},getAllItems:function(){var a=this.tree.getAllItems(),c=[];r.forEach(a,d.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),
c.push(a))}));return c},getHandledItem:function(a){return{name:a.name,layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(a){this.createMapResponse=a;w.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(d.hitch(this,function(a){this.layerInfosObj=a;this.own(k(this.layerInfosObj,"layerInfosChanged",d.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&this.own(k(this.layerInfosObj,"layerInfosIsShowInMapChanged",
d.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(a,d){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(a){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(a){this._clear();f.setStyle(this.errorTipSection,"display","block");var c=[];this.onlyShowWebMapLayers?(c=a.getLayerInfoArrayOfWebmap(),c=c.concat(a.getTableInfoArrayOfWebmap())):(c=a.getLayerInfoArray(),
c=c.concat(a.getTableInfoArray()));0!==c.length&&(f.setStyle(this.errorTipSection,"display","none"),r.forEach(c,d.hitch(this,function(a){this._addDirectLayerInfo(a)})))},_addDirectLayerInfo:function(a){a&&a.getLayerObject().then(d.hitch(this,function(){this._addItem("root",a)}),d.hitch(this,function(a){console.error(a)}))},_clear:function(){var a=this._store.query({parent:"root"});r.forEach(a,d.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_addItem:function(a,c){var f=null,
e=c.getLayerType(),g=this.filter(c);v({layerType:e,valid:g}).then(d.hitch(this,function(e){if(e.valid){var g=d.hitch(this,function(d,g){this._id++;f={name:c.title||"",parent:a,layerInfo:c,type:e.layerType,layerClass:c.layerObject.declaredClass,id:this._id.toString(),isLeaf:d,hasChildren:g};this._store.add(f)}),h=c.getSubLayers(),m=0===h.length;m?g(m,!1):(h=r.map(h,d.hitch(this,function(a){return this.filter(a)})),v(h).then(d.hitch(this,function(a){(a=r.some(a,function(a){return a}))&&g(m,a)})))}}))},
_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var a=this._getRootItem(),a=new c({data:[a],getChildren:function(a){return this.query({parent:a.id})}});this._store=new e(a);a=new m({store:this._store,query:{id:"root"},mayHaveChildren:d.hitch(this,this._mayHaveChildren)});this.tree=new t({multiple:this.multiple,model:a,showRoot:!1,isLeafItem:d.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:d.hitch(this,function(a,d){"root"!==
a.id&&this._onTreeOpen(a,d)}),onClick:d.hitch(this,function(a,d,c){this._onTreeClick(a,d,c);this.emit("tree-click",a,d,c)}),getIconStyle:d.hitch(this,function(a,d){var c=null;if(!a||"root"===a.id)return null;var f={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},e=window.location.protocol+"//"+window.location.host+require.toUrl("jimu");if(a=this._getIconInfo(a,d).imageName)f.backgroundImage="url("+e+"/css/images/"+a+")",c=f;return c}),
getIconClass:d.hitch(this,function(a,d){return this._getIconInfo(a,d).className}),getTooltip:d.hitch(this,function(a){return this.displayTooltipForTreeNode?a.layerInfo.title:""})});f.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},_getIconInfo:function(a,d){var c="",f="";"ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===a.type?d?(c="mapserver_open.png",f="mapservice-layer-icon open"):
(c="mapserver_close.png",f="mapservice-layer-icon close"):"GroupLayer"===a.type?d?(c="group_layer2.png",f="group-layer-icon open"):(c="group_layer1.png",f="group-layer-icon close"):"FeatureLayer"===a.type?(a=p.getTypeByGeometryType(a.layerInfo.layerObject.geometryType),"point"===a?(c="point_layer1.png",f="point-layer-icon"):"polyline"===a?(c="line_layer1.png",f="line-layer-icon"):"polygon"===a&&(c="polygon_layer1.png",f="polygon-layer-icon")):"Table"===a.type?(c="table.png",f="table-icon"):"ArcGISImageServiceLayer"===
a.type||"ArcGISImageServiceVectorLayer"===a.type?(c="image_layer.png",f="iamge-layer-icon"):d?(c="mapserver_open.png",f="mapservice-layer-icon open"):(c="mapserver_close.png",f="mapservice-layer-icon close");return{imageName:c,className:f}},_onTreeOpen:function(a,c){if("root"!==a.id){var f=[];c=[];f=a.layerInfo.getSubLayers();a.checked||(this.shelter.show(),c=r.map(f,d.hitch(this,function(a){return a.getLayerObject()})),v(c).then(d.hitch(this,function(){this.domNode&&(r.forEach(f,d.hitch(this,function(d){this._addItem(a.id,
d)})),a.checked=!0,this.shelter.hide())}),d.hitch(this,function(a){console.error(a);this.shelter.hide()})))}},_onTreeClick:function(a,d,c){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});u.createFilterByLayerType=function(a){d.isArrayLike(a)||(a=[]);return function(d){var c=new g;if(0===a.length)c.resolve(!0);else{var f=[];d.traversal(function(a){f.push(a.getLayerType())});v(f).then(function(d){for(var f=0;f<
d.length;f++)for(var e=0;e<a.length;e++)if(d[f]===a[e]){c.resolve(!0);return}c.resolve(!1)},function(a){console.error(a);c.reject(a)})}return c}};u.createFeaturelayerFilter=function(a,d,c,f){var e=["point","polyline","polygon"];a&&0<a.length?(a=r.filter(a,function(a){return 0<=e.indexOf(a)}),0===a.length&&(a=e)):a=e;return function(e){var g=e.getLayerType();e=e.getLayerObject();return v({layerType:g,layerObject:e}).then(function(e){var g=e.layerType;e=e.layerObject;if("ArcGISDynamicMapServiceLayer"===
g||"ArcGISTiledMapServiceLayer"===g||"GroupLayer"===g||"FeatureCollection"===g)return!0;if("FeatureLayer"===g){var g=p.getTypeByGeometryType(e.geometryType),g=0<=r.indexOf(a,g),h=u._shouldPassStatisticsCheck(f,e);return e.url?(e=p.isFeaturelayerUrlSupportQuery(e.url,e.capabilities),g&&e&&h):d&&g}return"Table"===g?(g=p.isFeaturelayerUrlSupportQuery(e.url,e.capabilities),e=u._shouldPassStatisticsCheck(f,e),c&&g&&e):!1})}};u.createImageServiceLayerFilter=function(a,d){return function(c){var f=c.getLayerType();
c=c.getLayerObject();return v({layerType:f,layerObject:c}).then(function(c){var f=c.layerType,e=c.layerObject;return"ArcGISImageServiceLayer"===f||"ArcGISImageServiceVectorLayer"===f?a?p.isImageServiceSupportQuery(c.layerObject.capabilities)?d?u._shouldPassStatisticsCheck(d,e):!0:!1:!0:!1})}};u._shouldPassStatisticsCheck=function(a,d){return a?(a=!1,a=d.advancedQueryCapabilities?!!d.advancedQueryCapabilities.supportsStatistics:!!d.supportsStatistics):!0};u.createQueryableLayerFilter=function(a){var d=
u.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,a);a=u.createImageServiceLayerFilter(!0,a);return u.orCombineFilters([d,a])};u.andCombineFilters=function(a){return u._combineFilters(a,!0)};u.orCombineFilters=function(a){return u._combineFilters(a,!1)};u._combineFilters=function(a,d){return function(c){var f=new g,e=r.map(a,function(a){return a(c)});v(e).then(function(a){var c=!1,c=d?r.every(a,function(a){return a}):r.some(a,function(a){return a});f.resolve(c)},function(a){console.error(a);
f.reject(a)});return f}};return u})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(k,n,q,l,a,h,c){return q("dijit.tree.ObjectStoreModel",c,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(c){a.mixin(this,c);this.childrenCache={}},getRoot:function(c,e){if(this.root)c(this.root);else{var g=this.store.query(this.query);g.then&&this.own(g);
h(g,a.hitch(this,function(e){if(1!=e.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+e.length+" items, but must return exactly one");this.root=e[0];c(this.root);g.observe&&g.observe(a.hitch(this,function(a){this.onChange(a)}),!0)}),e)}},mayHaveChildren:function(){return!0},getChildren:function(c,e,m){var g=this.store.getIdentity(c);if(this.childrenCache[g])h(this.childrenCache[g],e,m);else{var d=this.childrenCache[g]=this.store.getChildren(c);d.then&&this.own(d);d.observe&&
this.own(d.observe(a.hitch(this,function(f,e,g){this.onChange(f);e!=g&&h(d,a.hitch(this,"onChildrenChange",c))}),!0));h(d,e,m)}},isItem:function(){return!0},getIdentity:function(a){return this.store.getIdentity(a)},getLabel:function(a){return a[this.labelAttr]},newItem:function(a,c,h,k){return this.store.put(a,{parent:c,before:k})},pasteItem:function(c,e,h,n,d,f){var g=new l;if(e===h&&!n&&!f)return g.resolve(!0),g;e&&!n?this.getChildren(e,a.hitch(this,function(a){a=[].concat(a);var d=k.indexOf(a,
c);a.splice(d,1);this.onChildrenChange(e,a);g.resolve(this.store.put(c,{overwrite:!0,parent:h,oldParent:e,before:f,isCopy:!1}))})):g.resolve(this.store.put(c,{overwrite:!0,parent:h,oldParent:e,before:f,isCopy:!0}));return g},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/keys dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(k,n,q,l,a,h,c,g,e,m,v,d,f,r,p,t){var w=k([p._TreeNode,f],{templateString:l,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);h.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=h.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=h.toDom('\x3cinput type\x3d"checkbox" /\x3e');h.addClass(this.checkNode,"jimu-tree-check-node");h.place(this.checkNode,this.contentNode,
"first");this.own(v(this.checkNode,"click",a.hitch(this,this._onClick)));this.own(v(this.rowNode,"keydown",a.hitch(this,function(a,c){c.target=a;c.keyCode!==d.ENTER&&c.keyCode!==d.SPACE||this._onClick(c)},this.checkNode)));this.isLeaf?this.groupId?h.setStyle(this.checkNode,"display","none"):h.setStyle(this.checkNode,"display","inline"):h.setStyle(this.checkNode,"display","none");this.isLeaf?h.addClass(this.domNode,"jimu-tree-leaf-node"):h.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&
(this.checkNode.checked=!0,h.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,h.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(a.hitch(this,
function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return k([p,f],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+t.getRandomString()},postCreate:function(){this.inherited(arguments);h.addClass(this.domNode,"jimu-tree");this.own(m.before(this,"onClick",a.hitch(this,this._jimuBeforeClick)));
this.rootLoadingIndicator&&h.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0;h.setAttr(this.domNode,"tabindex",0)},removeItem:function(a){this.model.store.remove(a)},getAllItems:function(){var d=this.getAllTreeNodeWidgets();return c.map(d,a.hitch(this,function(a){var c=a.item;c.selected=a.checkNode.checked;return c}))},getSelectedItems:function(){var d=this.getAllTreeNodeWidgets(),d=c.filter(d,a.hitch(this,function(a){return a.checkNode.checked}));return c.map(d,
a.hitch(this,function(a){return a.item}))},getFilteredItems:function(d){var f=this.getAllTreeNodeWidgets(),f=c.map(f,a.hitch(this,function(a){var c=a.item;c.selected=a.checkNode.checked;return c}));return c.filter(f,a.hitch(this,function(a){return d(a)}))},getTreeNodeByItemId:function(a){for(var c=this._getAllTreeNodeDoms(),d=0;d<c.length;d++){var f=r.byNode(c[d]);if(f.item.id.toString()===a.toString())return f}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},
unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var d=this.getAllTreeNodeWidgets();return c.filter(d,a.hitch(this,function(a){return a.isLeaf}))},getAllTreeNodeWidgets:function(){var d=this._getAllTreeNodeDoms();return c.map(d,a.hitch(this,function(a){return r.byNode(a)}))},isLeafItem:function(a){return a&&a.isLeaf},_getAllTreeNodeDoms:function(){return e(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);
this.multiple||(a.groupId=this.uniqueId);return new w(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,c,d){c.isLeaf&&(h.hasClass(d.target||d.srcElement,"jimu-tree-check-node")||(this.multiple?c.toggleSelect():this.selectNodeWidget(c)));return arguments},_onCheckNodeClick:function(c,
d,f){!this.multiple&&d&&this.unselectAllLeafNodeWidgets();g.stop(f);this.focusNode(c);setTimeout(a.hitch(this,function(){d?this.selectNodeWidget(c):c.unselect();this.onClick(c.item,c,f)}),0)},unselectAllLeafNodeWidgets:function(){var d=this.getAllLeafTreeNodeWidgets();c.forEach(d,a.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(k,n,q,l,a,h,c,g,e,m,v,d,f,r,p,t,w,D,u,M,E,A,B,I,J,F,K,N,L,G,O,P,R,b,Q){function y(a){return t.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var H=l("dijit._TreeNode",[J,F,K,N,L],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a);f("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:O,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";m.set(this.domNode,
"backgroundPosition",b+" 0px");m.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",b);k.forEach(this.getChildren(),function(b){b.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,c=b.model;b._v10Compat&&a===c.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(a,b,c){var d="_"+b+"Class";b+="Node";var z=this[d];this[d]=this.tree["get"+c+"Class"](a,this.isExpanded);g.replace(this[b],this[d]||"",z||"");m.set(this[b],this.tree["get"+c+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent(),a=!a||!a.rowNode||"none"==a.rowNode.style.display;g.toggle(this.domNode,"dijitTreeIsRoot",a);g.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var b=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;g.replace(this.expandoNode,b[a],b);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return y(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");g.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var b=d.wipeIn({node:this.containerNode,duration:I.defaultDuration}),c=this._expandDeferred=new a(function(){b.stop()});n.after(b,"onEnd",function(){c.resolve(!0)},!0);b.play();return y(c)},collapse:function(){if(this._collapseDeferred)return y(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");g.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var b=d.wipeOut({node:this.containerNode,duration:I.defaultDuration}),c=this._collapseDeferred=new a(function(){b.stop()});n.after(b,"onEnd",
function(){c.resolve(!0)},!0);b.play();return y(c)},indent:0,setChildItems:function(a){var b=this.tree,d=b.model,z=[],f=b.focusedChild,e=this.getChildren();k.forEach(e,function(a){K.prototype.removeChild.call(this,a)},this);this.defer(function(){k.forEach(e,function(a){if(!a._destroyed&&!a.getParent()){var z=function(a){var c=d.getIdentity(a.item),f=b._itemNodesMap[c];1==f.length?delete b._itemNodesMap[c]:(c=k.indexOf(f,a),-1!=c&&f.splice(c,1));k.forEach(a.getChildren(),z)};b.dndController.removeTreeNode(a);
z(a);if(b.persist){var e=k.map(a.getTreePath(),function(a){return b.model.getIdentity(a)}).join("/"),x;for(x in b._openedNodes)x.substr(0,e.length)==e&&delete b._openedNodes[x];b._saveExpandedNodes()}b.lastFocusedChild&&!c.isDescendant(b.lastFocusedChild.domNode,b.domNode)&&delete b.lastFocusedChild;f&&!c.isDescendant(f.domNode,b.domNode)&&b.focus();a.destroyRecursive()}})});this.state="Loaded";a&&0<a.length?(this.isExpandable=!0,k.forEach(a,function(a){var c=d.getIdentity(a),f=b._itemNodesMap[c],
e;if(f)for(var x=0;x<f.length;x++)if(f[x]&&!f[x].getParent()){e=f[x];e.set("indent",this.indent+1);break}e||(e=this.tree._createTreeNode({item:a,tree:b,isExpandable:d.mayHaveChildren(a),label:b.getLabel(a),labelType:b.model&&b.model.labelType||"text",tooltip:b.getTooltip(a),ownerDocument:b.ownerDocument,dir:b.dir,lang:b.lang,textDir:b.textDir,indent:this.indent+1}),f?f.push(e):b._itemNodesMap[c]=[e]);this.addChild(e);(this.tree.autoExpand||this.tree._state(e))&&z.push(b._expandNode(e))},this),k.forEach(this.getChildren(),
function(a){a._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);a=h(z);this.tree._startPaint(a);return y(a)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,
this.collapse());k.forEach(b,function(a){a._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");g.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){A.focus(this.focusNode)}});f("dojo-bidi")&&H.extend({_setTextDirAttr:function(a){!a||this.textDir==a&&this._created||(this._set("textDir",a),this.applyTextDir(this.labelNode),k.forEach(this.getChildren(),function(b){b.set("textDir",
a)},this))}});var C=l("dijit.Tree",[J,G,F,L],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:P,persist:!1,autoExpand:!1,dndController:Q,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,b){D.publish(this.id,t.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new a;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(w(this.containerNode,
w.selector(".dijitTreeNode",u.enter),function(b){a._onNodeMouseEnter(B.byNode(this),b)}),w(this.containerNode,w.selector(".dijitTreeNode",u.leave),function(b){a._onNodeMouseLeave(B.byNode(this),b)}),w(this.containerNode,w.selector(".dijitTreeRow",E.press),function(b){a._onNodePress(B.getEnclosingWidget(this),b)}),w(this.containerNode,w.selector(".dijitTreeRow",E),function(b){a._onClick(B.getEnclosingWidget(this),b)}),w(this.containerNode,w.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(B.getEnclosingWidget(this),
b)}));this.model||this._store2model();this.own(n.after(this.model,"onChange",t.hitch(this,"_onItemChange"),!0),n.after(this.model,"onChildrenChange",t.hitch(this,"_onItemChildrenChange"),!0),n.after(this.model,"onDelete",t.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){t.isString(this.dndController)&&(this.dndController=t.getObject(this.dndController));for(var b={},c=0;c<this.dndParams.length;c++)this[this.dndParams[c]]&&(b[this.dndParams[c]]=this[this.dndParams[c]]);
this.dndController=new this.dndController(this,b)}this._load();this.onLoadDeferred=y(this.pendingCommandsPromise);this.onLoadDeferred.then(t.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;r.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=t.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(a.getChildren=t.hitch(this,function(a,b,c){this.getItemChildren(this._v10Compat&&a===this.model.root?null:a,b,c)}));this.model=new b(a);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(t.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
b.labelNode.setAttribute("role","presentation"),b.labelNode.removeAttribute("aria-selected"),b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(t.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),t.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=t.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(t.hitch(this,function(){var c=
k.map(a,function(a){return!a||t.isString(a)?a:b.model.getIdentity(a)}),d=[];k.forEach(c,function(a){d=d.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",d)}))},_setPathAttr:function(a){return a.length?y(this.set("paths",[a]).then(function(a){return a[0]})):y(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(a){function b(a,d){var f=a.shift(),e=k.filter(d,function(a){return a.getIdentity()==f})[0];if(e)return a.length?c._expandNode(e).then(function(){return b(a,
e.getChildren())}):e;throw new C.PathError("Could not expand path at "+f);}var c=this;return y(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return h(k.map(a,function(a){a=k.map(a,function(a){return a&&t.isObject(a)?c.model.getIdentity(a):a});if(a.length)return b(a,[c.rootNode]);throw new C.PathError("Empty path");}))}).then(function(a){c.set("selectedNodes",a);return c.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},
expandAll:function(){function a(c){return b._expandNode(c).then(function(){var b=k.filter(c.getChildren()||[],function(a){return a.isExpandable});return h(k.map(b,a))})}var b=this;return y(a(this.rootNode))},collapseAll:function(){function a(c){var d=k.filter(c.getChildren()||[],function(a){return a.isExpandable}),d=h(k.map(d,a));return!c.isExpanded||c==b.rootNode&&!b.showRoot?d:d.then(function(){return b._collapseNode(c)})}var b=this;return y(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){(a=this._getNext(b))&&a.isTreeNode&&this.focusNode(a)},_onUpArrow:function(a,b){if(a=b.getPreviousSibling())for(b=a;b.isExpandable&&b.isExpanded&&
b.hasChildren();)b=b.getChildren(),b=b[b.length-1];else if(a=b.getParent(),this.showRoot||a!==this.rootNode)b=a;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){b.isExpandable&&b.isExpanded?this._collapseNode(b):(a=b.getParent())&&a.isTreeNode&&(this.showRoot||a!==this.rootNode)&&this.focusNode(a)},focusLastChild:function(){var a=this._getLast();
a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,b){return c.isDescendant(a,
b.expandoNode)||c.isDescendant(a,b.expandoNodeText)},_onNodePress:function(a,b){this.focusNode(a)},__click:function(a,b,c,d){var f=this.isExpandoNode(b.target,a);a.isExpandable&&(c||f)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[d](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(a){a=
a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){r.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){r.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&
delete a._expandNodeDeferred;if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(b){if(b._expandNodeDeferred)return b._expandNodeDeferred;var c=this.model,d=b.item,f=this;b._loadDeferred||(b.markProcessing(),b._loadDeferred=new a,c.getChildren(d,function(a){b.unmarkProcessing();b.setChildItems(a).then(function(){b._loadDeferred.resolve(a)})},function(a){console.error(f,": error loading "+b.label+" children: ",
a);b._loadDeferred.reject(a)}));c=b._loadDeferred.then(t.hitch(this,function(){var a=b.expand();this.onOpen(b.item,b);this._state(b,!0);return a}));this._startPaint(c);return c},focusNode:function(a){for(var b=[],c=this.domNode;c&&c.tagName&&"IFRAME"!==c.tagName.toUpperCase();c=c.parentNode)b.push({domNode:c.contentWindow||c,scrollLeft:c.scrollLeft||0,scrollTop:c.scrollTop||0});this.focusChild(a);this.defer(function(){for(var a=0,c=b.length;a<c;a++)b[a].domNode.scrollLeft=b[a].scrollLeft,b[a].domNode.scrollTop=
b[a].scrollTop},0)},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var c=this.getLabel(a),d=this.getTooltip(a);k.forEach(b,function(b){b.set({item:a,label:c,tooltip:d});b._updateItemClasses(a)})}},_onItemChildrenChange:function(a,b){a=this.model.getIdentity(a);(a=this._itemNodesMap[a])&&k.forEach(a,function(a){a.setChildItems(b)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var b=this._itemNodesMap[a];
b&&(k.forEach(b,function(a){this.dndController.removeTreeNode(a);var b=a.getParent();b&&b.removeChild(a);this.lastFocusedChild&&!c.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!c.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();a.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=q(this.cookieName);a&&k.forEach(a.split(","),function(a){this._openedNodes[a]=
!0},this)}},_state:function(a,b){if(!this.persist)return!1;var c=k.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");if(1===arguments.length)return this._openedNodes[c];b?this._openedNodes[c]=!0:delete this._openedNodes[c];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],b;for(b in this._openedNodes)a.push(b);q(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),
delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!t.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&e.setMarginBox(this.domNode,a);this._nodePixelIndent=e.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(t.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},
_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var b=t.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});M(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);
this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new H(a)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});f("dojo-bidi")&&C.extend({_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});C.PathError=v("TreePathError");C._TreeNode=H;return C})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array",
"dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(k,n,q,l){return q("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(a){l.mixin(this,a);this.connects=[];a=this.store;if(!a.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");a.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([n.after(a,
"onNew",l.hitch(this,"onNewItem"),!0),n.after(a,"onDelete",l.hitch(this,"onDeleteItem"),!0),n.after(a,"onSet",l.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var a;a=this.connects.pop();)a.remove()},getRoot:function(a,h){this.root?a(this.root):this.store.fetch({query:this.query,onComplete:l.hitch(this,function(c){if(1!=c.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+c.length+" items, but must return exactly one");this.root=c[0];a(this.root)}),onError:h})},mayHaveChildren:function(a){return k.some(this.childrenAttrs,
function(h){return this.store.hasAttribute(a,h)},this)},getChildren:function(a,h,c){var g=this.store;if(g.isItemLoaded(a)){for(var e=[],m=0;m<this.childrenAttrs.length;m++)var n=g.getValues(a,this.childrenAttrs[m]),e=e.concat(n);var d=0;this.deferItemLoadingUntilExpand||k.forEach(e,function(a){g.isItemLoaded(a)||d++});0==d?h(e):k.forEach(e,function(a,f){g.isItemLoaded(a)||g.loadItem({item:a,onItem:function(a){e[f]=a;0==--d&&h(e)},onError:c})})}else{var f=l.hitch(this,arguments.callee);g.loadItem({item:a,
onItem:function(a){f(a,h,c)},onError:c})}},isItem:function(a){return this.store.isItem(a)},fetchItemByIdentity:function(a){this.store.fetchItemByIdentity(a)},getIdentity:function(a){return this.store.getIdentity(a)},getLabel:function(a){return this.labelAttr?this.store.getValue(a,this.labelAttr):this.store.getLabel(a)},newItem:function(a,h,c){var g={parent:h,attribute:this.childrenAttrs[0]},e;this.newItemIdAttr&&a[this.newItemIdAttr]?this.fetchItemByIdentity({identity:a[this.newItemIdAttr],scope:this,
onItem:function(m){m?this.pasteItem(m,null,h,!0,c):(e=this.store.newItem(a,g))&&void 0!=c&&this.pasteItem(e,h,h,!1,c)}}):(e=this.store.newItem(a,g))&&void 0!=c&&this.pasteItem(e,h,h,!1,c)},pasteItem:function(a,h,c,g,e){var m=this.store,l=this.childrenAttrs[0];h&&k.forEach(this.childrenAttrs,function(c){if(m.containsValue(h,c,a)){if(!g){var d=k.filter(m.getValues(h,c),function(c){return c!=a});m.setValues(h,c,d)}l=c}});if(c)if("number"==typeof e){var d=m.getValues(c,l).slice();d.splice(e,0,a);m.setValues(c,
l,d)}else m.setValues(c,l,m.getValues(c,l).concat(a))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(a,h){h&&this.getChildren(h.item,l.hitch(this,function(a){this.onChildrenChange(h.item,a)}))},onDeleteItem:function(a){this.onDelete(a)},onSetItem:function(a,h){if(-1!=k.indexOf(this.childrenAttrs,h))this.getChildren(a,l.hitch(this,function(c){this.onChildrenChange(a,c)}));else this.onChange(a)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(k,n,q,l,a){return n("dijit.tree.ForestStoreModel",a,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(a){this.root={store:this,root:!0,id:a.rootId,label:a.rootLabel,children:a.rootChildren}},mayHaveChildren:function(a){return a===this.root||this.inherited(arguments)},getChildren:function(a,c,g){a===this.root?this.root.children?c(this.root.children):this.store.fetch({query:this.query,onComplete:l.hitch(this,
function(a){this.root.children=a;c(a)}),onError:g}):this.inherited(arguments)},isItem:function(a){return a===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(a){if(a.identity==this.root.id){var c=a.scope||q.global;a.onItem&&a.onItem.call(c,this.root)}else this.inherited(arguments)},getIdentity:function(a){return a===this.root?this.root.id:this.inherited(arguments)},getLabel:function(a){return a===this.root?this.root.label:this.inherited(arguments)},newItem:function(a,c,g){return c===
this.root?(this.onNewRootItem(a),this.store.newItem(a)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(a,c,g,e,m){if(c===this.root&&!e)this.onLeaveRoot(a);this.inherited(arguments,[a,c===this.root?null:c,g===this.root?null:g,e,m]);if(g===this.root)this.onAddToRoot(a)},onAddToRoot:function(a){console.log(this,": item ",a," added to root")},onLeaveRoot:function(a){console.log(this,": item ",a," removed from root")},_requeryTop:function(){var a=this.root.children||[];this.store.fetch({query:this.query,
onComplete:l.hitch(this,function(c){this.root.children=c;if(a.length!=c.length||k.some(a,function(a,e){return c[e]!=a}))this.onChildrenChange(this.root,c)})})},onNewItem:function(a,c){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(a){-1!=k.indexOf(this.root.children,a)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(a,c,g,e){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),
function(k,n,q,l,a,h,c,g,e,m,v){return n("dijit.tree._dndSelector",v,{constructor:function(){this.selection={};this.anchor=null;this.events.push(g(this.tree.domNode,e.press,l.hitch(this,"onMouseDown")),g(this.tree.domNode,e.release,l.hitch(this,"onMouseUp")),g(this.tree.domNode,e.move,l.hitch(this,"onMouseMove")),g(this.tree.domNode,m.press,l.hitch(this,"onClickPress")),g(this.tree.domNode,m.release,l.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],c=this.selection,
e;for(e in c)a.push(c[e]);return a},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,c){this.setSelection(this.getSelectedTreeNodes().concat([a]));c&&(this.anchor=a);return a},removeTreeNode:function(a){var c=k.filter(this.getSelectedTreeNodes(),function(c){return!h.isDescendant(c.domNode,a.domNode)});this.setSelection(c);return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},
setSelection:function(a){var c=this.getSelectedTreeNodes();k.forEach(this._setDifference(c,a),l.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));k.forEach(this._setDifference(a,c),l.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,c){k.forEach(c,function(a){a.__exclude__=!0});a=k.filter(a,function(a){return!a.__exclude__});k.forEach(c,function(a){delete a.__exclude__});
return a},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),c=[],e=[];k.forEach(a,function(a){var d=a.getTreePath();e.push(a);c.push(d)},this);a=k.map(e,function(a){return a.item});this.tree._set("paths",c);this.tree._set("path",c[0]||[]);this.tree._set("selectedNodes",e);this.tree._set("selectedNode",e[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(d){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(d.target,
this.current))){"mousedown"==d.type&&c.isLeft(d)&&d.preventDefault();var e="keydown"==d.type?this.tree.focusedChild:this.current;if(e){var g=a.getCopyKeyState(d),h=e.id;this.singular||d.shiftKey||!this.selection[h]?(this._doDeselect=!1,this.userSelect(e,g,d.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(c){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==c.type?this.tree.focusedChild:this.current,a.getCopyKeyState(c),c.shiftKey))},onMouseMove:function(){this._doDeselect=
!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(a,c){if(a===c)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-c.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(c)&2?1:-1;if(document.createRange){var d=doc.createRange();d.setStartBefore(a);a=doc.createRange();a.setStartBefore(c);return d.compareBoundaryPoints(d.END_TO_END,a)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
},userSelect:function(a,c,e){if(this.singular)this.anchor==a&&c?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(e&&this.anchor){c=this._compareNodes(this.anchor.rowNode,a.rowNode);e=this.anchor;0>c?c=e:(c=a,a=e);for(e=[];c!=a;)e.push(c),c=this.tree._getNext(c);e.push(a);this.setSelection(e)}else this.selection[a.id]&&c?this.removeTreeNode(a):c?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,
c){c=c||q.global;for(var d in this.selection)a.call(c,this.getItem(d),d,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(k,n,q,l,a,h){return n("dijit.tree._dndContainer",null,{constructor:function(c,g){this.tree=c;this.node=c.domNode;l.mixin(this,g);this.containerState="";q.add(this.node,"dojoDndContainer");this.events=[a(this.node,h.enter,l.hitch(this,"onOverEvent")),a(this.node,h.leave,
l.hitch(this,"onOutEvent")),k.after(this.tree,"_onNodeMouseEnter",l.hitch(this,"onMouseOver"),!0),k.after(this.tree,"_onNodeMouseLeave",l.hitch(this,"onMouseOut"),!0),a(this.node,"dragstart, selectstart",function(a){a.preventDefault()})]},destroy:function(){for(var a;a=this.events.pop();)a.remove();this.node=this.parent=null},onMouseOver:function(a){this.current=a},onMouseOut:function(){this.current=null},_changeState:function(a,g){var c="dojoDnd"+a;a=a.toLowerCase()+"State";q.replace(this.node,c+
g,c+this[a]);this[a]=g},_addItemClass:function(a,g){q.add(a,"dojoDndItem"+g)},_removeItemClass:function(a,g){q.remove(a,"dojoDndItem"+g)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/LayerChooserFromMapWithDropbox":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/keys dojo/Evented dojo/Deferred dijit/popup dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LayerChooserFromMapWithDropbox.html jimu/LayerInfos/LayerInfos".split(" "),
function(k,n,q,l,a,h,c,g,e,m,v,d){return k([e,m,h],{templateString:v,baseClass:"jimu-layer-chooser-from-map-withdropbox",declaredClass:"jimu.dijit.LayerChooserFromMapWithDropbox",_selectedItem:null,_isLayerChooserShow:!1,layerInfosObj:null,layerChooser:null,customClass:"",postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.queryableLayerSource;this.nls.customSelectLayer=this.label?this.label:this.nls.selectLayer},postCreate:function(){this.inherited(arguments);this.layerInfosObj=
d.getInstanceSync();this.layerChooser.domNode.style.zIndex=1;this.layerChooser.tree.domNode.style.borderTop="0";this.layerChooser.tree.domNode.style.maxHeight="290px";this.own(l(this.layerChooser,"tree-click",n.hitch(this,this._onTreeClick)));this.own(l(this.layerChooser,"update",n.hitch(this,this._onLayerChooserUpdate)));this.own(l(document.body,"click",n.hitch(this,this._onBodyClicked)));this.own(l(document.body,"keydown",n.hitch(this,function(c){c.keyCode===a.ENTER&&this._onBodyClicked(c)})));
this.own(l(this.layerChooser.domNode,"keydown",n.hitch(this,function(c){c.keyCode===a.ESCAPE&&this.hideLayerChooser()})))},destroy:function(){this.hideLayerChooser();this.layerChooser&&this.layerChooser.destroy();this.layerChooser=null;this.inherited(arguments)},getLayerChooser:function(){return this.layerChooser},setSelectedLayer:function(a){var d=new c;if(a){var e=this.layerInfosObj.getLayerOrTableInfoById(a.id);e?this.layerChooser.filter(e).then(n.hitch(this,function(c){c?(this._onSelectNewItem({layerInfo:e,
name:e.title,url:a.url}),d.resolve(!0)):d.resolve(!1)}),n.hitch(this,function(){d.resolve(!1)})):d.resolve(!1)}else this._onSelectNewItem(null),d.resolve(!0);return d},getSelectedItem:function(){return this._selectedItem},getSelectedItems:function(){return[this._selectedItem]},_onBodyClicked:function(a){a=a.target||a.srcElement;a===this.domNode||q.isDescendant(a,this.domNode)||a===this.layerChooser.domNode||q.isDescendant(a,this.layerChooser.domNode)||this.hideLayerChooser()},_onDropDownClick:function(a){a.stopPropagation();
a.preventDefault();this._isLayerChooserShow?this.hideLayerChooser():(this.isActive=!0,this.showLayerChooser())},_onDropDownKeydown:function(c){c.keyCode===a.ENTER&&this._onDropDownClick(c)},_getSelectedItems:function(){return this.layerChooser.getSelectedItems()},showLayerChooser:function(){this.layerChooser.domNode.style.minWidth=this.domNode.clientWidth+2+"px";g.open({parent:this,popup:this.layerChooser,around:this.domNode});var a=this.layerChooser.domNode.parentNode;a&&(q.addClass(a,"jimu-layer-chooser-from-map-withdropbox-popup"),
this.customClass&&q.addClass(a,this.customClass),this.layerChooser.tree.domNode.focus());this._isLayerChooserShow=!0},hideLayerChooser:function(){g.close(this.layerChooser);this._isLayerChooserShow=!1;this.isActive&&(this.dropDownBtn.focus(),this.isActive=!1)},_onLayerChooserUpdate:function(){this._selectedItem&&this.layerChooser.onlyShowVisible&&!this._selectedItem.layerInfo.isShowInMap()&&(this._selectedItem=null,this.emit("selection-change",[]))},_onSelectNewItem:function(a){var c=n.getObject("layerInfo.id",
!1,this._selectedItem)||-1,d=n.getObject("layerInfo.id",!1,a)||-1,c=c!==d;this._selectedItem=a;this.hideLayerChooser();a=n.getObject("layerInfo.title",!1,this._selectedItem)||"";this.layerNameNode.innerHTML=a;q.setAttr(this.layerNameNode,"title",a);a=n.getObject("layerInfo.layerObject",!1,this._selectedItem);c&&this.emit("selection-change",[a])},_onTreeClick:function(){var a=this._getSelectedItems();this._onSelectNewItem(0<a.length?a[0]:null)}})})},"dijit/form/Textarea":function(){define(["dojo/_base/declare",
"dojo/dom-style","./_ExpandingTextAreaMixin","./SimpleTextarea"],function(k,n,q,l){return k("dijit.form.Textarea",[l,q],{baseClass:"dijitTextBox dijitTextArea dijitExpandingTextArea",cols:"",buildRendering:function(){this.inherited(arguments);n.set(this.textbox,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"})}})})},"dijit/form/_ExpandingTextAreaMixin":function(){define("dojo/_base/declare dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/_base/window ../Viewport".split(" "),
function(k,n,q,l,a,h,c){q.add("textarea-needs-help-shrinking",function(){var a=h.body(),c=n.create("textarea",{rows:"5",cols:"20",value:" ",style:{zoom:1,fontSize:"12px",height:"96px",overflow:"hidden",visibility:"hidden",position:"absolute",border:"5px solid white",margin:"0",padding:"0",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"}},a,"last"),m=c.scrollHeight>=c.clientHeight;a.removeChild(c);return m});return k("dijit.form._ExpandingTextAreaMixin",
null,{_setValueAttr:function(){this.inherited(arguments);this.resize()},postCreate:function(){this.inherited(arguments);var c=this.textbox;c.style.overflowY="hidden";this.own(a(c,"focus, resize",l.hitch(this,"_resizeLater")))},startup:function(){this.inherited(arguments);this.own(c.on("resize",l.hitch(this,"_resizeLater")));this._resizeLater()},_onInput:function(a){this.inherited(arguments);this.resize()},_estimateHeight:function(){var a=this.textbox;a.rows=(a.value.match(/\n/g)||[]).length+1},_resizeLater:function(){this.defer("resize")},
resize:function(){function a(){var a=!1;""===c.value&&(c.value=" ",a=!0);var d=c.scrollHeight;a&&(c.value="");return d}var c=this.textbox;"hidden"==c.style.overflowY&&(c.scrollTop=0);if(!this.busyResizing){this.busyResizing=!0;if(a()||c.offsetHeight){var h=a()+Math.max(c.offsetHeight-c.clientHeight,0),k=h+"px";k!=c.style.height&&(c.style.height=k,c.rows=1);if(q("textarea-needs-help-shrinking")){var d=a(),f=c.style.minHeight,l=4,n=c.scrollTop;c.style.minHeight=k;for(c.style.height="auto";0<h;){c.style.minHeight=
Math.max(h-l,4)+"px";k=a();d-=k;h-=d;if(d<l)break;d=k;l<<=1}c.style.height=h+"px";c.style.minHeight=f;c.scrollTop=n}c.style.overflowY=a()>c.clientHeight?"auto":"hidden";"hidden"==c.style.overflowY&&(c.scrollTop=0)}else this._estimateHeight();this.busyResizing=!1}}})})},"widgets/Share/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/ShareLink.html":'\x3cdiv class\x3d"shareLink"\x3e\r\n  \x3cdiv class\x3d"shareLinkOptionsWrapper displaynone"\x3e\r\n    \x3cdiv role\x3d"button" data-dojo-attach-point\x3d"backBtn" class\x3d"backBtn" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"linkOptionsTitle"\x3e${nls.linkOptions}\x3c/div\x3e\r\n    \x3cdiv class\x3d"subTitle"\x3e${nls.linkOptionsUrlParameters}\x3c/div\x3e\r\n    \x3cform data-id\x3d"shareOptionsRadios" data-dojo-attach-point\x3d"shareOptionsRadios"\x3e\r\n      \x3cfieldset\x3e\r\n        \x3clegend class\x3d"screen-readers-only"\x3e${nls.linkOptionsUrlParameters}\x3c/legend\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3clabel\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"currentMapExtent" tabindex\x3d"0" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"currentMapExtent" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-props\x3d\'checked:true\' checked\x3e\r\n            \x3cdiv class\x3d"labels" data-forid\x3d"currentMapExtent"\x3e${nls.currentMapExtent}\x3c/div\x3e\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow" data-dojo-attach-point\x3d"chooseCenterWithLevelRow"\x3e\r\n          \x3clabel\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"chooseCenterWithLevel" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"chooseCenterWithLevel" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n            \x3cdiv class\x3d"labels" data-forid\x3d"chooseCenterWithLevel"\x3e${nls.chooseCenterWithLevel}\x3c/div\x3e\r\n          \x3c/label\x3e\r\n          \x3cdiv class\x3d"optionsMore chooseCenterWithLevel_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"chooseCenterWithLevel_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"chooseCenterWithLevel_levels" class\x3d"shareSelects" style\x3d"display: none !important;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3clabel\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"chooseCenterWithScale" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"chooseCenterWithScale" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n            \x3cdiv class\x3d"labels"\x3e${nls.chooseCenterWithScale}\x3c/div\x3e\r\n          \x3c/label\x3e\r\n          \x3cdiv class\x3d"optionsMore chooseCenterWithScale_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"chooseCenterWithScale_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"chooseCenterWithScale_scales" class\x3d"shareSelects" style\x3d"display: none !important;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"optionsRow" data-dojo-attach-point\x3d"findLocationRow"\x3e\r\n          \x3clabel\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"findLocation" tabindex\x3d"0" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"findLocation" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n            \x3cdiv class\x3d"labels"\x3e${nls.findLocation}\x3c/div\x3e\r\n          \x3c/label\x3e\r\n          \x3cdiv class\x3d"optionsMore findLocation_optionsMore"\x3e\r\n            \x3cdiv class\x3d"moreOptions"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"findLocation_input" tabindex\x3d"0" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.findLocation_inputPlaceholder}"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3clabel\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"queryFeature" tabindex\x3d"0" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"queryFeature" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n            \x3cdiv class\x3d"labels"\x3e${nls.queryFeature}\x3c/div\x3e\r\n          \x3c/label\x3e\r\n          \x3cdiv class\x3d"optionsMore queryFeature_optionsMore"\x3e\r\n            \x3cdiv class\x3d"moreOptions"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"queryFeature_layer" name\x3d"queryFeature_layer" class\x3d"queryFeature_layer"\x3e\x3c/div\x3e\r\n              \x3ctable class\x3d"query-wapper"\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd class\x3d"t-row"\x3e \x3cselect data-dojo-attach-point\x3d"queryFeature_field" name\x3d"queryFeature_field"\r\n                      data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e \x3c/td\x3e\r\n                  \x3ctd class\x3d"t-row"\x3e \x3cdiv style\x3d"width: 5px;"\x3e\x3c/div\x3e \x3c/td\x3e\r\n                  \x3ctd class\x3d"t-row"\x3e \x3ctable data-dojo-attach-point\x3d"queryFeature_valueFilter" name\x3d"queryFeature_valueFilter"\r\n                      class\x3d"dijitSelect queryFeature_value_filter"\x3e\x3c/table\x3e \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/table\x3e\r\n              \x3c!--\r\n                \x3cselect data-dojo-attach-point\x3d"queryFeature_value" name\x3d"queryFeature_value" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n              --\x3e\r\n              \x3c!--\r\n                \x3cdiv role\x3d"button" class\x3d"sort-btn-wapper" tabindex\x3d"0" title\x3d${nls.asc}\x3e\r\n                  \x3cdiv class\x3d"sort-btn ASC" data-dojo-attach-point\x3d"queryFeature_sortBtn"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n              --\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3clabel\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"addMarker" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"addMarker" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n            \x3cdiv class\x3d"labels"\x3e${nls.addMarker}\x3c/div\x3e\r\n          \x3c/label\x3e\r\n          \x3cdiv class\x3d"optionsMore addMarker_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"addMarker_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"moreOptions addMarker_moreOptions"\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e\r\n                  \x3cspan\x3e${nls.WKID}\x3c/span\x3e\r\n                  \x3cinput data-dojo-attach-point\x3d"addMarker_spatialReference" tabindex\x3d"0" name\x3d"spatialReference" data-dojo-type\x3d"dijit.form.TextBox"\x3e\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e\r\n                  \x3cspan\x3e${nls.popupTitle}\x3c/span\x3e\r\n                  \x3cinput data-dojo-attach-point\x3d"addMarker_title" tabindex\x3d"0" title\x3d"${nls.addMarker_titlePlaceholder}" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_titlePlaceholder}"\x3e\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e\r\n                  \x3cspan\x3e${nls.symbol}\x3c/span\x3e\r\n                  \x3cinput data-dojo-attach-point\x3d"addMarker_symbolURL" tabindex\x3d"0" title\x3d"${nls.addMarker_symbolURL}" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_symbolURL}"\x3e\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e\r\n                  \x3cspan\x3e${nls.label}\x3c/span\x3e\r\n                  \x3cinput data-dojo-attach-point\x3d"addMarker_label" tabindex\x3d"0" title\x3d"${nls.addMarker_label}" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_label}"\x3e\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow displaynone"\x3e\r\n                \x3clabel\x3e\r\n                  \x3cspan\x3e${nls.zoomLevel}\x3c/span\x3e\r\n                  \x3cdiv class\x3d"table-for-select"\x3e\r\n                    \x3cselect data-dojo-attach-point\x3d"addMarker_level" tabindex\x3d"0" name\x3d"addMarker_level" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/fieldset\x3e\r\n    \x3c/form\x3e\r\n\r\n    \x3cfieldset\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"overwirteMobileLayout" data-id\x3d"share-options-overwirteMobileLayout" class\x3d"shareCheckBoxes"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-props\x3d\'label:"${nls.overwirteMobileLayout}"\'\x3e\x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"optionsMore share-options-overwirteMobileLayout_optionsMore"\x3e\r\n          \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" required\x3d"true"\r\n                 data-dojo-attach-point\x3d"mobileLayout" tabindex\x3d"0" data-dojo-props\x3d\'style:{width:"100px"}, constraints:{min:300}\'/\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"setlanguage" data-id\x3d"share-options-language" class\x3d"shareCheckBoxes"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-props\x3d\'label:"${nls.language}"\'\x3e\x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"optionsMore share-options-language_optionsMore"\x3e\r\n          \x3cselect data-dojo-attach-point\x3d"setlanguage_languages" tabindex\x3d"0" title\x3d"${nls.language}" name\x3d"${nls.language}" class\x3d"shareSelects" style\x3d"display:inline-block;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix" style\x3d"display: none;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"auth" data-id\x3d"share-options-auth" class\x3d"shareCheckBoxes jimu-float-leading"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-props\x3d\'label:"${nls.auth}"\'\x3e\x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"optionsMore share-options-auth_optionsMore"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"authtoken" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d\'required:true\'/\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"setLayerVisibility" data-id\x3d"share-options-layerVisibility" class\x3d"shareCheckBoxes"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-props\x3d\'label:"${nls.layerVisibility}"\'\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"optionsRow shareClearFix url-toolong-tips" data-dojo-attach-point\x3d"urlLengthTips1"\x3e\x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3clabel\x3e\r\n          \x3cdiv class\x3d"subTitle"\x3e${nls.linkPreview}\x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"preview" tabindex\x3d"0" class\x3d"preview inputsText" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d\'required:true,readOnly:true\'\x3e\x3c/div\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"shareUrlsWrapper"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"Text"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"linkShare" data-dojo-attach-point\x3d"LinkShareContainer"\x3e\r\n      \x3clabel\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"LinkText" class\x3d"subTitle linkToApp"\x3e${nls.shareLinkText}\x3c/div\x3e\r\n        \x3cinput data-dojo-attach-point\x3d"_linkUrlTextBox" class\x3d"shareLinkUrl inputsText" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d\'required:true,readOnly:true\' tabindex\x3d"0"/\x3e\r\n      \x3c/label\x3e\r\n      \x3cdiv class\x3d"shareClearFix"\x3e\r\n        \x3cspan role\x3d"link" class\x3d"optionsText jimu-float-leading" data-dojo-attach-point\x3d"linkOptions" tabindex\x3d"0" aria-title\x3d"${nls.linkOptions}"\x3e${nls.linkOptions}\x3c/span\x3e\r\n        \x3cdiv class\x3d"shareLinkIcons jimu-float-trailing" data-dojo-attach-point\x3d"socialNetworkLinks"\x3e\r\n          \x3ca role\x3d"link" class\x3d"socialNetworkIcons email" data-dojo-attach-point\x3d"emailShare" title\x3d"${nls.shareEmail}" tabindex\x3d"0"\x3e\x3c/a\x3e\r\n          \x3cdiv role\x3d"link" class\x3d"socialNetworkIcons facebook" data-dojo-attach-event\x3d"click:_toFacebook, keydown:_toFacebookKeyDown" data-dojo-attach-point\x3d"FacebookShare" title\x3d"${nls.shareFacebook}" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n          \x3cdiv role\x3d"link" class\x3d"socialNetworkIcons twitter" data-dojo-attach-event\x3d"click:_toTwitter, keydown:_toTwitterKeyDown" data-dojo-attach-point\x3d"TwitterShare" title\x3d"${nls.shareTwitter}" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n          \x3cdiv role\x3d"link" class\x3d"socialNetworkIcons googlePlus" data-dojo-attach-point\x3d"googlePlusShare" title\x3d"${nls.shareGooglePlus}" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"optionsRow shareClearFix url-toolong-tips" data-dojo-attach-point\x3d"urlLengthTips2"\x3e\x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"embedShare" data-dojo-attach-point\x3d"EmbedShareContainer"\x3e\r\n      \x3clabel\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"embedText" class\x3d"subTitle"\x3e${nls.embed}\x3c/div\x3e\r\n        \x3cinput data-dojo-attach-point\x3d"_embedCodeTextArea" role\x3d"presentation" class\x3d"shareEmbedCode inputsText" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d\'required:true,readOnly:true\'/\x3e\r\n      \x3c/label\x3e\r\n      \x3cdiv role\x3d"link" class\x3d"moreOptions" data-dojo-attach-point\x3d"MoreOptions" data-dojo-attach-event\x3d"click:_moreOptionsExpandCollapse, keydown:_moreOptionsExpandCollapseKeyDown" tabindex\x3d"0"\x3e\r\n        \x3cdiv class\x3d"moreOptionsIcon" data-dojo-attach-point\x3d"MoreOptionsIcon"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsText"\x3e${nls.more}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"MoreOptionsContainer" class\x3d"moreOptionsContainer inputsText displaynone"\x3e\r\n        \x3cdiv class\x3d"sizeSelect" data-dojo-attach-point\x3d"SizeSelect"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"customSize disable" data-dojo-attach-point\x3d"CustomSizeContainer"\x3e\r\n          \x3cdiv class\x3d"timesConnector"\x3eX\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"shareTips" data-dojo-attach-point\x3d"shareTips"\x3e\r\n      \x3c!--\x3cdiv class\x3d"infoIcon"\x3e\x3c/div\x3e--\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"shareTipsText" class\x3d"shareTipsText"\x3e${nls.shareToWebTips}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/LayerChooserFromMapWithDropbox.html":'\x3cdiv\x3e\r\n\x3ctable role\x3d"listbox" aria-haspopup\x3d"true" data-dojo-attach-point\x3d"dropDownBtn" data-dojo-attach-event\x3d"onclick: _onDropDownClick,onkeydown: _onDropDownKeydown"\r\n  tabindex\x3d"0" title\x3d"${nls.customSelectLayer}" aria-label\x3d"${nls.customSelectLayer}"\x3e\r\n    \x3ccaption class\x3d"screen-readers-only-no-position"\x3e${nls.customSelectLayer}\x3c/caption\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"layer-name jimu-ellipsis" data-dojo-attach-point\x3d"layerNameNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"drop-select jimu-float-trailing" data-dojo-attach-point\x3d"dropArrowNode"\x3e\r\n            \x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Share/Widget.html":'\x3cdiv style\x3d"width:100%;min-width:230px;min-height:245px;"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"container"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"*now":function(k){k(['dojo/i18n!*preload*widgets/Share/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang jimu/BaseWidget jimu/portalUrlUtils jimu/shareUtils jimu/dijit/ShareLink jimu/utils jimu/dijit/LoadingIndicator jimu/dijit/Message".split(" "),function(k,n,q,l,a,h,c,g,e){return k([q],{name:"Share",baseClass:"jimu-widget-share share-container",_isShowFindLocation:!0,onOpen:function(){this.widgetManager.activateWidget(this);a.getItemShareInfo(this.appConfig.portalUrl).then(n.hitch(this,function(c){c=a.isSharedToPublic(c);if(this.shareLink&&this.shareLink.onShareToPublicChanged&&
!0===this.shareLink.HAS_INIT_URL)this.shareLink.onShareToPublicChanged(c)}))},onClose:function(){if(this.shareLink)this.shareLink.onCloseContainer()},onDeActive:function(){},_disableWebMapPopup:function(){},_enableWebMapPopup:function(){},postCreate:function(){this.inherited(arguments);this.shelter=new g({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup()},startup:function(){this.inherited(arguments);this.shelter.show();this._isShowFindLocation=this._findSearchWidget(this.appConfig);
a.getItemShareInfo(this.appConfig.portalUrl).then(n.hitch(this,function(e){this.shareLink=new h({portalUrl:this.appConfig.portalUrl,appTitle:this.appConfig.title,isOnline:l.isOnline(c.getAppHref()),isShowSocialMediaLinks:!0,isSharedToPublic:a.isSharedToPublic(e),isShowBackBtn:!0,config:this.config,isShowFindLocation:this._isShowFindLocation});this.shareLink.placeAt(this.container);c.initFirstFocusNode(this.domNode,this.shareLink._linkUrlTextBox.textbox);c.initLastFocusNode(this.domNode,this.shareLink.MoreOptions);
this.openAtStartAysn=!0;c.isAutoFocusFirstNodeWidget(this)&&this.shareLink._linkUrlTextBox.textbox.focus()}),n.hitch(this,function(a){new e({message:a.message})})).always(n.hitch(this,function(){this.shelter.hide()}))},destroy:function(){this.shareLink&&this.shareLink.destroy&&this.shareLink.destroy();this.inherited(arguments)},onAppConfigChanged:function(a){this._isShowFindLocation=this._findSearchWidget(a);this.shareLink&&this.shareLink.updateShareLinkOptionsUI&&this.shareLink.updateShareLinkOptionsUI({isShowFindLocation:this._isShowFindLocation})},
_findSearchWidget:function(a){a=a.getConfigElementsByName("Search");return 0<a.length&&a[0].visible}})});