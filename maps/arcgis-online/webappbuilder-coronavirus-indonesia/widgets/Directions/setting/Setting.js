// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Directions/setting/PresetDestinations":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/_base/html dojo/query esri/lang dojo/Deferred esri/tasks/locator jimu/utils ../searchUtil jimu/LayerInfos/LayerInfos dojo/when dojo/promise/all dojo/_base/array esri/layers/FeatureLayer dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./PresetDestinations.html esri/dijit/Search jimu/dijit/RadioBtn".split(" "),function(p,h,k,r,t,g,d,c,q,v,
w,a,e,u,y,l,f,n,A,x){return p([l,f,n],{templateString:A,_defaultLocations:null,_startSearchResults:null,_endSearchResults:null,_isSearchResultsShown:!1,_ERROR_CLASS:"have-error",constructor:function(b){b&&(this._defaultLocations=[],this._defaultLocations=this._parseDefaultLocations(b.defaultLocations),this.nls=b.nls)},postCreate:function(){this.inherited(arguments)},startup:function(){this._getLayerInfos().then(h.hitch(this,function(){this.startSearch=new x({enableSuggestions:!1,enableButtonMode:!1,
theme:"arcgisSearch"});this.startSearch.placeAt(this.startSearchDom);this.own(k(this.startSearch,"search-results",h.hitch(this,"_onStartSearchResults")));this.own(k(this.startSearchResultsNode,"li:click",h.hitch(this,"_onSelectStartSearchResult")));this.own(k(this.startSearch.inputNode,"focus",h.hitch(this,"_onCleanStartError")));this.own(k(this.startSearch.inputNode,"blur",h.hitch(this,function(){!1===this._isSearchResultsShown&&this.startSearch&&this.startSearch.search&&this.startSearch.search()})));
this.endSearch=new x({enableSuggestions:!1,enableButtonMode:!1,theme:"arcgisSearch"});this.endSearch.placeAt(this.endSearchDom);this.own(k(this.endSearch,"search-results",h.hitch(this,"_onEndSearchResults")));this.own(k(this.endSearchResultsNode,"li:click",h.hitch(this,"_onSelectEndSearchResult")));this.own(k(this.endSearch.inputNode,"focus",h.hitch(this,"_onCleanEndError")));this.own(k(this.endSearch.inputNode,"blur",h.hitch(this,function(){!1===this._isSearchResultsShown&&this.endSearch&&this.endSearch.search&&
this.endSearch.search()})));this.own(k(window.document,"click",h.hitch(this,function(b){r.isDescendant(b.target,this.searchResultsNode)||this._hideResultMenu()})));if(this._defaultLocations&&this._defaultLocations.length&&0<this._defaultLocations.length)for(var b=0,a=this._defaultLocations.length;b<a;b++)0===b?this._setSearchValue(this.startSearch,this._defaultLocations[b]):1===b&&this._setSearchValue(this.endSearch,this._defaultLocations[b])}));this.inherited(arguments)},_setSearchValue:function(b,
a){"string"===typeof a?b.set("value",a):a.name&&(b.set("selectedResult",a),b.set("value",a.name))},getValue:function(){var b=[],a=this._getSearchRest(this.startSearch,this._defaultLocations[0]);b.push(a);a=this._getSearchRest(this.endSearch,this._defaultLocations[1]);b.push(a);return b},_getSearchRest:function(b,a){var e=b.selectedResult;if(e)e.feature&&(e.feature._layer&&(e.feature._layer=""),e.feature._sourceLayer&&(e.feature._sourceLayer=""));else if(b.value)e=!1,"string"===typeof a?e=a!==b.value:
a.name&&(e=a.name!==b.value),e=e?b.value:a;else return"";return e},_parseDefaultLocations:function(b){for(var a=[],e=0,f=b.length;e<f;e++)a.push(b[e]);return a},setValue:function(b){b&&0<b.length&&(this._defaultLocations=[],this._defaultLocations=this._parseDefaultLocations(b))},validate:function(){var b=!1;t(".searchLoading",this.domNode).forEach(h.hitch(this,function(){b=!0}));return!1!==b||r.hasClass(this.startSearch,this._ERROR_CLASS)||r.hasClass(this.endSearch,this._ERROR_CLASS)?!1:!0},setSources:function(b){if(b&&
b.sources&&b.sources.length)this.shelter.show(),a(v.getConfigInfo(b)).then(h.hitch(this,function(b){return e(this._convertConfig(b)).then(function(b){return u.filter(b,function(b){return b})})})).then(h.hitch(this,function(b){this.startSearch.set("sources",b);this.endSearch.set("sources",b);this.shelter.hide()}));else if(f&&f.url&&f.singleLineFieldName){var f={locator:new c(f.url||""),outFields:["*"],singleLineFieldName:f.singleLineFieldName};this.startSearch.set("sources",[f]);this.endSearch.set("sources",
[f])}else this.startSearch.set("sources",[]),this.endSearch.set("sources",[])},_onCleanError:function(b){r.removeClass(b,this._ERROR_CLASS)},_onCleanStartError:function(){this._onCleanError(this.startSearch)},_onCleanEndError:function(){this._onCleanError(this.endSearch)},_onStartSearchResults:function(b){this._onSearchResults(b,{searchDijit:this.startSearch,searchResultsNode:this.startSearchResultsNode,searchError:this.startSearchError,results:"start"})},_onEndSearchResults:function(b){this._onSearchResults(b,
{searchDijit:this.endSearch,searchResultsNode:this.endSearchResultsNode,searchError:this.endSearchError,results:"end"})},_onSearchResults:function(b,a){var e=a.searchDijit.get("sources"),f=a.searchDijit.get("activeSourceIndex"),c=a.searchDijit.get("value"),n="",z=b.results;if(""!==c)if(z&&0<b.numResults){"start"===a.results?this._startSearchResults=z:"end"===a.results&&(this._endSearchResults=z);var n=n+'\x3cdiv class\x3d"searchMenu searchResultsMenu" role\x3d"menu"\x3e',l;for(l in z)if(z[l]&&z[l].length){b=
e[parseInt(l,10)].name;1<e.length&&"all"===f&&(n+='\x3cdiv title\x3d"'+b+'" class\x3d"menuHeader"\x3e'+b+"\x3c/div\x3e");n+="\x3cul\x3e";b=e[l].maxResults||5;for(var c=0,x=z[l].length;c<x&&c<b;c++){var u;g.isDefined(z[l][c].name)?(u=z[l][c].name,u=q.sanitizeHTML(u)):u=this.nls.untitled;n+='\x3cli title\x3d"'+u+'" data-index\x3d"'+c+'" data-source-index\x3d"'+l+'" role\x3d"menuitem" tabindex\x3d"0"\x3e'+u.toString()+"\x3c/li\x3e"}n+="\x3c/url\x3e"}a.searchResultsNode.innerHTML=n+"\x3c/div\x3e";this._showResultMenu(a.searchDijit,
a.searchResultsNode);this._resetSelectorPosition(a.searchDijit,".searchResultsMenu")}else r.addClass(a.searchDijit,this._ERROR_CLASS),this._resetSelectorPosition(a.searchDijit,".noResultsMenu")},_onSelectStartSearchResult:function(b){this._onSelectSearchResult(b,this.startSearch,this._startSearchResults)},_onSelectEndSearchResult:function(b){this._onSelectSearchResult(b,this.endSearch,this._endSearchResults)},_onSelectSearchResult:function(b,a,e){for(b=b.target;!r.hasAttr(b,"data-source-index")||
!r.getAttr(b,"data-index");)b=b.parentNode;var f=null,f=r.getAttr(b,"data-source-index");b=parseInt(r.getAttr(b,"data-index"),10);"all"!==f&&(f=parseInt(f,10));e&&e[f]&&e[f][b]&&(f=e[f][b],a.select(f),f.name&&a.set("value",f.name))},_showResultMenu:function(b,a){r.setStyle(a,"display","block");t(".searchMenu",a).style("display","block");this._isSearchResultsShown=!0;if(b=t(".searchInputGroup",b.domNode)[0])b={width:r.getMarginBox(b).w+"px"},t(".searchMenu",a).style(b)},_resetSelectorPosition:function(b,
a){var e=r.getMarginBox(this.domNode.offsetParent);t(a,this.domNode).forEach(h.hitch(this,function(f){var c=r.position(f),n=r.position(b.domNode),n=".noResultsMenu"===a?0:n.h;c.y+c.h>e.h&&r.setStyle(f,"top",-(c.h+n)-4+"px")}))},_hideResultMenu:function(){t(".searchMenu",this.domNode).style("display","none");this._isSearchResultsShown=!1},_getLayerInfos:function(){var b=new d;w.getInstance(this.map,this.map.itemInfo).then(h.hitch(this,function(a){this.layerInfosObj=a;this.own(this.layerInfosObj.on("layerInfosFilterChanged",
h.hitch(this,function(b){v.config.onLayerInfosFilterChanged(b,this.config)})));b.resolve()}));return b},_convertConfig:function(b){return u.map(b.sources,h.hitch(this,function(b){var a=new d;if(b&&b.url&&"locator"===b.type){var e={locator:new c(b.url||""),outFields:["*"],singleLineFieldName:b.singleLineFieldName||"",name:q.stripHTML(b.name||""),placeholder:q.stripHTML(b.placeholder||""),countryCode:b.countryCode||"",maxSuggestions:b.maxSuggestions,useMapExtent:!!b.searchInCurrentMapExtent};b.enableLocalSearch&&
(e.localSearchOptions={minScale:b.localSearchMinScale,distance:b.localSearchDistance});b.zoomScale&&(e.autoNavigate=!1);a.resolve(e)}else b&&b.url&&"query"===b.type?(e=new y(b.url||null,{outFields:["*"]}),this.own(k(e,"load",h.hitch(this,function(e){var f=e.layer;e=this.map.getLayer(b.layerId);var c=this.layerInfosObj.getLayerInfoById(b.layerId);e?c=e=!1:c?c=e=!1:(e=!1,c=!0);var n=null;b.searchFields&&0<b.searchFields.length?n=b.searchFields:(n=[],u.forEach(f.fields,function(b){"esriFieldTypeOID"!==
b.type&&b.name!==f.objectIdField&&"esriFieldTypeGeometry"!==b.type&&n.push(b.name)}));var l={featureLayer:f,outFields:["*"],searchFields:n,autoNavigate:!1,displayField:b.displayField||"",exactMatch:!!b.exactMatch,name:q.stripHTML(b.name||""),placeholder:q.stripHTML(b.placeholder||""),maxSuggestions:b.maxSuggestions||6,useMapExtent:!!b.searchInCurrentMapExtent,showInfoWindowOnSelect:e,enableInfoWindow:c,_featureLayerId:b.layerId};l._featureLayerId&&(e=this.layerInfosObj.getLayerInfoById(l._featureLayerId))&&
f.setDefinitionExpression(e.getFilter());v.config.getInfoTemplate(f,b,this.layerInfosObj).then(h.hitch(this,function(b){l.infoTemplate=h.clone(b);a.resolve(l)}),h.hitch(this,function(){a.resolve(l)}))}))),this.own(k(e,"error",function(){a.resolve(null)}))):a.resolve(null);return a}))}})})},"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),
function(p,h,k,r,t,g,d,c,q,v,w){p=p(v,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],"location-to-address-complete":["address"],"suggest-locations-complete":["suggestions"]},constructor:function(a){this._geocodeHandler=h.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=h.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=h.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},
outSpatialReference:null,setOutSpatialReference:function(a){this.outSpatialReference=a},_geocodeHandler:function(a,e,c,d,l){try{var f=a.candidates,n;e=[];var u,x=f.length,b=a.spatialReference,g;for(u=0;u<x;u++){n=f[u];if(g=n.location)g.spatialReference=b;e[u]=new w(n)}this._successHandler([e],"onAddressToLocationsComplete",c,l)}catch(E){this._errorHandler(E,d,l)}},_geocodeAddressesHandler:function(a,e,c,d,l){try{var f=a.locations;e=[];var n,u=f.length,x=a.spatialReference,b;for(n=0;n<u;n++){if(b=
f[n].location)b.spatialReference=x;e[n]=new w(f[n])}this._successHandler([e],"onAddressesToLocationsComplete",c,l)}catch(z){this._errorHandler(z,d,l)}},addressToLocations:function(a,e,u,d,l){var f,n,g,x,b,z,w,v;a.address&&(d=u,u=e,e=a.outFields,l=a.searchExtent,v=a.countryCode,f=a.magicKey,n=a.distance,w=a.categories,a.location&&this.normalization&&(g=a.location.normalize()),x=a.locationType,b=a.maxLocations,z=a.forStorage,a=a.address);l&&(l=l.shiftCentralMeridian());var k=this.outSpatialReference;
a=this._encode(h.mixin({},this._url.query,a,{f:"json",outSR:k&&t.toJson(k.toJson()),outFields:e&&e.join(",")||null,searchExtent:l&&t.toJson(l.toJson()),category:w&&w.join(",")||null,countryCode:v||null,magicKey:f||null,distance:n||null,location:g||null,locationType:x||null,maxLocations:b||null,forStorage:z||null}));var y=this._geocodeHandler,p=this._errorHandler,I=new r(q._dfdCanceller);I._pendingDfd=c({url:this._url.path+"/findAddressCandidates",content:a,callbackParamName:"callback",load:function(b,
a){y(b,a,u,d,I)},error:function(b){p(b,d,I)}});return I},suggestLocations:function(a){var e;e=new r(q._dfdCanceller);a.hasOwnProperty("location")&&this.normalization&&(a.location=a.location.normalize());a.searchExtent&&(a.searchExtent=a.searchExtent.shiftCentralMeridian());a=this._encode(h.mixin({},this._url.query,{f:"json",text:a.text,maxSuggestions:a.maxSuggestions,searchExtent:a.searchExtent&&t.toJson(a.searchExtent.toJson()),category:a.categories&&a.categories.join(",")||null,countryCode:a.countryCode||
null,location:a.location||null,distance:a.distance||null},{f:"json"}));a=c({url:this._url.path+"/suggest",content:a,callbackParamName:"callback"});e._pendingDfd=a;a.then(h.hitch(this,function(a){a=a.suggestions||[];this.onSuggestLocationsComplete(a);e.resolve(a)}),h.hitch(this,function(a){this._errorHandler(a);e.reject(a)}));return e},addressesToLocations:function(a,e,d){var u=this.outSpatialReference,l=[],f=a.categories,n=a.locationType,g=a.countryCode;k.forEach(a.addresses,function(b,a){l.push({attributes:b})});
a=this._encode(h.mixin({},this._url.query,{category:f&&f.join(",")||null,locationType:n||null,sourceCountry:g||null},{addresses:t.toJson({records:l})},{f:"json",outSR:u&&t.toJson(u.toJson())}));var x=this._geocodeAddressesHandler,b=this._errorHandler,z=new r(q._dfdCanceller);z._pendingDfd=c({url:this._url.path+"/geocodeAddresses",content:a,callbackParamName:"callback",load:function(b,a){x(b,a,e,d,z)},error:function(a){b(a,d,z)}});return z},_reverseGeocodeHandler:function(a,e,c,d,l){try{var f=new w({address:a.address,
location:a.location,score:100});this._successHandler([f],"onLocationToAddressComplete",c,l)}catch(n){this._errorHandler(n,d,l)}},locationToAddress:function(a,e,d,g){a&&this.normalization&&(a=a.normalize());var l=this.outSpatialReference;a=this._encode(h.mixin({},this._url.query,{outSR:l&&t.toJson(l.toJson()),location:a&&t.toJson(a.toJson()),distance:e,f:"json"}));var f=this._reverseGeocodeHandler,n=this._errorHandler,u=new r(q._dfdCanceller);u._pendingDfd=c({url:this._url.path+"/reverseGeocode",content:a,
callbackParamName:"callback",load:function(a,b){f(a,b,d,g,u)},error:function(a){n(a,g,u)}});return u},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}});g("extend-esri")&&h.setObject("tasks.Locator",p,d);return p})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(p,h,k,r,t){p=p(null,{declaredClass:"esri.tasks.AddressCandidate",
constructor:function(g){h.mixin(this,g);this.location=new t(this.location)}});k("extend-esri")&&h.setObject("tasks.AddressCandidate",p,r);return p})},"widgets/Directions/searchUtil":function(){define("dojo/_base/lang dojo/_base/array dojo/Deferred dojo/when dojo/promise/all jimu/portalUtils esri/lang esri/request jimu/utils esri/dijit/PopupTemplate esri/graphic esri/geometry/Extent".split(" "),function(p,h,k,r,t,g,d,c,q,v,w,a){return{map:null,layerInfosObj:null,appConfig:null,_esriLocatorRegExp:/geocode(.){0,3}\.arcgis.com\/arcgis\/rest\/services\/World\/GeocodeServer/g,
setMap:function(a){this.map=a},setLayerInfosObj:function(a){this.layerInfosObj=a},setAppConfig:function(a){this.appConfig=a},getConfigInfo:function(a){if(a&&a.sources&&0<a.sources.length){var e=null;return this.searchLayer(this.map)&&a.upgradeFromGeocoder?(e=this.map.itemInfo.itemData.applicationProperties.viewing.search,e=h.map(e.layers,p.hitch(this,function(a,e){e.hintText=a;return this._getQueryTypeGeocoder(e)},e.hintText)),t(e).then(p.hitch(this,function(e){a.sources=[].concat(e).concat(a.sources);
return a}))):a}return r(this._getSoucesFromPortalAndWebmap()).then(p.hitch(this,function(a){return{allPlaceholder:"",showInfoWindowOnSelect:!0,sources:a}}))},_getSoucesFromPortalAndWebmap:function(){var a=[],c=null;this.searchLayer(this.map)&&(c=this.map.itemInfo.itemData.applicationProperties.viewing.search,h.forEach(c.layers,p.hitch(this,function(e,c){c.hintText=e;a.push(this._getQueryTypeGeocoder(c))},c.hintText)));return g.getPortalSelfInfo(this.appConfig.portalUrl).then(p.hitch(this,function(e){if((e=
e.helperServices&&e.helperServices.geocode)&&0<e.length)for(var c=0,f=e.length;c<f;c++){var n=e[c];n&&a.push(this._processSingleLine(n))}return t(a).then(p.hitch(this,function(a){for(var e=[],b=0;b<a.length;b++){var f=a[b];f&&(f&&"query"===f.type||(f={name:f.name||this._getGeocodeName(f.url),url:f.url,singleLineFieldName:f.singleLineFieldName,placeholder:"Find address or place",maxResults:6,searchInCurrentMapExtent:!1,type:"locator"},f.enableLocalSearch=this._isEsriLocator(f.url),f.localSearchMinScale=
3E5,f.localSearchDistance=5E4),e.push(f))}return e}))}))},_getQueryTypeGeocoder:function(a){var e=this.map.getLayer(a.id),c=null,l=null,f=null,f=d.isDefined(a.subLayer)?a.id+"_"+a.subLayer:a.id,c=this.layerInfosObj.traversal(function(a){return a.id===f?(l=a,!0):!1});return e&&c&&l?(c=d.isDefined(a.subLayer)?l.url||e.url+"/"+a.subLayer:l.url||e.url,{name:l.title,layerId:f,url:c,placeholder:a.hintText,searchFields:[a.field.name],displayField:a.field.name,exactMatch:a.field.exactMatch||!1,maxResults:6,
searchInCurrentMapExtent:!1,type:"query"}):null},_isEsriLocator:function(a){this._esriLocatorRegExp.lastIndex=0;return this._esriLocatorRegExp.test(a)},_processSingleLine:function(a){if(a.singleLineFieldName)return a;if(this._isEsriLocator(a.url))return a.singleLineFieldName="SingleLine",a;var e=new k;c({url:a.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(p.hitch(this,function(c){c.singleLineAddressField&&c.singleLineAddressField.name?(a.singleLineFieldName=c.singleLineAddressField.name,
e.resolve(a)):(console.warn(a.url+"has no singleLineFieldName"),e.resolve(null))}),p.hitch(this,function(a){console.error(a);e.resolve(null)}));return e.promise},_getGeocodeName:function(a){if("string"!==typeof a)return"geocoder";a=a.split("/");return a[a.length-2]||"geocoder"},getGeocoderName:function(a){return this._getGeocodeName(a)},hasAppSearchInfo:function(a){return a.itemInfo&&a.itemInfo.itemData&&a.itemInfo.itemData.applicationProperties&&a.itemInfo.itemData.applicationProperties.viewing&&
a.itemInfo.itemData.applicationProperties.viewing.search},searchLayer:function(a){if(!this.hasAppSearchInfo(a))return!1;a=a.itemInfo.itemData.applicationProperties.viewing.search;return a.enabled&&0!==a.layers.length?!0:!1},getSingleLineAddressName:function(a){var e=new k;c({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(p.hitch(this,function(a){a&&a.singleLineAddressField&&a.singleLineAddressField.name?e.resolve(a.singleLineAddressField.name):e.resolve(null)}),p.hitch(this,
function(a){console.error(a);e.reject()}));return e},version:{isConfigBefore63:function(a){var c=!1;a&&a.geocoderOptions&&(c=!0);return c},upgradeConfig:function(a){a.geocoderOptions&&delete a.geocoderOptions},getVersionState:function(){}},config:{onLayerInfosFilterChanged:function(a,c){h.some(a,p.hitch(this,function(a){c.searchOptions&&c.searchOptions.sources&&0<c.searchOptions.sources.length&&h.forEach(c.searchOptions.sources,function(c){c._featureLayerId===a.id&&c.featureLayer.setDefinitionExpression(a.getFilter())})}))},
getInfoTemplate:function(a,c,d){var e=new k;d=d.getLayerInfoById(c.layerId);var f;if(d)e=d.loadInfoTemplate();else{var n=[];h.filter(a.fields,function(a){"shape"!==a.name.toLowerCase()&&n.push(a.name)});(a=q.getDefaultPopupInfo(a,c.name+": {"+c.displayField+"}",n))&&(f=new v(a));e.resolve(f)}return e},getWayPoints:function(a,c){if(c)return a.defaultLocations;c=[];for(var e=0,d=a.defaultLocations.length;e<d;e++){var f;f=a.defaultLocations[e];if("object"===typeof f&&f.feature&&f.name){var n={},n=f.feature.attributes;
f.name&&(n.Name=f.name);f=new w(f.feature,null,n);c.push(f)}else"string"===typeof f?c.push(f):c.push("")}return c},_toPointGeometry:function(a){var c=a.feature.geometry;c&&(c.getCentroid?a.feature.geometry=c.getCentroid():c.getExtent&&(c=c.getExtent())&&(a.feature.geometry=c.getCenter()));return a},_getLocationObject:function(a){return{name:a.name,extent:a.extent,feature:{geometry:a.feature.geometry,attributes:{Score:100,Addr_Type:"PointAddress"}}}}}}})},"esri/dijit/Search":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/Deferred dojo/keys dojo/on dojo/query dojo/uacss dojo/regexp dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/date/locale dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ../lang ../InfoTemplate ../kernel ../SpatialReference ../graphic ../promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/normalizeUtils ../geometry/scaleUtils ../tasks/locator ../tasks/query ../Color ../styles/basic".split(" "),
function(p,h,k,r,t,g,d,c,q,v,w,a,e,u,y,l,f,n,A,x,b,z,E,B,F,M,N,I,G,K,Q,R,O,S,T,D,J,H,C,L,V,U,W,X){function P(b,a){b&&a&&(b._layer=a,b._sourceLayer=a)}h=h([x,b,z,t],{declaredClass:"esri.dijit.Search",templateString:A,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,constructor:function(b,a){this.css={searchGroup:"searchGroup",searchInput:"searchInput",searchInputGroup:"searchInputGroup",searchBtn:"searchBtn",searchSubmit:"searchSubmit",searchIcon:"searchIcon esri-icon-search",searchButtonText:"searchButtonText",
searchToggle:"searchToggle",searchToggleIcon:"searchIcon esri-icon-down-arrow",searchMenu:"searchMenu",searchMenuHeader:"menuHeader",searchClear:"searchClear",searchClearIcon:"searchIcon esri-icon-close searchClose",searchSpinner:"searchIcon esri-icon-loading-indicator searchSpinner",searchSourceName:"sourceName",suggestionsMenu:"suggestionsMenu",sourcesMenu:"sourcesMenu",activeSource:"active",hasValue:"hasValue",hasButtonMode:"hasButtonMode",hasMultipleSources:"hasMultipleSources",showSuggestions:"showSuggestions",
showSources:"showSources",showNoResults:"showNoResults",searchLoading:"searchLoading",latLonHeader:"searchLatLongHeader",searchMoreResults:"moreResults",searchMoreResultsList:"resultsList",searchMoreResultsHeader:"moreHeader",searchMoreResultsItem:"moreItem",searchMoreResultsListHeader:"popupHeader",searchShowMoreResults:"showMoreResults",searchNoResultsMenu:"noResultsMenu",searchNoResultsBody:"noResultsBody",searchNoResultsHeader:"noResultsHeader",searchNoValueIcon:"noValueIcon esri-icon-notice-triangle",
searchNoValueText:"noValueText",searchNoResultsText:"noResultsText",searchExpandContainer:"searchExpandContainer",searchAnimateContainer:"searchAnimate",searchExpanded:"searchExpanded",searchCollapsed:"searchCollapsed",searchClearFloat:"searchClearFloat"};this._allIndex="all";this._objectIdIdentifier="_objectId";this._deferreds=[];this._sourceNames=[];this.defaultSource={locator:new V("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),singleLineFieldName:"SingleLine",outFields:["Addr_type",
"Match_addr","StAddr","City"],name:n.widgets.Search.main.esriLocatorName,localSearchOptions:{minScale:3E5,distance:5E4},placeholder:n.widgets.Search.main.placeholder,highlightSymbol:(new Q(p.toUrl("./Search/images/search-pointer.png"),36,36)).setOffset(9,18)};this.options={map:null,theme:"arcgisSearch",visible:!0,value:"",allPlaceholder:"",sources:[this.defaultSource],activeSourceIndex:0,suggestionDelay:150,enableSourcesMenu:!0,enableSuggestionsMenu:!0,enableInfoWindow:!0,showInfoWindowOnSelect:!0,
enableSuggestions:!0,enableButtonMode:!1,autoNavigate:!0,autoSelect:!0,addLayersFromMap:!1,zoomScale:1E3,graphicsLayer:null,enableHighlight:!0,highlightGraphic:null,enableLabel:!1,labelSymbol:(new T).setColor(new W([181,56,46,.9])).setFont(new D("14px",D.STYLE_NORMAL,D.VARIANT_NORMAL,D.WEIGHT_BOLD,"Arial")),labelGraphic:null,infoTemplate:new M(n.widgets.Search.main.searchResult,'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),
searchResults:null,suggestResults:null,selectedResult:null,magicKey:null,selectedFeatureId:null,expanded:!1,maxLength:128,maxResults:6,maxSuggestions:6,locationToAddressDistance:1500,minCharacters:1,enableSearchingAll:!0};b=k.mixin({},this.options,b);this.set(b);this._updateActiveSource();this._i18n=n;this._defaultSR=new I(4326);this.domNode=a},startup:function(){this.inherited(arguments);this.sources||(this.sources=[]);this._mapLoaded().then(k.hitch(this,this._init))},postCreate:function(){var b=
this;this.inherited(arguments);this._moreResultsId=this.id+"_more_results";this.own(c(this.submitNode,E,k.hitch(this,this._searchButton)));this.own(c(this.sourcesBtnNode,E,k.hitch(this,this._toggleSourcesMenu)));this.own(c(this.inputNode,E,k.hitch(this,this._inputClick)));this.own(c(this.clearNode,E,k.hitch(this,this._clearButton)));this.own(c(this.formNode,"submit",k.hitch(this,function(b){b.preventDefault();this._cancelSuggest();this.search()})));this.own(c(this.inputNode,"keyup",k.hitch(this,function(b){this._inputKey(b)})));
this.own(c(this.sourcesBtnNode,"keyup",k.hitch(this,function(b){this._sourceBtnKey(b)})));this.own(c(this.suggestionsNode,"li:click, li:keyup",function(a){b._suggestionsEvent(a,this)}));this.own(c(this.sourcesNode,"li:click, li:keyup",function(a){b._sourcesEvent(a,this)}));this.own(c(this.inputNode,"input, paste",k.hitch(this,function(){this._suggestDelay()})));this.map&&this.map.infoWindow&&this.map.infoWindow.domNode&&this.enableInfoWindow&&(this.own(c(this.map.infoWindow.domNode,"#"+this._moreResultsId+
"_show:click",k.hitch(this,function(b){this._showMoreResultsClick(b)}))),this.own(c(this.map.infoWindow.domNode,"#"+this._moreResultsId+"_list li a:click",k.hitch(this,function(b){this._moreResultsClick(b)}))),this.own(c(this.map.infoWindow.domNode,"#"+this._moreResultsId+" [data-switch-coordinates]:click",k.hitch(this,function(b){this._switchCoordinatesClick(b)}))));this.value&&this._checkStatus();this._hideMenus();this._updateVisible();this._insertSources(this.sources);this._setPlaceholder(this.activeSourceIndex);
this._updateButtonMode(this.enableButtonMode);this.toggle(this.expanded)},destroy:function(){this.clear();l.empty(this.domNode);this.inherited(arguments)},clear:function(){this.clearGraphics();e.get(this.inputNode,"value")&&e.set(this.inputNode,"value","");this._changeAttrValue("value","");this.set("searchResults",null);this.set("suggestResults",null);this.set("selectedResult",null);this.set("magicKey",null);this.set("selectedFeatureId",null);u.remove(this.containerNode,this.css.hasValue);e.set(this.clearNode,
"title","");this._hideMenus();this._closePopup();this._hideLoading();this.emit("clear-search")},show:function(){y.set(this.domNode,"display","block")},hide:function(){y.set(this.domNode,"display","none")},expand:function(){this.enableButtonMode&&(u.add(this.containerNode,this.css.searchExpanded),u.remove(this.containerNode,this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!0))},collapse:function(){this.enableButtonMode&&(u.remove(this.containerNode,this.css.searchExpanded),u.add(this.containerNode,
this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!1))},toggle:function(b){this.enableButtonMode&&("undefined"===typeof b&&(b=!this.expanded),b?this.expand():this.collapse())},search:function(b){var a=new g;this._mapLoaded().then(k.hitch(this,function(){this._searchDeferred(b).then(k.hitch(this,function(b){var m=b.results;this.set("searchResults",m);0===b.numResults&&(this._noResults(b.value),this._showNoResultsMenu());this._hideLoading();this.emit("search-results",b);this._selectFirstResult(m,
b.activeSourceIndex);a.resolve(m)}),k.hitch(this,function(b){a.reject(b)}))}));return a.promise},suggest:function(b){var a=new g;this._mapLoaded().then(k.hitch(this,function(){this._suggestDeferred(b).then(k.hitch(this,function(b){if(b){var m=b.results;this.set("suggestResults",m);this._insertSuggestions(m,b.value);this.emit("suggest-results",b);a.resolve(m)}}),k.hitch(this,function(b){a.reject(b)}))}));return a.promise},select:function(b){var a=this._getDefaultSymbol(b),m=this.labelSymbol,c,f=this.sources,
e=this.activeSourceIndex,n=this.enableHighlight,d=this.enableLabel,l=this.autoNavigate,x=this.showInfoWindowOnSelect,g=this.enableInfoWindow,C=this.infoTemplate,q=b.feature?new G(b.feature.toJson()):null,w=q?b.feature._sourceLayer:null;P(q,w);if(e===this._allIndex){var z=this._getSourceIndexOfResult(b);null!==z&&(c=f[z],e=z)}else c=f[e];c&&(c.hasOwnProperty("highlightSymbol")&&(a=c.highlightSymbol),c.hasOwnProperty("labelSymbol")&&(m=c.labelSymbol),c.hasOwnProperty("enableHighlight")&&(n=c.enableHighlight),
c.hasOwnProperty("enableLabel")&&(d=c.enableLabel),c.hasOwnProperty("autoNavigate")&&(l=c.autoNavigate),c.hasOwnProperty("showInfoWindowOnSelect")&&(x=c.showInfoWindowOnSelect),c.hasOwnProperty("enableInfoWindow")&&(g=c.enableInfoWindow),c.hasOwnProperty("infoTemplate")?C=c.infoTemplate:c.featureLayer&&c.featureLayer.infoTemplate&&(C=c.featureLayer.infoTemplate));this._hideMenus();this._hideLoading();if(q){var f=this.highlightGraphic,v=this.graphicsLayer,z=this.labelGraphic,u=k.mixin({},q.attributes,
{searchTheme:this.theme,searchResult:this._searchResultHTML(b),searchMoreResults:this.css.searchMoreResults,searchMoreResultsItem:this.css.searchMoreResultsItem,searchMoreResultsId:this._moreResultsId,searchMoreResultsHtml:this._moreResultsHTML(b)}),L=null;g&&(L=C);z?(z.setGeometry(q.geometry),z.setAttributes(u),z.setSymbol(m),m&&"textsymbol"===m.type&&z.symbol.setText(b.name)):(z=new G(q.geometry,m,u),P(z,w),m&&"textsymbol"===m.type&&z.symbol.setText(b.name),d&&(v?v.add(z):this.map&&this.map.graphics&&
this.map.graphics.add(z)));f?(f.setGeometry(q.geometry),f.setAttributes(u),f.setInfoTemplate(L),f.setSymbol(a)):(f=new G(q.geometry,a,u,L),P(f,w),n&&(v?v.add(f):this.map&&this.map.graphics&&this.map.graphics.add(f)));f&&f.symbol&&"textsymbol"===f.symbol.type&&f.symbol.setText(b.name);this.map&&this.map.infoWindow&&g&&x&&(this.map.infoWindow.setFeatures([f]),a=this._getPointFromGeometry(f.geometry),this.map.infoWindow.show(a));this.map&&l&&b&&b.hasOwnProperty("extent")&&"function"===typeof this.map.setExtent&&
this.map.setExtent(b.extent,!0);this.set("highlightGraphic",f);this.set("labelGraphic",z)}this.set("selectedResult",b);this.emit("select-result",{result:b,source:c,sourceIndex:e})},focus:function(){B.focus(this.inputNode)},blur:function(){this.inputNode.blur();B.curNode&&B.curNode.blur()},clearGraphics:function(){var b=this.highlightGraphic,a=this.graphicsLayer,c=this.labelGraphic;b&&(a?a.remove(b):this.map&&this.map.graphics&&this.map.graphics.remove(b));c&&(a?a.remove(c):this.map&&this.map.graphics&&
this.map.graphics.remove(c));this.set("labelGraphic",null);this.set("highlightGraphic",null)},_mapLoaded:function(){var b=new g;if(this.map)if(this.map.loaded)b.resolve();else c.once(this.map,"load",k.hitch(this,function(){b.resolve()}));else b.resolve();return b.promise},_init:function(){this._getMapLayers().then(k.hitch(this,function(){this.set("loaded",!0);this.emit("load")}))},_clearButton:function(){this.clear();B.focus(this.inputNode)},_error:function(b){return Error(this.declaredClass+" "+
b)},_searchDeferred:function(b){var a=new g,m=this.value,c=this.activeSourceIndex;b&&b.hasOwnProperty("index")&&(c=b.index);this._showLoading();this._hideMenus();this._closePopup();this.clearGraphics();var f={magicKey:this.magicKey,text:m};b?"string"===typeof b?(f.text=b,b=this._searchQueries(f)):b="object"===typeof b&&b.hasOwnProperty("magicKey")?this._searchQueries(b):"object"===typeof b&&b.hasOwnProperty("geometry")?this._searchQueries({geometry:b}):"object"===typeof b&&b.hasOwnProperty(this._objectIdIdentifier)?
this._searchQueries(b):"object"===typeof b&&"point"===b.type?this._searchQueries({point:b}):b instanceof Array&&2===b.length?this._searchQueries({latlon:b}):this._searchQueries(f):b=this._searchQueries(f);b.always(k.hitch(this,function(b){b=this._formatResults(b,c,m);a.resolve(b)}));return a.promise},_suggestDeferred:function(b){var a=new g;this._deferreds.push(a);b||(b=this.value);var m=this.activeSourceIndex;this._suggestQueries({text:b}).always(k.hitch(this,function(c){var f;if(c)for(var e=0;e<
c.length;e++)c[e]&&(f=!0);f?(c=this._formatResults(c,m,b),a.resolve(c)):a.resolve()}));return a.promise},_getDefaultSymbol:function(b){var a,m,c,f;this.map&&(f=this.map.getBasemap());f||(f="topo");b&&b.feature&&b.feature.geometry&&(c=b.feature.geometry.type);"polyline"===c?c="line":"circle"===c||"extent"===c?c="polygon":"multipoint"===c&&(c="point");if(c){if(b=X.getSchemes({theme:"default",basemap:f,geometryType:c}))m=b.primaryScheme;if(m){m.color&&m.hasOwnProperty("opacity")&&(m.color.a=m.opacity);
a=m;b=m.color;m=m.size;var e;switch(c){case "point":e=new R;e.setColor(b);e.setSize(null!==m?m:a.size);c=new O;c.setColor(a.outline.color);c.setWidth(a.outline.width);e.setOutline(c);break;case "line":e=new O;e.setColor(b);e.setWidth(null!==m?m:a.width);break;case "polygon":e=new S,e.setColor(b),c=new O,c.setColor(a.outline.color),c.setWidth(a.outline.width),e.setOutline(c)}a=e}}return a},_selectFirstResult:function(b,a){if(this.autoSelect&&b){var m;a===this._allIndex?m=this._getFirstResult(b):b[a]&&
b[a][0]&&(m=b[a][0]);m&&this.select(m)}},_getSourceIndexOfResult:function(b){var a=this.searchResults;if(a)for(var m in a)if(a[m]&&a[m].length)for(var c=0;c<a[m].length;c++)if(a[m][c]===b)return parseInt(m,10);return null},_getFirstResult:function(b){if(b)for(var a in b)if(b[a]&&b[a][0])return b[a][0];return!1},_onFocus:function(){this.map&&"function"===typeof this.map.disableKeyboardNavigation&&this.map.disableKeyboardNavigation();this.emit("focus");this.inherited(arguments)},_onBlur:function(){this._hideMenus();
this.map&&"function"===typeof this.map.enableKeyboardNavigation&&this.map.enableKeyboardNavigation();this.enableButtonMode&&this.loaded&&this.collapse();this.emit("blur");this.inherited(arguments)},_getMapLayers:function(){var b=new g;if(this.addLayersFromMap&&this.map){var a=[],c=this.map.graphicsLayerIds;if(c&&c.length){for(var f=0;f<c.length;f++){var e=this.map.getLayer(c[f]);e&&a.push(this._featureLayerLoaded(e))}K(a).always(k.hitch(this,function(a){for(var m,c=this.sources,f=0;f<a.length;f++)a[f]&&
a[f].loaded&&"Feature Layer"===a[f].type&&(c.push({featureLayer:a[f],enableSuggestions:!0}),m=!0);m&&this.set("sources",c);b.resolve()}))}else b.resolve()}else b.resolve();return b.promise},_switchCoordinatesClick:function(b){b.preventDefault();if(b=e.get(b.target,"data-switch-coordinates"))this._cancelSuggest(),this.set("value",b),this.search()},_moreResultsClick:function(b){b.preventDefault();var a=b.target;b=parseInt(e.get(a,"data-source-index"),10);var a=parseInt(e.get(a,"data-index"),10),m=this.searchResults;
m&&m[b]&&(b=m[b][a])&&this.select(b)},_showMoreResultsClick:function(b){b.preventDefault();if(b=a.byId(this._moreResultsId)){u.toggle(b,this.css.searchShowMoreResults);var m=a.byId(this._moreResultsId+"_show");m&&(u.contains(b,this.css.searchShowMoreResults)?e.set(m,"textContent",n.widgets.Search.main.hideMoreResults):e.set(m,"textContent",n.widgets.Search.main.showMoreResults))}},_featureLayerLoaded:function(b){var a=new g;if(b.loaded)a.resolve(b);else if(b.loadError)a.reject(this._error("Layer failed to load."));
else{var m,f;m=c.once(b,"load",k.hitch(this,function(){f.remove();a.resolve(b)}));f=c.once(b,"error",k.hitch(this,function(){m.remove();a.reject(this._error("Layer could not be loaded."))}))}return a.promise},_getObjectSize:function(b){var a=0,m;for(m in b)b.hasOwnProperty(m)&&a++;return a},_sourcesEvent:function(b,a){var m=e.get(a,"data-index"),c=q("li",this.sourcesNode);a=r.indexOf(c,a);m!==this._allIndex&&(m=parseInt(m,10));"click"===b.type||b.keyCode===d.ENTER?(this.set("activeSourceIndex",m),
B.focus(this.inputNode),this._hideSourcesMenu()):b.keyCode===d.UP_ARROW?(b.stopPropagation(),b.preventDefault(),b=a-1,0>b?B.focus(this.sourcesBtnNode):B.focus(c[b])):b.keyCode===d.DOWN_ARROW?(b.stopPropagation(),b.preventDefault(),b=a+1,b>=c.length?B.focus(this.sourcesBtnNode):B.focus(c[b])):b.keyCode===d.ESCAPE&&(this._hideSourcesMenu(),B.focus(this.inputNode))},_suggestionsEvent:function(b,a){var m=e.get(a,"data-source-index"),c=parseInt(e.get(a,"data-index"),10),f=q("li",this.suggestionsNode),
n=this.sources;a=r.indexOf(f,a);m!==this._allIndex&&(m=parseInt(m,10));var l;this._clearQueryTimeout();"click"===b.type||b.keyCode===d.ENTER?((f=this.suggestResults)&&f[m]&&f[m][c]&&(l=f[m][c]),l&&(l.index=m,n[m].featureLayer?(m=n[m].featureLayer.objectIdField,l[this._objectIdIdentifier]=l.feature.attributes[m],this.set("value",this._getSuggestionName(l)),this.set("selectedFeatureId",l.feature.attributes[m])):l.magicKey&&l.text&&(this.set("value",l.text),this.set("magicKey",l.magicKey)),this.search(l),
B.focus(this.inputNode))):b.keyCode===d.BACKSPACE||b.keyCode===d.DELETE?B.focus(this.inputNode):b.keyCode===d.UP_ARROW?(b.stopPropagation(),b.preventDefault(),l=a-1,0>l?B.focus(this.inputNode):B.focus(f[l])):b.keyCode===d.DOWN_ARROW?(b.stopPropagation(),b.preventDefault(),l=a+1,l>=f.length?B.focus(this.inputNode):B.focus(f[l])):b.keyCode===d.ESCAPE&&(this._hideMenus(),B.focus(this.inputNode))},_getResultName:function(b){var a;b.hasOwnProperty("name")&&null!==b.name&&(a=b.name.toString());a||(a=n.widgets.Search.main.untitledResult);
return a},_getSuggestionName:function(b){var a;b.hasOwnProperty("name")&&null!==b.name&&(a=b.name.toString());b=b.text||a;b||(b=n.widgets.Search.main.untitledResult);return b},_searchResultHTML:function(b){var a="";if(b.feature&&b.feature.attributes&&b.feature.attributes.Addr_type&&"LatLong"===b.feature.attributes.Addr_type){var c=b.name.split(" "),m,f;2===c.length&&(m=c[0],f=c[1]);f&&m?(b=parseFloat(m),f=parseFloat(f),c=f+", "+b,a+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e',a+='\x3cdiv class\x3d"'+
this.css.latLonHeader+'"\x3e'+n.widgets.Search.main.lonlat+"\x3c/div\x3e",a=a+(b+", "+f)+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),b===f||90<b||-90>b||180<f||-180>f||(a+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+n.widgets.Search.main.reverseLonLatHeader+"\x3c/div\x3e",a=a+('\x3ca data-switch-coordinates\x3d"'+c+'" tabindex\x3d"0" href\x3d"#"\x3e'+c+"\x3c/a\x3e")+"\x3c/div\x3e")):a=b.name}else a=b.name;return a},_moreResultsHTML:function(b){var a="",c="",
m=this.searchResults,f=this.sources,e=0;if(m){var c=c+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),c=c+('\x3ca href\x3d"#" id\x3d"'+this._moreResultsId+'_show"\x3e'+n.widgets.Search.main.showMoreResults+"\x3c/a\x3e"),c=c+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsList+'"\x3e'),c=c+('\x3cdiv id\x3d"'+this._moreResultsId+'_list"\x3e'),l;for(l in m)if(m[l]){var d=m[l].length;if(d){var x=1===d&&m[l][0]===b;if(1<this._getObjectSize(m)&&!x)var g=this._getSourceName(l),
c=c+('\x3cdiv class\x3d"'+this.css.searchMoreResultsListHeader+'"\x3e'+g+"\x3c/div\x3e");if(d&&!x){c+="\x3cul\x3e";g=f[l].maxResults||this.maxResults;for(x=0;x<d&&x<g;++x)if(m[l][x]!==b){var C=this._getResultName(m[l][x]),c=c+('\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"'+x+'" data-source-index\x3d"'+l+'" href\x3d"#"\x3e'+C+"\x3c/a\x3e\x3c/li\x3e");e++}c+="\x3c/ul\x3e"}}}c+="\x3c/div\x3e\x3c/div\x3e"}e&&(a+=c);return a},_validField:function(b,a){return b.getField(a)},_validFields:function(b,a){if(b&&
a&&a.length){for(var c=0;c<a.length;c++)if(!this._validField(b,a[c]))return!1;return!0}return!1},_getCodedName:function(b,a){if(b&&b.length)for(var c=0,m=b.length;c<m;c++){var f=b[c];if(f.code===a)return f.name}},_getCodedValue:function(b,a,c){if(b&&b.length)for(var m=0,f=b.length;m<f;m++){var e=b[m],l=e.name,n=a;c||(l=l.toLowerCase(),n=n.toLowerCase());if(l===n)return e.code}return!1},_whereClause:function(b,a,c,f){var m=null;if(b){var e="";this.reHostedFS.test(a.url)&&this._containsNonLatinCharacter(b)&&
(e="N");if(c&&c.length)for(var l=0,n=c.length;l<n;l++){var d="",x=b.replace(/\'/g,"''"),d=c[l],g=a.getField(d),C=a.getDomain(d);C&&"codedValue"===C.type&&(x=this._getCodedValue(C.codedValues,x,f));!1!==x&&(g=g.type,"esriFieldTypeString"===g||"esriFieldTypeDate"===g?d=f?d+" \x3d "+e+"'"+x+"'":"UPPER("+d+") LIKE "+e+"'%"+x.toUpperCase()+"%'":"esriFieldTypeOID"===g||"esriFieldTypeSmallInteger"===g||"esriFieldTypeInteger"===g||"esriFieldTypeSingle"===g||"esriFieldTypeDouble"===g?(x=parseFloat(x),d=isNaN(x)?
!1:d+" \x3d "+x):d=d+" \x3d "+x,d&&(m=m?m+" or ":"",m+=d))}}return m},_suggest:function(b){b||(b={index:this.activeSourceIndex,text:this.value});var a=new g,c=b.index,f=this.sources[c],m=this.enableSuggestions;f.hasOwnProperty("enableSuggestions")&&(m=f.enableSuggestions);var e=0,l;b.hasOwnProperty("text")&&b.text&&(l=k.trim(b.text),e=b.text.length);b=f.minCharacters||this.minCharacters;if(m&&l&&e>=b&&this._supportsPagination(f)){var n="";f.prefix&&(n+=f.prefix);n+=l;f.suffix&&(n+=f.suffix);var d=
this._defaultSR;this.map&&(d=this.map.spatialReference);m={};f.locator?(f.categories&&(m.categories=f.categories),f.locator.outSpatialReference=d,this.map&&f.localSearchOptions&&f.localSearchOptions.hasOwnProperty("distance")&&f.localSearchOptions.hasOwnProperty("minScale")&&(e=this._getScale(),!f.localSearchOptions.minScale||e&&e<=parseFloat(f.localSearchOptions.minScale))&&(m.location=this.map.extent.getCenter(),m.distance=f.localSearchOptions.distance),m.text=n,f.useMapExtent&&this.map&&this.map.extent&&
(m.searchExtent=this.map.extent),f.searchExtent&&(m.searchExtent=f.searchExtent),m.maxSuggestions=f.maxSuggestions||this.maxSuggestions,f.sourceCountry&&(m.countryCode=f.sourceCountry),f.countryCode&&(m.countryCode=f.countryCode),f.locator.suggestLocations(m).then(k.hitch(this,function(b){a.resolve(b)}),k.hitch(this,function(b){b||(b=this._error("Locator suggestLocations could not be performed."));a.reject(b)}))):f.featureLayer?this._featureLayerLoaded(f.featureLayer).then(k.hitch(this,function(){var b=
this._getDisplayField(f),m=f.searchFields||[b],e=[];f.suggestionTemplate?f.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g,function(b,a){e.push(a)}):e=[b];-1===r.indexOf(e,f.featureLayer.objectIdField)&&e.push(f.featureLayer.objectIdField);var b=this._validField(f.featureLayer,b),l=this._validFields(f.featureLayer,e),x=this._validFields(f.featureLayer,m);if(b&&l&&x){b=new U;f.hasOwnProperty("suggestQueryParams")&&k.mixin(b,f.suggestQueryParams);b.outSpatialReference=d;b.returnGeometry=!1;b.num=f.maxSuggestions||
this.maxSuggestions;b.outFields=e;f.useMapExtent&&this.map&&this.map.extent&&(b.geometry=this.map.extent);f.searchExtent&&(b.geometry=f.searchExtent);var g;if(m=this._whereClause(n,f.featureLayer,m,!1))b.where=m,g=!0;g?f.featureLayer.queryFeatures(b,k.hitch(this,function(b){var f;(b=b.features)&&(f=this._hydrateResults(b,c,!0));a.resolve(f)}),k.hitch(this,function(b){b||(b=this._error("FeatureLayer queryFeatures errored with suggestions"));a.reject(b)})):a.resolve()}else a.reject(this._error("Invalid FeatureLayer field"))})):
a.reject(this._error("Invalid source"))}else a.resolve();return a.promise},_supportsPagination:function(b){var a;b.locator?a=!0:b.featureLayer&&b.featureLayer.advancedQueryCapabilities&&b.featureLayer.advancedQueryCapabilities.supportsPagination&&(a=!0);return a},_suggestQueries:function(b){var a=this.sources,c=this.activeSourceIndex,f=[],m;if(c===this._allIndex)for(c=0;c<a.length;c++)m=b,m.index=c,m=this._suggest(m),f.push(m);else b.index=c,m=this._suggest(b),f.push(m);return K(f)},_getPointFromGeometry:function(b){var a;
switch(b.type){case "extent":a=b.getCenter();break;case "multipoint":a=b.getPoint(0);break;case "point":a=b;break;case "polygon":a=b.getCentroid();break;case "polyline":a=b.getPoint(0,0)}return a},_searchQueries:function(b){b.hasOwnProperty("index")||(b.index=this.activeSourceIndex);var a=[],c;if(b.index===this._allIndex)for(var f=this.sources,m=0;m<f.length;m++)c=b,c.index=m,c=this._search(c),a.push(c);else b=this._search(b),a.push(b);return K(a)},_searchButton:function(){this.enableButtonMode&&
!this.expanded?(this.expand(),B.focus(this.inputNode)):(this._cancelSuggest(),this.search())},_search:function(b){b||(b={text:this.value,magicKey:null,geometry:null,point:null,index:this.activeSourceIndex,latlon:null});this.selectedFeatureId&&(b.text=null,b[this._objectIdIdentifier]=this.selectedFeatureId);var a,c=new g,f=b.index,m=this.sources[f],e;b.hasOwnProperty("text")&&b.text&&(e=k.trim(b.text));if(m){var l="";m.prefix&&!b.magicKey&&(l+=m.prefix);l+=e;m.suffix&&!b.magicKey&&(l+=m.suffix);var n=
this._defaultSR;this.map&&(n=this.map.spatialReference);if(m.locator)if(b.hasOwnProperty("text")&&e){var d={};m.categories&&(d.categories=m.categories);m.locationType&&(d.locationType=m.locationType);n&&(m.locator.outSpatialReference=n);if(this.map&&m.localSearchOptions&&m.localSearchOptions.hasOwnProperty("distance")&&m.localSearchOptions.hasOwnProperty("minScale")){var x=this._getScale();if(!m.localSearchOptions.minScale||x&&x<=parseFloat(m.localSearchOptions.minScale))d.location=this.map.extent.getCenter(),
d.distance=m.localSearchOptions.distance}d.address={};d.maxLocations=m.maxResults||this.maxResults;m.useMapExtent&&this.map&&this.map.extent&&(d.searchExtent=this.map.extent);m.searchExtent&&(d.searchExtent=m.searchExtent);m.sourceCountry&&(d.countryCode=m.sourceCountry);m.countryCode&&(d.countryCode=m.countryCode);b.magicKey&&(d.magicKey=b.magicKey);m.singleLineFieldName?d.address[m.singleLineFieldName]=l:d.address["Single Line Input"]=l;m.outFields&&(d.outFields=m.outFields);m.locator.addressToLocations(d).then(k.hitch(this,
function(b){b=this._hydrateResults(b,f,!1);c.resolve(b)}),k.hitch(this,function(b){b||(b=this._error("Locator addressToLocations could not be performed"));c.reject(b)}))}else b.geometry?(a=this._getPointFromGeometry(b.geometry.geometry))?this._reverseGeocodePoint(f,a).then(function(b){c.resolve(b)},function(b){c.reject(b)}):c.reject(this._error("Invalid point to reverse geocode")):b.point?this._reverseGeocodePoint(f,b.point).then(function(b){c.resolve(b)},function(b){c.reject(b)}):b.latlon?(d=new J(b.latlon,
this._defaultSR),this._reverseGeocodePoint(f,d).then(function(b){c.resolve(b)},function(b){c.reject(b)})):b.hasOwnProperty("text")&&!e?c.resolve([]):c.reject(this._error("Invalid query type for Locator"));else m.featureLayer?this._featureLayerLoaded(m.featureLayer).then(k.hitch(this,function(){var d=this._getDisplayField(m),x=m.searchFields||[d],d=this._validField(m.featureLayer,d),g=this._validFields(m.featureLayer,x);if(d&&g){d=new U;m.hasOwnProperty("searchQueryParams")&&k.mixin(d,m.searchQueryParams);
n&&(d.outSpatialReference=n,g=this.map&&this.map.getMaxResolution()||1/L.getUnitValueForSR(n))&&(d.maxAllowableOffset=g);d.returnGeometry=!0;m.outFields&&(d.outFields=m.outFields);var C;b.hasOwnProperty(this._objectIdIdentifier)||(this._supportsPagination(m)&&(d.num=m.maxResults||this.maxResults),m.useMapExtent&&this.map&&this.map.extent&&(d.geometry=this.map.extent),m.searchExtent&&(d.geometry=m.searchExtent),C=m.exactMatch);b.hasOwnProperty("text")&&e?(x=this._whereClause(l,m.featureLayer,x,C))?
(d.where=x,x=!0):x=!1:b.hasOwnProperty(this._objectIdIdentifier)?(d.objectIds=[b[this._objectIdIdentifier]],x=!0):b.geometry?(d.geometry=b.geometry,x=!0):b.point?(d.geometry=b.point,x=!0):b.latlon?(a=new J(b.latlon,this._defaultSR),d.geometry=a,x=!0):(b.hasOwnProperty("text")&&!e?c.resolve([]):c.reject(this._error("Invalid query type for FeatureLayer")),x=!1);x?m.featureLayer.queryFeatures(d,k.hitch(this,function(b){b=b.features;var a;b&&(a=this._hydrateResults(b,f,!1));c.resolve(a)}),k.hitch(this,
function(b){b||(b=this._error("FeatureLayer queryFeatures could not be performed"));c.reject(b)})):c.resolve()}else c.reject(this._error("Invalid FeatureLayer field"))})):c.reject(this._error("Invalid source"))}else c.reject(this._error("Source is undefined"));return c.promise},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_formatResults:function(b,a,c){c={activeSourceIndex:a,value:c,numResults:0,numErrors:0,errors:null,results:null};var f={},m={};if(b)if(a===this._allIndex)for(a=
0;a<b.length;a++)b[a]&&(b[a]instanceof Error?(f[a]=b[a],c.numErrors++):(m[a]=b[a],c.numResults+=b[a].length));else b[0]&&(b[0]instanceof Error?(f[a]=b[0],c.numErrors++):(m[a]=b[0],c.numResults+=b[0].length));c.numErrors&&(c.errors=f);c.numResults&&(c.results=m);return c},_reverseGeocodePoint:function(b,a){var c=new g,f=this.sources[b];if(a&&f){var m=f.locationToAddressDistance||this.locationToAddressDistance;f.locator.outSpatialReference=this._defaultSR;this.map&&(f.locator.outSpatialReference=this.map.spatialReference);
f.locator.locationToAddress(a,m,k.hitch(this,function(a){a=this._hydrateResults([a],b,!1);c.resolve(a)}),k.hitch(this,function(b){b||(b=this._error("Locator locationToAddress could not be performed"));c.reject(b)}))}else c.reject(this._error("No point or source defined for reverse geocoding"));return c.promise},_cancelDeferreds:function(){if(this._deferreds&&this._deferreds.length)for(var b=0;b<this._deferreds.length;b++)this._deferreds[b].cancel(this.declaredClass+" cancelling request");this._deferreds=
[]},_sourceBtnKey:function(b){if(b){var a=q("li",this.sourcesNode);b.keyCode===d.UP_ARROW?(b.stopPropagation(),b.preventDefault(),this._showSourcesMenu(),(b=a.length)&&B.focus(a[b-1])):b.keyCode===d.DOWN_ARROW&&(b.stopPropagation(),b.preventDefault(),this._showSourcesMenu(),a[0]&&B.focus(a[0]))}},_inputKey:function(b){if(b){var a=q("li",this.suggestionsNode),c=this.suggestResults;if(b.keyCode===d.TAB||b.keyCode===d.ESCAPE)this._cancelSuggest(),this._hideMenus();else if(b.keyCode===d.UP_ARROW)b.stopPropagation(),
b.preventDefault(),this._cancelSuggest(),c&&this._showSuggestionsMenu(),(b=a.length)&&B.focus(a[b-1]);else if(b.keyCode===d.DOWN_ARROW)b.stopPropagation(),b.preventDefault(),this._cancelSuggest(),c&&this._showSuggestionsMenu(),a[0]&&B.focus(a[0]);else{if(b.ctrlKey||b.metaKey||b.keyCode===d.copyKey||b.keyCode===d.LEFT_ARROW||b.keyCode===d.RIGHT_ARROW||b.keyCode===d.ENTER)return b;this._suggestDelay()}}},_cancelSuggest:function(){this._cancelDeferreds();this._clearQueryTimeout()},_suggestDelay:function(){this._cancelSuggest();
this._changeValue();this._queryTimer=setTimeout(k.hitch(this,function(){this.suggest()}),this.suggestionDelay)},_changeValue:function(){this.set("magicKey",null);this.set("selectedFeatureId",null);this._changeAttrValue("value",this.inputNode.value);this._checkStatus()},_inputClick:function(){this._hideSourcesMenu();this._hideNoResultsMenu()},_getSourceName:function(b){return this._sourceNames[b]},_loadSources:function(b){b=r.filter(b,function(b){return!!b.featureLayer});b=r.map(b,function(b){return this._featureLayerLoaded(b.featureLayer)},
this);return K(b)},_createSourceNameMap:function(b){return this._loadSources(b).then(k.hitch(this,function(){var a=r.map(b,function(b){return b.name||b.featureLayer&&b.featureLayer.name||n.widgets.Search.main.untitledSource});this._preventDuplicateSourceNames(b,a);return a}))},_getDuplicateSourceNameIndexes:function(b){var a={},c=[];r.forEach(b,function(f,m){a.hasOwnProperty(f)?(-1===c.indexOf(a[f])&&c.push(a[f]),c.push(m)):b.lastIndexOf(f)!==m&&(a[f]=m)});return c},_preventDuplicateSourceNames:function(b,
a){if(a&&1<a.length){var c=this._getDuplicateSourceNameIndexes(a);r.forEach(c,function(c){a[c]+=this._getFieldsString(b[c])},this)}},_getFieldsString:function(b){var a="",c=b.featureLayer;if(c){b=b.searchFields||[this._getDisplayField(b)];for(var f=0;f<b.length;f++)var a=0===f?a+": ":a+", ",m=b[f],e=c.getFieldLabel(m),a=a+(e||m)}return a},_splitResult:function(b,a){a=w.escapeString(a);return b.replace(new RegExp("(^|)("+a+")(|$)","ig"),"$1|$2|$3").split("|")},_insertSuggestions:function(b,a){if(this.enableSuggestionsMenu&&
this.suggestionsNode){this._hideSourcesMenu();this._hideNoResultsMenu();var c,f=this.sources;if(b){c=l.create("div");for(var m in b)if(b[m]&&b[m].length){var e=this._getSourceName(m);1<f.length&&this.activeSourceIndex===this._allIndex&&l.create("div",{className:this.css.searchMenuHeader,textContent:e},c);for(var e=l.create("ul",{role:"menu"},c),d=f[m].maxSuggestions||this.maxSuggestions,n=0;n<b[m].length&&n<d;++n)for(var x=l.create("li",{"data-index":n,"data-source-index":m,role:"menuitem",tabindex:0},
e),g=this._getSuggestionName(b[m][n]),g=this._splitResult(g,a),C=g.length,q=0;q<C;q++){var z=g[q];z.toLowerCase()===a.toLowerCase()?l.create("strong",{textContent:z},x):(z=document.createTextNode(z),l.place(z,x))}}}c?(l.place(c,this.suggestionsNode,"only"),this._showSuggestionsMenu()):(l.empty(this.suggestionsNode),this._hideSuggestionsMenu())}},_insertSources:function(b){if(this.enableSourcesMenu&&b&&1<b.length){var a,c,f=this.activeSourceIndex,m=l.create("ul",{role:"menu"});this.enableSearchingAll&&
(a="",f===this._allIndex&&(a="active"),l.create("li",{"data-index":this._allIndex,role:"menuitem",className:a,tabIndex:0,textContent:n.widgets.Search.main.all},m));for(c=0;c<b.length;c++){a="";c===f&&(a=this.css.activeSource);var e=this._getSourceName(c);l.create("li",{"data-index":c,role:"menuitem",className:a,tabIndex:0,textContent:e},m)}u.add(this.containerNode,this.css.hasMultipleSources);l.place(m,this.sourcesNode,"only")}else u.remove(this.containerNode,this.css.hasMultipleSources),l.empty(this.sourcesNode)},
_showLoading:function(){u.add(this.containerNode,this.css.searchLoading)},_hideLoading:function(){u.remove(this.containerNode,this.css.searchLoading)},_checkStatus:function(){this.value?(u.add(this.containerNode,this.css.hasValue),e.set(this.clearNode,"title",n.widgets.Search.main.clearButtonTitle)):this.clear()},_closePopup:function(){this.enableInfoWindow&&this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_noResults:function(b){var a;b&&(a=k.trim(b));var c=l.create("div",{className:this.css.searchNoResultsBody});
b&&a?(l.create("div",{className:this.css.searchNoResultsHeader,textContent:n.widgets.Search.main.noResults},c),l.create("div",{className:this.css.searchNoResultsText,textContent:F.substitute({value:'"'+b+'"'},n.widgets.Search.main.noResultsFound)},c)):(b=l.create("div",{},c),l.create("span",{"aria-hidden":"true",className:this.css.searchNoValueIcon},b),l.create("span",{className:this.css.searchNoValueText,textContent:n.widgets.Search.main.emptyValue},b));l.place(c,this.noResultsMenuNode,"only")},
_hideMenus:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();this._hideNoResultsMenu()},_hideNoResultsMenu:function(){u.remove(this.containerNode,this.css.showNoResults)},_showNoResultsMenu:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();u.add(this.containerNode,this.css.showNoResults)},_hideSourcesMenu:function(){u.remove(this.containerNode,this.css.showSources)},_hideSuggestionsMenu:function(){u.remove(this.containerNode,this.css.showSuggestions)},_showSourcesMenu:function(){this._hideSuggestionsMenu();
this._hideNoResultsMenu();u.add(this.containerNode,this.css.showSources)},_showSuggestionsMenu:function(){this._hideSourcesMenu();this._hideNoResultsMenu();u.add(this.containerNode,this.css.showSuggestions)},_toggleSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();u.toggle(this.containerNode,this.css.showSources)},_getFirstStringField:function(b){if(b&&(b=b.fields)&&b.length)for(var a=0;a<b.length;a++){var c=b[a];if("esriFieldTypeString"===c.type)return c.name}return""},
_getDisplayField:function(b){return b.displayField||b.featureLayer.displayField||this._getFirstStringField(b.featureLayer)},_validLocation:function(b){return b&&"number"===typeof b.x&&"number"===typeof b.y},_validExtent:function(b){return b&&"number"===typeof b.xmin&&"number"===typeof b.ymin&&"number"===typeof b.xmax&&"number"===typeof b.ymax},_hydrateResult:function(b,a,c){var e={},d=this._defaultSR,n;a=this.sources[a];this.map&&(d=this.map.spatialReference);if(b.hasOwnProperty("text")&&b.hasOwnProperty("magicKey"))return b;
if(b.hasOwnProperty("geometry"))n=new G(b.toJson()),e.feature=n,(n=e.feature.geometry)&&n.setSpatialReference(d);else if(b.hasOwnProperty("location")&&this._validLocation(b.location)){var l=new J(b.location.x,b.location.y,d);n={};b.hasOwnProperty("attributes")&&(n=b.attributes);b.hasOwnProperty("address")&&"object"===typeof b.address&&k.mixin(n,b.address);b.hasOwnProperty("score")&&(n.score=b.score);e.feature=new G(l,null,n,null)}!e.feature&&c&&(n={},b.hasOwnProperty("attributes")&&(n=b.attributes),
b.hasOwnProperty("score")&&(n.score=b.score),e.feature=new G(null,null,n,null));if(e.feature){if(b.hasOwnProperty("extent")&&this._validExtent(b.extent))e.extent=new H(b.extent),e.extent.setSpatialReference(d);else if(e.feature&&e.feature.geometry)switch(e.feature.geometry.type){case "extent":e.extent=e.feature.geometry;break;case "multipoint":e.extent=C.getDenormalizedExtent(e.feature.geometry);break;case "polygon":e.extent=C.getDenormalizedExtent(e.feature.geometry);break;case "polyline":e.extent=
C.getDenormalizedExtent(e.feature.geometry);break;case "point":this.map?(d=this.zoomScale,a&&a.zoomScale&&(d=a.zoomScale),this._getScale()>d?e.extent=L.getExtentForScale(this.map,d).centerAt(e.feature.geometry):e.extent=this.map.extent.centerAt(e.feature.geometry)):e.extent=new H({xmin:e.feature.geometry.x-.25,ymin:e.feature.geometry.y-.25,xmax:e.feature.geometry.x+.25,ymax:e.feature.geometry.y+.25,spatialReference:this._defaultSR})}else e.extent=null;e.name="";a.featureLayer?a.suggestionTemplate&&
c?e.name=F.substitute(b.attributes,a.suggestionTemplate):a.searchTemplate?e.name=F.substitute(b.attributes,a.searchTemplate):(n=this._getDisplayField(a),c=a.featureLayer.getField(n),d=a.featureLayer.getDomain(n),n&&b.hasOwnProperty("attributes")&&b.attributes.hasOwnProperty(n)&&(b=b.attributes[n],d&&"codedValue"===d.type?e.name=this._getCodedName(d.codedValues,b):c&&"esriFieldTypeDate"===c.type&&!isNaN(b)?e.name=f.format(new Date(b)):e.name=b)):b.address&&a.searchTemplate?e.name=F.substitute(b.address,
a.searchTemplate):b.hasOwnProperty("name")?e.name=b.name:b.hasOwnProperty("attributes")&&"object"===typeof b.attributes&&b.attributes.LongLabel?e.name=b.attributes.LongLabel:b.hasOwnProperty("attributes")&&"object"===typeof b.attributes&&b.attributes.Match_addr?(e.name=b.attributes.Match_addr,b.attributes.Addr_type&&"POI"===b.attributes.Addr_type&&b.attributes.StAddr&&b.attributes.City?e.name+=" - "+b.attributes.StAddr+", "+b.attributes.City:b.attributes.Addr_type&&"POI"===b.attributes.Addr_type&&
b.attributes.City&&(e.name+=" - "+b.attributes.City)):b.hasOwnProperty("address")&&"string"===typeof b.address?e.name=b.address:b.hasOwnProperty("address")&&"object"===typeof b.address&&b.address.hasOwnProperty("Address")?b.address.hasOwnProperty("Match_addr")?e.name=b.address.Match_addr:b.address.hasOwnProperty("Address")&&(e.name=b.address.Address):e.feature&&e.feature.geometry&&(e.name=e.feature.geometry.x+","+e.feature.geometry.y);a.featureLayer&&e.feature&&P(e.feature,a.featureLayer);return e}},
_getScale:function(){var b;this.map&&"function"===typeof this.map.getScale&&(b=this.map.getScale());return b},_hydrateResults:function(b,a,c,f){f=[];var e=0;if(b&&b.length)for(e;e<b.length;e++){var d=this._hydrateResult(b[e],a,c);d&&f.push(d)}return f},_containsNonLatinCharacter:function(b){for(var a=0;a<b.length;a++)if(255<b.charCodeAt(a))return!0;return!1},_setPlaceholder:function(b){var a="",c=this.sources[b];b===this._allIndex?a=this.allPlaceholder||n.widgets.Search.main.allPlaceholder:c&&c.placeholder&&
(a=c.placeholder);var f=n.widgets.Search.main.all;c&&(f=this._getSourceName(b));e.set(this.sourceNameNode,"textContent",f);e.set(this.inputNode,"placeholder",a);e.set(this.inputNode,"title",a)},_updateActiveSource:function(){var b=this.sources,a=this.activeSourceIndex,c;b&&b[a]&&(c=b[a]);c?this.set("activeSource",c):this.set("activeSource",null)},_updateVisible:function(){this.visible?this.show():this.hide()},_updateButtonMode:function(b){b?(u.toggle(this.containerNode,this.css.searchExpanded,this.expanded),
u.toggle(this.containerNode,this.css.searchCollapsed,!this.expanded),u.add(this.containerNode,this.css.hasButtonMode)):(u.remove(this.containerNode,this.css.searchExpanded),u.remove(this.containerNode,this.css.searchCollapsed),u.remove(this.containerNode,this.css.hasButtonMode))},_setDefaultActiveSourceIndex:function(b){b&&1===b.length||!this.enableSearchingAll?this.set("activeSourceIndex",0):this.set("activeSourceIndex",this._allIndex)},_setEnableSourcesMenuAttr:function(b){this._set("enableSourcesMenu",
b);this._created&&this._insertSources(this.sources)},_setEnableSearchingAllAttr:function(b){this._set("enableSearchingAll",b);this._created&&(this._setDefaultActiveSourceIndex(this.sources),this._hideMenus(),this._insertSources(this.sources))},_setSourcesAttr:function(b){this._createSourceNameMap(b).then(k.hitch(this,function(a){this._sourceNames=a;this._created&&(this._setDefaultActiveSourceIndex(b),this._hideMenus(),this._insertSources(b))}));this._set("sources",b)},_setAllPlaceholderAttr:function(b){this._set("allPlaceholder",
b);this._created&&this._setPlaceholder(this.activeSourceIndex)},_setActiveSourceIndexAttr:function(b){this._set("activeSourceIndex",b);this._updateActiveSource();this._created&&(this._setPlaceholder(b),this._hideMenus(),this._insertSources(this.sources))},_setMaxLengthAttr:function(b){this._set("maxLength",b);this._created&&e.set(this.inputNode,"maxLength",b)},_setValueAttr:function(b){this.set("magicKey",null);this.set("selectedFeatureId",null);this._set("value",b);this._created&&(e.set(this.inputNode,
"value",b),this._checkStatus())},_setVisibleAttr:function(b){this._set("visible",b);this._created&&this._updateVisible()},_setEnableButtonModeAttr:function(b){this._set("enableButtonMode",b);this._created&&this._updateButtonMode(b)},_setThemeAttr:function(b){this._created&&(u.remove(this.domNode,this.theme),u.add(this.domNode,b));this._set("theme",b)}});v("extend-esri")&&k.setObject("dijit.Search",h,N);return h})},"esri/styles/basic":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/has",
"../kernel","../Color"],function(p,h,k,r,t){function g(c,a){var e;if(c)switch(e={},e.color=new t(c.color),e.opacity=c.opacity||1,a){case "point":e.outline={color:new t(c.outline.color),width:c.outline.width};e.size=c.size;break;case "line":e.width=c.width;break;case "polygon":e.outline={color:new t(c.outline.color),width:c.outline.width}}return e}function d(c){if("esriGeometryPoint"===c||"esriGeometryMultipoint"===c)c="point";else if("esriGeometryPolyline"===c)c="line";else if("esriGeometryPolygon"===
c||"esriGeometryMultiPatch"===c)c="polygon";return c}var c={"default":{name:"default",label:"Default",description:"Default theme for basic visualization of features.",basemapGroups:{light:"streets gray topo terrain national-geographic oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector".split(" "),dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector"]},pointSchemes:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,
255,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[255,255,255,1],outline:{color:[51,51,51,.25],width:1},size:8}]},dark:{primary:{color:[255,255,255,1],outline:{color:[92,92,92,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[26,26,26,1],outline:{color:[178,178,178,.25],width:1},size:8}]}},lineSchemes:{light:{primary:{color:[77,77,77,1],width:2},secondary:[{color:[226,
119,40,1],width:2},{color:[255,255,255,1],width:2}]},dark:{primary:{color:[255,255,255,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[26,26,26,1],width:2}]}},polygonSchemes:{light:{primary:{color:[227,139,79,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},secondary:[{color:[128,128,128,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},{color:[255,255,255,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]},dark:{primary:{color:[227,139,79,1],outline:{color:[92,
92,92,.25],width:1},opacity:.8},secondary:[{color:[178,178,178,1],outline:{color:[92,92,92,.25],width:1},opacity:.8},{color:[26,26,26,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]}}}},q={};(function(){var d,a,e,g,v,l,f,n;for(d in c)for(g in a=c[d],e=a.basemapGroups,v=q[d]={basemaps:[].concat(e.light).concat(e.dark),point:{},line:{},polygon:{}},e)for(l=e[g],f=0;f<l.length;f++)n=l[f],a.pointSchemes&&(v.point[n]=a.pointSchemes[g]),a.lineSchemes&&(v.line[n]=a.lineSchemes[g]),a.polygonSchemes&&
(v.polygon[n]=a.polygonSchemes[g])})();var v={getAvailableThemes:function(d){var a=[],e,g,v;for(e in c)g=c[e],v=q[e],d&&-1===p.indexOf(v.basemaps,d)||a.push({name:g.name,label:g.label,description:g.description,basemaps:v.basemaps.slice(0)});return a},getSchemes:function(c){var a=c.theme,e=c.basemap,v=d(c.geometryType);c=q[a];var h;(c=(c=c&&c[v])&&c[e])&&(h={primaryScheme:g(c.primary,v),secondarySchemes:p.map(c.secondary,function(a){return g(a,v)})});return h},cloneScheme:function(c){var a;c&&(a=h.mixin({},
c),a.color&&(a.color=new t(a.color)),a.outline&&(a.outline={color:a.outline.color&&new t(a.outline.color),width:a.outline.width}));return a}};k("extend-esri")&&h.setObject("styles.basic",v,r);return v})},"widgets/Directions/setting/SearchConfig/SearchConfig":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/_base/html dojo/query dojo/_base/array dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./SearchConfig.html ./QuerySourceSetting ./LocatorSourceSetting jimu/LayerInfos/LayerInfos jimu/dijit/LoadingShelter dojo/Deferred ../../searchUtil dojo/when jimu/dijit/Message jimu/dijit/SimpleTable jimu/dijit/RadioBtn".split(" "),
function(p,h,k,r,t,g,d,c,q,v,w,a,e,u,y,l,f,n,A,x){return p([c,q,v,d],{templateString:w,postMixInProperties:function(){this.inherited(arguments);h.mixin(this.nls,window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.sourceList=new x({autoHeight:!1,selectable:!0,fields:[{name:"name",title:this.nls.name,width:"auto",type:"text",editable:!1},{name:"type",hidden:!0,type:"text",editable:!1},{name:"actions",title:"",width:"70px",type:"actions",actions:["up","down","delete"]}]},this.sourceList);
r.setStyle(this.sourceList.domNode,"height","100%");this.sourceList.startup();this.own(k(this.sourceList,"row-select",h.hitch(this,this._onSourceItemSelected)));this.own(k(this.sourceList,"row-delete",h.hitch(this,this._onSourceItemRemoved)));this.own(k(this.sourceList,"row-edit",h.hitch(this,this._onSourceItemChanged)));this.shelter=new y({hidden:!0})},startup:function(){this.inherited(arguments);this.shelter.show();u.getInstance(this.map,this.map.itemInfo).then(h.hitch(this,function(b){this.layerInfosObj=
b;f.setMap(this.map);f.setLayerInfosObj(this.layerInfosObj);f.setAppConfig(this.appConfig);this._upgradeConfig().then(h.hitch(this,function(){n(f.getConfigInfo(this.config.searchOptions)).then(h.hitch(this,function(b){this.domNode&&(this.setConfig(b),this.shelter.hide())}))}))}))},setConfig:function(b){g.forEach(b.sources,h.hitch(this,function(b,a){var c=this.sourceList.addRow({name:b.name||"",type:b.type});c&&c.success?(this._setRelatedConfig(c.tr,b),0===a&&setTimeout(h.hitch(this,function(){this.sourceList.selectRow(c.tr)}),
100)):console.error("add row failed ",c)}))},getConfig:function(b){this._currentSourceSetting&&this._closeSourceSetting(!0===b?!0:!1);var a={},c=this.sourceList.getRows(),f=[];g.forEach(c,h.hitch(this,function(a){var c=this._getRelatedConfig(a);b&&(delete c._definition,this._removeRelatedConfig(a));f.push(c)}));a.sources=f;return a},destroy:function(){f.setMap(null);f.setLayerInfosObj(null);f.setAppConfig(null);this.inherited(arguments)},validate:function(){return!0},_onMenuItemClick:function(b){this._currentSourceSetting&&
!this._currentSourceSetting.isValidConfig()?this._currentSourceSetting.showValidationTip():(b=b&&b.target&&r.getAttr(b.target,"type"),"locator"===b?this._addNewLocator():"query"===b&&this._addNewQuerySource())},_addNewLocator:function(){this._createNewLocatorSourceSettingFromMenuItem({},{})},_addNewQuerySource:function(){this._createNewQuerySourceSettingFromMenuItem({},{})},_setRelatedConfig:function(b,a){t(b).data("config",h.clone(a))},_getRelatedConfig:function(b){return t(b).data("config")[0]},
_removeRelatedConfig:function(b){return t(b).removeData("config")},_createNewLocatorSourceSettingFromMenuItem:function(b,a){var c=new e({nls:this.nls,map:this.map});c.setDefinition(a);b={url:b.url||"",name:b.name||"",singleLineFieldName:b.singleLineFieldName||"",placeholder:b.placeholder||"",countryCode:b.countryCode||"",maxSuggestions:b.maxSuggestions,searchInCurrentMapExtent:!!b.searchInCurrentMapExtent,type:"locator",maxLocations:b.maxLocations,autoComplete:b.autoComplete,searchDelay:b.searchDelay,
minCharacters:b.minCharacters,_isUpgrade:b._isUpgrade};this._upgradeGeocoderConfig(b);c.setConfig(b);c._openLocatorChooser();c.own(k(c,"select-locator-url-ok",h.hitch(this,function(b){(b=this.sourceList.addRow({name:b.name||"New Geocoder",type:"locator"},this.sourceList.getRows().length))&&b.success&&(this._currentSourceSetting&&this._closeSourceSetting(),c.setRelatedTr(b.tr),c.placeAt(this.sourceSettingNode),this.sourceList.selectRow(b.tr),this._currentSourceSetting=c,this._checkConfig())})));c.own(k(c,
"reselect-locator-url-ok",h.hitch(this,function(b){var a=this._currentSourceSetting.getRelatedTr();this.sourceList.editRow(a,{name:b.name,type:"locator"});this._checkConfig()})));c.own(k(c,"select-locator-url-cancel",h.hitch(this,function(){this._currentSourceSetting!==c&&(c.destroy(),c=null)})))},_createNewLocatorSourceSettingFromSourceList:function(b,a,c){this._currentSourceSetting&&this._closeSourceSetting();this._currentSourceSetting=new e({nls:this.nls,map:this.map});this._currentSourceSetting.setDefinition(a);
a={url:b.url||"",name:b.name||"",singleLineFieldName:b.singleLineFieldName||"",placeholder:b.placeholder||"",countryCode:b.countryCode||"",maxSuggestions:b.maxSuggestions,searchInCurrentMapExtent:!!b.searchInCurrentMapExtent,enableLocalSearch:!!b.enableLocalSearch,localSearchMinScale:b.localSearchMinScale,localSearchDistance:b.localSearchDistance,type:"locator",maxLocations:b.maxLocations,autoComplete:b.autoComplete,searchDelay:b.searchDelay,minCharacters:b.minCharacters,_isUpgrade:b._isUpgrade};
this._upgradeGeocoderConfig(a);this._currentSourceSetting.setConfig(a);this._currentSourceSetting.setRelatedTr(c);this._currentSourceSetting.placeAt(this.sourceSettingNode);this._currentSourceSetting._processlocalSearchTable(!!b.enableLocalSearch);this._currentSourceSetting.own(k(this._currentSourceSetting,"reselect-locator-url-ok",h.hitch(this,function(b){var a=this._currentSourceSetting.getRelatedTr();this.sourceList.editRow(a,{name:b.name,type:"locator"});this._checkConfig()})))},_closeSourceSetting:function(b){var a=
this._currentSourceSetting.getRelatedTr(),c=this._currentSourceSetting.getConfig();c._definition=this._currentSourceSetting.getDefinition();this._setRelatedConfig(a,c);this.sourceList.editRow(a,{name:c.name});"undefined"!==typeof b&&!0!==b||this._currentSourceSetting.destroy()},_createNewQuerySourceSettingFromMenuItem:function(b,c){var f=new a({nls:this.nls,map:this.map,appConfig:this.appConfig});f.setDefinition(c);b={url:b.url,name:b.name||"",layerId:b.layerId,placeholder:b.placeholder||"",searchFields:b.searchFields||
[],displayField:b.displayField||c.displayField||"",exactMatch:!!b.exactMatch,maxSuggestions:b.maxSuggestions,searchInCurrentMapExtent:!!b.searchInCurrentMapExtent,type:"query",maxLocations:b.maxLocations,autoComplete:b.autoComplete,searchDelay:b.searchDelay,minCharacters:b.minCharacters,_isUpgrade:b._isUpgrade};this._upgradeGeocoderConfig(b);f.setConfig(b);f._openQuerySourceChooser();f.own(k(f,"select-query-source-ok",h.hitch(this,function(b){(b=this.sourceList.addRow({name:b.name,type:"query"},0))&&
b.success&&(this._currentSourceSetting&&this._closeSourceSetting(),f.setRelatedTr(b.tr),f.placeAt(this.sourceSettingNode),this.sourceList.selectRow(b.tr),this._currentSourceSetting=f)})));f.own(k(f,"reselect-query-source-ok",h.hitch(this,function(b){var a=this._currentSourceSetting.getRelatedTr();this.sourceList.editRow(a,{name:b.name})})));f.own(k(f,"select-query-source-cancel",h.hitch(this,function(){this._currentSourceSetting!==f&&(f.destroy(),f=null)})))},_createNewQuerySourceSettingFromSourceList:function(b,
c,f){this._currentSourceSetting&&this._closeSourceSetting();this._currentSourceSetting=new a({nls:this.nls,map:this.map,appConfig:this.appConfig});this._currentSourceSetting.placeAt(this.sourceSettingNode);this._currentSourceSetting.setDefinition(c);b={url:b.url,name:b.name||"",layerId:b.layerId,placeholder:b.placeholder||"",searchFields:b.searchFields||[],displayField:b.displayField||c.displayField||"",exactMatch:!!b.exactMatch,maxSuggestions:b.maxSuggestions,searchInCurrentMapExtent:!!b.searchInCurrentMapExtent,
type:"query",maxLocations:b.maxLocations,autoComplete:b.autoComplete,searchDelay:b.searchDelay,minCharacters:b.minCharacters,_isUpgrade:b._isUpgrade};this._upgradeGeocoderConfig(b);this._currentSourceSetting.setConfig(b);this._currentSourceSetting.setRelatedTr(f);this._currentSourceSetting.own(k(this._currentSourceSetting,"reselect-query-source",h.hitch(this,function(b){var a=this._currentSourceSetting.getRelatedTr();this.sourceList.editRow(a,{name:b.name})})))},_onSourceItemRemoved:function(b){this._checkConfig();
this._currentSourceSetting&&this._currentSourceSetting.getRelatedTr()===b&&(this._currentSourceSetting.destroy(),this._currentSourceSetting=null)},_onSourceItemChanged:function(){this._checkConfig()},_checkConfig:function(){!1===this._hasGeoLocator()?this.emit("isConfigValid","false"):this.emit("isConfigValid","true")},_hasGeoLocator:function(){var b=!1,a=this.sourceList.getData();g.some(a,h.hitch(this,function(a){if(a&&"locator"===a.type)return b=!0}));return b},_onSourceItemSelected:function(b){var a=
this._getRelatedConfig(b),c=this._currentSourceSetting&&this._currentSourceSetting.tr;a&&b!==c&&(this._currentSourceSetting&&!this._currentSourceSetting.isValidConfig()?(this._currentSourceSetting.showValidationTip(),this.sourceList.selectRow(c)):"query"===a.type?this._createNewQuerySourceSettingFromSourceList(a,a._definition||{},b):"locator"===a.type&&this._createNewLocatorSourceSettingFromSourceList(a,a._definition||{},b))},_upgradeConfig:function(){var b=new l,a=[],c="";if(f.version.isConfigBefore63(this.config)&&
(a=this.config.geocoderOptions&&this.config.geocoderOptions.geocoders)&&0<a.length){var e=a[0];e&&e.url&&(c=e.url)}c?f.getSingleLineAddressName(c).then(h.hitch(this,function(a){if(a){var d=[];d.push({type:"locator",url:c,name:f.getGeocoderName(c),placeholder:e.placeholder||"",singleLineFieldName:a});this.config.searchOptions={};this.config.searchOptions.sources=d;b.resolve()}else null===a&&(b.resolve(null),new A({message:this.nls.locatorWarning}))}),h.hitch(this,function(){b.resolve(null)})):b.resolve(null);
return b},_upgradeGeocoderConfig:function(b){this.config.geocoderOptions&&(b._oldConfig={},this.config.geocoderOptions.geocoders[0]&&(b._oldConfig.placeholder=this.config.geocoderOptions.geocoders[0].placeholder||""),b._oldConfig.autoComplete=this.config.geocoderOptions.autoComplete,b._oldConfig.maxLocations=this.config.geocoderOptions.maxLocations,b._oldConfig.minCharacters=this.config.geocoderOptions.minCharacters,b._oldConfig.searchDelay=this.config.geocoderOptions.searchDelay)}})})},"widgets/Directions/setting/SearchConfig/QuerySourceSetting":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./QuerySourceSetting.html dojo/_base/lang dojo/_base/array dojo/on dojo/query dojo/Deferred dojo/Evented jimu/dijit/_FeaturelayerSourcePopup jimu/portalUrlUtils esri/request esri/lang jimu/utils jimu/dijit/Popup jimu/dijit/CheckBox jimu/dijit/LoadingShelter dijit/form/ValidationTextBox dojo/NodeList-data".split(" "),
function(p,h,k,r,t,g,d,c,q,v,w,a,e,u,y,l,f,n,A){return p([k,r,t,a],{baseClass:"jimu-widget-search-query-source-setting",templateString:g,nls:null,appConfig:null,map:null,tr:null,config:null,fieldsPopup:null,_layerDefinition:null,_fieldsCheckBox:null,_layerId:null,_suggestible:!1,_clickSet:!1,postCreate:function(){this.inherited(arguments);this.exactMatch=new A({checked:!1,label:this.nls.exactMatch},this.exactMatch);this.searchInCurrentMapExtent=new A({checked:!1,label:this.nls.searchInCurrentMapExtent},
this.searchInCurrentMapExtent);this._layerDefinition={};this._fieldsCheckBox=[];this._setMessageNodeContent("");this.autoComplete=new A({checked:!1,label:this.nls.autoComplete},this.autoComplete)},setDefinition:function(a){this._layerDefinition=a||{}},getDefinition:function(){return this._layerDefinition},setRelatedTr:function(a){this.tr=a},getRelatedTr:function(){return this.tr},setConfig:function(a){if("[object Object]"===Object.prototype.toString.call(a)){var b=a.url;b&&(this.config=a,this.shelter.show(),
this._layerDefinition.url!==b?this._getDefinitionFromRemote(b).then(d.hitch(this,function(a){b&&a&&"error"!==a.type?(this._layerDefinition=a,this._layerDefinition.url=b,this._setSourceItems(),this._setMessageNodeContent("")):b&&a&&"error"===a.type&&(this._setSourceItems(),this._disableSourceItems(),this._setMessageNodeContent(l.substitute({URL:a.url},d.clone(this.nls.invalidUrlTip)),!0));this.shelter.hide()})):(this._setMessageNodeContent(""),this._setSourceItems(),this.shelter.hide()))}},isValidConfig:function(){var a=
this.getConfig();return a.url&&a.name&&a.displayField?!0:!1},showValidationTip:function(){this._showValidationErrorTip(this.sourceUrl);this._showValidationErrorTip(this.sourceName)},getConfig:function(){var a={layerId:this._layerId,url:this.sourceUrl.get("value"),name:f.stripHTML(this.sourceName.get("value")),placeholder:f.stripHTML(this.placeholder.get("value")),searchFields:this._getSearchFields(),displayField:this.displayField.get("value"),exactMatch:this.exactMatch.getValue(),searchInCurrentMapExtent:this.searchInCurrentMapExtent.checked,
maxSuggestions:this.maxSuggestions.get("value")||6,type:"query",autoComplete:this.autoComplete?this.autoComplete.getValue():!0,searchDelay:this.searchDelay.get("value")||350,minCharacters:this.minCharacters.get("value")||3};!0===this.config._isUpgrade&&(a._isUpgrade=!0);return a},destroy:function(){this.inherited(arguments);this.fieldsPopup&&(this.fieldsPopup.close(),this.fieldsPopup=null);this.tr=this.nls=this.config=this._layerDefinition=null},_onSourceNameBlur:function(){this.sourceName.set("value",
f.stripHTML(this.sourceName.get("value")))},_onPlaceholderBlur:function(){this.placeholder.set("value",f.stripHTML(this.placeholder.get("value")))},_disableSourceItems:function(){this.sourceName.set("disabled",!0);this.placeholder.set("disabled",!0);this.searchFields.set("disabled",!0);h.setStyle(this.fieldsSelectorNode,"display","none");this.displayField.set("disabled",!0);this.maxSuggestions.set("disabled",!0);this.autoComplete.set("disabled",!0);this.searchDelay.set("disabled",!0);this.minCharacters.set("disabled",
!0)},_enableSourceItems:function(){this.sourceName.set("disabled",!1);this.placeholder.set("disabled",!1);this.searchFields.set("disabled",!1);h.setStyle(this.fieldsSelectorNode,"display","inline-block");this.displayField.set("disabled",!1);this.maxSuggestions.set("disabled",!1);this.autoComplete.set("disabled",!1);this.searchDelay.set("disabled",!1);this.minCharacters.set("disabled",!1)},_setSourceItems:function(){this.sourceUrl.set("value",this.config.url);this.sourceName.set("value",f.stripHTML(this.config.name||
""));this.placeholder.set("value",f.stripHTML(this.config.placeholder||""));this.maxSuggestions.set("value",this.config.maxSuggestions||6);this.autoComplete.setValue("undefined"!==this.config.autoComplete?this.config.autoComplete:!0);this.searchDelay.set("value",this.config.searchDelay||350);this.minCharacters.set("value",this.config.minCharacters||3);this.config._oldConfig&&!this.config._isUpgrade&&(this.config._oldConfig.placeholder&&this.placeholder.set("value",f.stripHTML(this.config._oldConfig.placeholder)),
this.config._oldConfig.maxLocations&&this.maxSuggestions.set("value",this.config._oldConfig.maxLocations),this.config._oldConfig.autoComplete&&this.autoComplete.setValue(this.config._oldConfig.autoComplete),this.config._oldConfig.searchDelay&&this.searchDelay.set("value",this.config._oldConfig.searchDelay),this.config._oldConfig.minCharacters&&this.minCharacters.set("value",this.config._oldConfig.minCharacters),this.config._isUpgrade=!0);this._setSearchFields2Node();this.searchFields.set("value",
this._getSearchFieldsAlias());this._setDisplayFieldOptions();this.displayField.set("value",this.config.displayField||"");this.exactMatch.setValue(!!this.config.exactMatch);this.searchInCurrentMapExtent.setValue(!!this.config.searchInCurrentMapExtent);this._layerId=this.config.layerId;(this._suggestible=this._layerDefinition&&this._layerDefinition.advancedQueryCapabilities&&this._layerDefinition.advancedQueryCapabilities.supportsPagination)?this._hideSuggestibleTips():this._showSuggestibleTips();this._enableSourceItems()},
_getDefinitionFromRemote:function(a){var b=new w,c=y({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});this.own(c);c.then(d.hitch(this,function(a){b.resolve(a)}),d.hitch(this,function(c){console.error(c);b.resolve({type:"error",url:this._getRequestUrl(a)})}));return b.promise},_setMessageNodeContent:function(a,b){h.empty(this.messageNode);a.nodeType||(a=h.toDom(a));h.place(a,this.messageNode);b?h.setStyle(this.messageTr,"display",""):h.setStyle(this.messageTr,"display","none")},
_getRequestUrl:function(a){var b=window.location.protocol;return"http:"===b?u.setHttpProtocol(a):"https:"===b?u.setHttpsProtocol(a):a},_setSearchFields2Node:function(){var a=null,b=this._layerDefinition&&this._layerDefinition.fields&&0<this._layerDefinition.fields.length;this.config&&this.config.searchFields&&0<this.config.searchFields.length||(a=[]);if(b)var f=this._layerDefinition.fields,a=c.filter(this.config.searchFields,function(b){return c.some(f,function(a){return a.name===b})});else a=this.config.searchFields;
this.searchFields.set("_fields",a)},_setDisplayFieldOptions:function(){var a=[];this._layerDefinition&&this._layerDefinition.fields&&0<this._layerDefinition.fields.length?a=c.map(this._layerDefinition.fields,function(b){return{label:b.alias||b.name||"",value:b.name||""}}):this.config&&this.config.displayField&&(a=[{label:this.config.displayField,value:this.config.displayField}]);this.displayField.set("options",a)},_getSearchFieldsAlias:function(){var a=this._getSearchFields();if(!(a&&0<a.length))return"";
if(this._layerDefinition&&this._layerDefinition.fields&&0<this._layerDefinition.fields.length){for(var b=this._layerDefinition.fields,f=c.map(b,function(b){return b&&b.name}),e=[],d=0,n=a.length;d<n;d++){var l=f.indexOf(a[d]);-1<l&&e.push(b[l].alias)}return e.join(",")}return a.join(",")},_getSearchFields:function(){return this.searchFields.get("_fields")},_setSearchFields:function(a){this.searchFields.set("_fields",a)},_onSetSourceClick:function(){this._clickSet=!0;this._openServiceChooser()},_openQuerySourceChooser:function(){this._clickSet=
!1;this._openServiceChooser()},_openServiceChooser:function(){var a=new e({titleLabel:this.nls.setLayerSource,dijitArgs:{multiple:!1,createMapResponse:this.map.webMapResponse,portalUrl:this.appConfig.portalUrl,style:{height:"100%"}}});q.once(a,"ok",d.hitch(this,function(b){a.close();this.setDefinition(b.definition||{});this.setConfig({layerId:b.layerInfo&&b.layerInfo.id||null,url:b.url,name:b.name||"",placeholder:"",searchFields:[],displayField:this._layerDefinition.displayField||"",exactMatch:!1,
maxSuggestions:6,type:"query"});a=null;this._setMessageNodeContent("");this._clickSet?this.emit("reselect-query-source-ok",b):this.emit("select-query-source-ok",b)}));q.once(a,"cancel",d.hitch(this,function(){a.close();a=null;this.emit("select-query-source-cancel")}))},_onFieldsSelectorClick:function(){var a=h.create("div",{style:{maxHeight:"480px"}}),b=this._layerDefinition.fields;this._fieldsCheckBox=[];c.forEach(b,d.hitch(this,function(b,c){var f=new A({checked:this._isSearchable(b),label:b.alias||
b.name});h.addClass(f.domNode,"fields-checkbox");h.addClass(f.labelNode,"jimu-ellipsis");h.setAttr(f.domNode,{title:b.alias||b.name});0===c%3&&(window.isRTL?h.setStyle(f.domNode,"marginRight",0):h.setStyle(f.domNode,"marginLeft",0));f.placeAt(a);v(f.domNode).data("fieldName",b.name);this._fieldsCheckBox.push(f)}));this.fieldsPopup=new n({titleLabel:this.nls.setSearchFields,autoHeight:!0,content:a,container:window.jimuConfig.layoutId,width:640,maxHeight:600,buttons:[{label:this.nls.ok,onClick:d.hitch(this,
"_onSearchFieldsOk")},{label:this.nls.cancel,classNames:["jimu-btn-vacation"]}],onClose:d.hitch(this,function(){this.fieldsPopup=null})});h.addClass(this.fieldsPopup.domNode,"direction-setting jimu-widget-search-query-source-setting-fields")},_onSearchFieldsOk:function(){var a=[];c.forEach(this._fieldsCheckBox,function(b){if(b.getValue()){var c=v(b.domNode).data("fieldName");a.push(c[0]);v(b.domNode).removeData()}});this._setSearchFields(a);this.searchFields.set("value",this._getSearchFieldsAlias());
this.fieldsPopup.close()},_isSearchable:function(a){var b=this._getSearchFields();return c.some(b,d.hitch(this,function(b){return a.name===b}))},_showSuggestibleTips:function(){h.addClass(this.tipsNode,"source-tips-show");h.setStyle(this.maxSuggestions.domNode,"display","none")},_hideSuggestibleTips:function(){h.removeClass(this.tipsNode,"source-tips-show");h.setStyle(this.maxSuggestions.domNode,"display","block")},_showValidationErrorTip:function(a){if(!a.validate()&&a.domNode&&a.focusNode){var b=
a.get("disabled");b&&a.set("disabled",!1);a.focusNode.focus();setTimeout(d.hitch(this,function(){a.focusNode.blur();b&&a.set("disabled",!0);a=null}),100)}}})})},"jimu/dijit/_FeaturelayerSourcePopup":function(){define("dojo/_base/declare dojo/Evented dojo/on dojo/_base/lang dojo/_base/html jimu/dijit/Popup jimu/dijit/FeaturelayerSource jimu/dijit/LoadingIndicator esri/request".split(" "),function(p,h,k,r,t,g,d,c,q){return p([g,h],{width:830,height:560,titleLabel:"",dijitArgs:null,postCreate:function(){this.inherited(arguments);
t.addClass(this.domNode,"jimu-featurelayer-source-popup");this._initFls();this._initLoading()},getSelectedRadioType:function(){return this.fls.getSelectedRadioType()},_initFls:function(){this.fls=new d(this.dijitArgs);this.fls.placeAt(this.contentContainerNode);this.fls.startup();this.own(k(this.fls,"ok",r.hitch(this,function(c){if(0!==c.length){var d=c[0];if(d.definition)try{d.definition.name=d.name,d.definition.url=d.url,this.emit("ok",d)}catch(a){console.error(a)}else this.loading.show(),q({url:d.url,
content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(r.hitch(this,function(a){if(this.domNode){this.loading.hide();d.definition=a;try{d.definition.name=d.name,d.definition.url=d.url,this.emit("ok",d)}catch(e){console.error(e)}}}),r.hitch(this,function(a){console.error(a);this.domNode&&this.loading.hide()}))}})));this.own(k(this.fls,"cancel",r.hitch(this,function(){try{this.emit("cancel")}catch(v){console.error(v)}})))},_initLoading:function(){this.loading=new c({hidden:!0});this.loading.placeAt(this.domNode);
this.loading.startup()}})})},"jimu/dijit/FeaturelayerSource":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/FeaturelayerSource.html dojo/_base/lang dojo/_base/html dojo/on dojo/Evented jimu/dijit/RadioBtn jimu/dijit/_FeaturelayerChooserWithButtons jimu/dijit/FeaturelayerChooserFromPortal jimu/dijit/_FeaturelayerServiceChooserContent jimu/portalUrlUtils".split(" "),function(p,h,k,r,t,g,d,c,q,v,w,a,e,u){return p([h,k,
r,q],{templateString:t,baseClass:"jimu-layer-source jimu-featurelayer-source",declaredClass:"jimu.dijit.FeaturelayerSource",nls:null,multiple:!1,createMapResponse:null,portalUrl:null,layerChooserFromMap:null,postMixInProperties:function(){this.nls=window.jimuNls.featureLayerSource;this.portalUrl=u.getStandardPortalUrl(this.portalUrl)},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedRadioType:function(){if(this.mapRadio.checked)return"map";if(this.portalRadio.checked)return"portal";
if(this.urlRadio.checked)return"url"},getSelectedItems:function(){var a=[];this.mapRadio.checked?a=this.flcMap.getSelectedItems():this.portalRadio.checked?a=this.flcPortal.getSelectedItems():this.urlRadio.checked&&(a=this.flcUrl.getSelectedItems());return a},startup:function(){this.inherited(arguments);this.flcMap.startup();this.flcPortal.startup();this.flcUrl.startup()},_initSelf:function(){this._initRadios();this._createFeaturelayerChooserWithButtons();this._createFeaturelayerChooserFromPortal();
this._createFeaturelayerServiceChooserContent();this._onRadioClicked()},_createFeaturelayerChooserWithButtons:function(){this.flcMap=new w({style:{width:"100%",height:"100%"},multiple:this.multiple,createMapResponse:this.createMapResponse,onlyShowWebMapLayers:!0,layerChooserFromMap:this.layerChooserFromMap});this.flcMap.operationTip=this.nls.selectLayer;this.flcMap.placeAt(this.flcContainer);this.own(c(this.flcMap,"ok",g.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(c(this.flcMap,
"cancel",g.hitch(this,function(){this.emit("cancel")})))},_createFeaturelayerChooserFromPortal:function(){this.flcPortal=new a({multiple:this.multiple,portalUrl:this.portalUrl,style:{width:"100%",height:"100%"}});this.flcPortal.operationTip=this.nls.chooseItem;this.flcPortal.placeAt(this.hflcContainer);this.own(c(this.flcPortal,"next",g.hitch(this,function(){this.flcPortal.operationTip=this.nls.chooseItem+" -\x3e "+this.nls.chooseLayer;this._updateOperationTip()})));this.own(c(this.flcPortal,"back",
g.hitch(this,function(){this.flcPortal.operationTip=this.nls.chooseItem;this._updateOperationTip()})));this.own(c(this.flcPortal,"ok",g.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(c(this.flcPortal,"cancel",g.hitch(this,function(){this.emit("cancel")})));0<=(this.portalUrl||"").toLowerCase().indexOf(".arcgis.com")?this.portalLabel.innerHTML=this.nls.selectFromOnline:this.portalLabel.innerHTML=this.nls.selectFromPortal},_createFeaturelayerServiceChooserContent:function(){this.flcUrl=
new e({multiple:this.multiple,style:{width:"100%",height:"100%"}});this.flcUrl.operationTip=this.nls.setServiceUrl;this.flcUrl.placeAt(this.flscContainer);this.own(c(this.flcUrl,"ok",g.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(c(this.flcUrl,"cancel",g.hitch(this,function(){this.emit("cancel")})))},_initRadios:function(){var a="featureLayerSourceRadios_"+this._getRandomString(),e=g.hitch(this,this._onRadioClicked);this.mapRadio=new v({group:a,onStateChange:e,checked:!0});
this.mapRadio.placeAt(this.mapTd,"first");this.portalRadio=new v({group:a,onStateChange:e,checked:!1});this.portalRadio.placeAt(this.portalTd,"first");this.urlRadio=new v({group:a,onStateChange:e,checked:!1});this.urlRadio.placeAt(this.urlTd,"first");this.own(c(this.mapLabel,"click",g.hitch(this,function(){this.mapRadio.check()})));this.own(c(this.portalLabel,"click",g.hitch(this,function(){this.portalRadio.check()})));this.own(c(this.urlLabel,"click",g.hitch(this,function(){this.urlRadio.check()})))},
_getRandomString:function(){var a=Math.random().toString();return a=a.slice(2,a.length)},_onRadioClicked:function(){d.setStyle(this.flcContainer,"display","none");d.setStyle(this.hflcContainer,"display","none");d.setStyle(this.flscContainer,"display","none");this.mapRadio.checked?(d.setStyle(this.flcContainer,"display","block"),this.operationTip.innerHTML=this.nls.selectLayer):this.portalRadio.checked?(d.setStyle(this.hflcContainer,"display","block"),this.operationTip.innerHTML=this.nls.chooseItem):
this.urlRadio.checked&&(d.setStyle(this.flscContainer,"display","block"),this.operationTip.innerHTML=this.nls.setServiceUrl);this._updateOperationTip()},_updateOperationTip:function(){this.mapRadio.checked?this.operationTip.innerHTML=this.flcMap.operationTip:this.portalRadio.checked?this.operationTip.innerHTML=this.flcPortal.operationTip:this.urlRadio.checked&&(this.operationTip.innerHTML=this.flcUrl.operationTip)}})})},"jimu/dijit/_FeaturelayerChooserWithButtons":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin jimu/dijit/FeaturelayerChooserFromMap".split(" "),
function(p,h,k,r,t,g,d,c,q){return t([g,d,c,h],{baseClass:"jimu-layer-chooser-with-buttons jimu-feature-layer-chooser-with-buttons",declaredClass:"jimu.dijit.FeaturelayerChooserWithButtons",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"chooser-container" data-dojo-attach-point\x3d"chooserContainer"\x3e\x3c/div\x3e\x3cdiv class\x3d"footer"\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.cancel}\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1 jimu-state-disabled" data-dojo-attach-point\x3d"btnOk"\x3e${nls.ok}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
layerChooserFromMap:null,constructor:function(c){this.options=c},postMixInProperties:function(){this.nls=k.clone(window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.layerChooser=this.layerChooserFromMap?this.layerChooserFromMap:new q(this.options);this.layerChooser.placeAt(this.chooserContainer);r.setStyle(this.layerChooser.domNode,{width:"100%",height:"100%"});this.own(p(this.layerChooser,"tree-click",k.hitch(this,function(){0<this.getSelectedItems().length?r.removeClass(this.btnOk,
"jimu-state-disabled"):r.addClass(this.btnOk,"jimu-state-disabled")})));this.own(p(this.btnOk,"click",k.hitch(this,function(){var c=this.getSelectedItems();0<c.length&&this.emit("ok",c)})));this.own(p(this.btnCancel,"click",k.hitch(this,function(){this.emit("cancel")})))},getSelectedItems:function(){return this.layerChooser.getSelectedItems()},startup:function(){this.inherited(arguments);this.layerChooser.startup()}})})},"jimu/dijit/FeaturelayerChooserFromMap":function(){define(["dojo/_base/declare",
"dojo/Deferred","dojo/_base/html","dojo/_base/lang","./LayerChooserFromMap"],function(p,h,k,r,t){return p([t],{baseClass:"jimu-featurelayer-chooser-from-map",declaredClass:"jimu.dijit.FeaturelayerChooserFromMap",types:null,showLayerFromFeatureSet:!1,showTable:!1,onlyShowVisible:!1,ignoredFeaturelayerIds:null,mustSupportStatistics:!1,ignoreVirtualLayer:!1,postMixInProperties:function(){this.inherited(arguments);this.ignoredFeaturelayerIds||(this.ignoredFeaturelayerIds=[]);this.basicFilter=r.hitch(this,
this.basicFilter);this.filter=t.createFeaturelayerFilter(this.types,this.showLayerFromFeatureSet,this.showTable,this.mustSupportStatistics);this.ignoreVirtualLayer&&(this.filter=t.andCombineFilters([this.filter,r.hitch(this,this._ignoreVirtualLayerFilter)]))},postCreate:function(){this.inherited(arguments);k.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},_ignoreVirtualLayerFilter:function(g){return g.getLayerType().then(function(d){return!("ArcGISDynamicMapServiceLayer"===d||"ArcGISTiledMapServiceLayer"===
d||"GroupLayer"===d)})},basicFilter:function(g){var d=new h;0<=this.ignoredFeaturelayerIds.indexOf(g.id)?d.resolve(!1):this.onlyShowVisible&&"Table"!==g.getLayerType()?d.resolve(g.isShowInMap()):d.resolve(!0);return d},getHandledItem:function(g){var d=this.inherited(arguments),c=g&&g.layerInfo,c=c&&c.layerObject;d.url=c&&c.url||"";return d}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(p,h,k,r,t,g,d,c,q,v,w,a,e,u,y,l,f,n){var A=k([r,t,g,h],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,
updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,displayTooltipForTreeNode:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);e.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new n({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=a.hitch(this,this.basicFilter);this.filter=A.andCombineFilters([this.basicFilter,
this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(a){var b=new c;this.onlyShowVisible?b.resolve(a.isShowInMap()):b.resolve(!0);return b},filter:function(a){a=new c;a.resolve(!0);return a},getSelectedItems:function(){var c=this.tree.getSelectedItems();return u.map(c,a.hitch(this,function(b){return this.getHandledItem(b)}))},getAllItems:function(){var c=this.tree.getAllItems(),b=[];u.forEach(c,a.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),
b.push(a))}));return b},getHandledItem:function(a){return{name:a.name,layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(c){this.createMapResponse=c;f.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(a.hitch(this,function(b){this.layerInfosObj=b;this.own(p(this.layerInfosObj,"layerInfosChanged",a.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&this.own(p(this.layerInfosObj,"layerInfosIsShowInMapChanged",
a.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(a,b){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(a){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(c){this._clear();e.setStyle(this.errorTipSection,"display","block");var b=[];this.onlyShowWebMapLayers?(b=c.getLayerInfoArrayOfWebmap(),b=b.concat(c.getTableInfoArrayOfWebmap())):(b=c.getLayerInfoArray(),
b=b.concat(c.getTableInfoArray()));0!==b.length&&(e.setStyle(this.errorTipSection,"display","none"),u.forEach(b,a.hitch(this,function(b){this._addDirectLayerInfo(b)})))},_addDirectLayerInfo:function(c){c&&c.getLayerObject().then(a.hitch(this,function(){this._addItem("root",c)}),a.hitch(this,function(b){console.error(b)}))},_clear:function(){var c=this._store.query({parent:"root"});u.forEach(c,a.hitch(this,function(b){b&&"root"!==b.id&&this._store.remove(b.id)}))},_addItem:function(c,b){var f=null,
e=b.getLayerType(),d=this.filter(b);w({layerType:e,valid:d}).then(a.hitch(this,function(e){if(e.valid){var d=a.hitch(this,function(a,d){this._id++;f={name:b.title||"",parent:c,layerInfo:b,type:e.layerType,layerClass:b.layerObject.declaredClass,id:this._id.toString(),isLeaf:a,hasChildren:d};this._store.add(f)}),n=b.getSubLayers(),l=0===n.length;l?d(l,!1):(n=u.map(n,a.hitch(this,function(b){return this.filter(b)})),w(n).then(a.hitch(this,function(b){(b=u.some(b,function(b){return b}))&&d(l,b)})))}}))},
_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var c=this._getRootItem(),c=new d({data:[c],getChildren:function(b){return this.query({parent:b.id})}});this._store=new q(c);c=new v({store:this._store,query:{id:"root"},mayHaveChildren:a.hitch(this,this._mayHaveChildren)});this.tree=new l({multiple:this.multiple,model:c,showRoot:!1,isLeafItem:a.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:a.hitch(this,function(b,a){"root"!==
b.id&&this._onTreeOpen(b,a)}),onClick:a.hitch(this,function(b,a,c){this._onTreeClick(b,a,c);this.emit("tree-click",b,a,c)}),getIconStyle:a.hitch(this,function(b,a){var c=null;if(!b||"root"===b.id)return null;var f={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},e=window.location.protocol+"//"+window.location.host+require.toUrl("jimu");if(b=this._getIconInfo(b,a).imageName)f.backgroundImage="url("+e+"/css/images/"+b+")",c=f;return c}),
getIconClass:a.hitch(this,function(b,a){return this._getIconInfo(b,a).className}),getTooltip:a.hitch(this,function(b){return this.displayTooltipForTreeNode?b.layerInfo.title:""})});e.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},_getIconInfo:function(a,b){var c="",f="";"ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===a.type?b?(c="mapserver_open.png",f="mapservice-layer-icon open"):
(c="mapserver_close.png",f="mapservice-layer-icon close"):"GroupLayer"===a.type?b?(c="group_layer2.png",f="group-layer-icon open"):(c="group_layer1.png",f="group-layer-icon close"):"FeatureLayer"===a.type?(a=y.getTypeByGeometryType(a.layerInfo.layerObject.geometryType),"point"===a?(c="point_layer1.png",f="point-layer-icon"):"polyline"===a?(c="line_layer1.png",f="line-layer-icon"):"polygon"===a&&(c="polygon_layer1.png",f="polygon-layer-icon")):"Table"===a.type?(c="table.png",f="table-icon"):"ArcGISImageServiceLayer"===
a.type||"ArcGISImageServiceVectorLayer"===a.type?(c="image_layer.png",f="iamge-layer-icon"):b?(c="mapserver_open.png",f="mapservice-layer-icon open"):(c="mapserver_close.png",f="mapservice-layer-icon close");return{imageName:c,className:f}},_onTreeOpen:function(c,b){if("root"!==c.id){var f=[];b=[];f=c.layerInfo.getSubLayers();c.checked||(this.shelter.show(),b=u.map(f,a.hitch(this,function(b){return b.getLayerObject()})),w(b).then(a.hitch(this,function(){this.domNode&&(u.forEach(f,a.hitch(this,function(b){this._addItem(c.id,
b)})),c.checked=!0,this.shelter.hide())}),a.hitch(this,function(b){console.error(b);this.shelter.hide()})))}},_onTreeClick:function(a,b,c){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});A.createFilterByLayerType=function(f){a.isArrayLike(f)||(f=[]);return function(b){var a=new c;if(0===f.length)a.resolve(!0);else{var e=[];b.traversal(function(b){e.push(b.getLayerType())});w(e).then(function(b){for(var c=0;c<
b.length;c++)for(var e=0;e<f.length;e++)if(b[c]===f[e]){a.resolve(!0);return}a.resolve(!1)},function(b){console.error(b);a.reject(b)})}return a}};A.createFeaturelayerFilter=function(a,b,c,f){var e=["point","polyline","polygon"];a&&0<a.length?(a=u.filter(a,function(b){return 0<=e.indexOf(b)}),0===a.length&&(a=e)):a=e;return function(e){var d=e.getLayerType();e=e.getLayerObject();return w({layerType:d,layerObject:e}).then(function(e){var d=e.layerType;e=e.layerObject;if("ArcGISDynamicMapServiceLayer"===
d||"ArcGISTiledMapServiceLayer"===d||"GroupLayer"===d||"FeatureCollection"===d)return!0;if("FeatureLayer"===d){var d=y.getTypeByGeometryType(e.geometryType),d=0<=u.indexOf(a,d),n=A._shouldPassStatisticsCheck(f,e);return e.url?(e=y.isFeaturelayerUrlSupportQuery(e.url,e.capabilities),d&&e&&n):b&&d}return"Table"===d?(d=y.isFeaturelayerUrlSupportQuery(e.url,e.capabilities),e=A._shouldPassStatisticsCheck(f,e),c&&d&&e):!1})}};A.createImageServiceLayerFilter=function(a,b){return function(c){var f=c.getLayerType();
c=c.getLayerObject();return w({layerType:f,layerObject:c}).then(function(c){var f=c.layerType,e=c.layerObject;return"ArcGISImageServiceLayer"===f||"ArcGISImageServiceVectorLayer"===f?a?y.isImageServiceSupportQuery(c.layerObject.capabilities)?b?A._shouldPassStatisticsCheck(b,e):!0:!1:!0:!1})}};A._shouldPassStatisticsCheck=function(a,b){return a?(a=!1,a=b.advancedQueryCapabilities?!!b.advancedQueryCapabilities.supportsStatistics:!!b.supportsStatistics):!0};A.createQueryableLayerFilter=function(a){var b=
A.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,a);a=A.createImageServiceLayerFilter(!0,a);return A.orCombineFilters([b,a])};A.andCombineFilters=function(a){return A._combineFilters(a,!0)};A.orCombineFilters=function(a){return A._combineFilters(a,!1)};A._combineFilters=function(a,b){return function(f){var e=new c,d=u.map(a,function(b){return b(f)});w(d).then(function(a){var c=!1,c=b?u.every(a,function(b){return b}):u.some(a,function(b){return b});e.resolve(c)},function(b){console.error(b);
e.reject(b)});return e}};return A})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(p,h,k,r,t,g,d){return k("dijit.tree.ObjectStoreModel",d,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(c){t.mixin(this,c);this.childrenCache={}},getRoot:function(c,d){if(this.root)c(this.root);else{var q=this.store.query(this.query);q.then&&this.own(q);
g(q,t.hitch(this,function(d){if(1!=d.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+d.length+" items, but must return exactly one");this.root=d[0];c(this.root);q.observe&&q.observe(t.hitch(this,function(a){this.onChange(a)}),!0)}),d)}},mayHaveChildren:function(){return!0},getChildren:function(c,d,v){var q=this.store.getIdentity(c);if(this.childrenCache[q])g(this.childrenCache[q],d,v);else{var a=this.childrenCache[q]=this.store.getChildren(c);a.then&&this.own(a);a.observe&&
this.own(a.observe(t.hitch(this,function(e,d,q){this.onChange(e);d!=q&&g(a,t.hitch(this,"onChildrenChange",c))}),!0));g(a,d,v)}},isItem:function(){return!0},getIdentity:function(c){return this.store.getIdentity(c)},getLabel:function(c){return c[this.labelAttr]},newItem:function(c,d,g,h){return this.store.put(c,{parent:d,before:h})},pasteItem:function(c,d,g,h,a,e){var q=new r;if(d===g&&!h&&!e)return q.resolve(!0),q;d&&!h?this.getChildren(d,t.hitch(this,function(a){a=[].concat(a);var l=p.indexOf(a,
c);a.splice(l,1);this.onChildrenChange(d,a);q.resolve(this.store.put(c,{overwrite:!0,parent:g,oldParent:d,before:e,isCopy:!1}))})):q.resolve(this.store.put(c,{overwrite:!0,parent:g,oldParent:d,before:e,isCopy:!0}));return q},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/keys dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(p,h,k,r,t,g,d,c,q,v,w,a,e,u,y,l){var f=p([y._TreeNode,e],{templateString:r,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);g.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=g.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=g.toDom('\x3cinput type\x3d"checkbox" /\x3e');g.addClass(this.checkNode,"jimu-tree-check-node");g.place(this.checkNode,this.contentNode,
"first");this.own(w(this.checkNode,"click",t.hitch(this,this._onClick)));this.own(w(this.rowNode,"keydown",t.hitch(this,function(c,f){f.target=c;f.keyCode!==a.ENTER&&f.keyCode!==a.SPACE||this._onClick(f)},this.checkNode)));this.isLeaf?this.groupId?g.setStyle(this.checkNode,"display","none"):g.setStyle(this.checkNode,"display","inline"):g.setStyle(this.checkNode,"display","none");this.isLeaf?g.addClass(this.domNode,"jimu-tree-leaf-node"):g.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&
(this.checkNode.checked=!0,g.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,g.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(t.hitch(this,
function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return p([y,e],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+l.getRandomString()},postCreate:function(){this.inherited(arguments);g.addClass(this.domNode,"jimu-tree");this.own(v.before(this,"onClick",t.hitch(this,this._jimuBeforeClick)));
this.rootLoadingIndicator&&g.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0;g.setAttr(this.domNode,"tabindex",0)},removeItem:function(a){this.model.store.remove(a)},getAllItems:function(){var a=this.getAllTreeNodeWidgets();return d.map(a,t.hitch(this,function(a){var c=a.item;c.selected=a.checkNode.checked;return c}))},getSelectedItems:function(){var a=this.getAllTreeNodeWidgets(),a=d.filter(a,t.hitch(this,function(a){return a.checkNode.checked}));return d.map(a,
t.hitch(this,function(a){return a.item}))},getFilteredItems:function(a){var c=this.getAllTreeNodeWidgets(),c=d.map(c,t.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}));return d.filter(c,t.hitch(this,function(c){return a(c)}))},getTreeNodeByItemId:function(a){for(var c=this._getAllTreeNodeDoms(),f=0;f<c.length;f++){var b=u.byNode(c[f]);if(b.item.id.toString()===a.toString())return b}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},
unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var a=this.getAllTreeNodeWidgets();return d.filter(a,t.hitch(this,function(a){return a.isLeaf}))},getAllTreeNodeWidgets:function(){var a=this._getAllTreeNodeDoms();return d.map(a,t.hitch(this,function(a){return u.byNode(a)}))},isLeafItem:function(a){return a&&a.isLeaf},_getAllTreeNodeDoms:function(){return q(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);
this.multiple||(a.groupId=this.uniqueId);return new f(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,c,f){c.isLeaf&&(g.hasClass(f.target||f.srcElement,"jimu-tree-check-node")||(this.multiple?c.toggleSelect():this.selectNodeWidget(c)));return arguments},_onCheckNodeClick:function(a,
f,e){!this.multiple&&f&&this.unselectAllLeafNodeWidgets();c.stop(e);this.focusNode(a);setTimeout(t.hitch(this,function(){f?this.selectNodeWidget(a):a.unselect();this.onClick(a.item,a,e)}),0)},unselectAllLeafNodeWidgets:function(){var a=this.getAllLeafTreeNodeWidgets();d.forEach(a,t.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(p,h,k,r,t,g,d,c,q,v,w,a,e,u,y,l,f,n,A,x,b,z,E,B,F,M,N,I,G,K,Q,R,O,S,T){function D(b){return l.delegate(b.promise||b,{addCallback:function(b){this.then(b)},addErrback:function(b){this.otherwise(b)}})}var J=r("dijit._TreeNode",[F,M,N,I,G],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(b){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=b;this._set("label",b);e("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:Q,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(b){var a=Math.max(b,0)*this.tree._nodePixelIndent+"px";v.set(this.domNode,
"backgroundPosition",a+" 0px");v.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",a);p.forEach(this.getChildren(),function(a){a.set("indent",b+1)});this._set("indent",b)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(b){var a=this.tree,c=a.model;a._v10Compat&&b===c.root&&(b=null);this._applyClassAndStyle(b,"icon","Icon");this._applyClassAndStyle(b,"label","Label");this._applyClassAndStyle(b,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(b,a,f){var e="_"+a+"Class";a+="Node";var d=this[e];this[e]=this.tree["get"+f+"Class"](b,this.isExpanded);c.replace(this[a],this[e]||"",d||"");v.set(this[a],this.tree["get"+f+"Style"](b,this.isExpanded)||{})},_updateLayout:function(){var b=this.getParent(),b=!b||!b.rowNode||"none"==b.rowNode.style.display;c.toggle(this.domNode,"dijitTreeIsRoot",b);c.toggle(this.domNode,"dijitTreeIsLast",!b&&!this.getNextSibling())},_setExpando:function(b){var a=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];b=b?0:this.isExpandable?this.isExpanded?1:2:3;c.replace(this.expandoNode,a[b],a);this.expandoNodeText.innerHTML=["*","-","+","*"][b]},expand:function(){if(this._expandDeferred)return D(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");c.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var b=a.wipeIn({node:this.containerNode,duration:B.defaultDuration}),f=this._expandDeferred=new t(function(){b.stop()});h.after(b,"onEnd",function(){f.resolve(!0)},!0);b.play();return D(f)},collapse:function(){if(this._collapseDeferred)return D(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");c.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var b=a.wipeOut({node:this.containerNode,duration:B.defaultDuration}),f=this._collapseDeferred=new t(function(){b.stop()});h.after(b,"onEnd",
function(){f.resolve(!0)},!0);b.play();return D(f)},indent:0,setChildItems:function(b){var a=this.tree,c=a.model,f=[],e=a.focusedChild,l=this.getChildren();p.forEach(l,function(b){N.prototype.removeChild.call(this,b)},this);this.defer(function(){p.forEach(l,function(b){if(!b._destroyed&&!b.getParent()){var f=function(b){var e=c.getIdentity(b.item),d=a._itemNodesMap[e];1==d.length?delete a._itemNodesMap[e]:(e=p.indexOf(d,b),-1!=e&&d.splice(e,1));p.forEach(b.getChildren(),f)};a.dndController.removeTreeNode(b);
f(b);if(a.persist){var l=p.map(b.getTreePath(),function(b){return a.model.getIdentity(b)}).join("/"),g;for(g in a._openedNodes)g.substr(0,l.length)==l&&delete a._openedNodes[g];a._saveExpandedNodes()}a.lastFocusedChild&&!d.isDescendant(a.lastFocusedChild.domNode,a.domNode)&&delete a.lastFocusedChild;e&&!d.isDescendant(e.domNode,a.domNode)&&a.focus();b.destroyRecursive()}})});this.state="Loaded";b&&0<b.length?(this.isExpandable=!0,p.forEach(b,function(b){var e=c.getIdentity(b),d=a._itemNodesMap[e],
l;if(d)for(var g=0;g<d.length;g++)if(d[g]&&!d[g].getParent()){l=d[g];l.set("indent",this.indent+1);break}l||(l=this.tree._createTreeNode({item:b,tree:a,isExpandable:c.mayHaveChildren(b),label:a.getLabel(b),labelType:a.model&&a.model.labelType||"text",tooltip:a.getTooltip(b),ownerDocument:a.ownerDocument,dir:a.dir,lang:a.lang,textDir:a.textDir,indent:this.indent+1}),d?d.push(l):a._itemNodesMap[e]=[l]);this.addChild(l);(this.tree.autoExpand||this.tree._state(l))&&f.push(a._expandNode(l))},this),p.forEach(this.getChildren(),
function(b){b._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);b=g(f);this.tree._startPaint(b);return D(b)},getTreePath:function(){for(var b=this,a=[];b&&b!==this.tree.rootNode;)a.unshift(b.item),b=b.getParent();a.unshift(this.tree.rootNode.item);return a},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(b){this.inherited(arguments);var a=this.getChildren();0==a.length&&(this.isExpandable=!1,
this.collapse());p.forEach(a,function(b){b._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(b){this.labelNode.setAttribute("aria-selected",b?"true":"false");c.toggle(this.rowNode,"dijitTreeRowSelected",b)},focus:function(){z.focus(this.focusNode)}});e("dojo-bidi")&&J.extend({_setTextDirAttr:function(b){!b||this.textDir==b&&this._created||(this._set("textDir",b),this.applyTextDir(this.labelNode),p.forEach(this.getChildren(),function(a){a.set("textDir",
b)},this))}});var H=r("dijit.Tree",[F,K,M,G],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:R,persist:!1,autoExpand:!1,dndController:T,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(b,a){n.publish(this.id,l.mixin({tree:this,event:b},a||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new t;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(f(this.containerNode,
f.selector(".dijitTreeNode",A.enter),function(b){a._onNodeMouseEnter(E.byNode(this),b)}),f(this.containerNode,f.selector(".dijitTreeNode",A.leave),function(b){a._onNodeMouseLeave(E.byNode(this),b)}),f(this.containerNode,f.selector(".dijitTreeRow",b.press),function(b){a._onNodePress(E.getEnclosingWidget(this),b)}),f(this.containerNode,f.selector(".dijitTreeRow",b),function(b){a._onClick(E.getEnclosingWidget(this),b)}),f(this.containerNode,f.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(E.getEnclosingWidget(this),
b)}));this.model||this._store2model();this.own(h.after(this.model,"onChange",l.hitch(this,"_onItemChange"),!0),h.after(this.model,"onChildrenChange",l.hitch(this,"_onItemChildrenChange"),!0),h.after(this.model,"onDelete",l.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){l.isString(this.dndController)&&(this.dndController=l.getObject(this.dndController));for(var c={},e=0;e<this.dndParams.length;e++)this[this.dndParams[e]]&&(c[this.dndParams[e]]=this[this.dndParams[e]]);
this.dndController=new this.dndController(this,c)}this._load();this.onLoadDeferred=D(this.pendingCommandsPromise);this.onLoadDeferred.then(l.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;u.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var b={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(b.mayHaveChildren=l.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(b.getChildren=l.hitch(this,function(b,a,c){this.getItemChildren(this._v10Compat&&b===this.model.root?null:b,a,c)}));this.model=new S(b);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(l.hitch(this,function(b){var a=this.rootNode=this.tree._createTreeNode({item:b,tree:this,isExpandable:!0,label:this.label||this.getLabel(b),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(a.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(a.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(a.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
a.labelNode.setAttribute("role","presentation"),a.labelNode.removeAttribute("aria-selected"),a.containerNode.setAttribute("role","tree"),a.containerNode.setAttribute("aria-expanded","true"),a.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(a.domNode);b=this.model.getIdentity(b);this._itemNodesMap[b]?this._itemNodesMap[b].push(a):this._itemNodesMap[b]=[a];a._updateLayout();this._expandNode(a).then(l.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),l.hitch(this,function(b){console.error(this,": error loading root: ",b)}))},getNodesByItem:function(b){if(!b)return[];b=l.isString(b)?b:this.model.getIdentity(b);return[].concat(this._itemNodesMap[b])},_setSelectedItemAttr:function(b){this.set("selectedItems",[b])},_setSelectedItemsAttr:function(b){var a=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(l.hitch(this,function(){var c=
p.map(b,function(b){return!b||l.isString(b)?b:a.model.getIdentity(b)}),f=[];p.forEach(c,function(b){f=f.concat(a._itemNodesMap[b]||[])});this.set("selectedNodes",f)}))},_setPathAttr:function(b){return b.length?D(this.set("paths",[b]).then(function(b){return b[0]})):D(this.set("paths",[]).then(function(b){return b[0]}))},_setPathsAttr:function(b){function a(b,f){var e=b.shift(),d=p.filter(f,function(b){return b.getIdentity()==e})[0];if(d)return b.length?c._expandNode(d).then(function(){return a(b,
d.getChildren())}):d;throw new H.PathError("Could not expand path at "+e);}var c=this;return D(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return g(p.map(b,function(b){b=p.map(b,function(b){return b&&l.isObject(b)?c.model.getIdentity(b):b});if(b.length)return a(b,[c.rootNode]);throw new H.PathError("Empty path");}))}).then(function(b){c.set("selectedNodes",b);return c.paths}))},_setSelectedNodeAttr:function(b){this.set("selectedNodes",[b])},_setSelectedNodesAttr:function(b){this.dndController.setSelection(b)},
expandAll:function(){function b(c){return a._expandNode(c).then(function(){var a=p.filter(c.getChildren()||[],function(b){return b.isExpandable});return g(p.map(a,b))})}var a=this;return D(b(this.rootNode))},collapseAll:function(){function b(c){var f=p.filter(c.getChildren()||[],function(b){return b.isExpandable}),f=g(p.map(f,b));return!c.isExpanded||c==a.rootNode&&!a.showRoot?f:f.then(function(){return a._collapseNode(c)})}var a=this;return D(b(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(b){return this.model.getLabel(b)},getIconClass:function(b,a){return!b||this.model.mayHaveChildren(b)?a?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(b,a){(b=this._getNext(a))&&b.isTreeNode&&this.focusNode(b)},_onUpArrow:function(b,a){if(b=a.getPreviousSibling())for(a=b;a.isExpandable&&a.isExpanded&&
a.hasChildren();)a=a.getChildren(),a=a[a.length-1];else if(b=a.getParent(),this.showRoot||b!==this.rootNode)a=b;a&&a.isTreeNode&&this.focusNode(a)},_onRightArrow:function(b,a){a.isExpandable&&!a.isExpanded?this._expandNode(a):a.hasChildren()&&(a=a.getChildren()[0])&&a.isTreeNode&&this.focusNode(a)},_onLeftArrow:function(b,a){a.isExpandable&&a.isExpanded?this._collapseNode(a):(b=a.getParent())&&b.isTreeNode&&(this.showRoot||b!==this.rootNode)&&this.focusNode(b)},focusLastChild:function(){var b=this._getLast();
b&&b.isTreeNode&&this.focusNode(b)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var b=this.rootNode;b.isExpanded;){var a=b.getChildren();if(!a.length)break;b=a[a.length-1]}return b},_getNext:function(b){if(b.isExpandable&&b.isExpanded&&b.hasChildren())return b.getChildren()[0];for(;b&&b.isTreeNode;){var a=b.getNextSibling();if(a)return a;b=b.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(b,a){return d.isDescendant(b,
a.expandoNode)||d.isDescendant(b,a.expandoNodeText)},_onNodePress:function(b,a){this.focusNode(b)},__click:function(b,a,c,f){var e=this.isExpandoNode(a.target,b);b.isExpandable&&(c||e)?this._onExpandoClick({node:b}):(this._publish("execute",{item:b.item,node:b,evt:a}),this[f](b.item,b,a),this.focusNode(b));a.stopPropagation();a.preventDefault()},_onClick:function(b,a){this.__click(b,a,this.openOnClick,"onClick")},_onDblClick:function(b,a){this.__click(b,a,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(b){b=
b.node;this.focusNode(b);b.isExpanded?this._collapseNode(b):this._expandNode(b)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(b){u.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(b)},_getRootOrFirstNode:function(){u.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(b){b._expandNodeDeferred&&
delete b._expandNodeDeferred;if("Loading"!=b.state&&b.isExpanded){var a=b.collapse();this.onClose(b.item,b);this._state(b,!1);this._startPaint(a);return a}},_expandNode:function(b){if(b._expandNodeDeferred)return b._expandNodeDeferred;var a=this.model,c=b.item,f=this;b._loadDeferred||(b.markProcessing(),b._loadDeferred=new t,a.getChildren(c,function(a){b.unmarkProcessing();b.setChildItems(a).then(function(){b._loadDeferred.resolve(a)})},function(a){console.error(f,": error loading "+b.label+" children: ",
a);b._loadDeferred.reject(a)}));a=b._loadDeferred.then(l.hitch(this,function(){var a=b.expand();this.onOpen(b.item,b);this._state(b,!0);return a}));this._startPaint(a);return a},focusNode:function(b){for(var a=[],c=this.domNode;c&&c.tagName&&"IFRAME"!==c.tagName.toUpperCase();c=c.parentNode)a.push({domNode:c.contentWindow||c,scrollLeft:c.scrollLeft||0,scrollTop:c.scrollTop||0});this.focusChild(b);this.defer(function(){for(var b=0,c=a.length;b<c;b++)a[b].domNode.scrollLeft=a[b].scrollLeft,a[b].domNode.scrollTop=
a[b].scrollTop},0)},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(b){var a=this.model.getIdentity(b);if(a=this._itemNodesMap[a]){var c=this.getLabel(b),f=this.getTooltip(b);p.forEach(a,function(a){a.set({item:b,label:c,tooltip:f});a._updateItemClasses(b)})}},_onItemChildrenChange:function(b,a){b=this.model.getIdentity(b);(b=this._itemNodesMap[b])&&p.forEach(b,function(b){b.setChildItems(a)})},_onItemDelete:function(b){b=this.model.getIdentity(b);var a=this._itemNodesMap[b];
a&&(p.forEach(a,function(b){this.dndController.removeTreeNode(b);var a=b.getParent();a&&a.removeChild(b);this.lastFocusedChild&&!d.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!d.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();b.destroyRecursive()},this),delete this._itemNodesMap[b])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var b=k(this.cookieName);b&&p.forEach(b.split(","),function(b){this._openedNodes[b]=
!0},this)}},_state:function(b,a){if(!this.persist)return!1;var c=p.map(b.getTreePath(),function(b){return this.model.getIdentity(b)},this).join("/");if(1===arguments.length)return this._openedNodes[c];a?this._openedNodes[c]=!0:delete this._openedNodes[c];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var b=[],a;for(a in this._openedNodes)b.push(a);k(this.cookieName,b.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),
delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!l.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(b){b&&q.setMarginBox(this.domNode,b);this._nodePixelIndent=q.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(l.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},
_outstandingPaintOperations:0,_startPaint:function(b){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var a=l.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});x(b,a,a)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);
this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(b){return new J(b)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});e("dojo-bidi")&&H.extend({_setTextDirAttr:function(b){b&&this.textDir!=b&&(this._set("textDir",b),this.rootNode.set("textDir",b))}});H.PathError=w("TreePathError");H._TreeNode=J;return H})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array",
"dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(p,h,k,r){return k("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(k){r.mixin(this,k);this.connects=[];k=this.store;if(!k.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");k.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([h.after(k,
"onNew",r.hitch(this,"onNewItem"),!0),h.after(k,"onDelete",r.hitch(this,"onDeleteItem"),!0),h.after(k,"onSet",r.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var h;h=this.connects.pop();)h.remove()},getRoot:function(h,g){this.root?h(this.root):this.store.fetch({query:this.query,onComplete:r.hitch(this,function(d){if(1!=d.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+d.length+" items, but must return exactly one");this.root=d[0];h(this.root)}),onError:g})},mayHaveChildren:function(h){return p.some(this.childrenAttrs,
function(g){return this.store.hasAttribute(h,g)},this)},getChildren:function(h,g,d){var c=this.store;if(c.isItemLoaded(h)){for(var q=[],v=0;v<this.childrenAttrs.length;v++)var k=c.getValues(h,this.childrenAttrs[v]),q=q.concat(k);var a=0;this.deferItemLoadingUntilExpand||p.forEach(q,function(e){c.isItemLoaded(e)||a++});0==a?g(q):p.forEach(q,function(e,h){c.isItemLoaded(e)||c.loadItem({item:e,onItem:function(c){q[h]=c;0==--a&&g(q)},onError:d})})}else{var e=r.hitch(this,arguments.callee);c.loadItem({item:h,
onItem:function(a){e(a,g,d)},onError:d})}},isItem:function(h){return this.store.isItem(h)},fetchItemByIdentity:function(h){this.store.fetchItemByIdentity(h)},getIdentity:function(h){return this.store.getIdentity(h)},getLabel:function(h){return this.labelAttr?this.store.getValue(h,this.labelAttr):this.store.getLabel(h)},newItem:function(h,g,d){var c={parent:g,attribute:this.childrenAttrs[0]},q;this.newItemIdAttr&&h[this.newItemIdAttr]?this.fetchItemByIdentity({identity:h[this.newItemIdAttr],scope:this,
onItem:function(v){v?this.pasteItem(v,null,g,!0,d):(q=this.store.newItem(h,c))&&void 0!=d&&this.pasteItem(q,g,g,!1,d)}}):(q=this.store.newItem(h,c))&&void 0!=d&&this.pasteItem(q,g,g,!1,d)},pasteItem:function(h,g,d,c,q){var v=this.store,k=this.childrenAttrs[0];g&&p.forEach(this.childrenAttrs,function(a){if(v.containsValue(g,a,h)){if(!c){var e=p.filter(v.getValues(g,a),function(a){return a!=h});v.setValues(g,a,e)}k=a}});if(d)if("number"==typeof q){var a=v.getValues(d,k).slice();a.splice(q,0,h);v.setValues(d,
k,a)}else v.setValues(d,k,v.getValues(d,k).concat(h))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(h,g){g&&this.getChildren(g.item,r.hitch(this,function(d){this.onChildrenChange(g.item,d)}))},onDeleteItem:function(h){this.onDelete(h)},onSetItem:function(h,g){if(-1!=p.indexOf(this.childrenAttrs,g))this.getChildren(h,r.hitch(this,function(d){this.onChildrenChange(h,d)}));else this.onChange(h)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(p,h,k,r,t){return h("dijit.tree.ForestStoreModel",t,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(g){this.root={store:this,root:!0,id:g.rootId,label:g.rootLabel,children:g.rootChildren}},mayHaveChildren:function(g){return g===this.root||this.inherited(arguments)},getChildren:function(g,d,c){g===this.root?this.root.children?d(this.root.children):this.store.fetch({query:this.query,onComplete:r.hitch(this,
function(c){this.root.children=c;d(c)}),onError:c}):this.inherited(arguments)},isItem:function(g){return g===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(g){if(g.identity==this.root.id){var d=g.scope||k.global;g.onItem&&g.onItem.call(d,this.root)}else this.inherited(arguments)},getIdentity:function(g){return g===this.root?this.root.id:this.inherited(arguments)},getLabel:function(g){return g===this.root?this.root.label:this.inherited(arguments)},newItem:function(g,d,c){return d===
this.root?(this.onNewRootItem(g),this.store.newItem(g)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(g,d,c,q,h){if(d===this.root&&!q)this.onLeaveRoot(g);this.inherited(arguments,[g,d===this.root?null:d,c===this.root?null:c,q,h]);if(c===this.root)this.onAddToRoot(g)},onAddToRoot:function(g){console.log(this,": item ",g," added to root")},onLeaveRoot:function(g){console.log(this,": item ",g," removed from root")},_requeryTop:function(){var g=this.root.children||[];this.store.fetch({query:this.query,
onComplete:r.hitch(this,function(d){this.root.children=d;if(g.length!=d.length||p.some(g,function(c,g){return d[g]!=c}))this.onChildrenChange(this.root,d)})})},onNewItem:function(g,d){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(g){-1!=p.indexOf(this.root.children,g)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(g,d,c,q){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),
function(p,h,k,r,t,g,d,c,q,v,w){return h("dijit.tree._dndSelector",w,{constructor:function(){this.selection={};this.anchor=null;this.events.push(c(this.tree.domNode,q.press,r.hitch(this,"onMouseDown")),c(this.tree.domNode,q.release,r.hitch(this,"onMouseUp")),c(this.tree.domNode,q.move,r.hitch(this,"onMouseMove")),c(this.tree.domNode,v.press,r.hitch(this,"onClickPress")),c(this.tree.domNode,v.release,r.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],c=this.selection,
d;for(d in c)a.push(c[d]);return a},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,c){this.setSelection(this.getSelectedTreeNodes().concat([a]));c&&(this.anchor=a);return a},removeTreeNode:function(a){var c=p.filter(this.getSelectedTreeNodes(),function(c){return!g.isDescendant(c.domNode,a.domNode)});this.setSelection(c);return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},
setSelection:function(a){var c=this.getSelectedTreeNodes();p.forEach(this._setDifference(c,a),r.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));p.forEach(this._setDifference(a,c),r.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,c){p.forEach(c,function(a){a.__exclude__=!0});a=p.filter(a,function(a){return!a.__exclude__});p.forEach(c,function(a){delete a.__exclude__});
return a},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),c=[],d=[];p.forEach(a,function(a){var e=a.getTreePath();d.push(a);c.push(e)},this);a=p.map(d,function(a){return a.item});this.tree._set("paths",c);this.tree._set("path",c[0]||[]);this.tree._set("selectedNodes",d);this.tree._set("selectedNode",d[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(a){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(a.target,
this.current))){"mousedown"==a.type&&d.isLeft(a)&&a.preventDefault();var c="keydown"==a.type?this.tree.focusedChild:this.current;if(c){var g=t.getCopyKeyState(a),q=c.id;this.singular||a.shiftKey||!this.selection[q]?(this._doDeselect=!1,this.userSelect(c,g,a.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(a){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==a.type?this.tree.focusedChild:this.current,t.getCopyKeyState(a),a.shiftKey))},onMouseMove:function(){this._doDeselect=
!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(a,c){if(a===c)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-c.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(c)&2?1:-1;if(document.createRange){var e=doc.createRange();e.setStartBefore(a);a=doc.createRange();a.setStartBefore(c);return e.compareBoundaryPoints(e.END_TO_END,a)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
},userSelect:function(a,c,d){if(this.singular)this.anchor==a&&c?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(d&&this.anchor){c=this._compareNodes(this.anchor.rowNode,a.rowNode);d=this.anchor;0>c?c=d:(c=a,a=d);for(d=[];c!=a;)d.push(c),c=this.tree._getNext(c);d.push(a);this.setSelection(d)}else this.selection[a.id]&&c?this.removeTreeNode(a):c?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,
c){c=c||k.global;for(var e in this.selection)a.call(c,this.getItem(e),e,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(p,h,k,r,t,g){return h("dijit.tree._dndContainer",null,{constructor:function(d,c){this.tree=d;this.node=d.domNode;r.mixin(this,c);this.containerState="";k.add(this.node,"dojoDndContainer");this.events=[t(this.node,g.enter,r.hitch(this,"onOverEvent")),t(this.node,g.leave,
r.hitch(this,"onOutEvent")),p.after(this.tree,"_onNodeMouseEnter",r.hitch(this,"onMouseOver"),!0),p.after(this.tree,"_onNodeMouseLeave",r.hitch(this,"onMouseOut"),!0),t(this.node,"dragstart, selectstart",function(c){c.preventDefault()})]},destroy:function(){for(var d;d=this.events.pop();)d.remove();this.node=this.parent=null},onMouseOver:function(d){this.current=d},onMouseOut:function(){this.current=null},_changeState:function(d,c){var g="dojoDnd"+d;d=d.toLowerCase()+"State";k.replace(this.node,g+
c,g+this[d]);this[d]=c},_addItemClass:function(d,c){k.add(d,"dojoDndItem"+c)},_removeItemClass:function(d,c){k.remove(d,"dojoDndItem"+c)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/FeaturelayerChooserFromPortal":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/FeaturelayerChooserFromPortal.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/Deferred dojo/Evented dojo/promise/all jimu/dijit/ItemSelector jimu/dijit/FeaturelayerServiceBrowser jimu/portalUrlUtils esri/request".split(" "),
function(p,h,k,r,t,g,d,c,q,v,w,a,e,u,y,l,f){return p([h,k,r,a],{templateString:t,declaredClass:"jimu.dijit.FeaturelayerChooserFromPortal",baseClass:"jimu-service-chooser-from-portal jimu-featurelayer-chooser-from-portal",_serviceBrowserDef:null,portalUrl:null,multiple:!1,postMixInProperties:function(){this.nls=g.mixin({},window.jimuNls.common);this.nls=g.mixin(this.nls,window.jimuNls.featureLayerChooserFromPortal);this.portalUrl=l.getStandardPortalUrl(this.portalUrl);this.multiple=!0===this.multiple?
!0:!1},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},_initSelf:function(){this.selector=new u({portalUrl:this.portalUrl,itemTypes:["Feature Service","Map Service"],onlyShowOnlineFeaturedItems:!1});this.own(q(this.selector,"item-selected",g.hitch(this,this._onItemSelected)));this.own(q(this.selector,"none-item-selected",g.hitch(this,this._onNoneItemSelected)));this.selector.placeAt(this.selectorContainer);
this.selector.startup();this.serviceBrowser=new y({multiple:this.multiple});this.own(q(this.serviceBrowser,"tree-click",g.hitch(this,this._onServiceBrowserClicked)));this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup()},_onItemSelected:function(){d.removeClass(this.btnNext,"jimu-state-disabled")},_onNoneItemSelected:function(){d.addClass(this.btnNext,"jimu-state-disabled")},_onBtnBackClicked:function(){this._serviceBrowserDef&&!this._serviceBrowserDef.isFulfilled()&&
this._serviceBrowserDef.cancel();d.setStyle(this.btnOk,"display","none");d.setStyle(this.btnNext,"display","block");d.setStyle(this.btnBack,"display","none");d.addClass(this.btnOk,"jimu-state-disabled");d.setStyle(this.selectorContainer,"display","block");d.setStyle(this.serviceBrowserContainer,"display","none");this.serviceBrowser.reset();this.emit("back")},_onBtnOkClicked:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnNextClicked:function(){var a=this.selector.getSelectedItem();
a&&(d.setStyle(this.btnNext,"display","none"),d.setStyle(this.btnBack,"display","block"),d.setStyle(this.btnOk,"display","block"),d.addClass(this.btnOk,"jimu-state-disabled"),d.setStyle(this.selectorContainer,"display","none"),d.setStyle(this.serviceBrowserContainer,"display","block"),this.serviceBrowser.reset(),this._serviceBrowserDef=this.serviceBrowser.setUrl(a.url||a.item),this._serviceBrowserDef.then(g.hitch(this,function(){this._serviceBrowserDef=null;this._setOkStateBySelectedItems()}),g.hitch(this,
function(){this._serviceBrowserDef=null})),this.emit("next"))},_setOkStateBySelectedItems:function(){0<this.serviceBrowser.getSelectedItems().length?d.removeClass(this.btnOk,"jimu-state-disabled"):d.addClass(this.btnOk,"jimu-state-disabled")},_onServiceBrowserClicked:function(){this._setOkStateBySelectedItems()},_onBtnCancelClicked:function(){this.emit("cancel")}})})},"jimu/dijit/ItemSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemSelector.html dojo/Evented dojo/_base/lang dojo/_base/config dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/promise/all dojo/query dojo/on dojo/dom-style jimu/utils jimu/portalUtils jimu/tokenUtils jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/Search jimu/dijit/TabContainer3 jimu/dijit/_ItemTable jimu/dijit/BindLabelPropsMixin dijit/form/RadioButton".split(" "),
function(p,h,k,r,t,g,d,c,q,v,w,a,e,u,y,l,f,n,A,x,b,z,E,B,F){return p([k,r,t,F,d],{templateString:g,declaredClass:"jimu.dijit.ItemSelector",baseClass:"jimu-item-selector",tab:null,_user:null,_group:null,_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_isPublicTabShow:!1,_signIn:!1,_itemTypeQueryString:"",
_typeKeywordQueryString:"",portalUrl:null,itemTypes:"",typeKeywords:"",showOnlineItems:!0,onlyShowOnlineFeaturedItems:!1,showMyContent:!0,showMyOrganization:!0,showMyGroups:!0,showPublic:!0,showOnlyEditableGroups:!1,postMixInProperties:function(){this.portalUrl=x.getStandardPortalUrl(this.portalUrl);this.showOnlineItems=!1===this.showOnlineItems?!1:!0;this.itemTypes&&0<this.itemTypes.length||(this.itemTypes=[]);this._itemTypes="";v.forEach(this.itemTypes,c.hitch(this,function(b,a){this._itemTypes+=
'"'+b+'"';a!==this.itemTypes.length-1&&(this._itemTypes+=",")}));this._itemTypes="["+this._itemTypes+"]";this.typeKeywords&&0<this.typeKeywords.length||(this.typeKeywords=[]);this._typeKeywords="";v.forEach(this.typeKeywords,c.hitch(this,function(b,a){this._typeKeywords+='"'+b+'"';a!==this.typeKeywords.length-1&&(this._typeKeywords+=",")}));this._typeKeywords="["+this._typeKeywords+"]";this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);var b=this._getPortalUrl();
this.portal=n.getPortal(b);this._initOptions();this._initSearchQuery();this._initTabs();this._initPortalRadio();this._initItemTables();this._initPublic();this._initPrivate();this._updateUIbySignIn()},_initOptions:function(){this._itemTypeQueryString=f.getItemQueryStringByTypes(this.itemTypes);this._typeKeywordQueryString=f.getItemQueryStringByTypeKeywords(this.typeKeywords)},_initTabs:function(){var b={title:this.nls.myContent,content:this.mycontentTabNode},a={title:this.nls.myOrganization,content:this.organizationTabNode},
f={title:this.nls.myGroup,content:this.groupTabNode},e={title:this.nls.publicMap,content:this.publicTabNode};l.set(this.mycontentTabNode,"display","none");l.set(this.organizationTabNode,"display","none");l.set(this.groupTabNode,"display","none");l.set(this.publicTabNode,"display","none");var d=[];this.showMyContent&&(d.push(b),l.set(this.mycontentTabNode,"display","block"));this.showMyOrganization&&(d.push(a),l.set(this.organizationTabNode,"display","block"));this.showMyGroups&&(d.push(f),l.set(this.groupTabNode,
"display","block"));this.showPublic&&(d.push(e),l.set(this.publicTabNode,"display","block"));this.tab=new E({tabs:d},this.tabNode);this.own(y(this.tab,"tabChanged",c.hitch(this,function(b){w.setStyle(this.signinSection,"display","none");b!==this.nls.publicMap?(this._isPublicTabShow=!1,this._updateUIbySignIn()):this._isPublicTabShow=!0})))},_updateUIbySignIn:function(){w.setStyle(this.signinSection,"display","none");var b=u(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",
this.domNode);A.userHaveSignInPortal(this._getPortalUrl())?b.style("display","block"):(b.style("display","none"),this._isPublicTabShow||w.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){var b=this._getPortalUrl(),b=x.getServerByUrl(b);this.portalPublicRaido.set("disabled",!1);this.onlinePublicRaido.set("disabled",!1);this.portalPublicRaido.set("checked",!0);var a=!1;x.isArcGIScom(b)?(a=!0,this.portalPublicLabel.innerHTML="ArcGIS.com"):(this.portalPublicLabel.innerHTML=
b,a=this.showOnlineItems?!1:!0);a&&(this.onlinePublicRaido.set("disabled",!0),w.setStyle(this.onlinePublicRaido,"display","none"),w.setStyle(this.onlinePublicLabel,"display","none"))},_initSearchQuery:function(){var b="esri_"+(q.locale&&q.locale.slice(0,2)||"en").toLowerCase(),a=v.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
c.hitch(this,function(a){return a!==b})),f="";v.forEach(a,c.hitch(this,function(b){f+=" -owner:"+b+" "}));a=" ";this.portal&&this.portal.user&&this.portal.user.orgId&&(a=" orgid:"+this.portal.user.orgId+" ");a=a+this._itemTypeQueryString+" AND access:public "+f+" "+this._typeKeywordQueryString;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:a});this._filterPublicPortalQuery=this._getQuery({q:a,basicQ:a});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",
sortOrder:"desc",q:(this.onlyShowOnlineFeaturedItems?' (group:"c755678be14e4a0984af36a15f5b643e"  OR group:"b8787a74b4d74f7fb9b8fac918735153") ':" ")+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._filterPublicOnlineQuery=this._getQuery({q:this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=
this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(b){return c.mixin({start:1,num:16,f:"json"},b||{})},_getPortalUrl:function(){return x.getStandardPortalUrl(this.portalUrl)},_initItemTables:function(){"function"===typeof this.onCreateItemContent&&(this.mycontentItemTable.onCreateItemContent=this.onCreateItemContent,this.organizationItemTable.onCreateItemContent=this.onCreateItemContent,this.groupItemTable.onCreateItemContent=this.onCreateItemContent,
this.publicPortalItemTable.onCreateItemContent=this.onCreateItemContent,this.publicOnlineItemTable.onCreateItemContent=this.onCreateItemContent);this.own(y(this.publicPortalItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));this.own(y(this.publicOnlineItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));this.own(y(this.organizationItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));this.own(y(this.groupItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));
this.own(y(this.mycontentItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));this.own(y(this.publicPortalItemTable,"update",c.hitch(this,this._onItemTableUpdate)));this.own(y(this.publicOnlineItemTable,"update",c.hitch(this,this._onItemTableUpdate)));this.own(y(this.organizationItemTable,"update",c.hitch(this,this._onItemTableUpdate)));this.own(y(this.groupItemTable,"update",c.hitch(this,this._onItemTableUpdate)));this.own(y(this.mycontentItemTable,"update",c.hitch(this,this._onItemTableUpdate)));
var b=this._getPortalUrl();this.portalPublicRaido.get("disabled")||(this.publicPortalItemTable.set("portalUrl",b),this.publicPortalItemTable.searchAllItems(this._allPublicPortalQuery),this.publicPortalItemTable.set("filteredQuery",this._filterPublicPortalQuery));this.onlinePublicRaido.get("disabled")||(this.publicOnlineItemTable.set("portalUrl",window.location.protocol+"//www.arcgis.com"),this.publicOnlineItemTable.searchAllItems(this._allPublicOnlineQuery),this.publicOnlineItemTable.set("filteredQuery",
this._filterPublicOnlineQuery))},_initPublic:function(){this.own(y(this.portalPublicRaido,"click",c.hitch(this,this._onPublicRaidoClicked)));this.own(y(this.onlinePublicRaido,"click",c.hitch(this,this._onPublicRaidoClicked)));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.get("checked")?(this.publicPortalItemTable.show(),this.publicOnlineItemTable.hide()):this.onlinePublicRaido.get("checked")&&(this.publicPortalItemTable.hide(),this.publicOnlineItemTable.show())},
_onPublicSearch:function(b){(b=b&&c.trim(b))?(this.publicPortalItemTable.showFilterItemsSection(),this.publicOnlineItemTable.showFilterItemsSection(),this.portalPublicRaido.get("checked")?(this._filterPublicPortalQuery.q=b+" "+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalItemTable.searchFilteredItems(this._filterPublicPortalQuery)):this.onlinePublicRaido.get("checked")&&(this._filterPublicOnlineQuery.q=b+" "+this._itemTypeQueryString+" AND access:public "+
this._typeKeywordQueryString,this._filterPublicOnlineQuery.start=1,this.publicOnlineItemTable.searchFilteredItems(this._filterPublicOnlineQuery))):(this.publicPortalItemTable.showAllItemsSection(),this.publicOnlineItemTable.showAllItemsSection())},_initPrivate:function(){this._resetPortalMaps();this.own(y(this.groupsSelect,"change",c.hitch(this,this._onGroupsSelectChange)));var b=x.getServerByUrl(this._getPortalUrl());x.isArcGIScom(b)&&(b="ArcGIS.com");A.userHaveSignInPortal(this._getPortalUrl())&&
this._onSignIn()},_onOrganizationSearch:function(b){if(b=b&&c.trim(b)){if(this._allOrganizationQuery){var a=this._allOrganizationQuery.q;a&&(this._filterOrganizationQuery.q=b+" "+a,this._filterOrganizationQuery.start=1,this.organizationItemTable.searchFilteredItems(this._filterOrganizationQuery))}}else this.organizationItemTable.showAllItemsSection()},_onMyContentSearch:function(b){if(b=b&&c.trim(b)){if(this._allMyContentQuery){var a=this._allMyContentQuery.q;a&&(this._filterMyContentQuery.q=b+" "+
a,this._filterMyContentQuery.start=1,this.mycontentItemTable.searchFilteredItems(this._filterMyContentQuery))}}else this.mycontentItemTable.showAllItemsSection()},_onGroupSearch:function(b){if(b=b&&c.trim(b)){if(this._allGroupQuery){var a=this._allGroupQuery.q;a&&(this._filterGroupQuery.q=b+" "+a,this._filterGroupQuery.start=1,this.groupItemTable.searchFilteredItems(this._filterGroupQuery))}}else this.groupItemTable.showAllItemsSection()},_onSignIn:function(){this._updateUIbySignIn();if(!this._signIn){this._signIn=
!0;var b=this._getPortalUrl();n.getPortal(b).getUser().then(c.hitch(this,function(b){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(b),this._searchMyContent(b),this._searchGroups(b))}))}},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationItemTable.clear();this.mycontentItemTable.clear();this._resetGroupsSection()},_searchOrganization:function(b){this.organizationItemTable.clear();b=" orgid:"+b.orgId+
" AND "+this._itemTypeQueryString+" AND (access:org OR access:public) "+this._typeKeywordQueryString;var a=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:b});this._filterOrganizationQuery=this._getQuery({q:b});this.organizationItemTable.set("portalUrl",a);this.organizationItemTable.searchAllItems(this._allOrganizationQuery)},_searchMyContent:function(b){this.mycontentItemTable.clear();var a=this._getPortalUrl();b="owner:"+b.username+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;
this._allMyContentQuery=this._getQuery({q:b});this._filterMyContentQuery=this._getQuery({q:b});this.mycontentItemTable.set("portalUrl",a);this.mycontentItemTable.searchAllItems(this._allMyContentQuery)},_searchGroups:function(b){this._resetGroupsSection();w.setStyle(this.groupsSection,"display","flex");b=b.getGroups();if(0<b.length){w.setStyle(this.groupSearch.domNode,"display","block");this.groupItemTable.show();w.empty(this.groupsSelect);for(var a=0;a<b.length;a++){var c=b[a];w.create("option",
{value:c.id,innerHTML:c.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(b.length)},_resetGroupsSection:function(){w.setStyle(this.groupsSection,"display","none");w.empty(this.groupsSelect);w.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupItemTable.clear();w.setStyle(this.groupSearch.domNode,"display","none");this.groupItemTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(b){0===b?w.setStyle(this.groupsSection,
"top","15px"):w.setStyle(this.groupsSection,"top","50px")},_onGroupsSelectChange:function(){var b=this.groupsSelect.value;this.groupItemTable.clear();if("nodata"===b)w.setStyle(this.groupSearch,"display","none"),this.groupItemTable.hide();else{w.setStyle(this.groupSearch,"display","block");this.groupItemTable.show();var a=this._getPortalUrl(),b="group:"+b+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allGroupQuery=this._getQuery({q:b});this._filterGroupQuery=this._getQuery({q:b});
this.groupItemTable.set("portalUrl",a);this.groupItemTable.searchAllItems(this._allGroupQuery)}},_onItemTableUpdate:function(){this.emit("update")},_onItemDomClicked:function(b){var a=w.hasClass(b,"jimu-state-active");u(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active");a&&w.addClass(b,"jimu-state-active");(b=this.getSelectedItem())?this.emit("item-selected",b):this.emit("none-item-selected")},getSelectedItem:function(){var b=null,a=u(".item.jimu-state-active",this.domNode);
0<a.length&&(b=c.mixin({},a[0].item));return b}})})},"jimu/dijit/_ItemTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),function(p,h,k,r,t,g,d,c,q,v,w,a,e,u,y,l){return p([h,k,r,g],{templateString:t,declaredClass:"jimu.dijit.ItemTable",
baseClass:"jimu-item-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"desktopapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&0<this.types.length||(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=y.getStandardPortalUrl(this.portalUrl));
this.showAllItemsSection();this.searchAllItems()},show:function(){q.setStyle(this.domNode,"display","block")},hide:function(){q.setStyle(this.domNode,"display","none")},searchAllItems:function(a){this.showAllItemsSection();a&&(this.query=d.mixin({},a),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),u.getPortal(this.portalUrl).queryItems(this.query).then(d.hitch(this,function(a){this.domNode&&(this.allItemsShelter.hide(),
this.query.start=a.nextStart,this._createItems(a,this.allItemTbody))}),d.hitch(this,function(a){console.error(a);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(a){this.showFilterItemsSection();a&&(this.filteredQuery=d.clone(a),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredItemShelter.show(),u.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(d.hitch(this,function(c){this.domNode&&
(this.showFilterItemsSection(),a&&this.clearFilteredItemsSection(),this.filteredQuery.start=c.nextStart,this._createItems(c,this.filteredItemsTbody),this._filterItemCallback())}),d.hitch(this,function(a){console.error(a);this.domNode&&this._filterItemCallback()})))},_filterItemCallback:function(){this.filteredItemShelter.hide();0<this._getItemCount(this.filteredItemsTbody)?(q.setStyle(this.filteredItemsTableDiv,"display","block"),q.setStyle(this.searchNoneTipSection,"display","none")):(q.setStyle(this.filteredItemsTableDiv,
"display","none"),q.setStyle(this.searchNoneTipSection,"display","block"))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){q.empty(this.allItemTbody)},clearFilteredItemsSection:function(){q.empty(this.filteredItemsTbody)},showAllItemsSection:function(){q.setStyle(this.allItemsSection,"display","block");q.setStyle(this.filteredItemsSection,"display","none")},showFilterItemsSection:function(){q.setStyle(this.allItemsSection,"display","none");
q.setStyle(this.filteredItemsSection,"display","block");q.setStyle(this.filteredItemsTableDiv,"display","block");q.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&this.searchFilteredItems()},_isScrollToBottom:function(a){return e.isScrollToBottom(a)},_createItems:function(a,e){a=a.results;var f=
c.map(this.types,d.hitch(this,function(b){return b.toLowerCase()}));a=c.filter(a,d.hitch(this,function(b){b=b.type&&b.type.toLowerCase()||"";return 0<=c.indexOf(f,b)}));if(0!==a.length){var l,b=w("td.empty",e),g;if(0<b.length){var n=Math.min(a.length,b.length),h=a.splice(0,n);for(g=0;g<n;g++){var k=b[g];l=this._createItem(h[g]);q.place(l,k);q.removeClass(k,"empty")}}if(0!==a.length){b=Math.ceil(a.length/2);for(g=0;g<b;g++)for(l=q.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),
q.place(l,e),n=w("td",l),h=0;h<n.length;h++)k=n[h],(l=a[2*g+h])?(l=this._createItem(l),q.place(l,k)):q.addClass(k,"empty");this.emit("update")}}},_getItemCount:function(a){return w(".item",a).length},_createItem:function(a){var c=q.toDom('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
c.item=a;var f=w(".item-thumbnail",c)[0],e=w(".item-name",c)[0],b=w(".item-type-owner",c)[0],d=w(".item-date",c)[0],l=w(".item-details",c)[0],g=w(".none-thumbnail-tip",c)[0];if(!a.thumbnailUrl){var h=this._defaultThumbnail[a.type];h&&(a.thumbnailUrl=require.toUrl("jimu")+"/images/"+h)}a.thumbnailUrl?q.setStyle(f,"backgroundImage","url("+a.thumbnailUrl+")"):g.innerHTML=this.nls.noneThumbnail;"function"===typeof this.onCreateItemContent?(d=w(".item-info",c)[0],this.onCreateItemContent(a,d)):(e.innerHTML=
a.title,e.title=e.innerHTML,b.innerHTML=a.type+" by "+a.owner,b.title=b.innerHTML,f=new Date,f.setTime(a.modified),d.innerHTML=f.toLocaleString(),d.title=d.innerHTML,l.innerHTML=this.nls.moreDetails,l.href=a.detailsPageUrl||"#");return c},_onItemsTableClicked:function(a){var c=a.target||a.srcElement;a=null;q.hasClass(c,"item-thumbnail")?a=c.parentNode:q.hasClass(c,"none-thumbnail-tip")&&(a=c.parentNode.parentNode);a&&(c=q.hasClass(a,"jimu-state-active"),w(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active"),
c?q.removeClass(a,"jimu-state-active"):q.addClass(a,"jimu-state-active"),this.emit("item-dom-clicked",a))},getSelectedItem:function(){var a=null,c=w(".item.jimu-state-active",this.domNode);0<c.length&&(a=d.mixin({},c[0].item));return a}})})},"jimu/dijit/FeaturelayerServiceBrowser":function(){define(["dojo/_base/declare","./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array","jimu/serviceBrowserRuleUtils"],function(p,h,k,r,t){return p([h],{baseClass:"jimu-featurelayer-service-browser",declaredClass:"jimu.dijit.FeaturelayerServiceBrowser",
url:"",multiple:!1,types:null,isSupportQuery:!0,postMixInProperties:function(){this.inherited(arguments);this.rule=t.getFeaturelayerServiceBrowserRule(this.types,this.isSupportQuery)},getSelectedItems:function(){var g=this.inherited(arguments);return g=r.map(g,k.hitch(this,function(d){return{name:d.name,url:d.url,definition:d.definition}}))}})})},"jimu/dijit/_BasicServiceBrowser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/store/Memory dojo/store/Observable dijit/tree/ObjectStoreModel jimu/utils jimu/dijit/_Tree jimu/dijit/LoadingIndicator".split(" "),
function(p,h,k,r,t,g,d,c,q,v,w,a,e,u,y){return p([h,k,r,t],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"shelter"  data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_currentUrl:"",_treeClass:"service-browser-tree",_def:null,url:"",multiple:!1,rule:null,postMixInProperties:function(){this.nls=window.jimuNls.basicServiceBrowser},postCreate:function(){this.inherited(arguments);d.addClass(this.domNode,
"jimu-basic-service-browser");this.multiple=!!this.multiple;this._createTree();this.url&&"string"===typeof this.url&&this.setUrl(this.url)},reset:function(){this.url="";this._clear()},getSelectedItems:function(){return this.tree.getSelectedItems()},setUrl:function(a){this._def&&(this._def.isFulfilled()||this._def.cancel(),this._def=null);this._def=new q;a&&"string"===typeof a&&a.replace(/\/*$/g,"")||this._def.reject();a=a.replace(/\/*$/g,"");a=g.trim(a);var c=a.match(/^http(s?):\/\//gi);c&&0<c.length||
(a="http://"+a);if(!(0>=a.search(/\/rest\/services/i))&&(this._clear(),this._currentUrl=a))return a=this._getRootItem(),a=u.isStringEndWith(this._currentUrl,"rest/services")?this._searchBaseServiceUrl(this._currentUrl,a):this._isUrlContainsServiceType(this._currentUrl)?this._searchServiceUrl(this._currentUrl,a):this._searchFolderServiceUrl(this._currentUrl,a),this.shelter.show(),a.then(g.hitch(this,function(a){this.domNode&&this.shelter.hide();var c=this.tree.getAllLeafTreeNodeWidgets();1===c.length&&
c[0].select();this._def.resolve(a)}),g.hitch(this,function(a){this.domNode&&this.shelter.hide();this._showRequestError();this._def.reject(a)})),this._def;this._def.reject()},_getItem:function(a){return this.rule.getItem(a)},_getSubItemUrls:function(a){return this.rule.getSubItemUrls(a)},_getSubItems:function(a){var f=new q;this._getSubItemUrls(a).then(g.hitch(this,function(a){a=c.map(a,g.hitch(this,function(a){return this._getItem(a)}));v(a).then(g.hitch(this,function(a){a=c.filter(a,g.hitch(this,
function(a){return a&&"object"===typeof a}));f.resolve(a)}),g.hitch(this,function(a){f.reject(a)}))}),g.hitch(this,function(a){f.reject(a)}));return f},_selectFirstLeafTreeNodeWidget:function(){var a=this.tree.getAllLeafTreeNodeWidgets();1===a.length&&a[0].select()},isLeafItem:function(a){return 0<=this.rule.leafTypes.indexOf(a.type)},isServiceTypeSupported:function(a){return this.rule.isServiceTypeSupported(a)},_getStringEndWith:function(a,c){var f="",e=a.indexOf(c);0<=e&&(f=a.slice(0,e+c.length));
return f},_isUrlContainsServiceType:function(a){return this.rule.isUrlContainsServiceType(a)},_getBaseServiceUrl:function(){return this._getStringEndWith(this._currentUrl,"rest/services")},_getServiceName:function(a){var c="";a=a.split("/");return c=a[a.length-1]},_searchBaseServiceUrl:function(a,f){var e=new q;this._getRestInfo(a).then(g.hitch(this,function(d){if(this.domNode){var l=[];c.map(d.folders,g.hitch(this,function(b){var e={name:b,type:"folder",url:a+"/"+b,parent:f.id};this._addItem(e);
var d=new q;this._doSearchFolderServiceUrl(e.url,e.id).then(g.hitch(this,function(b){0<b.length?c.forEach(b,g.hitch(this,function(b){b.parent=e.id;this._addItem(b)})):this._removeItem(e.id);d.resolve()}),g.hitch(this,function(b){d.reject(b)}));l.push(d);return d}));c.forEach(d.services,g.hitch(this,function(b){if(this.isServiceTypeSupported(b.type)){b=a+"/"+b.name+"/"+b.type;var c=new q;this.rule.getItem(b).then(g.hitch(this,function(b){b&&(b.parent=f.id,this._addItem(b));c.resolve()}),g.hitch(this,
function(b){console.error(b);c.reject(b)}));l.push(c)}}));v(l).then(g.hitch(this,function(){this.domNode&&e.resolve()}),g.hitch(this,function(b){console.error(b);this.domNode&&e.reject(b)}))}}),g.hitch(this,function(a){console.error(a);this.domNode&&e.reject({errorCode:"NETWORK_ERROR",error:a})}));return e},_searchFolderServiceUrl:function(a,f){var e=new q;this._doSearchFolderServiceUrl(a,f).then(g.hitch(this,function(a){this.domNode&&(c.forEach(a,g.hitch(this,function(a){a.parent=f.id;this._addItem(a)})),
e.resolve())}),g.hitch(this,function(a){console.error(a);this.domNode&&e.reject({errorCode:"NETWORK_ERROR",error:a})}));return e},_doSearchFolderServiceUrl:function(a){var f=new q,e=this._getBaseServiceUrl();this._getRestInfo(a).then(g.hitch(this,function(a){a=a.services;var d=[];a&&0<a.length&&c.forEach(a,g.hitch(this,function(b){this.isServiceTypeSupported(b.type)&&(b=this.rule.getItem(e+"/"+b.name+"/"+b.type),d.push(b))}));v(d).then(g.hitch(this,function(b){b=c.filter(b,g.hitch(this,function(b){return b}));
f.resolve(b)}),g.hitch(this,function(b){console.error(b);f.reject(b)}))}),g.hitch(this,function(a){console.error(a);f.reject(a)}));return f},_searchServiceUrl:function(a,f){var e=new q;this._getSubItems(a).then(g.hitch(this,function(d){d&&0<d.length?(c.forEach(d,g.hitch(this,function(a){a.parent=f.id;this._addItem(a)})),e.resolve()):this._getItem(a).then(g.hitch(this,function(a){a&&(a.parent=f.id,this._addItem(a));e.resolve()}),g.hitch(this,function(a){e.reject(a)}))}),g.hitch(this,function(a){e.reject(a)}));
return e},_getRestInfo:function(a){var c=new q;this.rule.getRestInfo(a).then(g.hitch(this,function(a){this.domNode&&c.resolve(a)}),g.hitch(this,function(a){this.domNode&&c.reject(a)}));return c},_clear:function(){var a=this._store.query({parent:"root"});c.forEach(a,g.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_showRequestError:function(){this.emit("error",this.nls.invalidUrlTip)},_addItem:function(a){this._id++;a.id=this._id.toString();this._store.add(a);return a},_removeItem:function(a){this._store.remove(a)},
_getRootItem:function(){return{id:"root",name:"Services Root",type:"root"}},_createTree:function(){var c=this._getRootItem(),c=new w({data:[c],getChildren:function(a){return this.query({parent:a.id})}});this._store=new a(c);c=new e({store:this._store,query:{id:"root"},mayHaveChildren:g.hitch(this,this._mayHaveChildren)});this.tree=new y({multiple:this.multiple,model:c,showRoot:!1,style:{width:"100%"},isLeafItem:g.hitch(this,this.isLeafItem),onOpen:g.hitch(this,function(a,c){this._onTreeOpen(a,c);
this.emit("tree-open",a,c)}),onClick:g.hitch(this,function(a,c,e){this._onTreeClick(a,c,e);this.emit("tree-click",a,c,e)}),getIconStyle:g.hitch(this,function(a,c){var f=null;if(!a)return null;var e={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},b=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),d=this._getIconImageName(a,c);d||("folder"===a.type?d=c?"folder_open_default.png":"folder_close_default.png":this.isServiceTypeSupported(a.type)&&
(d=c?"folder_open_default.png":"folder_close_default.png"));d&&(e.backgroundImage="url("+b+"/css/images/"+d+")",f=e);return f})});d.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.domNode)},_getIconImageName:function(a,c){var f="";"function"===typeof this.rule.getIconImageName&&(f=this.rule.getIconImageName(a,c));return f},_mayHaveChildren:function(a){return"root"===a.type?!0:!this.isLeafItem(a)},_onTreeOpen:function(a,f){"root"===a.id||0<this._store.query({parent:a.id}).length||
a.checking||a.checked||(a.checking=!0,this._getSubItems(a.url).then(g.hitch(this,function(f){c.forEach(f,g.hitch(this,function(c){c.parent=a.id;this._addItem(c)}));a.checking=!1;a.checked=!0}),g.hitch(this,function(c){console.error(c);a.checking=!1;a.checked=!0})))},_onTreeClick:function(a,c,e){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)}})})},"jimu/serviceBrowserRuleUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/Deferred",
"jimu/utils","jimu/ServiceBrowserRule"],function(p,h,k,r,t){var g={combineRules:function(d){var c=new t;h.forEach(d,function(d){h.forEach(d.leafTypes,function(d){0>c.leafTypes.indexOf(d)&&c.leafTypes.push(d)});h.forEach(d.serviceTypes,function(d){0>c.serviceTypes.indexOf(d)&&c.serviceTypes.push(d)})});c.getMatchedRule=function(c){var g=null;h.some(d,function(d){return d.isUrlContainsServiceType(c)?(g=d,!0):!1});return g};c.getItem=function(d){var g=null;return g=(g=c.getMatchedRule(d))?g.getItem(d):
c.defaultGetItem(d)};c.getSubItemUrls=function(d){var g=null;return g=(g=c.getMatchedRule(d))?g.getSubItemUrls(d):c.defaultGetSubItemUrls(d)};c.getIconImageName=function(d,g){var h="";if(d.url){var a=c.getMatchedRule(d.url);a&&"function"===typeof a.getIconImageName&&(h=a.getIconImageName(d,g))}return h};return c},getFeaturelayerServiceBrowserRule:function(d,c,q){d=p.clone(d);var k=["point","polyline","polygon"];p.isArrayLike(d)&&0<d.length?(d=h.filter(d,function(c){return 0<=k.indexOf(c)}),0===d.length&&
(d=k)):d=k;return g._getFeaturelayerServiceBrowserRule(d,c,q)},_getFeaturelayerServiceBrowserRule:function(d,c,g){return new t({types:d,leafTypes:["Feature Layer","Table"],serviceTypes:["MapServer","FeatureServer"],_groupLayerType:"Group Layer",_featureLayerType:"Feature Layer",_tableType:"Table",getItem:function(c){var d=new k;this.isUrlEndWithServiceType(c,this.serviceTypes)?d=this.defaultGetItem(c):this.getRestInfo(c).then(p.hitch(this,function(a){a=this._getItemByLayerDefinition(c,a);d.resolve(a)}),
p.hitch(this,function(a){d.reject(a)}));return d},getSubItemUrls:function(c){var d=new k;return d=this.isUrlEndWithServiceType(c)?this._getSubUrlsByServiceUrl(c):this._getSubUrlsByGroupUrl(c)},getIconImageName:function(c,d){var a="";"MapServer"===c.type||"FeatureServer"===c.type?a=d?"mapserver_open.png":"mapserver_close.png":c.type===this._groupLayerType?a=d?"group_layer2.png":"group_layer1.png":c.type===this._featureLayerType?(c=r.getTypeByGeometryType(c.definition&&c.definition.geometryType),"point"===
c?a="point_layer1.png":"polyline"===c?a="line_layer1.png":"polygon"===c&&(a="polygon_layer1.png")):c.type===this._tableType?a="table.png":"root"===c.type&&this._currentUrl&&h.some(this.serviceTypes,p.hitch(this,function(a){return r.isStringEndWith(this._currentUrl,"/"+a)}))&&(a=d?"mapserver_open.png":"mapserver_close.png");return a},_getSubUrlsByServiceUrl:function(c){var d=new k;this.getRestInfo(c).then(p.hitch(this,function(a){var e=[];h.forEach(a.layers,p.hitch(this,function(a){0<=a.parentLayerId||
e.push(c+"/"+a.id)}));g&&h.forEach(a.tables,p.hitch(this,function(a){0<=a.parentLayerId||e.push(c+"/"+a.id)}));d.resolve(e)}),p.hitch(this,function(a){d.reject(a)}));return d},_getSubUrlsByGroupUrl:function(c){var d=new k;this.getRestInfo(c).then(p.hitch(this,function(a){var e=[];if(a.type===this._groupLayerType)var g=this._getServiceUrlByLayerUrl(c),e=h.map(a.subLayers||[],p.hitch(this,function(a){return g+"/"+a.id}));d.resolve(e)}),p.hitch(this,function(a){d.reject(a)}));return d},_getItemByLayerDefinition:function(d,
g){var a=null,e=g.type;if(e===this._groupLayerType)a={name:g.name,type:e,url:d,definition:g};else if(e===this._featureLayerType||e===this._tableType){var h=!1;e===this._featureLayerType?h=this._validateEsriGeometryType(g.geometryType):e===this._tableType&&(h=!0);h&&(h=!1,(h=c?r.isFeaturelayerUrlSupportQuery(d,g.capabilities):!0)&&(a={name:g.name,type:e,url:d,definition:g}))}return a},_validateEsriGeometryType:function(c){c=r.getTypeByGeometryType(c);return 0<=this.types.indexOf(c)},_getServiceUrlByLayerUrl:function(c){for(var d=
"",a=0;a<this.serviceTypes.length;a++){var e=this.serviceTypes[a].toLowerCase(),g=c.toLowerCase().lastIndexOf("/"+e+"/");if(0<=g){d=c.slice(0,g+e.length+1);break}}return d}})},getGeocodeServiceBrowserRule:function(){return new t({leafTypes:["GeocodeServer"],serviceTypes:["GeocodeServer"]})},getGpServiceBrowserRule:function(){return new t({leafTypes:["GPTask"],serviceTypes:["GPServer"],getItem:function(d){var c=new k;this.isUrlEndWithServiceType(d)?c=this.defaultGetItem(d):this.getRestInfo(d).then(p.hitch(this,
function(g){c.resolve({name:g.displayName||g.name,type:"GPTask",url:d,definition:g})}),p.hitch(this,function(d){c.reject(d)}));return c},getSubItemUrls:function(d){var c=new k;this.isUrlEndWithServiceType(d)?this.getRestInfo(d).then(p.hitch(this,function(g){g=h.map(g.tasks||[],p.hitch(this,function(c){return d+"/"+c}));c.resolve(g)}),p.hitch(this,function(d){c.reject(d)})):c.resolve([]);return c},getIconImageName:function(d,c){c="";"GPServer"===d.type?c="toolbox.png":"GPTask"===d.type&&(c="tool.png");
return c}})},getImageServiceBrowserRule:function(d){return new t({leafTypes:["ImageServer"],serviceTypes:["ImageServer"],getItem:function(c){var g=new k;this.isUrlEndWithServiceType(c)?this.defaultGetItem(c).then(p.hitch(this,function(c){d?r.isImageServiceSupportQuery(c.definition.capabilities)?g.resolve(c):g.resolve(null):g.resolve(c)}),p.hitch(this,function(c){g.reject(c)})):g.resolve(null);return g},getIconImageName:function(c,d){d="";"ImageServer"===c.type&&(d="image_layer.png");return d}})},
getQueryableServiceBrowserRule:function(){var d=g.getFeaturelayerServiceBrowserRule(["point","polyline","polygon"],!0,!0),c=g.getImageServiceBrowserRule(!0);return g.combineRules([d,c])}};return g})},"jimu/ServiceBrowserRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred jimu/utils esri/request esri/IdentityManager".split(" "),function(p,h,k,r,t,g,d){return p([],{leafTypes:null,serviceTypes:null,_restInfoCache:{},constructor:function(c){h.mixin(this,c);h.isArrayLike(this.leafTypes)||
(this.leafTypes=[]);h.isArrayLike(this.serviceTypes)||(this.serviceTypes=[])},getItem:function(c){return this.defaultGetItem(c)},getSubItemUrls:function(c){return this.defaultGetSubItemUrls(c)},getIconImageName:function(c,d){return""},defaultGetItem:function(c){var d=new r;c=c.replace(/\/*$/g,"");if(this.isUrlEndWithServiceType(c)){var g=c.split("/"),k=g[g.length-1],a=g[g.length-2];this.getRestInfo(c).then(h.hitch(this,function(e){d.resolve({name:a,type:k,url:c,definition:e})}),h.hitch(this,function(a){console.error(a);
d.reject({errorCode:"NETWORK_ERROR",error:a})}))}else d.resolve(null);return d},defaultGetSubItemUrls:function(c){c=new r;c.resolve([]);return c},getRestInfo:function(c){var k=new r;c=c.replace(/\/*$/g,"");var p=this._restInfoCache[c];if(p)k.resolve(p);else{var p={url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback",timeout:2E4},t=d.findCredential(c);t&&t.token&&(p.content.token=t.token);g(p).then(h.hitch(this,function(a){this._restInfoCache[c]=a;k.resolve(a)}),function(a){k.reject(a)})}return k},
isServiceTypeSupported:function(c){c=c.toLowerCase();return k.some(this.serviceTypes,h.hitch(this,function(d){return d.toLowerCase()===c}))},isUrlEndWithServiceType:function(c){return k.some(this.serviceTypes,h.hitch(this,function(d){return t.isStringEndWith(c,"/"+d)}))},isUrlContainsServiceType:function(c){c=c.toLowerCase();return k.some(this.serviceTypes,h.hitch(this,function(d){d=d.toLowerCase();return 0<=c.indexOf("/"+d)}))}})})},"jimu/dijit/_FeaturelayerServiceChooserContent":function(){define(["dojo/_base/declare",
"./_BasicServiceChooserContent","./FeaturelayerServiceBrowser"],function(p,h,k){return p([h],{baseClass:"jimu-featurelayer-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/MapServer","http://myserver/arcgis/rest/services/myservice/FeatureServer"],_createServiceBrowser:function(h){return new k(h)}})})},"jimu/dijit/_BasicServiceChooserContent":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_BasicServiceChooserContent.html dojo/Evented dojo/Deferred dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/promise/all jimu/dijit/URLInput jimu/dijit/LoadingIndicator".split(" "),
function(p,h,k,r,t,g,d,c,q,v,w,a,e,u,y){return p([h,k,r,g],{templateString:t,_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/servicetype"],multiple:!1,url:"",getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},postMixInProperties:function(){this.nls=v.mixin({},window.jimuNls.common);this.nls=v.mixin(this.nls,window.jimuNls.basicServiceChooser)},postCreate:function(){this.inherited(arguments);
c.addClass(this.domNode,"jimu-basic-service-chooser-content");this.multiple=!!this.multiple;this._initSelf();this.exampleTd.innerHTML=this.exampleTd.innerHTML},setUrl:function(a){var c=new d;(this.url=a)&&"string"===typeof this.url?(this.urlInput.set("value",this.url),c=this._onBtnValidateClick()):c.reject();return c},focusInput:function(){this.urlInput.focus()},_initSelf:function(){this._examples&&0<this._examples.length?q.forEach(this._examples,v.hitch(this,function(a){c.create("div",{innerHTML:a,
"class":"example-url"},this.exampleTd)})):c.setStyle(this.exampleTr,"display","none");var d={multiple:this.multiple,_onTreeClick:v.hitch(this,this._onTreeClick)};this.serviceBrowser=this._createServiceBrowser(d);this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup();this.own(a.after(this.urlInput,"validator",v.hitch(this,this._afterUrlValidate)));this.url&&"string"===typeof this.url&&this.urlInput.set("value",this.url);this.own(w(this.serviceBrowser,"error",v.hitch(this,
this._onServiceBrowserError)))},_createServiceBrowser:function(a){},_validateUrl:function(a){a=a.replace(/\/*$/g,"");if((a=a.match(/\/rest\/services\/*(.*)/gi))&&0<a.length)if(a=a[0].replace(/\/rest\/services\/*/,"")){var c=a.split("/");if(1===c.length)return!0;if(2===c.length)return this.serviceBrowser.isServiceTypeSupported(c[1]);if(3<=c.length)return a=this.serviceBrowser.isServiceTypeSupported(c[1]),c=this.serviceBrowser.isServiceTypeSupported(c[2]),a||c}else return!0;else return!1},_afterUrlValidate:function(a){a&&
(a=this.urlInput.get("value"),a=this._validateUrl(a));a?c.removeClass(this.btnValidate,"jimu-state-disabled"):c.addClass(this.btnValidate,"jimu-state-disabled");return a},_onServiceBrowserError:function(a){this._showErrorMessage(a)},_showErrorMessage:function(a){a&&"string"===typeof a?(this.errorNode.innerHTML=a,c.addClass(this.errorSection,"visible")):c.removeClass(this.errorSection,"visible")},_clearErrorMessage:function(){this.errorNode.innerHTML="";c.removeClass(this.errorSection,"visible")},
_onBtnValidateClick:function(){this._clearErrorMessage();var a=new d;if(this.urlInput.validate()){var c=this.urlInput.get("value");this.serviceBrowser.setUrl(c).then(v.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.resolve()}),v.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.reject()}));this.emit("validate-click")}else a.reject();return a},_checkSelectedItemsNumber:function(){0<this.getSelectedItems().length?c.removeClass(this.btnOk,"jimu-state-disabled"):
c.addClass(this.btnOk,"jimu-state-disabled")},_onTreeClick:function(){this._checkSelectedItemsNumber()},_onBtnOkClick:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnCancelClick:function(){this.emit("cancel")}})})},"dojo/NodeList-data":function(){define(["./_base/kernel","./query","./_base/lang","./_base/array","./dom-attr"],function(p,h,k,r,t){var g=h.NodeList,d={},c=0,q=function(a){var d=t.get(a,"data-dojo-dataid");d||(d="pid"+c++,t.set(a,"data-dojo-dataid",d));return d},
v=p._nodeData=function(a,c,g){var e=q(a),h;d[e]||(d[e]={});if(1==arguments.length)return d[e];"string"==typeof c?2<arguments.length?d[e][c]=g:h=d[e][c]:h=k.mixin(d[e],c);return h},w=p._removeNodeData=function(a,c){a=q(a);d[a]&&(c?delete d[a][c]:delete d[a])};g._gcNodeData=p._gcNodeData=function(){var a=h("[data-dojo-dataid]").map(q),c;for(c in d)0>r.indexOf(a,c)&&delete d[c]};k.extend(g,{data:g._adaptWithCondition(v,function(a){return 0===a.length||1==a.length&&"string"==typeof a[0]}),removeData:g._adaptAsForEach(w)});
return g})},"widgets/Directions/setting/SearchConfig/LocatorSourceSetting":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/Evented dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin jimu/portalUrlUtils jimu/dijit/Message jimu/dijit/_GeocodeServiceChooserContent jimu/dijit/Popup jimu/dijit/LoadingShelter esri/request esri/lang ../../searchUtil jimu/utils dojo/text!./LocatorSourceSetting.html jimu/dijit/CheckBox dijit/form/ValidationTextBox dijit/form/NumberTextBox".split(" "),
function(p,h,k,r,t,g,d,c,q,v,w,a,e,u,y,l,f,n,A,x){return p([d,c,q,t],{baseClass:"jimu-widget-search-locator-source-setting",tr:null,nls:null,config:null,singleLineFieldName:null,templateString:A,_suggestible:!1,_locatorDefinition:null,_esriLocatorRegExp:/http(s)?:\/\/geocode(.){0,3}\.arcgis.com\/arcgis\/rest\/services\/World\/GeocodeServer/g,serviceChooserContent:null,geocoderPopup:null,_clickSet:!1,postCreate:function(){this.inherited(arguments);this.exampleHint=this.nls.locatorExample+": http://\x26lt;myServerName\x26gt;/arcgis/rest/services/World/GeocodeServer";
this.searchInCurrentMapExtent=new x({checked:!1,label:this.nls.searchInCurrentMapExtent},this.searchInCurrentMapExtent);this.enableLocalSearch=new x({checked:!1,label:this.nls.enableLocalSearch},this.enableLocalSearch);this._processlocalSearchTable(!1);this.own(r(this.enableLocalSearch,"change",h.hitch(this,function(){this._processlocalSearchTable(this.enableLocalSearch.getValue())})));k.setStyle(this.enableLocalSearch.domNode,"display","none");this._setMessageNodeContent(this.exampleHint);this.autoComplete=
new x({checked:!1,label:this.nls.autoComplete},this.autoComplete);this.config=this.config?this.config:{};this.setConfig(this.config)},setRelatedTr:function(b){this.tr=b},getRelatedTr:function(){return this.tr},setDefinition:function(b){this._locatorDefinition=b||{}},getDefinition:function(){return this._locatorDefinition},setConfig:function(b){if("[object Object]"===Object.prototype.toString.call(b)){var a=b.url;a&&(this.config=b,this.shelter.show(),this._locatorDefinition.url!==a?this._getDefinitionFromRemote(a).then(h.hitch(this,
function(b){a&&b&&"error"!==b.type?(this._locatorDefinition=b,this._locatorDefinition.url=a,this._setSourceItems(),this._setMessageNodeContent(this.exampleHint)):a&&b&&"error"===b.type&&(this._setSourceItems(),this._disableSourceItems(),this._setMessageNodeContent(l.substitute({URL:b.url},h.clone(this.nls.invalidUrlTip)),!0));this.shelter.hide()})):(this._setSourceItems(),this._setMessageNodeContent(this.exampleHint),this.shelter.hide()))}},isValidConfig:function(){var b=this.getConfig();return b.url&&
b.name&&b.singleLineFieldName?!0:!1},showValidationTip:function(){this._showValidationErrorTip(this.locatorUrl);this._showValidationErrorTip(this.locatorName)},getConfig:function(){var b={url:this.locatorUrl.get("value"),name:n.stripHTML(this.locatorName.get("value")),singleLineFieldName:this.singleLineFieldName,placeholder:n.stripHTML(this.placeholder.get("value")),countryCode:n.stripHTML(this.countryCode.get("value")),maxSuggestions:this.maxSuggestions.get("value")||6,searchInCurrentMapExtent:this.searchInCurrentMapExtent.checked,
enableLocalSearch:this.enableLocalSearch.getValue(),localSearchMinScale:this.localSearchMinScale.get("value"),localSearchDistance:this.localSearchDistance.get("value"),type:"locator",autoComplete:this.autoComplete?this.autoComplete.getValue():!0,searchDelay:this.searchDelay.get("value")||350,minCharacters:this.minCharacters.get("value")||3};!0===this.config._isUpgrade&&(b._isUpgrade=!0);return b},_onLocatorNameBlur:function(){this.locatorName.set("value",n.stripHTML(this.locatorName.get("value")))},
_onPlaceholderBlur:function(){this.placeholder.set("value",n.stripHTML(this.placeholder.get("value")))},_onCountryCodeBlur:function(){this.countryCode.set("value",n.stripHTML(this.countryCode.get("value")))},_disableSourceItems:function(){this.locatorName.set("disabled",!0);this.placeholder.set("disabled",!0);this.countryCode.set("disabled",!0);this.maxSuggestions.set("disabled",!0)},_enableSourceItems:function(){this.locatorName.set("disabled",!1);this.placeholder.set("disabled",!1);this.countryCode.set("disabled",
!1);this.maxSuggestions.set("disabled",!1)},_setSourceItems:function(){var b=this.config;b.url&&(this.locatorUrl.set("value",b.url),this._processCountryCodeRow(b.url));b.name&&this.locatorName.set("value",n.stripHTML(b.name));b.singleLineFieldName&&(this.singleLineFieldName=b.singleLineFieldName);b.placeholder&&this.placeholder.set("value",n.stripHTML(b.placeholder));this.maxSuggestions.set("value",b.maxSuggestions||6);this.autoComplete.setValue("undefined"!==this.config.autoComplete?this.config.autoComplete:
!0);this.searchDelay.set("value",b.searchDelay||350);this.minCharacters.set("value",b.minCharacters||3);b._oldConfig&&!b._isUpgrade&&(b._oldConfig.placeholder&&this.placeholder.set("value",n.stripHTML(b._oldConfig.placeholder)),b._oldConfig.maxLocations&&this.maxSuggestions.set("value",b._oldConfig.maxLocations),b._oldConfig.autoComplete&&this.autoComplete.setValue(b._oldConfig.autoComplete),b._oldConfig.searchDelay&&this.searchDelay.set("value",b._oldConfig.searchDelay),b._oldConfig.minCharacters&&
this.minCharacters.set("value",b._oldConfig.minCharacters),b._isUpgrade=!0);b.countryCode&&this.countryCode.set("value",n.stripHTML(b.countryCode));"capabilities"in this._locatorDefinition?(k.setStyle(this.enableLocalSearch.domNode,"display",""),this._processlocalSearchTable(b.enableLocalSearch),this.enableLocalSearch.setValue(b.enableLocalSearch),b.localSearchMinScale&&b.enableLocalSearch&&this.localSearchMinScale.set("value",b.localSearchMinScale),b.localSearchDistance&&b.enableLocalSearch&&this.localSearchDistance.set("value",
b.localSearchDistance)):(this.enableLocalSearch.setValue(!1),k.setStyle(this.enableLocalSearch.domNode,"display","none"));(this._suggestible=this._locatorDefinition&&this._locatorDefinition.capabilities&&-1<this._locatorDefinition.capabilities.indexOf("Suggest"))?this._hideSuggestibleTips():this._showSuggestibleTips();this.searchInCurrentMapExtent.setValue(!!b.searchInCurrentMapExtent);this._enableSourceItems()},_isEsriLocator:function(b){this._esriLocatorRegExp.lastIndex=0;return this._esriLocatorRegExp.test(b)},
_getDefinitionFromRemote:function(b){var a=new g;if(this._isEsriLocator(b))a.resolve({singleLineAddressField:{name:"SingleLine",type:"esriFieldTypeString",alias:"Single Line Input",required:!1,length:200,localizedNames:{},recognizedNames:{}},capabilities:"Geocode,ReverseGeocode,Suggest"});else{var c=y({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});this.own(c);c.then(h.hitch(this,function(b){a.resolve(b)}),h.hitch(this,function(c){console.error(c);a.resolve({type:"error",
url:this._getRequestUrl(b)})}))}return a.promise},_setMessageNodeContent:function(b,a){k.empty(this.messageNode);b.nodeType||(b=k.toDom(b));k.place(b,this.messageNode);a?k.addClass(this.messageNode,"error-message"):k.removeClass(this.messageNode,"error-message")},_getRequestUrl:function(b){var a=window.location.protocol;return"http:"===a?v.setHttpProtocol(b):"https:"===a?v.setHttpsProtocol(b):b},_onSetLocatorUrlClick:function(){this._clickSet=!0;this._openServiceChooser()},_openLocatorChooser:function(){this._clickSet=
!1;this._openServiceChooser()},_openServiceChooser:function(){this.serviceChooserContent=new a({url:this.locatorUrl.get("value")||""});this.shelter=new u({hidden:!0});this.geocoderPopup=new e({titleLabel:this.nls.setGeocoderURL,autoHeight:!0,content:this.serviceChooserContent.domNode,container:window.jimuConfig.layoutId,width:640});this.shelter.placeAt(this.geocoderPopup.domNode);k.setStyle(this.serviceChooserContent.domNode,"width","580px");k.addClass(this.serviceChooserContent.domNode,"override-geocode-service-chooser-content");
this.serviceChooserContent.own(r(this.serviceChooserContent,"validate-click",h.hitch(this,function(){k.removeClass(this.serviceChooserContent.domNode,"override-geocode-service-chooser-content")})));this.serviceChooserContent.own(r(this.serviceChooserContent,"ok",h.hitch(this,"_onSelectLocatorUrlOk")));this.serviceChooserContent.own(r(this.serviceChooserContent,"cancel",h.hitch(this,"_onSelectLocatorUrlCancel")))},_onSelectLocatorUrlOk:function(b){b&&b[0]&&b[0].url&&this.domNode&&(this.shelter.show(),
y({url:b[0].url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(h.hitch(this,function(a){this.shelter.hide();a&&a.singleLineAddressField&&a.singleLineAddressField.name?(this._enableSourceItems(),this.locatorUrl.set("value",b[0].url),this.locatorName.get("value")||this.locatorName.set("value",f.getGeocoderName(b[0].url)),"capabilities"in a?(k.setStyle(this.enableLocalSearch.domNode,"display",""),this._isEsriLocator(b[0].url)?this.enableLocalSearch.setValue(!0):this.enableLocalSearch.setValue(!1)):
(this.enableLocalSearch.setValue(!1),k.setStyle(this.enableLocalSearch.domNode,"display","none")),this.singleLineFieldName=a.singleLineAddressField.name,this._processCountryCodeRow(b[0].url),this._locatorDefinition=a,this._locatorDefinition.url=b[0].url,(this._suggestible=a.capabilities&&-1<this._locatorDefinition.capabilities.indexOf("Suggest"))?this._hideSuggestibleTips():this._showSuggestibleTips(),this._clickSet?this.emit("reselect-locator-url-ok",this.getConfig()):this.emit("select-locator-url-ok",
this.getConfig()),this.geocoderPopup&&(this.geocoderPopup.close(),this.geocoderPopup=null),this._setMessageNodeContent(this.exampleHint)):new w({message:this.nls.locatorWarning})}),h.hitch(this,function(a){console.error(a);this.shelter.hide();new w({message:l.substitute({URL:this._getRequestUrl(b[0].url)},h.clone(this.nls.invalidUrlTip))})})))},_onSelectLocatorUrlCancel:function(){this.geocoderPopup&&(this.geocoderPopup.close(),this.geocoderPopup=null,this.emit("select-locator-url-cancel"))},_processlocalSearchTable:function(b){b?
(k.removeClass(this.minScaleNode,"hide-local-search-table"),k.removeClass(this.radiusNode,"hide-local-search-table"),b=k.getMarginBox(this.radiusHintNode),k.setStyle(this.radiusHintNode.parentNode,"paddingBottom",(45<b.h?b.h+10:45)+"px")):(k.addClass(this.minScaleNode,"hide-local-search-table"),k.addClass(this.radiusNode,"hide-local-search-table"))},_processCountryCodeRow:function(b){this._isEsriLocator(b)?(this.countryCode.set("value",""),k.removeClass(this.countryCodeRow,"hide-country-code-row")):
k.addClass(this.countryCodeRow,"hide-country-code-row")},_showSuggestibleTips:function(){k.addClass(this.tipsNode,"source-tips-show");k.setStyle(this.maxSuggestions.domNode,"display","none")},_hideSuggestibleTips:function(){k.removeClass(this.tipsNode,"source-tips-show");k.setStyle(this.maxSuggestions.domNode,"display","block")},_showValidationErrorTip:function(b){if(!b.validate()&&b.domNode&&b.focusNode){var a=b.get("disabled");a&&b.set("disabled",!1);b.focusNode.focus();setTimeout(h.hitch(this,
function(){b.focusNode.blur();a&&b.set("disabled",!0);b=null}),100)}}})})},"jimu/dijit/_GeocodeServiceChooserContent":function(){define(["dojo/_base/declare","./_BasicServiceChooserContent","./GeocodeServiceBrowser"],function(p,h,k){return p([h],{baseClass:"jimu-geocode-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/GeocodeServer"],_createServiceBrowser:function(h){return new k(h)}})})},
"jimu/dijit/GeocodeServiceBrowser":function(){define(["dojo/_base/declare","./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array","jimu/serviceBrowserRuleUtils"],function(p,h,k,r,t){return p([h],{baseClass:"jimu-geocode-service-browser",declaredClass:"jimu.dijit.GeocodeServiceBrowser",url:"",multiple:!1,postMixInProperties:function(){this.inherited(arguments);this.rule=t.getGeocodeServiceBrowserRule()},getSelectedItems:function(){var g=this.inherited(arguments);return g=r.map(g,k.hitch(this,
function(d){return{name:d.name,url:d.url}}))}})})},"widgets/Directions/setting/BarrierLayers":function(){define("dojo/_base/declare dojo/_base/lang jimu/LayerInfos/LayerInfos dijit/form/Select dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./BarrierLayers.html".split(" "),function(p,h,k,r,t,g,d,c){return p([t,g,d],{templateString:c,constructor:function(c){c&&(this.nls=c.nls)},postCreate:function(){this.inherited(arguments)},startup:function(){this.layerInfosObj=k.getInstanceSync();
var c=[],d=[],g=[];this.layerInfosObj.traversal(h.hitch(this,function(a){"esriGeometryPoint"===a.layerObject.geometryType&&this._isLayerInMap(a)&&c.push(a);"esriGeometryPolyline"===a.layerObject.geometryType&&this._isLayerInMap(a)&&d.push(a);"esriGeometryPolygon"===a.layerObject.geometryType&&this._isLayerInMap(a)&&g.push(a)}));this.pointLayers=(new r({name:"pointLayers",options:this._getOptionsByLayers(c,this.nls.noPointBarrier)})).placeAt(this.pointLayersNode);this.pointLayers.startup();this.polylineLayers=
(new r({name:"polylineLayers",options:this._getOptionsByLayers(d,this.nls.noLineBarrier)})).placeAt(this.polylineLayersNode);this.polylineLayers.startup();this.polygonLayers=(new r({name:"polygonLayers",options:this._getOptionsByLayers(g,this.nls.noPolygonBarrier)})).placeAt(this.polygonLayersNode);this.polygonLayers.startup();this.inherited(arguments)},destroy:function(){this.pointLayers&&this.pointLayers.destroy&&(this.pointLayers.closeDropDown(),this.pointLayers.destroy());this.polylineLayers&&
this.polylineLayers.destroy&&(this.polylineLayers.closeDropDown(),this.polylineLayers.destroy());this.polygonLayers&&this.polygonLayers.destroy&&(this.polygonLayers.closeDropDown(),this.polygonLayers.destroy())},_getOptionsByLayers:function(c,d){var g=[];g.push({label:d||"",value:"",selected:"true"});d=0;for(var a=c.length;d<a;d++){var e=c[d];g.push({label:e.title||e.id,value:e.layerObject.id})}return g},validate:function(){return!0},getValue:function(){var c={pointLayers:[],polylineLayers:[],polygonLayers:[]};
c.pointLayers.push(this.pointLayers.getValue());c.polylineLayers.push(this.polylineLayers.getValue());c.polygonLayers.push(this.polygonLayers.getValue());return c},setValue:function(c){this._selectItem(this.pointLayers,c.pointLayers||[]);this._selectItem(this.polylineLayers,c.polylineLayers||[]);this._selectItem(this.polygonLayers,c.polygonLayers||[])},_selectItem:function(c,d){for(var g=c.getOptions(),a=0,e=g.length;a<e;a++)g[a].value===d[0]&&c.setValue(d[0])},_isLayerInMap:function(c){for(var d=
this.layerInfosObj.getLayerInfoArrayOfWebmap(),g=c.getRootLayerInfo(),a=0,e=d.length;a<e;a++){var h=d[a];if(h.id===c.id||g&&g.id===h.id)return!0}return!1}})})},"jimu/dijit/ServiceURLComboBox":function(){define(["dojo/_base/declare","dojo/_base/html","dijit/form/ComboBox","jimu/dijit/ServiceURLInput"],function(p,h,k,r){return p([r,k],{declaredClass:"jimu.dijit.ServiceURLComboBox",postCreate:function(){this.inherited(arguments);h.addClass(this.domNode,"jimu-dijit-ServiceURLComboBox")},setProcessFunction:function(){this.inherited(arguments)}})})},
"widgets/Directions/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Directions/setting/PresetDestinations.html":'\x3cdiv\x3e\r\n  \x3cspan class\x3d"title"\x3e${nls.presetDestinations}\x3c/span\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\r\n  \x3ctable style\x3d"width:98%;" cellspacing\x3d"0"\x3e\r\n    \x3ctbody\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd style\x3d"width:50%;"\x3e\r\n        \x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n          \x3ctbody\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd style\x3d"width:200px;"\x3e\r\n              \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.startPoint}\x3c/span\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd style\x3d"width:auto;"\x3e\r\n              \x3cspan data-dojo-attach-point\x3d"startSearchDom" style\x3d"width:220px;"\x3e\x3c/span\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"startSearchResultsNode" class\x3d"searchResults arcgisSearch"\x3e\x3c/div\x3e\r\n              \x3c!--\x3cdiv data-dojo-attach-point\x3d"startSearchError" class\x3d"hide preset-des-error"\x3eNo Results\x3c/div\x3e--\x3e\r\n            \x3c/td\x3e\r\n\r\n            \x3ctd style\x3d"width:200px;"\x3e\r\n              \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.endPoint}\x3c/span\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd style\x3d"width:auto;"\x3e\r\n              \x3cspan data-dojo-attach-point\x3d"endSearchDom" class\x3d"end-search" style\x3d"width:220px;"\x3e\x3c/span\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"endSearchResultsNode" class\x3d"searchResults arcgisSearch"\x3e\x3c/div\x3e\r\n              \x3c!--\x3cdiv data-dojo-attach-point\x3d"endSearchError" class\x3d"hide preset-des-error"\x3eNo Results\x3c/div\x3e--\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/Search/templates/Search.html":'\x3cdiv role\x3d"presentation" class\x3d"${theme}"\x3e\r\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\r\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\r\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\r\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\r\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\r\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n          \x3c/form\x3e\r\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\r\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.widgets.Search.main.searchButtonTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/SearchConfig/SearchConfig.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"search-config"\x3e\r\n    \x3cdiv class\x3d"dropdown-button" role\x3d"button"\x3e\r\n      \x3cdiv class\x3d"button"\x3e\r\n        \x3cspan class\x3d"button-text"\x3e${nls.add}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cul class\x3d"dropdown-menu" role\x3d"menu" data-dojo-attach-event\x3d"click:_onMenuItemClick"\x3e\r\n        \x3cli class\x3d"dropdown-item" type\x3d"query"\x3e${nls.searchableLayer}\x3c/li\x3e\r\n        \x3cli class\x3d"dropdown-item" type\x3d"locator"\x3e${nls.geocoder}\x3c/li\x3e\r\n      \x3c/ul\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sources"\x3e\r\n      \x3cdiv class\x3d"source-list jimu-float-leading"\x3e\r\n        \x3cdiv class\x3d"source-list-table" data-dojo-attach-point\x3d"sourceList"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"source-setting jimu-float-trailing" data-dojo-attach-point\x3d"sourceSettingNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/SearchConfig/QuerySourceSetting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"source-url-section"\x3e\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.layerSource}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"sourceUrl" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true,disabled:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"third"\x3e\r\n            \x3cspan title\x3d"${nls.set}" class\x3d"jimu-btn" data-dojo-attach-event\x3d"click:_onSetSourceClick"\x3e${nls.set}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"messageTr"\x3e\r\n          \x3ctd class\x3d"first"\x3e\x3c/td\x3e\r\n          \x3ctd class\x3d"second" colspan\x3d"2"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"messageNode" class\x3d"tip error-message"\x3e\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"source-details-section"\x3e\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.name}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"sourceName" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-event\x3d"Blur:_onSourceNameBlur" data-dojo-props\x3d"trim:true,required:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.placeholderText}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"placeholder" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-event\x3d"Blur:_onPlaceholderBlur" data-dojo-props\x3d"trim:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.searchFields}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv class\x3d"search-fields"\x3e\r\n            \x3c!-- \x3cspan class\x3d"fields jimu-float-leading" data-dojo-attach-point\x3d"fieldsNode"\x3e\x3c/span\x3e --\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"searchFields" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true,disabled:true,style:{width:\'95%\'}"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"search-fields-selector jimu-float-trailing" data-dojo-attach-point\x3d"fieldsSelectorNode" data-dojo-attach-event\x3d"click:_onFieldsSelectorClick"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.displayField}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"displayField" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d\'style:{width:"100%"}\'\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.maxSuggestions}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv class\x3d"source-tips" title\x3d"${nls.searchLayerTips}" data-dojo-attach-point\x3d"tipsNode"\x3e\r\n            \x3cem\x3e${nls.searchLayerTips}\x3c/em\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"maxSuggestions" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1,places:0},style:{width:\'100%\'},value:6"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/table\x3e\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"exactMatch"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"searchInCurrentMapExtent"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2" class\x3d"auto-complete-td" data-dojo-attach-point\x3d"autoComplete"\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd style\x3d"width:200px;"\x3e\r\n            \x3cspan class\x3d"search-delay"\x3e${nls.searchDelay}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd style\x3d"width:auto;"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"searchDelay" data-dojo-type\x3d"dijit/form/NumberSpinner" data-dojo-props\x3d\'required:true,value:350,smallDelta:1,largeDelta:10,constraints:{min:10},intermediateChanges:true\'\r\n              type\x3d"text" style\x3d"width:220px;" /\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd style\x3d"width:200px;"\x3e\r\n            \x3cspan class\x3d"min-characters jimu-ellipsis"\x3e${nls.minCharacters}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd style\x3d"width:auto;"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"minCharacters" data-dojo-type\x3d"dijit/form/NumberSpinner" data-dojo-props\x3d\'required:true,value:3,smallDelta:1,largeDelta:1,constraints:{min:3},intermediateChanges:true\'\r\n              type\x3d"text" style\x3d"width:220px;" /\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/FeaturelayerSource.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"map-td" nowrap data-dojo-attach-point\x3d"mapTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"mapLabel"\x3e${nls.selectFromMap}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"portal-td" nowrap data-dojo-attach-point\x3d"portalTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalLabel"\x3e${nls.selectFromPortal}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"url-td" nowrap data-dojo-attach-point\x3d"urlTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"urlLabel"\x3e${nls.addServiceUrl}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"source-content"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"operationTip" class\x3d"operation-tip"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"flcContainer" class\x3d"dijit-container map-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"hflcContainer" class\x3d"dijit-container portal-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"flscContainer" class\x3d"dijit-container url-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/FeaturelayerChooserFromPortal.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"selector-container" data-dojo-attach-point\x3d"selectorContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"footer"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-point\x3d"btnCancel" data-dojo-attach-event\x3d"onclick:_onBtnCancelClicked"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing next jimu-state-disabled" data-dojo-attach-point\x3d"btnNext" data-dojo-attach-event\x3d"onclick:_onBtnNextClicked"\x3e${nls.next}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-state-disabled" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClicked"\x3e${nls.ok}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing back" data-dojo-attach-point\x3d"btnBack" data-dojo-attach-event\x3d"onclick:_onBtnBackClicked"\x3e${nls.back}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/ItemSelector.html":'\r\n\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"setting-tab-container"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cdiv\x3e${nls.groups}:\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:85px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cfieldset id\x3d"publicSearchRaido"\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" data-dojo-type\x3d"dijit/form/RadioButton" \r\n\t\t\t\t\t\t\tdata-label-id\x3d"portalPublicRaido" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalPublicLabel" data-label-for\x3d"portalPublicRaido" class\x3d"jimu-float-leading portal-public-label"\x3ePortal\x3c/label\x3e\r\n\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" data-dojo-type\x3d"dijit/form/RadioButton"\r\n\t\t\t\t\t\t\tdata-label-id\x3d"onlinePublicRaido" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlinePublicLabel" data-label-for\x3d"onlinePublicRaido" class\x3d"jimu-float-leading portal-public-label"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\t\x3c/fieldset\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicItemSection" class\x3d"public-item-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip jimu-state-error-text"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_BasicServiceChooserContent.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"content-section"\x3e\r\n\t\t\x3ctable class\x3d"layout"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"80px" align\x3d"right"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"170px"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3eURL:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlInput" data-dojo-type\x3d"jimu/dijit/URLInput" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"jimu-btn jimu-state-disabled validate-btn jimu-float-trailing" data-dojo-attach-point\x3d"btnValidate" data-dojo-attach-event\x3d"onclick:_onBtnValidateClick"\x3e${nls.validate}\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"exampleTr" class\x3d"example-tr"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td" style\x3d"padding-top:5px;"\x3e\r\n\t\t\t\t\t\t\x3cspan title\x3d"${nls.example}:"\x3e${nls.example}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"exampleTd" colspan\x3d"2" style\x3d"padding-top:5px;font-style:italic;color:#ccc;"\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\r\n\t\t\t\x3cdiv class\x3d"error-section" data-dojo-attach-point\x3d"errorSection"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"error-message" data-dojo-attach-point\x3d"errorNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operations"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_onBtnCancelClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing jimu-state-disabled ok" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClick"\x3e${nls.ok}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/SearchConfig/LocatorSourceSetting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"source-url-section"\x3e\r\n    \x3ctable class\x3d"source-table" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.locatorUrl}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"locatorUrl" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true,disabled:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"third"\x3e\r\n            \x3cspan title\x3d"${nls.set}" class\x3d"jimu-btn" data-dojo-attach-event\x3d"click:_onSetLocatorUrlClick"\x3e${nls.set}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"messageNode" class\x3d"tip"\x3e\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"source-details-section" data-dojo-attach-point\x3d"detailsSection"\x3e\r\n    \x3ctable class\x3d"source-table" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e${nls.locatorName}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"locatorName" data-dojo-attach-event\x3d"Blur: _onLocatorNameBlur"\r\n            placeHolder\x3d"${nls.locatorName}"\r\n            required\x3d"true" data-dojo-props\x3d\'style:{width:"100%"}\'/\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e${nls.placeholderText}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"placeholder"\r\n            data-dojo-attach-event\x3d"Blur: _onPlaceholderBlur"\r\n            placeHolder\x3d"${nls.placeholderText}" data-dojo-props\x3d\'style:{width:"100%"}\'/\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"hide-country-code-row country-code-row" data-dojo-attach-point\x3d"countryCodeRow"\x3e\r\n          \x3ctd class\x3d"first"\x3e${nls.countryCode}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"countryCode"\r\n            data-dojo-attach-event\x3d"Blur:_onCountryCodeBlur"\r\n            placeHolder\x3d"${nls.countryCodeEg} USA,CHN" data-dojo-props\x3d\'style:{width:"96%"}\'/\x3e\r\n            \x3ca class\x3d"jimu-float-trailing" target\x3d"_blank" href\x3d"https://developers.arcgis.com/rest/geocode/api-reference/geocode-coverage.htm" style\x3d"line-height:30px;"\x3e\r\n              \x3ci class\x3d"esri-icon-question"\x3e\x3c/i\x3e\r\n            \x3c/a\x3e\r\n            \x3cspan class\x3d"example"\x3e${nls.countryCodeHint}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.maxSuggestions}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv class\x3d"source-tips" title\x3d"${nls.locatorTips}" data-dojo-attach-point\x3d"tipsNode"\x3e\r\n              ${nls.locatorTips}\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"maxSuggestions" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1,places:0},style:{width:\'100%\'},value:6"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first" colspan\x3d"2"\x3e\r\n            \x3cspan class\x3d"source-label" data-dojo-attach-point\x3d"enableLocalSearch"\x3e\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"minScaleNode" class\x3d"local-search-row"\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.minScale}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cspan class\x3d"jimu-float-leading" style\x3d"line-height:30px;"\x3e1: \x3c/span\x3e\r\n            \x3cdiv class\x3d"jimu-float-trailing" data-dojo-attach-point\x3d"localSearchMinScale" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1},style:{width:\'96%\'},value:300000"\x3e\x3c/div\x3e\r\n            \x3cspan class\x3d"example" title\x3d"${nls.minScaleHint}"\x3e${nls.minScaleHint}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"radiusNode" class\x3d"local-search-row"\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.radius}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv class\x3d"jimu-float-leading" style\x3d"width:100%;"\x3e\r\n              \x3cdiv class\x3d"jimu-float-leading" data-dojo-attach-point\x3d"localSearchDistance" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1},style:{width:\'75%\'},value:50000"\x3e\x3c/div\x3e\r\n              \x3cspan class\x3d"jimu-float-trailing" style\x3d"line-height:30px;"\x3e${nls.meters}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n            \x3cspan class\x3d"example" data-dojo-attach-point\x3d"radiusHintNode" title\x3d"${nls.radiusHint}"\x3e${nls.radiusHint}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3ctable class\x3d"source-table" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"searchInCurrentMapExtent"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \r\n    \x3ctable class\x3d"source-table" style\x3d"margin-left: -2px;"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2" class\x3d"auto-complete-td" data-dojo-attach-point\x3d"autoComplete"\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd style\x3d"width:200px;"\x3e\r\n            \x3cspan class\x3d"search-delay"\x3e${nls.searchDelay}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd style\x3d"width:auto;"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"searchDelay" data-dojo-type\x3d"dijit/form/NumberSpinner" data-dojo-props\x3d\'required:true,value:350,smallDelta:1,largeDelta:10,constraints:{min:10},intermediateChanges:true\'\r\n              type\x3d"text" style\x3d"width:220px;" /\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd style\x3d"width:200px;"\x3e\r\n            \x3cspan class\x3d"min-characters jimu-ellipsis"\x3e${nls.minCharacters}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd style\x3d"width:auto;"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"minCharacters" data-dojo-type\x3d"dijit/form/NumberSpinner" data-dojo-props\x3d\'required:true,value:3,smallDelta:1,largeDelta:1,constraints:{min:3},intermediateChanges:true\'\r\n              type\x3d"text" style\x3d"width:220px;" /\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Directions/setting/BarrierLayers.html":'\x3cdiv\x3e\r\n  \x3cspan class\x3d"title"\x3e${nls.barrierLayers}\x3c/span\x3e\r\n  \x3ctable style\x3d"width:98%;" cellspacing\x3d"0"\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd style\x3d"width:200px;"\x3e\r\n          \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.pointBarrier}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd style\x3d"width:auto;"\x3e\r\n          \x3cdiv class\x3d"barrierLayersNode" data-dojo-attach-point\x3d"pointLayersNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n\r\n      \x3ctr\x3e\r\n        \x3ctd style\x3d"width:200px;"\x3e\r\n          \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.lineBarrier}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd style\x3d"width:auto;"\x3e\r\n          \x3cdiv class\x3d"barrierLayersNode" data-dojo-attach-point\x3d"polylineLayersNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n\r\n      \x3ctr\x3e\r\n        \x3ctd style\x3d"width:200px;"\x3e\r\n          \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.polygonBarrier}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd style\x3d"width:auto;"\x3e\r\n          \x3cdiv class\x3d"barrierLayersNode" data-dojo-attach-point\x3d"polygonLayersNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/Setting.html":'\x3cdiv style\x3d"width:100%;height:auto;"\x3e\r\n\t\x3cdiv class\x3d"query-setting-content" data-dojo-attach-point\x3d"content"\x3e\r\n\t\t\x3c!-- search tab --\x3e\r\n\t\t\x3cdiv class\x3d"search-section" data-dojo-attach-point\x3d"searchTabNode" onselectstart\x3d"return false;"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"searchConfigNode"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3c!-- route tab --\x3e\r\n\t\t\x3cdiv class\x3d"route-section" data-dojo-attach-point\x3d"routeTabNode" onselectstart\x3d"return false;"\x3e\r\n\t\t\t\x3ctable style\x3d"width:98%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\t\x3ccol width\x3d"200px" /\x3e\r\n\t\t\t\t\t\x3ccol width\x3d"auto" /\x3e\r\n\t\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cspan class\x3d"jimu-ellipsis"\x3e${nls.routeUrl}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd class\x3d"route-td"\x3e\r\n\t\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"routeUrl" data-dojo-type\x3d"jimu/dijit/ServiceURLComboBox" data-dojo-attach-props\x3d"trim:true;hasDownArrow:false;autoComplete:true"\r\n\t\t\t\t\t\t\t id\x3d"routeLayer" name\x3d"routeLayer" style\x3d"width:100%;height:30px;"\x3e\r\n\t\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cspan\x3e${nls.travelModesUrl}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd class\x3d"travelmodes-td"\x3e\r\n\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"travelModesUrl" data-dojo-type\x3d"jimu/dijit/ServiceURLInput"\r\n\t\t\t\t\t\t\t data-dojo-attach-props\x3d"trim:true" type\x3d"text" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cspan\x3e${nls.trafficLayerUrl}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd class\x3d"trafficlayer-td"\x3e\r\n\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"trafficLayerUrl" data-dojo-type\x3d"jimu/dijit/ServiceURLInput"\r\n\t\t\t\t\t\t\t data-dojo-attach-props\x3d"trim:true" type\x3d"text" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\x3ctr style\x3d"display:none;"\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cspan\x3e${nls.barrierLayerUrl}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\r\n\t\t\t\x3cspan class\x3d"title"\x3e${nls.routeOptions}\x3c/span\x3e\r\n\t\t\t\x3ctable style\x3d"width:98%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd style\x3d"width:50%;"\x3e\r\n\t\t\t\t\t\t\t\x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:200px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cspan class\x3d"jimu-ellipsis"\x3e${nls.directionsLanguage}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:auto;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"directionsLanguage" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n\t\t\t\t\t\t\t\t\t\t\t data-dojo-props\x3d\'required:true\' style\x3d"width:220px;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd style\x3d"width:50%;"\x3e\r\n\t\t\t\t\t\t\t\x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:200px"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cspan class\x3d"length-units jimu-ellipsis"\x3e${nls.directionsLengthUnits}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:auto;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"directionsLengthUnits" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:220px;height:30px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriFeet"\x3e${nls.feet}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriKilometers" selected\x3e${nls.kilometers}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriMeters"\x3e${nls.meters}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriMiles"\x3e${nls.miles}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriNauticalMiles"\x3e${nls.nauticalMiles}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriYards"\x3e${nls.yards}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd style\x3d"width:50%;display: none;"\x3e\r\n\t\t\t\t\t\t\t\x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:200px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cspan class\x3d"jimu-ellipsis"\x3e${nls.directionsOutputType}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:auto;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"directionsOutputType" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:220px;height:30px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"standard"\x3e${nls.standard}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"complete" selected\x3e${nls.complete}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"complete-no-events"\x3e${nls.completeNoEvents}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"instructions-only"\x3e${nls.instructionsOnly}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"summary-only"\x3e${nls.summaryOnly}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd style\x3d"width:50%;"\x3e\r\n\t\t\t\t\t\t\t\x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:200px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.impedanceAttribute}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:auto;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"impedanceAttribute" data-dojo-type\x3d"dijit/form/ValidationTextBox" style\x3d"width:220px;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\t\r\n\t\t\x3c!-- preset destinations --\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"presetDestinations"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3c!-- BarrierLayers --\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"barrierLayersNode"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/css/style.css":".jimu-widget-directions-setting{font-size: 14px; margin-bottom: 20px;}.jimu-widget-directions-setting .title{display:inline-block; font-size: 16px; font-weight:bold; margin:10px 0 5px 0px;}.jimu-widget-directions-setting .route-section table \x3e tbody \x3e tr \x3e td{padding:5px 0;}.jimu-widget-directions-setting .route-td{padding-left: 10px;}.jimu-widget-directions-setting .jimu-ellipsis{white-space: normal;}.jimu-rtl .jimu-widget-directions-setting .route-td{padding-left: 0; padding-right: 10px;}.jimu-widget-directions-setting .locator-td{padding-left: 10px;}.jimu-rtl .jimu-widget-directions-setting .locator-td{padding-left: 0; padding-right: 10px;}.jimu-widget-directions-setting .travelmodes-td{padding-left: 10px;}.jimu-rtl .jimu-widget-directions-setting .travelmodes-td{padding-left: 0; padding-right: 10px;}.jimu-widget-directions-setting .trafficlayer-td{padding-left: 10px;}.jimu-rtl .jimu-widget-directions-setting .trafficlayer-td{padding-left: 0; padding-right: 10px;}.jimu-widget-directions-setting .auto-complete-td span{margin-left: 10px;}.jimu-rtl .jimu-widget-directions-setting .auto-complete-td span{margin-left: 0px; margin-right: 10px;}.jimu-widget-directions-setting .searchResults.arcgisSearch{position: relative;}.jimu-widget-directions-setting .arcgisSearch{width: 220px;}.jimu-widget-directions-setting .arcgisSearch .searchMenu {position: absolute;}.jimu-widget-directions-setting .arcgisSearch .searchMenu.searchResultsMenu{width: 220px !important;}.jimu-widget-directions-setting .arcgisSearch .showNoResults .noResultsMenu{height: 122px;}.jimu-widget-directions-setting .arcgisSearch .hasValue.showNoResults .noResultsMenu{display: block !important;}.jimu-widget-directions-setting .arcgisSearch .searchGroup .searchInput{width:168px; padding: 6px; border-radius: 0; border-left: 6px green solid; overflow: hidden; text-overflow:ellipsis; white-space: nowrap;}.jimu-widget-directions-setting .end-search .arcgisSearch .searchGroup .searchInput{border-left: 6px red solid;}.jimu-rtl .jimu-widget-directions-setting .arcgisSearch .searchGroup .searchInput{border-left: none; border-right: 6px green solid;}.jimu-rtl .jimu-widget-directions-setting .end-search .arcgisSearch .searchGroup .searchInput{border-left: none; border-right: 6px red solid;}.jimu-widget-directions-setting .arcgisSearch .searchBtn{border-radius: 0; border-left: 0; padding: 6px;}.jimu-widget-directions-setting .searchGroup .searchExpandContainer .searchBtn.searchToggle{display: none;}.jimu-rtl .jimu-widget-directions-setting .arcgisSearch .searchBtn{border-right: 0; border-left: 1px solid #57585A;}.jimu-widget-directions-setting .arcgisSearch .searchClear{display: none;}.jimu-widget-directions-setting .hide{display: none;}.jimu-widget-directions-setting .preset-des-error{color:red;}.jimu-widget-directions-setting .barrierLayersNode{padding: 5px 0;}.jimu-widget-directions-setting .barrierLayersNode \x3e table{background-color: transparent; width: 100%;}.search-config .group-label{display: inline-block; margin-bottom: 10px; font-weight: bold;}.search-config .instruction{font-size: 12px;}.search-config .dropdown-button {margin: 8px 0; display: inline-block; position: relative; padding-left: 16px; color: #518dca; background: url(images/add_icon.png) no-repeat left; cursor: pointer;}.jimu-rtl .search-config .dropdown-button{padding-left: 0; padding-right: 16px; background-position: right;}.search-config .dropdown-button .dropdown-menu{position: absolute; display: none; list-style-type: none; top: 16px; left: 0; margin: 0; padding: 0; background: #fafafa; color: #7989a0; z-index: 999;}.jimu-rtl .search-config .dropdown-button .dropdown-menu{right: 0; left: auto;}.search-config .dropdown-button:hover .dropdown-menu{display: inline-block;}.search-config .dropdown-menu .dropdown-item{white-space: nowrap; height: 30px; padding: 0 25px; line-height: 30px;}.search-config .dropdown-menu .dropdown-item:hover{background: #edf2f5; color: #15a4fa;}.search-config .sources{height: 366px;}.search-config .source-list{width: 270px; height: 100%;}.search-config .source-setting{width: 660px; position: relative; overflow: auto; padding-right: 5px;}.search-config .source-setting .source-tips{display: none; font-size: 12px; color: #999;}.search-config .source-setting .source-tips-show{display: block;}.search-config .source-table,.search-config .general-setting-table{width: 100%;}.search-config .search-fields-selector {display: inline-block; margin: 6px 0; width: 18px; height: 18px; background: url(images/selector.png) no-repeat center;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row td,.search-config .jimu-widget-search-locator-source-setting .source-details-section .local-search-row td{padding-bottom: 35px; position: relative;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .local-search-row .first{padding-left: 20px;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row a{text-decoration: none;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row .esri-icon-question{color: #485566; font-style: normal;}.jimu-rtl .search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row .esri-icon-question{transform: rotateY(180deg); display: inline-block;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row .example,.search-config .jimu-widget-search-locator-source-setting .source-details-section .local-search-row .example{position: absolute; top: 35px; left: 0; font-size: 12px; color: #999;}.jimu-rtl .search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row .example{left: auto; right: 0;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .hide-country-code-row,.search-config .jimu-widget-search-locator-source-setting .hide-local-search-table {display: none;}.search-config .source-url-section .source-table \x3e tbody \x3e tr:first-child \x3e td {padding-bottom: 5px;}.search-config .source-table \x3e tbody \x3e tr \x3e td{padding-bottom: 10px;}.search-config .source-table \x3e tbody \x3e tr \x3e .first{width: auto; text-align: left; padding-right: 10px; white-space: nowrap;}.search-config .source-table \x3e tbody \x3e tr \x3e .second{width:550px;}.search-config .source-table \x3e tbody \x3e tr \x3e .third{width: 70px; padding-left: 10px;}.jimu-rtl .search-config .source-table \x3e tbody \x3e tr \x3e .first{padding-left: 10px; padding-right: 0;}.jimu-rtl .search-config .source-table \x3e tbody \x3e tr \x3e .first{text-align: right; padding-left: 10px; padding-right: auto;}.jimu-rtl .search-config .source-table \x3e tbody \x3e tr \x3e .third{padding-left: 0; padding-right: 10px;}.jimu-widget-query-source-setting .source-url-section .source-table \x3e tbody \x3e tr \x3e .second {width: 455px;}.search-config .source-table .jimu-btn{padding: 0; line-height: 30px; width: 60px;}.search-config .source-table \x3e tbody \x3e tr \x3e .second .tip{font-size: 12px; color: #999; width: 100%; display: inline-block;}.search-config .source-table .error-message{color: #e84b4b !important;}.search-config .jimu-basic-service-chooser {width: auto;}.search-config .override-geocode-service-chooser-content {width: 580px !important; min-height: 150px !important;}.search-config .override-geocode-service-chooser-content .service-browser-container{display: none;}.direction-setting.jimu-widget-search-query-source-setting-fields .fields-checkbox{width: 167px; margin-bottom: 20px; color: #596679; font-size: 14px; margin-left: 30px;}.direction-setting.jimu-widget-search-query-source-setting-fields .fields-checkbox .label{width: 140px;}.jimu-rtl .direction-setting.jimu-widget-search-query-source-setting-fields .fields-checkbox{margin-right: 30px; margin-left: auto;}",
"*now":function(p){p(['dojo/i18n!*preload*widgets/Directions/setting/nls/Setting*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/on dojo/_base/html dojo/_base/config dojo/Deferred dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/utils jimu/portalUtils ./PresetDestinations ./SearchConfig/SearchConfig jimu/dijit/Message ../searchUtil ./BarrierLayers jimu/dijit/TabContainer jimu/dijit/CheckBox jimu/dijit/ServiceURLComboBox jimu/dijit/ServiceURLInput dijit/form/NumberSpinner dijit/form/ValidationTextBox dijit/form/Select".split(" "),function(p,h,k,r,t,g,d,c,q,v,w,a,e,u,y,
l){return p([c,d],{baseClass:"jimu-widget-directions-setting",_ROUTE_WORLD:"Route_World",_serviceUrlInputInvalidClass:"jimu-serviceurl-input-invalid",_routeTaskUrl:"http://route.arcgis.com/arcgis/rest/services/World/Route/NAServer/",_locatorUrl:"http://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",_travelModesUrl:"http://logistics.arcgis.com/arcgis/rest/services/World/Utilities/GPServer",_trafficLayerUrl:"http://traffic.arcgis.com/arcgis/rest/services/World/Traffic/MapServer",postMixInProperties:function(){this.nls.complete||
(this.nls.complete="Complete");this.nls.completeNoEvents||(this.nls.completeNoEvents="Complete No Events");this.nls.instructionsOnly||(this.nls.instructionsOnly="Instructions Only");this.nls.standard||(this.nls.standard="Standard");this.nls.summaryOnly||(this.nls.summaryOnly="Summary Only");this.nls.travelModesUrl||(this.nls.travelModesUrl="Travel Modes URL");this.nls.example||(this.nls.example=this.nls.optional+" "+window.jimuNls.basicServiceChooser.example+" : ")},postCreate:function(){this.inherited(arguments);
this.portal=v.getPortal(this.appConfig.portalUrl);this.routeUrl.setProcessFunction(h.hitch(this,function(a){var c=!1;a&&a.data&&(c="esriNAServerRouteLayer"===a.data.layerType);if(!0===c)return c;this._setRouteUrl(a);a=this._getHandledUrlFromServiceUrlInput(this.routeUrl);return/\/rest\/services\/.+\/NAServer/i.test(a)}));this.travelModesUrl.setProcessFunction(h.hitch(this,function(){var a=this._getHandledUrlFromServiceUrlInput(this.travelModesUrl);return/\/rest\/services\/.+\/GPServer/gi.test(a)}),
h.hitch(this,function(){this.travelModesUrl.get("value")||r.removeClass(this.travelModesUrl.domNode,this._serviceUrlInputInvalidClass)}));this.trafficLayerUrl.setProcessFunction(h.hitch(this,function(){var a=this._getHandledUrlFromServiceUrlInput(this.trafficLayerUrl);return/\/rest\/services\/.+\/MapServer/gi.test(a)}),h.hitch(this,function(){this.trafficLayerUrl.get("value")||r.removeClass(this.trafficLayerUrl.domNode,this._serviceUrlInputInvalidClass)}));this.portal.loadSelfInfo().then(h.hitch(this,
function(a){var c=this._getRouteUrlFromPortalSelf(a);c&&this.routeUrl.set("placeHolder",c);(c=this._getTravelModesUrlFromPortalSelf(a))?this.travelModesUrl.set("placeHolder",this.nls.example+c):this.travelModesUrl.set("placeHolder",this.nls.example+this._travelModesUrl);(a=this._getTrafficLayerUrlFromPortalSelf(a))?this.trafficLayerUrl.set("placeHolder",this.nls.example+a):this.trafficLayerUrl.set("placeHolder",this.nls.example+this._trafficLayerUrl)}));this.barrierLayers=new y({nls:this.nls,map:this.map,
barrierLayers:this.config.barrierLayers},this.barrierLayersNode);this.barrierLayers.startup();this.presetDestinations=new w({nls:this.nls,map:this.map,defaultLocations:this.config.defaultLocations||[]},this.presetDestinations);this.presetDestinations.startup()},_getHandledUrlFromServiceUrlInput:function(a){a=a.get("value");return q.removeSuffixSlashes(a)},startup:function(){this.inherited(arguments);this.tabContainer=new l({tabs:[{title:this.nls.searchTabTitle,content:this.searchTabNode},{title:this.nls.routeTabTitle,
content:this.routeTabNode}],isNested:!0},this.content);this.tabContainer.startup();this.own(k(this.tabContainer,"tabChanged",h.hitch(this,function(a){a===this.nls.routeTabTitle&&this._setPresetDestinationsSources()})));this.searchConfig=new a({nls:this.nls,map:this.map,appConfig:this.appConfig,config:this.config},this.searchConfigNode);this.searchConfig.startup();this.own(k(this.searchConfig,"isConfigValid",h.hitch(this,function(a){"true"===a?this.settingPagePopup.enableButton(0):this.settingPagePopup.disableButton(0)})));
this.setConfig(this.config)},destroy:function(){this.directionsLengthUnits&&this.directionsLengthUnits.destroy&&(this.directionsLengthUnits.closeDropDown(),this.directionsLengthUnits.destroy());this.barrierLayers&&this.barrierLayers.destroy&&this.barrierLayers.destroy();this.inherited(arguments)},setConfig:function(a){if(this.config=a)(a=this.config.routeOptions)&&"object"===typeof a&&(this.directionsLanguage.set("value",a.directionsLanguage||t.locale||"en_us"),this.directionsLengthUnits.set("value",
a.directionsLengthUnits),this.impedanceAttribute.set("value",a.impedanceAttribute)),this._getRouteTaskUrl().then(h.hitch(this,function(a){this.routeUrl.set("value",a)})),this.config.travelModesUrl&&this.travelModesUrl.set("value",this.config.travelModesUrl),this.config.trafficLayerUrl&&this.trafficLayerUrl.set("value",this.config.trafficLayerUrl),this.config.barrierLayers&&this.barrierLayers.setValue(this.config.barrierLayers)},_getRouteTaskUrl:function(){var a=new g;this.config.routeTaskUrl?a.resolve(this.config.routeTaskUrl):
this.portal.loadSelfInfo().then(h.hitch(this,function(c){(c=this._getRouteUrlFromPortalSelf(c))?a.resolve(c):a.resolve(this._routeTaskUrl)}),h.hitch(this,function(c){console.error(c);a.resolve(this._routeTaskUrl)}));return a},_suffixWithSlant:function(a,c){return a=this._endsWith(a,"/")?a+c:a+("/"+c)},_endsWith:function(a,c){return-1!==a.indexOf(c,a.length-c.length)},_getRouteUrlFromPortalSelf:function(a){var c="";a&&a.helperServices&&(a=a.helperServices.route)&&a.url&&(c=a.url);return c},_getTravelModesUrlFromPortalSelf:function(a){var c=
"";a&&a.helperServices&&(a=a.helperServices.routingUtilities)&&a.url&&(c=a.url);return c},_getTrafficLayerUrlFromPortalSelf:function(a){var c="";a&&a.helperServices&&(a=a.helperServices.traffic)&&a.url&&(c=a.url);return c},getConfig:function(){if("valid"!==this.routeUrl.getStatus())return this._showValidationErrorTip(this.routeUrl),this._showParametersTip(),!1;if(this.travelModesUrl.get("value")&&"valid"!==this.travelModesUrl.getStatus())return this._showValidationErrorTip(this.travelModesUrl),this._showParametersTip(),
!1;if(this.trafficLayerUrl.get("value")&&"valid"!==this.trafficLayerUrl.getStatus())return this._showValidationErrorTip(this.trafficLayerUrl),this._showParametersTip(),!1;if(!this.directionsLanguage.validate())return this._showValidationErrorTip(this.directionsLanguage),this._showParametersTip(),!1;if(!this.barrierLayers.validate())return this._showValidationErrorTip(this.barrierLayers),this._showParametersTip(),!1;if(this.presetDestinations&&!1===this.presetDestinations.validate()||!1===this.searchConfig.validate())return!1;
var a=this.searchConfig.getConfig();this.config={routeTaskUrl:this._getHandledUrlFromServiceUrlInput(this.routeUrl),travelModesUrl:this._getHandledUrlFromServiceUrlInput(this.travelModesUrl),trafficLayerUrl:this._getHandledUrlFromServiceUrlInput(this.trafficLayerUrl),routeOptions:{directionsLanguage:this.directionsLanguage.get("value"),directionsLengthUnits:this.directionsLengthUnits.get("value"),impedanceAttribute:this.impedanceAttribute.get("value")},searchOptions:a,defaultLocations:this.presetDestinations.getValue(),
barrierLayers:this.barrierLayers.getValue()};u.version.upgradeConfig(this.config);return this.config},_showValidationErrorTip:function(a){!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),setTimeout(h.hitch(this,function(){a.focusNode.blur()}),100))},_showParametersTip:function(){new e({message:this.nls.parametersTip})},_setRouteUrl:function(a){if(a&&a.data&&a.data.routeLayers){for(var c=this.routeUrl.getValue(),d=!1,e=0,b=a.data.routeLayers.length;e<b;e++){var f=a.data.routeLayers[e],g=
{id:f,name:this._suffixWithSlant(c,f),value:this._suffixWithSlant(c,f)};f===this._ROUTE_WORLD&&(d=!0);this.routeUrl.store.put(g)}d&&this.routeUrl.setValue(this._suffixWithSlant(c,this._ROUTE_WORLD))}},_setPresetDestinationsSources:function(){var a=this.searchConfig.getConfig();this.presetDestinations.setSources(a)}})});