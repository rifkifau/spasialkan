// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/PublicNotification/setting/convert":function(){define(["dojo/_base/array"],function(d){return{unitCodesToLabels:function(g,k){var f=[];d.forEach(k,function(l){switch(l){case "CENTIMETERS":f.push(g.centimeters);break;case "INCHES":f.push(g.inches);break;case "FEET":f.push(g.feet);break;case "YARDS":f.push(g.yards);break;case "METERS":f.push(g.meters);break;case "KILOMETERS":f.push(g.kilometers);break;case "MILES":f.push(g.miles);break;default:f.push(l)}});return f},labelsToUnitCodes:function(g,
k){var f=[];d.forEach(k,function(l){switch(l){case g.centimeters:f.push("CENTIMETERS");break;case g.inches:f.push("INCHES");break;case g.feet:f.push("FEET");break;case g.yards:f.push("YARDS");break;case g.meters:f.push("METERS");break;case g.kilometers:f.push("KILOMETERS");break;case g.miles:f.push("MILES");break;default:f.push(l)}});return f},toolCodesToLabels:function(g,k){var f=[];d.forEach(k,function(l){switch(l){case "POINT":f.push(g.drawingToolsPoint);break;case "LINE":f.push(g.drawingToolsLine);
break;case "POLYLINE":f.push(g.drawingToolsPolyline);break;case "POLYGON":f.push(g.drawingToolsPolygon);break;case "FREEHAND_POLYGON":f.push(g.drawingToolsFreehandPolygon);break;default:f.push(l)}});return f},labelsToToolCodes:function(g,k){var f=[];d.forEach(k,function(l){switch(l){case g.drawingToolsPoint:f.push("POINT");break;case g.drawingToolsLine:f.push("LINE");break;case g.drawingToolsPolyline:f.push("POLYLINE");break;case g.drawingToolsPolygon:f.push("POLYGON");break;case g.drawingToolsFreehandPolygon:f.push("FREEHAND_POLYGON");
break;default:f.push(l)}});return f}}})},"widgets/PublicNotification/setting/SettingAddresseesBlock":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom-class ./settingComponents ./SettingCheckbox ./SettingContainer ./SettingObject ./SettingOptionsTable ./SettingStaticText".split(" "),function(d,g,k,f,l,b,a,c,h,n){return g(c,{_inputControl:null,_detailsDiv:null,_detailsTitle:null,_detailsCheckbox:null,_iCurrentDetails:-1,_menuItems:[],constructor:function(c,e,f){this.nls=
e;this._inputControl=new h(null,"half-width","",e.propertyLabels.name,null,e.hints.selectionListOfOptionsToDisplay,k.hitch(this,this._onRowSelected));this._detailsTitle=new n;this._detailsCheckbox=new b(null,e.propertyLabels.useRelatedRecords,"",k.hitch(this,this._checkboxChanged));this._detailsDiv=l.container("half-width optionsTableHeaderHeight","majorTrailingVertGap",[this._detailsTitle.div(),this._detailsCheckbox.div()]);this._mainDiv=(new a(null,"flexbox "+(f||""),"majorTrailingHorizGap",e.groupingLabels.addressSources,
"full-width",[this._inputControl,this._detailsDiv])).div()},setConfig:function(){var a,c;a=[this._config[0]];c=this._config.slice(1);this._menuItems=d.map(c,function(a){return a.name});this._menuItems=0<this._menuItems.length?[].concat(a,this._menuItems):[a];this._inputControl.setValue(this._menuItems);this._setDetails(0)},getConfig:function(a,c){var b=this._config.slice(1),e;this._menuItems=this._inputControl.getValue();e=[this._menuItems[0]];d.forEach(this._menuItems.slice(1),function(a){d.some(b,
function(c){a===c.name&&e.push(c)})});this._config=e;0>this._config[0].indexOf("1")&&c.push(this.nls.problems.noAddresseeLayers)},_setDetails:function(a){var c=this._config.length-1;0<=a&&a<c&&"boolean"===typeof this._config[a+1].useRelatedRecords?(f.remove(this._detailsDiv,"hidden"),this._detailsTitle.setValue(this._config[a+1].name),this._iCurrentDetails=a,this._detailsCheckbox.setValue(this._config[a+1].useRelatedRecords)):(f.add(this._detailsDiv,"hidden"),this._iCurrentDetails=-1)},_onRowSelected:function(a){var c=
a.innerText.trim();d.some(this._menuItems,k.hitch(this,function(a,b){return a===c?(this._setDetails(b-1),!0):!1}))},_checkboxChanged:function(a){0<=this._iCurrentDetails&&(this._config[this._iCurrentDetails+1].useRelatedRecords=a)}})})},"widgets/PublicNotification/setting/settingComponents":function(){define("dojo/_base/array dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-style dojo/on jimu/dijit/CheckBox dijit/form/NumberTextBox dijit/form/Select dijit/form/TextBox ../generalUtils ./SettingSimpleTable".split(" "),
function(d,g,k,f,l,b,a,c,h,n,p,e){var q={container:function(a,c,b){var m,e=q._createDiv(a||"");Array.isArray(b)&&0<b.length&&(m=b.length-1,d.forEach(b,function(a,b){f.place(a,e);b<m&&c&&k.add(a,c)}));return e},fieldsetContainer:function(a,c,b,e,h){var m,v=q._createDiv(c||""),t;c=f.create("fieldset",{"class":"fieldset"},v);a&&f.create("legend",{"class":"fieldsetLegend",innerHTML:a},c);t=q._createDiv(("fieldsetMainContainer "+(b||"")).trim(),c);Array.isArray(h)&&0<h.length&&(m=h.length-1,d.forEach(h,
function(a,c){f.place(a,t);c<m&&e&&k.add(a,e)}));return v},addTextButtonDropdownCtl:function(a,c,b){var e,m;a=q._createDiv(("addTextButton-button "+(a||"")).trim());e=q._createDiv("button",a);q._createSpan("button-text",e).innerHTML=c;c=m=f.create("ul",{"class":"addTextButton-menu"},a);d.forEach(b,function(a){f.create("li",{"class":"addTextButton-item",innerHTML:a},m)});return{div:a,ctl:c}},checkboxCtl:function(c,b,e){var m;c=q._createDiv(c);m=new a({style:"margin-top: 3px;"});m.setLabel(e);m.setValue(b);
f.place(m.domNode,c);m.startup();return{div:c,ctl:m}},dropdownCtl:function(a,c,b){a=q._createDiv(a);return{div:a,ctl:q.dropdown(a,c,b)}},dropdown:function(a,c,b){c=new h({options:b,"class":c});f.place(c.domNode,a);c.startup();return c},iconButton:function(a,c){a=q._createDiv(a);l.set(a,"display","inline-block");a.title=c;return a},numberInputCtl:function(a,b,e){a=q._createDiv(a);b={style:"width: 100%;",required:!0,placeHolder:b};e&&(b.constraints=e);e=new c(b);e.startup();f.place(e.domNode,a);return{div:a,
ctl:e}},tableCtl:function(a,c,b){a=q._createDiv(a);c=new e(c);c.placeAt(a);c.startup();Array.isArray(b)&&0<b.length&&c.addRows(b);return{div:a,ctl:c}},text:function(a,c){a=q._createDiv(a||"");a.innerHTML=p.sanitizeNoTags(c||"");return a},textButton:function(a,c,b){a=q._createDiv(("jimu-btn "+(a||"")).trim());a.innerHTML=c;b&&(a.title=b);return a},textButtonCtl:function(a,c,b){var e=q._createDiv(("jimu-btn "+(a||"")).trim());e.innerHTML=c;b&&(e.title=b);return{div:function(){return e},ctl:e}},textInputCtl:function(a,
c,e){var h,m;a=q._createDiv(a||"");h={style:"width:100%;"};c&&(h.placeholder=c);m=new n(h);m.setDisabled("undefined"!==typeof e?e:!1);m.startup();var l=b.pausable(m,"change",g.hitch(m,function(a){l.pause();m.set("value",p.sanitizeNoTags(a));l.resume()}));m.own(l);f.place(m.domNode,a);return{div:a,ctl:m}},_createSpan:function(a,c){return q._createSpanDiv(!0,a,c)},_createDiv:function(a,c){return q._createSpanDiv(!1,a,c)},_createSpanDiv:function(a,c,b){var e={};c&&(e["class"]=c);a=f.create(a?"span":
"div",e);b&&f.place(a,b);return a}};return q})},"widgets/PublicNotification/generalUtils":function(){define(["jimu/utils"],function(d){return{sanitizeNoTags:function(g){if(!g)return g;var k;k=d.sanitizeHTML(g);g=/<(?:!--(?:(?:-*[^->])*--+|-?)|script\b(?:[^"'>]|"[^"]*"|'[^']*')*>[\s\S]*?<\/script\s*|style\b(?:[^"'>]|"[^"]*"|'[^']*')*>[\s\S]*?<\/style\s*|\/?[a-z](?:[^"'>]|"[^"]*"|'[^']*')*)>/gi;var f;do f=k,k=k.replace(g,"");while(k!==f);return k=k.replace(/</g,"\x26lt;").trim()}}})},"widgets/PublicNotification/setting/SettingSimpleTable":function(){define(["dojo/_base/declare",
"dojo/_base/html","jimu/dijit/SimpleTable"],function(d,g,k){return d(k,{_onRowMoved:null,constructor:function(f){},deleteRow:function(f){var l,b;f&&(l=this.getRowData(f),b=f.rowIndex,g.destroy(f),this.updateUI(),this._onDeleteRow(f,l,b))},_onDeleteRow:function(f,l,b){this.emit("row-delete",f,l,b)}})})},"widgets/PublicNotification/setting/SettingCheckbox":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/on","./settingComponents","./SettingObject"],function(d,g,k,f,l){return d(l,{_inputControl:null,
constructor:function(b,a,c,h){b=[];a=f.checkboxCtl("inline-block",!1,a);b.push(a.div);this._inputControl=a.ctl;h&&this.own(k(this._inputControl,"change",g.hitch(this,h)));c&&b.push(f.container("variable-width","minorTrailingVertGap",[f.text("hint",c)]));this._mainDiv=f.container("full-width flexbox","minorTrailingHorizGap",b)},setValue:function(b){this._inputControl&&this._inputControl.setValue(b)},getValue:function(){if(this._inputControl)return this._inputControl.getValue()},setConfig:function(){this._inputControl&&
this._config&&this.setValue(this._config)},getConfig:function(b,a){this._inputControl&&(this._config=this.getValue())}})})},"widgets/PublicNotification/setting/SettingObject":function(){define(["dojo/_base/declare","dijit/Destroyable"],function(d,g){return d(g,{"-chains-":{setConfig:"after",getConfig:"before"},_name:null,_config:null,_mainDiv:null,constructor:function(d){this._name=d},div:function(){return this._mainDiv},setConfig:function(d){this._name&&(this._config=d[this._name])},getConfig:function(d,
f){this._name&&(d[this._name]=this._config)}})})},"widgets/PublicNotification/setting/SettingContainer":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","./settingComponents","./SettingObject"],function(d,g,k,f,l){return g(l,{_contents:[],constructor:function(b,a,c,h,n,l){Array.isArray(h)?(this._contents=h,this._mainDiv=f.container(a||"",c,this._getContentDivs(this._contents))):(this._contents=l,this._mainDiv=f.fieldsetContainer(h,n,a||"",c,this._getContentDivs(this._contents)))},
setConfig:function(b){d.forEach(this._contents,k.hitch(this,function(a){a.setConfig(this._config||b)}))},getConfig:function(b,a){this._name&&(this._config={});d.forEach(this._contents,k.hitch(this,function(c){c.getConfig(this._config||b,a)}))},_getContentDivs:function(b){return d.map(b,function(a){return a.div?a.div():a})}})})},"widgets/PublicNotification/setting/SettingOptionsTable":function(){define("dojo/_base/array dojo/_base/declare dojo/on dojo/query ./settingComponents ./SettingObject".split(" "),
function(d,g,k,f,l,b){return g(b,{_inputControl:null,_isFlagged:!0,constructor:function(a,c,b,n,f,e,d,g,r){a=[];n=[{name:"selected",title:"",width:"32px",type:"checkbox",editable:!1},{name:"item",title:n,width:"auto",type:"text",editable:!1},{name:"actions",title:"",width:"40px",type:"actions",actions:["up","down"]}];"function"===typeof g&&(this._isFlagged=!1,n=n.slice(1),n[1].width="60px",n[1].actions.push("delete"));b=l.tableCtl(b,{autoHeight:!0,selectable:"function"===typeof d,fields:n},f);a.push(b.div);
this._inputControl=b.ctl;d&&this.own(k(this._inputControl,"row-select",d));g&&this.own(k(this._inputControl,"row-delete",g));r&&(this.own(k(this._inputControl,"row-up",function(a){r(a,!0)})),this.own(k(this._inputControl,"row-down",function(a){r(a,!1)})));e&&a.push(l.text("hint",e));this._mainDiv=l.container(c||"","minorTrailingVertGap",a)},addRowToTable:function(a){this._inputControl&&this._inputControl.addRow(a)},selectTableRow:function(a){(a=this._getRowTR(a))&&this._inputControl.selectRow(a)},
renameTableRow:function(a,c){(a=this._getRowTR(a))&&this._inputControl.editRow(a,{item:c})},setValue:function(a){this._inputControl&&(this._inputControl.addRows(this._isFlagged?this._convertTableConfigToTableLines(a):a),this.selectTableRow(0))},getValue:function(){var a;return this._inputControl?(a=this._inputControl.getData(),this._isFlagged?this._convertTableLinesToTableConfig(a):a):null},setConfig:function(){this._inputControl&&this._config&&this.setValue(this._config)},getConfig:function(a,c){this._inputControl&&
(this._config=this.getValue())},_getRowTR:function(a){var c;return this._inputControl&&0<=a?(c=f(".simple-table-row",this._inputControl.domNode),a<c.length?c[a]:null):null},_convertTableConfigToTableLines:function(a){var c=a[0];return d.map(a.slice(1),function(a,b){return{item:a,selected:"1"===c[b]}})},_convertTableLinesToTableConfig:function(a){var c="";a=d.map(a,function(a){c+=a.selected?"1":"0";return a.item});return a=[c].concat(a)}})})},"widgets/PublicNotification/setting/SettingStaticText":function(){define(["dojo/_base/declare",
"jimu/utils","./settingComponents","./SettingObject"],function(d,g,k,f){return d(f,{constructor:function(f,b,a){this._name="";this._mainDiv=k.text(b,a)},setValue:function(f){this._mainDiv.innerHTML=g.sanitizeHTML(f||"")},getValue:function(){return this._mainDiv.innerHTML}})})},"widgets/PublicNotification/setting/SettingBufferBlock":function(){define("dojo/_base/declare dojo/_base/lang ./settingComponents ./SettingInputWithDropdownLabeled ./SettingObject ./SettingOptionsTable ./SettingStaticText".split(" "),
function(d,g,k,f,l,b,a){return d(l,{_inputControlDistance:null,_inputControlTable:null,_defaultConfig:{bufferDistance:100,bufferUnits:"FEET",bufferUnitsMenu:"10100 FEET YARDS METERS KILOMETERS MILES".split(" ")},constructor:function(c,h,n,l,e,d,g,r,m){c=[];this._defaultConfig=d;this._inputControlDistance=new f(null,!0,"full-width",l,e,g,r,m,null,"","",this._createLargeDistanceUnitsDropdownItemsList(),{min:0});c.push(this._inputControlDistance.div());this._inputControlTable=new b("bufferUnitsMenu",
"details-value","",h.propertyLabels.units,null,h.hints.selectionListOfOptionsToDisplay);c.push(k.container("full-width flexbox","minorTrailingHorizGap",[(new a(null,"details-label static-text",h.propertyLabels.bufferUnits)).div(),this._inputControlTable.div()]));this._mainDiv=k.container(n||"","majorTrailingVertGap",c)},setValue:function(a){this._inputControl&&this._inputControl.set("value",a)},setConfig:function(){g.mixin({},this._defaultConfig,this._config);this._inputControlDistance&&this._inputControlTable&&
(this._inputControlDistance.setValue(this._config.bufferDistance),this._inputControlDistance.setModifier(this._config.bufferUnits),this._inputControlTable.setConfig(this._config))},getConfig:function(a,b){this._inputControlDistance&&this._inputControlTable&&(this._config.bufferDistance=this._inputControlDistance.getValue(),this._config.bufferUnits=this._inputControlDistance.getModifier(),this._inputControlTable.getConfig(this._config))},_createLargeDistanceUnitsDropdownItemsList:function(){return[{label:jimuNls.units.feet,
value:"FEET"},{label:jimuNls.units.yards,value:"YARDS"},{label:jimuNls.units.meters,value:"METERS"},{label:jimuNls.units.kilometers,value:"KILOMETERS"},{label:jimuNls.units.miles,value:"MILES"}]}})})},"widgets/PublicNotification/setting/SettingInputWithDropdownLabeled":function(){define(["dojo/_base/declare","./SettingDropdown","./SettingInputLabeled","./SettingObject"],function(d,g,k,f){return d(f,{_inputControl:null,_inputModifier:null,constructor:function(f,b,a,c,h,n,d,e,q,t,r,m,u){this._inputModifier=
new g(null,t,r,m);this._inputControl=new k(null,b,a,c,h,n,d,e,q,this._inputModifier,u);this._mainDiv=this._inputControl.div()},setValue:function(f){this._inputControl&&this._inputControl.setValue(f)},setModifier:function(f){this._inputModifier&&this._inputModifier.setValue(f)},getValue:function(){return this._inputControl?this._inputControl.getValue():null},getModifier:function(){return this._inputModifier?this._inputModifier.getValue():null},setConfig:function(){this._inputControl&&this._config&&
this.setValue(this._config)},getConfig:function(f,b){this._inputControl&&(this._config=this.getValue())}})})},"widgets/PublicNotification/setting/SettingDropdown":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/on","./settingComponents","./SettingObject"],function(d,g,k,f,l){return d(l,{_inputControl:null,constructor:function(b,a,c,h){b=f.dropdownCtl(a,c,h);this._mainDiv=b.div;this._inputControl=b.ctl;this.own(k(this._inputControl,"change",g.hitch(this,this._onChange)))},setValue:function(b){this._inputControl&&
this._inputControl.set("value",b)},getValue:function(){return this._inputControl?this._inputControl.get("value"):null},setConfig:function(){this._inputControl&&this._config&&this.setValue(this._config)},getConfig:function(b,a){this._inputControl&&(this._config=this.getValue())},_onChange:function(b){this._config=b}})})},"widgets/PublicNotification/setting/SettingInputLabeled":function(){define(["dojo/_base/declare","./settingComponents","./SettingObject"],function(d,g,k){return d(k,{_inputControl:null,
constructor:function(f,d,b,a,c,h,n,p,e,q,k,r){f=[];var m=[];e||q?(e&&("string"===typeof e?m.push(g.text("static-text",e)):m.push(e.div())),d=d?g.numberInputCtl("variable-width inline-block",n,k):g.textInputCtl("variable-width inline-block",n,r),m.push(d.div),this._inputControl=d.ctl,q&&("string"===typeof q?m.push(g.text("static-text",q)):m.push(q.div())),f.push(g.container("full-width flexbox","minorTrailingHorizGap",m))):(d=d?g.numberInputCtl("full-width inline-block",n,k):g.textInputCtl("full-width inline-block",
n,r),f.push(d.div),this._inputControl=d.ctl);p&&f.push(g.text("hint",p));this._mainDiv=g.container("flexbox "+(b||""),"minorTrailingHorizGap",[g.container("inline-block "+(a?a:""),"",[g.text("static-text",h)]),g.container("inline-block "+(c?c:""),"minorTrailingVertGap",f)])},setValue:function(f){this._inputControl&&this._inputControl.set("value",f)},getValue:function(){return this._inputControl?this._inputControl.get("value"):null},setConfig:function(){this._inputControl&&this._config&&this.setValue(this._config)},
getConfig:function(f,d){this._inputControl&&(this._config=this.getValue())}})})},"widgets/PublicNotification/setting/SettingCheckboxLabeled":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/on","./settingComponents","./SettingObject"],function(d,g,k,f,l){return d(l,{_inputControl:null,constructor:function(b,a,c,h,d,l,e){b=[];d=f.checkboxCtl("inline-block",!1,d);b.push(d.div);this._inputControl=d.ctl;e&&this.own(k(this._inputControl,"change",g.hitch(this,e)));l&&b.push(f.text("hint",
l));this._mainDiv=f.container("flexbox "+(a||""),"minorTrailingHorizGap",[f.container("inline-block "+(c?c:""),"",[]),f.container("inline-block "+(h?h:""),"minorTrailingVertGap",b)])},setValue:function(b){this._inputControl&&this._inputControl.setValue(b)},getValue:function(){if(this._inputControl)return this._inputControl.getValue()},setConfig:function(){this._inputControl&&this._config&&this.setValue(this._config)},getConfig:function(b,a){this._inputControl&&(this._config=this.getValue())}})})},
"widgets/PublicNotification/setting/SettingLabelFormats":function(){define(["dojo/_base/array","dojo/_base/declare","./SettingContainer","./SettingObject","./SettingOptionsTable"],function(d,g,k,f,l){return g(f,{_inputControl:null,constructor:function(b,a,c){this.nls=a;this._inputControl=new l(null,"half-width","",a.propertyLabels.description,null,a.hints.selectionListOfOptionsToDisplay);this._mainDiv=(new k(null,"flexbox "+(c||""),"majorTrailingHorizGap",a.groupingLabels.labelFormats,"full-width",
[this._inputControl])).div()},setConfig:function(){var b,a;b=[this._config[0]];a=this._config.slice(1);a=d.map(a,function(a){return a.name});a=0<a.length?[].concat(b,a):[b];this._inputControl.setValue(a)},getConfig:function(b,a){var c=this._config.slice(1),h;b=this._inputControl.getValue();h=[b[0]];d.forEach(b.slice(1),function(a){d.some(c,function(c){a===c.name&&h.push(c)})});this._config=h;0>this._config[0].indexOf("1")&&a.push(this.nls.problems.noNotificationLabelFormats)}})})},"widgets/PublicNotification/setting/SettingSearchSourcesBlock":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/_base/html dojo/on dojo/string jimu/dijit/_GeocodeServiceChooserContent jimu/dijit/Popup jimu/dijit/LoadingShelter jimu/portalUrlUtils jimu/dijit/Message esri/request esri/lang ./convert ./QuerySourceSetting ./settingComponents ./SettingBoxedDivs ./SettingBufferBlock ./SettingCheckboxLabeled ./SettingContainer ./SettingDropdownLabeled ./SettingFieldListLabeled ./SettingInputLabeled ./SettingObject ./SettingOptionsTable ./SettingStaticText".split(" "),
function(d,g,k,f,l,b,a,c,h,n,p,e,q,t,r,m,u,x,w,v,B,z,C,F,y,G,H,I){return g(G,{_inputControl:null,_mainControl:null,_detailsDiv:null,_detailsTitle:null,_detailsCheckbox:null,_sourceDisplay:null,_iCurrentSource:-1,_sourceMenuItems:[],_newSourceTypeMenuItems:[],_nls:null,_webmapFeatureLayers:[],_fieldListPicker:null,_displayFieldInput:null,constructor:function(c,b,e,m,v,h){this._nls=b;this._map=m;this._webmapFeatureLayers=v;this._portalUrl=h;this._newSourceTypeMenuItems=[b.groupingLabels.featureLayerDetails,
b.groupingLabels.geocoderDetails];this._inputControl=new H(null,"third-width","",b.propertyLabels.name,null,"",k.hitch(this,this._onRowSelected),k.hitch(this,this._onRowDeleted),k.hitch(this,this._onRowMoved));this._detailsDiv=x.container("two-thirds-width","majorTrailingVertGap",[]);c=x.addTextButtonDropdownCtl("",b.buttons.addSearchSource,this._newSourceTypeMenuItems);this.own(a(c.ctl,"click",k.hitch(this,this._onAddSearchSourceMenuItemClick)));this._mainControl=new z(null,e||"","majorTrailingVertGap",
b.groupingLabels.searchSources,"full-width",[new y("allPlaceholder",!1,"full-width","third-width","two-thirds-width",b.propertyLabels.placeholderTextForAllSources),new B("showInfoWindowOnSelect","full-width","third-width","two-thirds-width",b.propertyLabels.showPopupForFoundItem),new w(null,[c.div,x.container("full-width flexbox","majorTrailingHorizGap",[this._inputControl.div(),this._detailsDiv])])]);this._mainDiv=this._mainControl.div()},setConfig:function(){this._mainControl.setConfig(this._config);
this._sourceMenuItems=d.map(this._config.sources,function(a){return{item:a.name}});this._inputControl.setValue(this._sourceMenuItems);0<this._sourceMenuItems.length&&this._inputControl.selectTableRow(0)},getConfig:function(a,b){this._mainControl.getConfig(this._config);this._setDetails(-1);d.forEach(this._config.sources,function(a){"locator"===a.type?a.url||b.push(c.substitute(this._nls.problems.noSearchSourceURL,{sourceName:a.name})):0===a.searchFields.length&&b.push(c.substitute(this._nls.problems.noSearchSourceFields,
{sourceName:a.name}));0>a.buffer.bufferUnitsMenu[0].indexOf("1")&&b.push(c.substitute(this._nls.problems.noBufferUnitsForSearchSource,{sourceName:a.name}))},this)},_onAddSearchSourceMenuItemClick:function(c){var b,e={};if(c.target.innerText===this._newSourceTypeMenuItems[0]){var m=new u({nls:this._nls.querySourceSetting,map:this._map,appConfig:{portalUrl:this._portalUrl}});b=k.clone(this._config.searchSourceTemplates.query);m.setConfig({name:b.name||"",placeholder:b.placeholder||"",searchFields:b.searchFields||
[],displayField:b.displayField||"",maxSuggestions:b.maxSuggestions||6,maxResults:b.maxResults||6,zoomScale:b.zoomScale||5E4,exactMatch:b.exactMatch,searchInCurrentMapExtent:b.searchInCurrentMapExtent,type:b.type||"query",layerId:b.layerId,url:b.url||""});m._openQuerySourceChooser();m.own(a(m,"select-query-source-ok",k.hitch(this,function(a){b.name=a.name;b.layerId=a.layerInfo?a.layerInfo.id:null;b.url=a.url;b.buffer=k.clone(this._config.bufferTemplate);b.fieldMenuItems=[];(a=a.definition&&a.definition.fields)&&
d.map(a,function(a){b.fieldMenuItems.push({label:a.alias||a.name,value:a.name})});this._config.sources.push(b);e.item=b.name;this._sourceMenuItems.push(e);this._inputControl.addRowToTable(e);this._inputControl.selectTableRow(this._config.sources.length-1);m.destroy();m=null})));m.own(a(m,"select-query-source-cancel",function(){m.destroy();m=null}))}else b=k.clone(this._config.searchSourceTemplates.locator),b.buffer=k.clone(this._config.bufferTemplate),this._openServiceChooser(b,e)},_openServiceChooser:function(c,
e){var m=c&&e?!1:!0;this.serviceChooserContent=new h({url:m?this._sourceDisplay._contents[0].getValue():""});this.shelter=new p({hidden:!0});this.geocoderPopup=new n({titleLabel:this._nls.querySourceSetting.setGeocoderURL,autoHeight:!0,content:this.serviceChooserContent.domNode,container:window.jimuConfig.layoutId,width:640,configItem:c||this._config.sources[this._iCurrentSource],menuEntry:e||this._sourceMenuItems[this._iCurrentSource],update:m});this.shelter.placeAt(this.geocoderPopup.domNode);b.setStyle(this.serviceChooserContent.domNode,
"width","580px");b.addClass(this.serviceChooserContent.domNode,"override-geocode-service-chooser-content");this.serviceChooserContent.own(a(this.serviceChooserContent,"validate-click",k.hitch(this,function(){b.removeClass(this.serviceChooserContent.domNode,"override-geocode-service-chooser-content")})));this.serviceChooserContent.own(a(this.serviceChooserContent,"ok",k.hitch(this,"_onSelectLocatorUrlOk")));this.serviceChooserContent.own(a(this.serviceChooserContent,"cancel",k.hitch(this,"_onSelectLocatorUrlCancel")))},
_onSelectLocatorUrlOk:function(a){if(a&&a[0]&&a[0].url){this.shelter.show();var b=a[0].url;t({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(k.hitch(this,function(a){this.shelter.hide();if(a&&a.singleLineAddressField&&a.singleLineAddressField.name){var c=this.geocoderPopup.configItem;c.singleLineFieldName=a.singleLineAddressField.name;"string"===typeof b?(a=b.split("/"),c.name=a[a.length-2]||"geocoder"):c.name="geocoder";c.url=b;a=this.geocoderPopup.menuEntry;a.item=
c.name;this._sourceDisplay&&this._sourceDisplay._contents&&this._sourceDisplay._contents[0]&&this._sourceDisplay._contents[0].getValue&&this._sourceDisplay._contents[0].getValue()!==b&&(this._sourceDisplay._contents[0].setValue(b),this._sourceDisplay._contents[1].setValue(c.name));this.geocoderPopup.update?(this._config.sources[this._iCurrentSource]=c,this._sourceMenuItems[this._iCurrentSource]=a):(this._config.sources.push(c),this._sourceMenuItems.push(a),this._inputControl.addRowToTable(a));this._setDetails(this._iCurrentSource);
this._inputControl.selectTableRow(this.geocoderPopup.update?this._iCurrentSource:this._config.sources.length-1);this.geocoderPopup&&(this.geocoderPopup.close(),this.geocoderPopup=null)}else new q({message:this._nls.querySourceSetting.locatorWarning})}),k.hitch(this,function(a){console.error(a);this.shelter.hide();new q({message:r.substitute({URL:this._getRequestUrl(b)},k.clone(this._nls.querySourceSetting.invalidUrlTip))})}))}},_getRequestUrl:function(a){var b=window.location.protocol;return"http:"===
b?e.setHttpProtocol(a):"https:"===b?e.setHttpsProtocol(a):a},_onSelectLocatorUrlCancel:function(){this.geocoderPopup&&(this.geocoderPopup.close(),this.geocoderPopup=null,this.emit("select-locator-url-cancel"))},_setDetails:function(b){var c=this._sourceMenuItems.length;this._removeCurrentDetails();if(0<=b&&b<c){c=this._config.sources[b];if("query"===c.type)this._fieldListPicker=new F("searchFields",this._nls,"full-width","details-label","details-value",this._nls.propertyLabels.searchFields,this._nls.hints.csvNameList,
c.fieldMenuItems),this._displayFieldInput=new C("displayField","full-width","details-label","details-value",this._nls.propertyLabels.displayField,"",c.fieldMenuItems,k.hitch(this,this._onChangeField)),this._sourceDisplay=new z(null,"","majorTrailingVertGap",this._nls.groupingLabels.featureLayerDetails,"full-width",[new z(null,"full-width","minorTrailingHorizGap",[new I(null,"details-label inline-block",this._nls.querySourceSetting.layerSource),new I(null,"details-value inline-block wrapText",c.url)]),
new y("name",!1,"full-width","details-label","details-value",this._nls.propertyLabels.name,c.name),new y("placeholder",!1,"full-width","details-label","details-value",this._nls.propertyLabels.placeholderText),this._fieldListPicker,this._displayFieldInput,new y("maxSuggestions",!0,"full-width","details-label","details-value",this._nls.propertyLabels.maximumSuggestions,"6",null,null,null,{min:1,max:10,places:0}),new y("maxResults",!0,"full-width","details-label","details-value",this._nls.propertyLabels.maximumResults,
"6",null,null,null,{min:1,max:10,places:0}),new y("zoomScale",!0,"full-width","details-label","details-value",this._nls.propertyLabels.zoomScale,"50000","","1:",null,{min:0,places:0}),new B("exactMatch","full-width","details-label","details-value",this._nls.propertyLabels.exactMatch),new B("searchInCurrentMapExtent","full-width","details-label","details-value",this._nls.propertyLabels.limitSearchToMapExtent),new v("buffer",this._nls,"full-width","details-label","details-value",this._config.bufferTemplate,
this._nls.propertyLabels.bufferDefaultDistance,"100")]);else if("locator"===c.type){var e=x.textButtonCtl("",this._nls.querySourceSetting.set,this._nls.querySourceSetting.set);this.own(a(e.ctl,"click",k.hitch(this,this._openServiceChooser,void 0,void 0)));this._sourceDisplay=new z(null,"","majorTrailingVertGap",this._nls.groupingLabels.geocoderDetails,"full-width",[new y("url",!1,"full-width","details-label","details-value",this._nls.propertyLabels.url,void 0,void 0,void 0,e,void 0,!0),new y("name",
!1,"full-width","details-label","details-value",this._nls.propertyLabels.name),new y("placeholder",!1,"full-width","details-label","details-value",this._nls.propertyLabels.placeholderText),new y("countryCode",!1,"full-width","details-label","details-value",this._nls.propertyLabels.countryRegionCodes,this._nls.placeholders.countryRegionCodes),new y("maxSuggestions",!0,"full-width","details-label","details-value",this._nls.propertyLabels.maximumSuggestions,"6",null,null,null,{min:1,max:10,places:0}),
new y("maxResults",!0,"full-width","details-label","details-value",this._nls.propertyLabels.maximumResults,"6",null,null,null,{min:1,max:10,places:0}),new y("zoomScale",!0,"full-width","details-label","details-value",this._nls.propertyLabels.zoomScale,"50000","","1:",null,{min:0,places:0}),new B("searchInCurrentMapExtent","full-width","details-label","details-value",this._nls.propertyLabels.limitSearchToMapExtent),new v("buffer",this._nls,"full-width","details-label","details-value",this._config.bufferTemplate,
this._nls.propertyLabels.bufferDefaultDistance,"100")])}this._sourceDisplay&&(c.buffer.bufferUnitsMenu=m.unitCodesToLabels(jimuNls.units,c.buffer.bufferUnitsMenu),this._sourceDisplay.setConfig(c),l.place(this._sourceDisplay.div(),this._detailsDiv),f.remove(this._detailsDiv,"hidden"),this._iCurrentSource=b)}},_convertLayerIdToLayerName:function(a){var b=a;d.some(this._webmapFeatureLayers,function(c){return c.layerId===a?(b=c.name,!0):!1});return b},_convertLayerNameToLayerId:function(a){var b=a;d.some(this._webmapFeatureLayers,
function(c){return c.name===a?(b=c.layerId,!0):!1});return b},_onChangeFeatureLayer:function(a){var b,c=[];0<=this._iCurrentSource&&(b=this._config.sources[this._iCurrentSource],d.some(this._webmapFeatureLayers,k.hitch(this,function(e){return a===e.layerId?(b.name=e.layerId,b.searchFields=[],b.displayField=e.displayField,b.layerId=e.layerId,b.url=e.url,d.map(e.fields,function(a){c.push({label:a.alias||a.name,value:a.name})}),this._fieldListPicker.setFieldList(c),this._fieldListPicker.setDisplay(),
this._displayFieldInput.setOptions(c),this._inputControl.renameTableRow(this._iCurrentSource,e.name),!0):!1})))},_onChangeField:function(a){var b;0<=this._iCurrentSource&&(b=this._config.sources[this._iCurrentSource],b.displayField=a)},_onRowSelected:function(a){this._setDetails(a.rowIndex)},_onRowMoved:function(a,b){var c;this._removeCurrentDetails();c=b?a.rowIndex+1:a.rowIndex-1;b=this._sourceMenuItems.splice(c,1);c=this._config.sources.splice(c,1);this._sourceMenuItems.splice(a.rowIndex,0,b[0]);
this._config.sources.splice(a.rowIndex,0,c[0]);this._inputControl.selectTableRow(a.rowIndex)},_onRowDeleted:function(a,b,c){this._removeCurrentDetails();this._sourceMenuItems.splice(c,1);this._config.sources.splice(c,1);0<this._sourceMenuItems.length&&this._inputControl.selectTableRow(0)},_removeCurrentDetails:function(){var a;0<=this._iCurrentSource&&(f.add(this._detailsDiv,"hidden"),a=this._config.sources[this._iCurrentSource],this._sourceDisplay.getConfig(a),a.buffer.bufferUnitsMenu=m.labelsToUnitCodes(jimuNls.units,
a.buffer.bufferUnitsMenu),"query"===a.type&&(a.name=this._convertLayerIdToLayerName(a.name)),l.empty(this._detailsDiv),this._sourceDisplay=null,this._iCurrentSource=-1)}})})},"jimu/dijit/_GeocodeServiceChooserContent":function(){define(["dojo/_base/declare","./_BasicServiceChooserContent","./GeocodeServiceBrowser"],function(d,g,k){return d([g],{baseClass:"jimu-geocode-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/GeocodeServer"],
_createServiceBrowser:function(d){return new k(d)}})})},"jimu/dijit/_BasicServiceChooserContent":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_BasicServiceChooserContent.html dojo/Evented dojo/Deferred dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/promise/all jimu/dijit/URLInput jimu/dijit/LoadingIndicator".split(" "),function(d,g,k,f,l,b,a,c,h,n,p,e,q,t,r){return d([g,k,f,b],{templateString:l,
_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/servicetype"],multiple:!1,url:"",getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},postMixInProperties:function(){this.nls=n.mixin({},window.jimuNls.common);this.nls=n.mixin(this.nls,window.jimuNls.basicServiceChooser)},postCreate:function(){this.inherited(arguments);c.addClass(this.domNode,"jimu-basic-service-chooser-content");this.multiple=
!!this.multiple;this._initSelf();this.exampleTd.innerHTML=this.exampleTd.innerHTML},setUrl:function(b){var c=new a;(this.url=b)&&"string"===typeof this.url?(this.urlInput.set("value",this.url),c=this._onBtnValidateClick()):c.reject();return c},focusInput:function(){this.urlInput.focus()},_initSelf:function(){this._examples&&0<this._examples.length?h.forEach(this._examples,n.hitch(this,function(a){c.create("div",{innerHTML:a,"class":"example-url"},this.exampleTd)})):c.setStyle(this.exampleTr,"display",
"none");var a={multiple:this.multiple,_onTreeClick:n.hitch(this,this._onTreeClick)};this.serviceBrowser=this._createServiceBrowser(a);this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup();this.own(e.after(this.urlInput,"validator",n.hitch(this,this._afterUrlValidate)));this.url&&"string"===typeof this.url&&this.urlInput.set("value",this.url);this.own(p(this.serviceBrowser,"error",n.hitch(this,this._onServiceBrowserError)))},_createServiceBrowser:function(a){},_validateUrl:function(a){a=
a.replace(/\/*$/g,"");if((a=a.match(/\/rest\/services\/*(.*)/gi))&&0<a.length)if(a=a[0].replace(/\/rest\/services\/*/,"")){var b=a.split("/");if(1===b.length)return!0;if(2===b.length)return this.serviceBrowser.isServiceTypeSupported(b[1]);if(3<=b.length)return a=this.serviceBrowser.isServiceTypeSupported(b[1]),b=this.serviceBrowser.isServiceTypeSupported(b[2]),a||b}else return!0;else return!1},_afterUrlValidate:function(a){a&&(a=this.urlInput.get("value"),a=this._validateUrl(a));a?c.removeClass(this.btnValidate,
"jimu-state-disabled"):c.addClass(this.btnValidate,"jimu-state-disabled");return a},_onServiceBrowserError:function(a){this._showErrorMessage(a)},_showErrorMessage:function(a){a&&"string"===typeof a?(this.errorNode.innerHTML=a,c.addClass(this.errorSection,"visible")):c.removeClass(this.errorSection,"visible")},_clearErrorMessage:function(){this.errorNode.innerHTML="";c.removeClass(this.errorSection,"visible")},_onBtnValidateClick:function(){this._clearErrorMessage();var b=new a;if(this.urlInput.validate()){var c=
this.urlInput.get("value");this.serviceBrowser.setUrl(c).then(n.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();b.resolve()}),n.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();b.reject()}));this.emit("validate-click")}else b.reject();return b},_checkSelectedItemsNumber:function(){0<this.getSelectedItems().length?c.removeClass(this.btnOk,"jimu-state-disabled"):c.addClass(this.btnOk,"jimu-state-disabled")},_onTreeClick:function(){this._checkSelectedItemsNumber()},
_onBtnOkClick:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnCancelClick:function(){this.emit("cancel")}})})},"jimu/dijit/GeocodeServiceBrowser":function(){define(["dojo/_base/declare","./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array","jimu/serviceBrowserRuleUtils"],function(d,g,k,f,l){return d([g],{baseClass:"jimu-geocode-service-browser",declaredClass:"jimu.dijit.GeocodeServiceBrowser",url:"",multiple:!1,postMixInProperties:function(){this.inherited(arguments);
this.rule=l.getGeocodeServiceBrowserRule()},getSelectedItems:function(){var b=this.inherited(arguments);return b=f.map(b,k.hitch(this,function(a){return{name:a.name,url:a.url}}))}})})},"jimu/dijit/_BasicServiceBrowser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/store/Memory dojo/store/Observable dijit/tree/ObjectStoreModel jimu/utils jimu/dijit/_Tree jimu/dijit/LoadingIndicator".split(" "),
function(d,g,k,f,l,b,a,c,h,n,p,e,q,t,r){return d([g,k,f,l],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"shelter"  data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_currentUrl:"",_treeClass:"service-browser-tree",_def:null,url:"",multiple:!1,rule:null,postMixInProperties:function(){this.nls=window.jimuNls.basicServiceBrowser},postCreate:function(){this.inherited(arguments);a.addClass(this.domNode,
"jimu-basic-service-browser");this.multiple=!!this.multiple;this._createTree();this.url&&"string"===typeof this.url&&this.setUrl(this.url)},reset:function(){this.url="";this._clear()},getSelectedItems:function(){return this.tree.getSelectedItems()},setUrl:function(a){this._def&&(this._def.isFulfilled()||this._def.cancel(),this._def=null);this._def=new h;a&&"string"===typeof a&&a.replace(/\/*$/g,"")||this._def.reject();a=a.replace(/\/*$/g,"");a=b.trim(a);var c=a.match(/^http(s?):\/\//gi);c&&0<c.length||
(a="http://"+a);if(!(0>=a.search(/\/rest\/services/i))&&(this._clear(),this._currentUrl=a))return a=this._getRootItem(),a=t.isStringEndWith(this._currentUrl,"rest/services")?this._searchBaseServiceUrl(this._currentUrl,a):this._isUrlContainsServiceType(this._currentUrl)?this._searchServiceUrl(this._currentUrl,a):this._searchFolderServiceUrl(this._currentUrl,a),this.shelter.show(),a.then(b.hitch(this,function(a){this.domNode&&this.shelter.hide();var b=this.tree.getAllLeafTreeNodeWidgets();1===b.length&&
b[0].select();this._def.resolve(a)}),b.hitch(this,function(a){this.domNode&&this.shelter.hide();this._showRequestError();this._def.reject(a)})),this._def;this._def.reject()},_getItem:function(a){return this.rule.getItem(a)},_getSubItemUrls:function(a){return this.rule.getSubItemUrls(a)},_getSubItems:function(a){var e=new h;this._getSubItemUrls(a).then(b.hitch(this,function(a){a=c.map(a,b.hitch(this,function(a){return this._getItem(a)}));n(a).then(b.hitch(this,function(a){a=c.filter(a,b.hitch(this,
function(a){return a&&"object"===typeof a}));e.resolve(a)}),b.hitch(this,function(a){e.reject(a)}))}),b.hitch(this,function(a){e.reject(a)}));return e},_selectFirstLeafTreeNodeWidget:function(){var a=this.tree.getAllLeafTreeNodeWidgets();1===a.length&&a[0].select()},isLeafItem:function(a){return 0<=this.rule.leafTypes.indexOf(a.type)},isServiceTypeSupported:function(a){return this.rule.isServiceTypeSupported(a)},_getStringEndWith:function(a,b){var c="",e=a.indexOf(b);0<=e&&(c=a.slice(0,e+b.length));
return c},_isUrlContainsServiceType:function(a){return this.rule.isUrlContainsServiceType(a)},_getBaseServiceUrl:function(){return this._getStringEndWith(this._currentUrl,"rest/services")},_getServiceName:function(a){var b="";a=a.split("/");return b=a[a.length-1]},_searchBaseServiceUrl:function(a,e){var d=new h;this._getRestInfo(a).then(b.hitch(this,function(f){if(this.domNode){var v=[];c.map(f.folders,b.hitch(this,function(d){var f={name:d,type:"folder",url:a+"/"+d,parent:e.id};this._addItem(f);
var n=new h;this._doSearchFolderServiceUrl(f.url,f.id).then(b.hitch(this,function(a){0<a.length?c.forEach(a,b.hitch(this,function(a){a.parent=f.id;this._addItem(a)})):this._removeItem(f.id);n.resolve()}),b.hitch(this,function(a){n.reject(a)}));v.push(n);return n}));c.forEach(f.services,b.hitch(this,function(c){if(this.isServiceTypeSupported(c.type)){c=a+"/"+c.name+"/"+c.type;var d=new h;this.rule.getItem(c).then(b.hitch(this,function(a){a&&(a.parent=e.id,this._addItem(a));d.resolve()}),b.hitch(this,
function(a){console.error(a);d.reject(a)}));v.push(d)}}));n(v).then(b.hitch(this,function(){this.domNode&&d.resolve()}),b.hitch(this,function(a){console.error(a);this.domNode&&d.reject(a)}))}}),b.hitch(this,function(a){console.error(a);this.domNode&&d.reject({errorCode:"NETWORK_ERROR",error:a})}));return d},_searchFolderServiceUrl:function(a,e){var d=new h;this._doSearchFolderServiceUrl(a,e).then(b.hitch(this,function(a){this.domNode&&(c.forEach(a,b.hitch(this,function(a){a.parent=e.id;this._addItem(a)})),
d.resolve())}),b.hitch(this,function(a){console.error(a);this.domNode&&d.reject({errorCode:"NETWORK_ERROR",error:a})}));return d},_doSearchFolderServiceUrl:function(a){var e=new h,d=this._getBaseServiceUrl();this._getRestInfo(a).then(b.hitch(this,function(a){a=a.services;var v=[];a&&0<a.length&&c.forEach(a,b.hitch(this,function(a){this.isServiceTypeSupported(a.type)&&(a=this.rule.getItem(d+"/"+a.name+"/"+a.type),v.push(a))}));n(v).then(b.hitch(this,function(a){a=c.filter(a,b.hitch(this,function(a){return a}));
e.resolve(a)}),b.hitch(this,function(a){console.error(a);e.reject(a)}))}),b.hitch(this,function(a){console.error(a);e.reject(a)}));return e},_searchServiceUrl:function(a,e){var d=new h;this._getSubItems(a).then(b.hitch(this,function(h){h&&0<h.length?(c.forEach(h,b.hitch(this,function(a){a.parent=e.id;this._addItem(a)})),d.resolve()):this._getItem(a).then(b.hitch(this,function(a){a&&(a.parent=e.id,this._addItem(a));d.resolve()}),b.hitch(this,function(a){d.reject(a)}))}),b.hitch(this,function(a){d.reject(a)}));
return d},_getRestInfo:function(a){var c=new h;this.rule.getRestInfo(a).then(b.hitch(this,function(a){this.domNode&&c.resolve(a)}),b.hitch(this,function(a){this.domNode&&c.reject(a)}));return c},_clear:function(){var a=this._store.query({parent:"root"});c.forEach(a,b.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_showRequestError:function(){this.emit("error",this.nls.invalidUrlTip)},_addItem:function(a){this._id++;a.id=this._id.toString();this._store.add(a);return a},_removeItem:function(a){this._store.remove(a)},
_getRootItem:function(){return{id:"root",name:"Services Root",type:"root"}},_createTree:function(){var c=this._getRootItem(),c=new p({data:[c],getChildren:function(a){return this.query({parent:a.id})}});this._store=new e(c);c=new q({store:this._store,query:{id:"root"},mayHaveChildren:b.hitch(this,this._mayHaveChildren)});this.tree=new r({multiple:this.multiple,model:c,showRoot:!1,style:{width:"100%"},isLeafItem:b.hitch(this,this.isLeafItem),onOpen:b.hitch(this,function(a,c){this._onTreeOpen(a,c);
this.emit("tree-open",a,c)}),onClick:b.hitch(this,function(a,c,b){this._onTreeClick(a,c,b);this.emit("tree-click",a,c,b)}),getIconStyle:b.hitch(this,function(a,c){var b=null;if(!a)return null;var e={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},d=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),h=this._getIconImageName(a,c);h||("folder"===a.type?h=c?"folder_open_default.png":"folder_close_default.png":this.isServiceTypeSupported(a.type)&&
(h=c?"folder_open_default.png":"folder_close_default.png"));h&&(e.backgroundImage="url("+d+"/css/images/"+h+")",b=e);return b})});a.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.domNode)},_getIconImageName:function(a,c){var b="";"function"===typeof this.rule.getIconImageName&&(b=this.rule.getIconImageName(a,c));return b},_mayHaveChildren:function(a){return"root"===a.type?!0:!this.isLeafItem(a)},_onTreeOpen:function(a,e){"root"===a.id||0<this._store.query({parent:a.id}).length||
a.checking||a.checked||(a.checking=!0,this._getSubItems(a.url).then(b.hitch(this,function(e){c.forEach(e,b.hitch(this,function(c){c.parent=a.id;this._addItem(c)}));a.checking=!1;a.checked=!0}),b.hitch(this,function(c){console.error(c);a.checking=!1;a.checked=!0})))},_onTreeClick:function(a,c,b){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)}})})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),
function(d,g,k,f,l,b,a){return k("dijit.tree.ObjectStoreModel",a,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(a){l.mixin(this,a);this.childrenCache={}},getRoot:function(a,d){if(this.root)a(this.root);else{var c=this.store.query(this.query);c.then&&this.own(c);b(c,l.hitch(this,function(b){if(1!=b.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+b.length+" items, but must return exactly one");this.root=b[0];a(this.root);c.observe&&c.observe(l.hitch(this,
function(a){this.onChange(a)}),!0)}),d)}},mayHaveChildren:function(){return!0},getChildren:function(a,d,f){var c=this.store.getIdentity(a);if(this.childrenCache[c])b(this.childrenCache[c],d,f);else{var e=this.childrenCache[c]=this.store.getChildren(a);e.then&&this.own(e);e.observe&&this.own(e.observe(l.hitch(this,function(c,d,h){this.onChange(c);d!=h&&b(e,l.hitch(this,"onChildrenChange",a))}),!0));b(e,d,f)}},isItem:function(){return!0},getIdentity:function(a){return this.store.getIdentity(a)},getLabel:function(a){return a[this.labelAttr]},
newItem:function(a,b,d,f){return this.store.put(a,{parent:b,before:f})},pasteItem:function(a,b,n,g,e,q){var c=new f;if(b===n&&!g&&!q)return c.resolve(!0),c;b&&!g?this.getChildren(b,l.hitch(this,function(e){e=[].concat(e);var h=d.indexOf(e,a);e.splice(h,1);this.onChildrenChange(b,e);c.resolve(this.store.put(a,{overwrite:!0,parent:n,oldParent:b,before:q,isCopy:!1}))})):c.resolve(this.store.put(a,{overwrite:!0,parent:n,oldParent:b,before:q,isCopy:!0}));return c},onChange:function(){},onChildrenChange:function(){},
onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/keys dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),function(d,g,k,f,l,b,a,c,h,n,p,e,q,t,r,m){var u=d([r._TreeNode,q],{templateString:f,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);
b.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=b.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=b.toDom('\x3cinput type\x3d"checkbox" /\x3e');b.addClass(this.checkNode,"jimu-tree-check-node");b.place(this.checkNode,this.contentNode,"first");this.own(p(this.checkNode,"click",l.hitch(this,this._onClick)));this.own(p(this.rowNode,"keydown",l.hitch(this,function(a,b){b.target=a;b.keyCode!==e.ENTER&&b.keyCode!==
e.SPACE||this._onClick(b)},this.checkNode)));this.isLeaf?this.groupId?b.setStyle(this.checkNode,"display","none"):b.setStyle(this.checkNode,"display","inline"):b.setStyle(this.checkNode,"display","none");this.isLeaf?b.addClass(this.domNode,"jimu-tree-leaf-node"):b.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&(this.checkNode.checked=!0,b.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,b.removeClass(this.domNode,
"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(l.hitch(this,function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return d([r,
q],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+m.getRandomString()},postCreate:function(){this.inherited(arguments);b.addClass(this.domNode,"jimu-tree");this.own(n.before(this,"onClick",l.hitch(this,this._jimuBeforeClick)));this.rootLoadingIndicator&&b.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0;b.setAttr(this.domNode,"tabindex",0)},removeItem:function(a){this.model.store.remove(a)},
getAllItems:function(){var b=this.getAllTreeNodeWidgets();return a.map(b,l.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}))},getSelectedItems:function(){var b=this.getAllTreeNodeWidgets(),b=a.filter(b,l.hitch(this,function(a){return a.checkNode.checked}));return a.map(b,l.hitch(this,function(a){return a.item}))},getFilteredItems:function(b){var c=this.getAllTreeNodeWidgets(),c=a.map(c,l.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}));return a.filter(c,
l.hitch(this,function(a){return b(a)}))},getTreeNodeByItemId:function(a){for(var b=this._getAllTreeNodeDoms(),c=0;c<b.length;c++){var e=t.byNode(b[c]);if(e.item.id.toString()===a.toString())return e}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var b=this.getAllTreeNodeWidgets();return a.filter(b,l.hitch(this,function(a){return a.isLeaf}))},
getAllTreeNodeWidgets:function(){var b=this._getAllTreeNodeDoms();return a.map(b,l.hitch(this,function(a){return t.byNode(a)}))},isLeafItem:function(a){return a&&a.isLeaf},_getAllTreeNodeDoms:function(){return h(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);this.multiple||(a.groupId=this.uniqueId);return new u(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",
{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,c,e){c.isLeaf&&(b.hasClass(e.target||e.srcElement,"jimu-tree-check-node")||(this.multiple?c.toggleSelect():this.selectNodeWidget(c)));return arguments},_onCheckNodeClick:function(a,b,e){!this.multiple&&b&&this.unselectAllLeafNodeWidgets();c.stop(e);this.focusNode(a);setTimeout(l.hitch(this,function(){b?this.selectNodeWidget(a):a.unselect();this.onClick(a.item,
a,e)}),0)},unselectAllLeafNodeWidgets:function(){var b=this.getAllLeafTreeNodeWidgets();a.forEach(b,l.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(d,g,k,f,l,b,a,c,h,n,p,e,q,t,r,m,u,x,w,v,B,z,C,F,y,G,H,I,K,L,M,N,Q,O,P){function A(a){return m.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var J=f("dijit._TreeNode",[y,G,H,I,K],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a);q("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:M,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";n.set(this.domNode,
"backgroundPosition",b+" 0px");n.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",b);d.forEach(this.getChildren(),function(b){b.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,c=b.model;b._v10Compat&&a===c.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(a,b,e){var d="_"+b+"Class";b+="Node";var h=this[d];this[d]=this.tree["get"+e+"Class"](a,this.isExpanded);c.replace(this[b],this[d]||"",h||"");n.set(this[b],this.tree["get"+e+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent(),a=!a||!a.rowNode||"none"==a.rowNode.style.display;c.toggle(this.domNode,"dijitTreeIsRoot",a);c.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var b=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;c.replace(this.expandoNode,b[a],b);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return A(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");c.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var a=e.wipeIn({node:this.containerNode,duration:F.defaultDuration}),b=this._expandDeferred=new l(function(){a.stop()});g.after(a,"onEnd",function(){b.resolve(!0)},!0);a.play();return A(b)},collapse:function(){if(this._collapseDeferred)return A(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");c.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var a=e.wipeOut({node:this.containerNode,duration:F.defaultDuration}),b=this._collapseDeferred=new l(function(){a.stop()});g.after(a,"onEnd",
function(){b.resolve(!0)},!0);a.play();return A(b)},indent:0,setChildItems:function(c){var e=this.tree,h=e.model,f=[],v=e.focusedChild,D=this.getChildren();d.forEach(D,function(a){H.prototype.removeChild.call(this,a)},this);this.defer(function(){d.forEach(D,function(b){if(!b._destroyed&&!b.getParent()){var c=function(a){var b=h.getIdentity(a.item),f=e._itemNodesMap[b];1==f.length?delete e._itemNodesMap[b]:(b=d.indexOf(f,a),-1!=b&&f.splice(b,1));d.forEach(a.getChildren(),c)};e.dndController.removeTreeNode(b);
c(b);if(e.persist){var f=d.map(b.getTreePath(),function(a){return e.model.getIdentity(a)}).join("/"),D;for(D in e._openedNodes)D.substr(0,f.length)==f&&delete e._openedNodes[D];e._saveExpandedNodes()}e.lastFocusedChild&&!a.isDescendant(e.lastFocusedChild.domNode,e.domNode)&&delete e.lastFocusedChild;v&&!a.isDescendant(v.domNode,e.domNode)&&e.focus();b.destroyRecursive()}})});this.state="Loaded";c&&0<c.length?(this.isExpandable=!0,d.forEach(c,function(a){var b=h.getIdentity(a),c=e._itemNodesMap[b],
d;if(c)for(var v=0;v<c.length;v++)if(c[v]&&!c[v].getParent()){d=c[v];d.set("indent",this.indent+1);break}d||(d=this.tree._createTreeNode({item:a,tree:e,isExpandable:h.mayHaveChildren(a),label:e.getLabel(a),labelType:e.model&&e.model.labelType||"text",tooltip:e.getTooltip(a),ownerDocument:e.ownerDocument,dir:e.dir,lang:e.lang,textDir:e.textDir,indent:this.indent+1}),c?c.push(d):e._itemNodesMap[b]=[d]);this.addChild(d);(this.tree.autoExpand||this.tree._state(d))&&f.push(e._expandNode(d))},this),d.forEach(this.getChildren(),
function(a){a._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);c=b(f);this.tree._startPaint(c);return A(c)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,
this.collapse());d.forEach(b,function(a){a._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");c.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){z.focus(this.focusNode)}});q("dojo-bidi")&&J.extend({_setTextDirAttr:function(a){!a||this.textDir==a&&this._created||(this._set("textDir",a),this.applyTextDir(this.labelNode),d.forEach(this.getChildren(),function(b){b.set("textDir",
a)},this))}});var E=f("dijit.Tree",[y,L,G,K],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:N,persist:!1,autoExpand:!1,dndController:P,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,b){x.publish(this.id,m.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new l;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(u(this.containerNode,
u.selector(".dijitTreeNode",w.enter),function(b){a._onNodeMouseEnter(C.byNode(this),b)}),u(this.containerNode,u.selector(".dijitTreeNode",w.leave),function(b){a._onNodeMouseLeave(C.byNode(this),b)}),u(this.containerNode,u.selector(".dijitTreeRow",B.press),function(b){a._onNodePress(C.getEnclosingWidget(this),b)}),u(this.containerNode,u.selector(".dijitTreeRow",B),function(b){a._onClick(C.getEnclosingWidget(this),b)}),u(this.containerNode,u.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(C.getEnclosingWidget(this),
b)}));this.model||this._store2model();this.own(g.after(this.model,"onChange",m.hitch(this,"_onItemChange"),!0),g.after(this.model,"onChildrenChange",m.hitch(this,"_onItemChildrenChange"),!0),g.after(this.model,"onDelete",m.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){m.isString(this.dndController)&&(this.dndController=m.getObject(this.dndController));for(var b={},c=0;c<this.dndParams.length;c++)this[this.dndParams[c]]&&(b[this.dndParams[c]]=this[this.dndParams[c]]);
this.dndController=new this.dndController(this,b)}this._load();this.onLoadDeferred=A(this.pendingCommandsPromise);this.onLoadDeferred.then(m.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;t.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=m.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(a.getChildren=m.hitch(this,function(a,b,c){this.getItemChildren(this._v10Compat&&a===this.model.root?null:a,b,c)}));this.model=new O(a);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(m.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
b.labelNode.setAttribute("role","presentation"),b.labelNode.removeAttribute("aria-selected"),b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(m.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),m.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=m.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(m.hitch(this,function(){var c=
d.map(a,function(a){return!a||m.isString(a)?a:b.model.getIdentity(a)}),e=[];d.forEach(c,function(a){e=e.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",e)}))},_setPathAttr:function(a){return a.length?A(this.set("paths",[a]).then(function(a){return a[0]})):A(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(a){function c(a,b){var f=a.shift(),h=d.filter(b,function(a){return a.getIdentity()==f})[0];if(h)return a.length?e._expandNode(h).then(function(){return c(a,
h.getChildren())}):h;throw new E.PathError("Could not expand path at "+f);}var e=this;return A(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return b(d.map(a,function(a){a=d.map(a,function(a){return a&&m.isObject(a)?e.model.getIdentity(a):a});if(a.length)return c(a,[e.rootNode]);throw new E.PathError("Empty path");}))}).then(function(a){e.set("selectedNodes",a);return e.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},
expandAll:function(){function a(e){return c._expandNode(e).then(function(){var c=d.filter(e.getChildren()||[],function(a){return a.isExpandable});return b(d.map(c,a))})}var c=this;return A(a(this.rootNode))},collapseAll:function(){function a(e){var h=d.filter(e.getChildren()||[],function(a){return a.isExpandable}),h=b(d.map(h,a));return!e.isExpanded||e==c.rootNode&&!c.showRoot?h:h.then(function(){return c._collapseNode(e)})}var c=this;return A(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){(a=this._getNext(b))&&a.isTreeNode&&this.focusNode(a)},_onUpArrow:function(a,b){if(a=b.getPreviousSibling())for(b=a;b.isExpandable&&b.isExpanded&&
b.hasChildren();)b=b.getChildren(),b=b[b.length-1];else if(a=b.getParent(),this.showRoot||a!==this.rootNode)b=a;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){b.isExpandable&&b.isExpanded?this._collapseNode(b):(a=b.getParent())&&a.isTreeNode&&(this.showRoot||a!==this.rootNode)&&this.focusNode(a)},focusLastChild:function(){var a=this._getLast();
a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(b,c){return a.isDescendant(b,
c.expandoNode)||a.isDescendant(b,c.expandoNodeText)},_onNodePress:function(a,b){this.focusNode(a)},__click:function(a,b,c,e){var d=this.isExpandoNode(b.target,a);a.isExpandable&&(c||d)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[e](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(a){a=
a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){t.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){t.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&
delete a._expandNodeDeferred;if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var b=this.model,c=a.item,e=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new l,b.getChildren(c,function(b){a.unmarkProcessing();a.setChildItems(b).then(function(){a._loadDeferred.resolve(b)})},function(b){console.error(e,": error loading "+a.label+" children: ",
b);a._loadDeferred.reject(b)}));b=a._loadDeferred.then(m.hitch(this,function(){var b=a.expand();this.onOpen(a.item,a);this._state(a,!0);return b}));this._startPaint(b);return b},focusNode:function(a){for(var b=[],c=this.domNode;c&&c.tagName&&"IFRAME"!==c.tagName.toUpperCase();c=c.parentNode)b.push({domNode:c.contentWindow||c,scrollLeft:c.scrollLeft||0,scrollTop:c.scrollTop||0});this.focusChild(a);this.defer(function(){for(var a=0,c=b.length;a<c;a++)b[a].domNode.scrollLeft=b[a].scrollLeft,b[a].domNode.scrollTop=
b[a].scrollTop},0)},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var c=this.getLabel(a),e=this.getTooltip(a);d.forEach(b,function(b){b.set({item:a,label:c,tooltip:e});b._updateItemClasses(a)})}},_onItemChildrenChange:function(a,b){a=this.model.getIdentity(a);(a=this._itemNodesMap[a])&&d.forEach(a,function(a){a.setChildItems(b)})},_onItemDelete:function(b){b=this.model.getIdentity(b);var c=this._itemNodesMap[b];
c&&(d.forEach(c,function(b){this.dndController.removeTreeNode(b);var c=b.getParent();c&&c.removeChild(b);this.lastFocusedChild&&!a.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!a.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();b.destroyRecursive()},this),delete this._itemNodesMap[b])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=k(this.cookieName);a&&d.forEach(a.split(","),function(a){this._openedNodes[a]=
!0},this)}},_state:function(a,b){if(!this.persist)return!1;var c=d.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");if(1===arguments.length)return this._openedNodes[c];b?this._openedNodes[c]=!0:delete this._openedNodes[c];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],b;for(b in this._openedNodes)a.push(b);k(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),
delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!m.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&h.setMarginBox(this.domNode,a);this._nodePixelIndent=h.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(m.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},
_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var b=m.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});v(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);
this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new J(a)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});q("dojo-bidi")&&E.extend({_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});E.PathError=p("TreePathError");E._TreeNode=J;return E})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array",
"dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(d,g,k,f){return k("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(d){f.mixin(this,d);this.connects=[];d=this.store;if(!d.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");d.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([g.after(d,
"onNew",f.hitch(this,"onNewItem"),!0),g.after(d,"onDelete",f.hitch(this,"onDeleteItem"),!0),g.after(d,"onSet",f.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var d;d=this.connects.pop();)d.remove()},getRoot:function(d,b){this.root?d(this.root):this.store.fetch({query:this.query,onComplete:f.hitch(this,function(a){if(1!=a.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+a.length+" items, but must return exactly one");this.root=a[0];d(this.root)}),onError:b})},mayHaveChildren:function(f){return d.some(this.childrenAttrs,
function(b){return this.store.hasAttribute(f,b)},this)},getChildren:function(g,b,a){var c=this.store;if(c.isItemLoaded(g)){for(var h=[],n=0;n<this.childrenAttrs.length;n++)var l=c.getValues(g,this.childrenAttrs[n]),h=h.concat(l);var e=0;this.deferItemLoadingUntilExpand||d.forEach(h,function(a){c.isItemLoaded(a)||e++});0==e?b(h):d.forEach(h,function(d,f){c.isItemLoaded(d)||c.loadItem({item:d,onItem:function(a){h[f]=a;0==--e&&b(h)},onError:a})})}else{var q=f.hitch(this,arguments.callee);c.loadItem({item:g,
onItem:function(c){q(c,b,a)},onError:a})}},isItem:function(d){return this.store.isItem(d)},fetchItemByIdentity:function(d){this.store.fetchItemByIdentity(d)},getIdentity:function(d){return this.store.getIdentity(d)},getLabel:function(d){return this.labelAttr?this.store.getValue(d,this.labelAttr):this.store.getLabel(d)},newItem:function(d,b,a){var c={parent:b,attribute:this.childrenAttrs[0]},h;this.newItemIdAttr&&d[this.newItemIdAttr]?this.fetchItemByIdentity({identity:d[this.newItemIdAttr],scope:this,
onItem:function(f){f?this.pasteItem(f,null,b,!0,a):(h=this.store.newItem(d,c))&&void 0!=a&&this.pasteItem(h,b,b,!1,a)}}):(h=this.store.newItem(d,c))&&void 0!=a&&this.pasteItem(h,b,b,!1,a)},pasteItem:function(f,b,a,c,h){var n=this.store,g=this.childrenAttrs[0];b&&d.forEach(this.childrenAttrs,function(a){if(n.containsValue(b,a,f)){if(!c){var e=d.filter(n.getValues(b,a),function(a){return a!=f});n.setValues(b,a,e)}g=a}});if(a)if("number"==typeof h){var e=n.getValues(a,g).slice();e.splice(h,0,f);n.setValues(a,
g,e)}else n.setValues(a,g,n.getValues(a,g).concat(f))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(d,b){b&&this.getChildren(b.item,f.hitch(this,function(a){this.onChildrenChange(b.item,a)}))},onDeleteItem:function(d){this.onDelete(d)},onSetItem:function(g,b){if(-1!=d.indexOf(this.childrenAttrs,b))this.getChildren(g,f.hitch(this,function(a){this.onChildrenChange(g,a)}));else this.onChange(g)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(d,g,k,f,l){return g("dijit.tree.ForestStoreModel",l,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(b){this.root={store:this,root:!0,id:b.rootId,label:b.rootLabel,children:b.rootChildren}},mayHaveChildren:function(b){return b===this.root||this.inherited(arguments)},getChildren:function(b,a,c){b===this.root?this.root.children?a(this.root.children):this.store.fetch({query:this.query,onComplete:f.hitch(this,
function(b){this.root.children=b;a(b)}),onError:c}):this.inherited(arguments)},isItem:function(b){return b===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(b){if(b.identity==this.root.id){var a=b.scope||k.global;b.onItem&&b.onItem.call(a,this.root)}else this.inherited(arguments)},getIdentity:function(b){return b===this.root?this.root.id:this.inherited(arguments)},getLabel:function(b){return b===this.root?this.root.label:this.inherited(arguments)},newItem:function(b,a,c){return a===
this.root?(this.onNewRootItem(b),this.store.newItem(b)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(b,a,c,d,f){if(a===this.root&&!d)this.onLeaveRoot(b);this.inherited(arguments,[b,a===this.root?null:a,c===this.root?null:c,d,f]);if(c===this.root)this.onAddToRoot(b)},onAddToRoot:function(b){console.log(this,": item ",b," added to root")},onLeaveRoot:function(b){console.log(this,": item ",b," removed from root")},_requeryTop:function(){var b=this.root.children||[];this.store.fetch({query:this.query,
onComplete:f.hitch(this,function(a){this.root.children=a;if(b.length!=a.length||d.some(b,function(b,d){return a[d]!=b}))this.onChildrenChange(this.root,a)})})},onNewItem:function(b,a){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(b){-1!=d.indexOf(this.root.children,b)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(b,a,c,d){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),
function(d,g,k,f,l,b,a,c,h,n,p){return g("dijit.tree._dndSelector",p,{constructor:function(){this.selection={};this.anchor=null;this.events.push(c(this.tree.domNode,h.press,f.hitch(this,"onMouseDown")),c(this.tree.domNode,h.release,f.hitch(this,"onMouseUp")),c(this.tree.domNode,h.move,f.hitch(this,"onMouseMove")),c(this.tree.domNode,n.press,f.hitch(this,"onClickPress")),c(this.tree.domNode,n.release,f.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],b=this.selection,
c;for(c in b)a.push(b[c]);return a},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,b){this.setSelection(this.getSelectedTreeNodes().concat([a]));b&&(this.anchor=a);return a},removeTreeNode:function(a){var c=d.filter(this.getSelectedTreeNodes(),function(c){return!b.isDescendant(c.domNode,a.domNode)});this.setSelection(c);return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},
setSelection:function(a){var b=this.getSelectedTreeNodes();d.forEach(this._setDifference(b,a),f.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));d.forEach(this._setDifference(a,b),f.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,b){d.forEach(b,function(a){a.__exclude__=!0});a=d.filter(a,function(a){return!a.__exclude__});d.forEach(b,function(a){delete a.__exclude__});
return a},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),b=[],c=[];d.forEach(a,function(a){var e=a.getTreePath();c.push(a);b.push(e)},this);a=d.map(c,function(a){return a.item});this.tree._set("paths",b);this.tree._set("path",b[0]||[]);this.tree._set("selectedNodes",c);this.tree._set("selectedNode",c[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(b){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(b.target,
this.current))){"mousedown"==b.type&&a.isLeft(b)&&b.preventDefault();var c="keydown"==b.type?this.tree.focusedChild:this.current;if(c){var e=l.getCopyKeyState(b),d=c.id;this.singular||b.shiftKey||!this.selection[d]?(this._doDeselect=!1,this.userSelect(c,e,b.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(a){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==a.type?this.tree.focusedChild:this.current,l.getCopyKeyState(a),a.shiftKey))},onMouseMove:function(){this._doDeselect=
!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(a,b){if(a===b)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-b.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(b)&2?1:-1;if(document.createRange){var c=doc.createRange();c.setStartBefore(a);a=doc.createRange();a.setStartBefore(b);return c.compareBoundaryPoints(c.END_TO_END,a)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
},userSelect:function(a,b,c){if(this.singular)this.anchor==a&&b?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(c&&this.anchor){b=this._compareNodes(this.anchor.rowNode,a.rowNode);c=this.anchor;0>b?b=c:(b=a,a=c);for(c=[];b!=a;)c.push(b),b=this.tree._getNext(b);c.push(a);this.setSelection(c)}else this.selection[a.id]&&b?this.removeTreeNode(a):b?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,
b){b=b||k.global;for(var c in this.selection)a.call(b,this.getItem(c),c,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(d,g,k,f,l,b){return g("dijit.tree._dndContainer",null,{constructor:function(a,c){this.tree=a;this.node=a.domNode;f.mixin(this,c);this.containerState="";k.add(this.node,"dojoDndContainer");this.events=[l(this.node,b.enter,f.hitch(this,"onOverEvent")),l(this.node,b.leave,
f.hitch(this,"onOutEvent")),d.after(this.tree,"_onNodeMouseEnter",f.hitch(this,"onMouseOver"),!0),d.after(this.tree,"_onNodeMouseLeave",f.hitch(this,"onMouseOut"),!0),l(this.node,"dragstart, selectstart",function(a){a.preventDefault()})]},destroy:function(){for(var a;a=this.events.pop();)a.remove();this.node=this.parent=null},onMouseOver:function(a){this.current=a},onMouseOut:function(){this.current=null},_changeState:function(a,b){var c="dojoDnd"+a;a=a.toLowerCase()+"State";k.replace(this.node,c+
b,c+this[a]);this[a]=b},_addItemClass:function(a,b){k.add(a,"dojoDndItem"+b)},_removeItemClass:function(a,b){k.remove(a,"dojoDndItem"+b)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/serviceBrowserRuleUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/Deferred","jimu/utils","jimu/ServiceBrowserRule"],function(d,g,k,f,l){var b={combineRules:function(a){var b=new l;g.forEach(a,function(a){g.forEach(a.leafTypes,
function(a){0>b.leafTypes.indexOf(a)&&b.leafTypes.push(a)});g.forEach(a.serviceTypes,function(a){0>b.serviceTypes.indexOf(a)&&b.serviceTypes.push(a)})});b.getMatchedRule=function(b){var c=null;g.some(a,function(a){return a.isUrlContainsServiceType(b)?(c=a,!0):!1});return c};b.getItem=function(a){var c=null;return c=(c=b.getMatchedRule(a))?c.getItem(a):b.defaultGetItem(a)};b.getSubItemUrls=function(a){var c=null;return c=(c=b.getMatchedRule(a))?c.getSubItemUrls(a):b.defaultGetSubItemUrls(a)};b.getIconImageName=
function(a,c){var d="";if(a.url){var e=b.getMatchedRule(a.url);e&&"function"===typeof e.getIconImageName&&(d=e.getIconImageName(a,c))}return d};return b},getFeaturelayerServiceBrowserRule:function(a,c,f){a=d.clone(a);var h=["point","polyline","polygon"];d.isArrayLike(a)&&0<a.length?(a=g.filter(a,function(a){return 0<=h.indexOf(a)}),0===a.length&&(a=h)):a=h;return b._getFeaturelayerServiceBrowserRule(a,c,f)},_getFeaturelayerServiceBrowserRule:function(a,b,h){return new l({types:a,leafTypes:["Feature Layer",
"Table"],serviceTypes:["MapServer","FeatureServer"],_groupLayerType:"Group Layer",_featureLayerType:"Feature Layer",_tableType:"Table",getItem:function(a){var b=new k;this.isUrlEndWithServiceType(a,this.serviceTypes)?b=this.defaultGetItem(a):this.getRestInfo(a).then(d.hitch(this,function(c){c=this._getItemByLayerDefinition(a,c);b.resolve(c)}),d.hitch(this,function(a){b.reject(a)}));return b},getSubItemUrls:function(a){var b=new k;return b=this.isUrlEndWithServiceType(a)?this._getSubUrlsByServiceUrl(a):
this._getSubUrlsByGroupUrl(a)},getIconImageName:function(a,b){var c="";"MapServer"===a.type||"FeatureServer"===a.type?c=b?"mapserver_open.png":"mapserver_close.png":a.type===this._groupLayerType?c=b?"group_layer2.png":"group_layer1.png":a.type===this._featureLayerType?(a=f.getTypeByGeometryType(a.definition&&a.definition.geometryType),"point"===a?c="point_layer1.png":"polyline"===a?c="line_layer1.png":"polygon"===a&&(c="polygon_layer1.png")):a.type===this._tableType?c="table.png":"root"===a.type&&
this._currentUrl&&g.some(this.serviceTypes,d.hitch(this,function(a){return f.isStringEndWith(this._currentUrl,"/"+a)}))&&(c=b?"mapserver_open.png":"mapserver_close.png");return c},_getSubUrlsByServiceUrl:function(a){var b=new k;this.getRestInfo(a).then(d.hitch(this,function(c){var e=[];g.forEach(c.layers,d.hitch(this,function(b){0<=b.parentLayerId||e.push(a+"/"+b.id)}));h&&g.forEach(c.tables,d.hitch(this,function(b){0<=b.parentLayerId||e.push(a+"/"+b.id)}));b.resolve(e)}),d.hitch(this,function(a){b.reject(a)}));
return b},_getSubUrlsByGroupUrl:function(a){var b=new k;this.getRestInfo(a).then(d.hitch(this,function(c){var e=[];if(c.type===this._groupLayerType)var f=this._getServiceUrlByLayerUrl(a),e=g.map(c.subLayers||[],d.hitch(this,function(a){return f+"/"+a.id}));b.resolve(e)}),d.hitch(this,function(a){b.reject(a)}));return b},_getItemByLayerDefinition:function(a,c){var e=null,d=c.type;if(d===this._groupLayerType)e={name:c.name,type:d,url:a,definition:c};else if(d===this._featureLayerType||d===this._tableType){var h=
!1;d===this._featureLayerType?h=this._validateEsriGeometryType(c.geometryType):d===this._tableType&&(h=!0);h&&(h=!1,(h=b?f.isFeaturelayerUrlSupportQuery(a,c.capabilities):!0)&&(e={name:c.name,type:d,url:a,definition:c}))}return e},_validateEsriGeometryType:function(a){a=f.getTypeByGeometryType(a);return 0<=this.types.indexOf(a)},_getServiceUrlByLayerUrl:function(a){for(var b="",c=0;c<this.serviceTypes.length;c++){var d=this.serviceTypes[c].toLowerCase(),f=a.toLowerCase().lastIndexOf("/"+d+"/");if(0<=
f){b=a.slice(0,f+d.length+1);break}}return b}})},getGeocodeServiceBrowserRule:function(){return new l({leafTypes:["GeocodeServer"],serviceTypes:["GeocodeServer"]})},getGpServiceBrowserRule:function(){return new l({leafTypes:["GPTask"],serviceTypes:["GPServer"],getItem:function(a){var b=new k;this.isUrlEndWithServiceType(a)?b=this.defaultGetItem(a):this.getRestInfo(a).then(d.hitch(this,function(c){b.resolve({name:c.displayName||c.name,type:"GPTask",url:a,definition:c})}),d.hitch(this,function(a){b.reject(a)}));
return b},getSubItemUrls:function(a){var b=new k;this.isUrlEndWithServiceType(a)?this.getRestInfo(a).then(d.hitch(this,function(c){c=g.map(c.tasks||[],d.hitch(this,function(b){return a+"/"+b}));b.resolve(c)}),d.hitch(this,function(a){b.reject(a)})):b.resolve([]);return b},getIconImageName:function(a,b){b="";"GPServer"===a.type?b="toolbox.png":"GPTask"===a.type&&(b="tool.png");return b}})},getImageServiceBrowserRule:function(a){return new l({leafTypes:["ImageServer"],serviceTypes:["ImageServer"],getItem:function(b){var c=
new k;this.isUrlEndWithServiceType(b)?this.defaultGetItem(b).then(d.hitch(this,function(b){a?f.isImageServiceSupportQuery(b.definition.capabilities)?c.resolve(b):c.resolve(null):c.resolve(b)}),d.hitch(this,function(a){c.reject(a)})):c.resolve(null);return c},getIconImageName:function(a,b){b="";"ImageServer"===a.type&&(b="image_layer.png");return b}})},getQueryableServiceBrowserRule:function(){var a=b.getFeaturelayerServiceBrowserRule(["point","polyline","polygon"],!0,!0),c=b.getImageServiceBrowserRule(!0);
return b.combineRules([a,c])}};return b})},"jimu/ServiceBrowserRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred jimu/utils esri/request esri/IdentityManager".split(" "),function(d,g,k,f,l,b,a){return d([],{leafTypes:null,serviceTypes:null,_restInfoCache:{},constructor:function(a){g.mixin(this,a);g.isArrayLike(this.leafTypes)||(this.leafTypes=[]);g.isArrayLike(this.serviceTypes)||(this.serviceTypes=[])},getItem:function(a){return this.defaultGetItem(a)},getSubItemUrls:function(a){return this.defaultGetSubItemUrls(a)},
getIconImageName:function(a,b){return""},defaultGetItem:function(a){var b=new f;a=a.replace(/\/*$/g,"");if(this.isUrlEndWithServiceType(a)){var c=a.split("/"),d=c[c.length-1],e=c[c.length-2];this.getRestInfo(a).then(g.hitch(this,function(c){b.resolve({name:e,type:d,url:a,definition:c})}),g.hitch(this,function(a){console.error(a);b.reject({errorCode:"NETWORK_ERROR",error:a})}))}else b.resolve(null);return b},defaultGetSubItemUrls:function(a){a=new f;a.resolve([]);return a},getRestInfo:function(c){var d=
new f;c=c.replace(/\/*$/g,"");var k=this._restInfoCache[c];if(k)d.resolve(k);else{var k={url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback",timeout:2E4},l=a.findCredential(c);l&&l.token&&(k.content.token=l.token);b(k).then(g.hitch(this,function(a){this._restInfoCache[c]=a;d.resolve(a)}),function(a){d.reject(a)})}return d},isServiceTypeSupported:function(a){a=a.toLowerCase();return k.some(this.serviceTypes,g.hitch(this,function(b){return b.toLowerCase()===a}))},isUrlEndWithServiceType:function(a){return k.some(this.serviceTypes,
g.hitch(this,function(b){return l.isStringEndWith(a,"/"+b)}))},isUrlContainsServiceType:function(a){a=a.toLowerCase();return k.some(this.serviceTypes,g.hitch(this,function(b){b=b.toLowerCase();return 0<=a.indexOf("/"+b)}))}})})},"widgets/PublicNotification/setting/QuerySourceSetting":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./QuerySourceSetting.html dojo/_base/lang dojo/_base/array dojo/on dojo/query dojo/Deferred dojo/Evented jimu/dijit/_FeaturelayerSourcePopup jimu/portalUrlUtils esri/request esri/lang jimu/utils jimu/dijit/Popup jimu/dijit/CheckBox jimu/dijit/LoadingShelter dijit/form/ValidationTextBox dojo/NodeList-data".split(" "),
function(d,g,k,f,l,b,a,c,h,n,p,e,q,t,r,m,u,x,w){return d([k,f,l,e],{baseClass:"jimu-widget-search-query-source-setting",templateString:b,nls:null,appConfig:null,map:null,tr:null,config:null,fieldsPopup:null,_layerDefinition:null,_fieldsCheckBox:null,_layerId:null,_suggestible:!1,_clickSet:!1,_defaultZoomScale:null,postCreate:function(){this.inherited(arguments);this.zoomScale.set("placeHolder",window.jimuNls.common.defaults);this.exactMatch=new w({checked:!1,label:this.nls.exactMatch},this.exactMatch);
this.searchInCurrentMapExtent=new w({checked:!1,label:this.nls.searchInCurrentMapExtent},this.searchInCurrentMapExtent);this._layerDefinition={};this._fieldsCheckBox=[];this._setMessageNodeContent("")},setDefinition:function(a){this._layerDefinition=a||{}},getDefinition:function(){return this._layerDefinition},setRelatedTr:function(a){this.tr=a},getRelatedTr:function(){return this.tr},setConfig:function(b){if("[object Object]"===Object.prototype.toString.call(b)){var c=b.url;c&&(this.config=b,this.shelter.show(),
this._layerDefinition.url!==c?this._getDefinitionFromRemote(c).then(a.hitch(this,function(b){c&&b&&"error"!==b.type?(this._layerDefinition=b,this._layerDefinition.url=c,this._setSourceItems(),this._setMessageNodeContent("")):c&&b&&"error"===b.type&&(this._setSourceItems(),this._disableSourceItems(),this._setMessageNodeContent(m.substitute({URL:b.url},a.clone(this.nls.invalidUrlTip)),!0));this.shelter.hide()})):(this._setMessageNodeContent(""),this._setSourceItems(),this.shelter.hide()))}},isValidConfig:function(){var a=
this.getConfig();return a.url&&a.name&&a.displayField?!0:!1},showValidationTip:function(){this._showValidationErrorTip(this.sourceUrl);this._showValidationErrorTip(this.sourceName)},getConfig:function(){return{layerId:this._layerId,url:this.sourceUrl.get("value"),name:u.stripHTML(this.sourceName.get("value")),placeholder:u.stripHTML(this.placeholder.get("value")),searchFields:this._getSearchFields(),displayField:this.displayField.get("value"),exactMatch:this.exactMatch.getValue(),searchInCurrentMapExtent:this.searchInCurrentMapExtent.checked,
zoomScale:this.zoomScale.get("value")||this._defaultZoomScale,maxSuggestions:this.maxSuggestions.get("value")||6,maxResults:this.maxResults.get("value")||6,type:"query"}},destroy:function(){this.inherited(arguments);this.fieldsPopup&&(this.fieldsPopup.close(),this.fieldsPopup=null);this.tr=this.nls=this.config=this._layerDefinition=null},_onSourceNameBlur:function(){this.sourceName.set("value",u.stripHTML(this.sourceName.get("value")))},_onPlaceholderBlur:function(){this.placeholder.set("value",u.stripHTML(this.placeholder.get("value")))},
_disableSourceItems:function(){this.sourceName.set("disabled",!0);this.placeholder.set("disabled",!0);this.searchFields.set("disabled",!0);g.setStyle(this.fieldsSelectorNode,"display","none");this.displayField.set("disabled",!0);this.maxSuggestions.set("disabled",!0);this.maxResults.set("disabled",!0);this.zoomScale.set("disabled",!0)},_enableSourceItems:function(){this.sourceName.set("disabled",!1);this.placeholder.set("disabled",!1);this.searchFields.set("disabled",!1);g.setStyle(this.fieldsSelectorNode,
"display","inline-block");this.displayField.set("disabled",!1);this.maxSuggestions.set("disabled",!1);this.maxResults.set("disabled",!1);this.zoomScale.set("disabled",!1)},_setSourceItems:function(){this.sourceUrl.set("value",this.config.url);this.sourceName.set("value",u.stripHTML(this.config.name||""));this.placeholder.set("value",u.stripHTML(this.config.placeholder||""));this._setSearchFields2Node();this.searchFields.set("value",this._getSearchFieldsAlias());this._setDisplayFieldOptions();this.displayField.set("value",
this.config.displayField||"");this.exactMatch.setValue(!!this.config.exactMatch);this.searchInCurrentMapExtent.setValue(!!this.config.searchInCurrentMapExtent);this.zoomScale.set("value",this.config.zoomScale||this._defaultZoomScale);this.maxSuggestions.set("value",this.config.maxSuggestions||6);this.maxResults.set("value",this.config.maxResults||6);this._layerId=this.config.layerId;(this._suggestible=this._layerDefinition&&this._layerDefinition.advancedQueryCapabilities&&this._layerDefinition.advancedQueryCapabilities.supportsPagination)?
this._hideSuggestibleTips():this._showSuggestibleTips();this._enableSourceItems()},_getDefinitionFromRemote:function(b){var c=new p,d=r({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});this.own(d);d.then(a.hitch(this,function(a){c.resolve(a)}),a.hitch(this,function(a){console.error(a);c.resolve({type:"error",url:this._getRequestUrl(b)})}));return c.promise},_setMessageNodeContent:function(a,b){g.empty(this.messageNode);a.nodeType||(a=g.toDom(a));g.place(a,this.messageNode);
b?g.setStyle(this.messageTr,"display",""):g.setStyle(this.messageTr,"display","none")},_getRequestUrl:function(a){var b=window.location.protocol;return"http:"===b?t.setHttpProtocol(a):"https:"===b?t.setHttpsProtocol(a):a},_setSearchFields2Node:function(){var a=null,b=this._layerDefinition&&this._layerDefinition.fields&&0<this._layerDefinition.fields.length;this.config&&this.config.searchFields&&0<this.config.searchFields.length||(a=[]);if(b)var d=this._layerDefinition.fields,a=c.filter(this.config.searchFields,
function(a){return c.some(d,function(b){return b.name===a})});else a=this.config.searchFields;this.searchFields.set("_fields",a)},_setDisplayFieldOptions:function(){var a=[];this._layerDefinition&&this._layerDefinition.fields&&0<this._layerDefinition.fields.length?a=c.map(this._layerDefinition.fields,function(a){return{label:a.alias||a.name||"",value:a.name||""}}):this.config&&this.config.displayField&&(a=[{label:this.config.displayField,value:this.config.displayField}]);this.displayField.set("options",
a)},_getSearchFieldsAlias:function(){var a=this._getSearchFields();if(!(a&&0<a.length))return"";if(this._layerDefinition&&this._layerDefinition.fields&&0<this._layerDefinition.fields.length){for(var b=this._layerDefinition.fields,d=c.map(b,function(a){return a&&a.name}),e=[],f=0,g=a.length;f<g;f++){var h=d.indexOf(a[f]);-1<h&&e.push(b[h].alias)}return e.join(",")}return a.join(",")},_getSearchFields:function(){return this.searchFields.get("_fields")},_setSearchFields:function(a){this.searchFields.set("_fields",
a)},_onSetSourceClick:function(){this._clickSet=!0;this._openServiceChooser()},_openQuerySourceChooser:function(){this._clickSet=!1;this._openServiceChooser()},_openServiceChooser:function(){var b=new q({titleLabel:this.nls.setLayerSource,dijitArgs:{multiple:!1,createMapResponse:this.map.webMapResponse,portalUrl:this.appConfig.portalUrl,style:{height:"100%"}}});h.once(b,"ok",a.hitch(this,function(a){b.close();this.setDefinition(a.definition||{});this.setConfig({layerId:a.layerInfo&&a.layerInfo.id||
null,url:a.url,name:a.name||"",placeholder:"",searchFields:[],displayField:this._layerDefinition.displayField||"",exactMatch:!1,zoomScale:this._defaultZoomScale,maxSuggestions:6,maxResults:6,type:"query"});b=null;this._setMessageNodeContent("");this._clickSet?this.emit("reselect-query-source-ok",a):this.emit("select-query-source-ok",a)}));h.once(b,"cancel",a.hitch(this,function(){b.close();b=null;this.emit("select-query-source-cancel")}))},_onFieldsSelectorClick:function(){var b=g.create("div",{style:{maxHeight:"480px"}}),
d=this._layerDefinition.fields;this._fieldsCheckBox=[];c.forEach(d,a.hitch(this,function(a,c){var d=new w({checked:this._isSearchable(a),label:a.alias||a.name});g.addClass(d.domNode,"fields-checkbox");g.addClass(d.labelNode,"jimu-ellipsis");g.setAttr(d.domNode,{title:a.alias||a.name});0===c%3&&(window.isRTL?g.setStyle(d.domNode,"marginRight",0):g.setStyle(d.domNode,"marginLeft",0));d.placeAt(b);n(d.domNode).data("fieldName",a.name);this._fieldsCheckBox.push(d)}));this.fieldsPopup=new x({titleLabel:this.nls.setSearchFields,
autoHeight:!0,content:b,container:window.jimuConfig.layoutId,width:640,maxHeight:600,buttons:[{label:this.nls.ok,onClick:a.hitch(this,"_onSearchFieldsOk")},{label:this.nls.cancel,classNames:["jimu-btn-vacation"]}],onClose:a.hitch(this,function(){this.fieldsPopup=null})});g.addClass(this.fieldsPopup.domNode,"jimu-widget-search-query-source-setting-fields")},_onSearchFieldsOk:function(){var a=[];c.forEach(this._fieldsCheckBox,function(b){if(b.getValue()){var c=n(b.domNode).data("fieldName");a.push(c[0]);
n(b.domNode).removeData()}});this._setSearchFields(a);this.searchFields.set("value",this._getSearchFieldsAlias());this.fieldsPopup.close()},_isSearchable:function(b){var d=this._getSearchFields();return c.some(d,a.hitch(this,function(a){return b.name===a}))},_showSuggestibleTips:function(){g.addClass(this.tipsNode,"source-tips-show");g.setStyle(this.maxSuggestions.domNode,"display","none")},_hideSuggestibleTips:function(){g.removeClass(this.tipsNode,"source-tips-show");g.setStyle(this.maxSuggestions.domNode,
"display","block")},_showValidationErrorTip:function(b){if(!b.validate()&&b.domNode&&b.focusNode){var c=b.get("disabled");c&&b.set("disabled",!1);b.focusNode.focus();setTimeout(a.hitch(this,function(){b.focusNode.blur();c&&b.set("disabled",!0);b=null}),100)}}})})},"jimu/dijit/_FeaturelayerSourcePopup":function(){define("dojo/_base/declare dojo/Evented dojo/on dojo/_base/lang dojo/_base/html jimu/dijit/Popup jimu/dijit/FeaturelayerSource jimu/dijit/LoadingIndicator esri/request".split(" "),function(d,
g,k,f,l,b,a,c,h){return d([b,g],{width:830,height:560,titleLabel:"",dijitArgs:null,postCreate:function(){this.inherited(arguments);l.addClass(this.domNode,"jimu-featurelayer-source-popup");this._initFls();this._initLoading()},getSelectedRadioType:function(){return this.fls.getSelectedRadioType()},_initFls:function(){this.fls=new a(this.dijitArgs);this.fls.placeAt(this.contentContainerNode);this.fls.startup();this.own(k(this.fls,"ok",f.hitch(this,function(a){if(0!==a.length){var b=a[0];if(b.definition)try{b.definition.name=
b.name,b.definition.url=b.url,this.emit("ok",b)}catch(e){console.error(e)}else this.loading.show(),h({url:b.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(f.hitch(this,function(a){if(this.domNode){this.loading.hide();b.definition=a;try{b.definition.name=b.name,b.definition.url=b.url,this.emit("ok",b)}catch(q){console.error(q)}}}),f.hitch(this,function(a){console.error(a);this.domNode&&this.loading.hide()}))}})));this.own(k(this.fls,"cancel",f.hitch(this,function(){try{this.emit("cancel")}catch(n){console.error(n)}})))},
_initLoading:function(){this.loading=new c({hidden:!0});this.loading.placeAt(this.domNode);this.loading.startup()}})})},"jimu/dijit/FeaturelayerSource":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/FeaturelayerSource.html dojo/_base/lang dojo/_base/html dojo/on dojo/Evented jimu/dijit/RadioBtn jimu/dijit/_FeaturelayerChooserWithButtons jimu/dijit/FeaturelayerChooserFromPortal jimu/dijit/_FeaturelayerServiceChooserContent jimu/portalUrlUtils".split(" "),
function(d,g,k,f,l,b,a,c,h,n,p,e,q,t){return d([g,k,f,h],{templateString:l,baseClass:"jimu-layer-source jimu-featurelayer-source",declaredClass:"jimu.dijit.FeaturelayerSource",nls:null,multiple:!1,createMapResponse:null,portalUrl:null,layerChooserFromMap:null,postMixInProperties:function(){this.nls=window.jimuNls.featureLayerSource;this.portalUrl=t.getStandardPortalUrl(this.portalUrl)},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedRadioType:function(){if(this.mapRadio.checked)return"map";
if(this.portalRadio.checked)return"portal";if(this.urlRadio.checked)return"url"},getSelectedItems:function(){var a=[];this.mapRadio.checked?a=this.flcMap.getSelectedItems():this.portalRadio.checked?a=this.flcPortal.getSelectedItems():this.urlRadio.checked&&(a=this.flcUrl.getSelectedItems());return a},startup:function(){this.inherited(arguments);this.flcMap.startup();this.flcPortal.startup();this.flcUrl.startup()},_initSelf:function(){this._initRadios();this._createFeaturelayerChooserWithButtons();
this._createFeaturelayerChooserFromPortal();this._createFeaturelayerServiceChooserContent();this._onRadioClicked()},_createFeaturelayerChooserWithButtons:function(){this.flcMap=new p({style:{width:"100%",height:"100%"},multiple:this.multiple,createMapResponse:this.createMapResponse,onlyShowWebMapLayers:!0,layerChooserFromMap:this.layerChooserFromMap});this.flcMap.operationTip=this.nls.selectLayer;this.flcMap.placeAt(this.flcContainer);this.own(c(this.flcMap,"ok",b.hitch(this,function(a){a&&0<a.length&&
this.emit("ok",a)})));this.own(c(this.flcMap,"cancel",b.hitch(this,function(){this.emit("cancel")})))},_createFeaturelayerChooserFromPortal:function(){this.flcPortal=new e({multiple:this.multiple,portalUrl:this.portalUrl,style:{width:"100%",height:"100%"}});this.flcPortal.operationTip=this.nls.chooseItem;this.flcPortal.placeAt(this.hflcContainer);this.own(c(this.flcPortal,"next",b.hitch(this,function(){this.flcPortal.operationTip=this.nls.chooseItem+" -\x3e "+this.nls.chooseLayer;this._updateOperationTip()})));
this.own(c(this.flcPortal,"back",b.hitch(this,function(){this.flcPortal.operationTip=this.nls.chooseItem;this._updateOperationTip()})));this.own(c(this.flcPortal,"ok",b.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(c(this.flcPortal,"cancel",b.hitch(this,function(){this.emit("cancel")})));0<=(this.portalUrl||"").toLowerCase().indexOf(".arcgis.com")?this.portalLabel.innerHTML=this.nls.selectFromOnline:this.portalLabel.innerHTML=this.nls.selectFromPortal},_createFeaturelayerServiceChooserContent:function(){this.flcUrl=
new q({multiple:this.multiple,style:{width:"100%",height:"100%"}});this.flcUrl.operationTip=this.nls.setServiceUrl;this.flcUrl.placeAt(this.flscContainer);this.own(c(this.flcUrl,"ok",b.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(c(this.flcUrl,"cancel",b.hitch(this,function(){this.emit("cancel")})))},_initRadios:function(){var a="featureLayerSourceRadios_"+this._getRandomString(),d=b.hitch(this,this._onRadioClicked);this.mapRadio=new n({group:a,onStateChange:d,checked:!0});
this.mapRadio.placeAt(this.mapTd,"first");this.portalRadio=new n({group:a,onStateChange:d,checked:!1});this.portalRadio.placeAt(this.portalTd,"first");this.urlRadio=new n({group:a,onStateChange:d,checked:!1});this.urlRadio.placeAt(this.urlTd,"first");this.own(c(this.mapLabel,"click",b.hitch(this,function(){this.mapRadio.check()})));this.own(c(this.portalLabel,"click",b.hitch(this,function(){this.portalRadio.check()})));this.own(c(this.urlLabel,"click",b.hitch(this,function(){this.urlRadio.check()})))},
_getRandomString:function(){var a=Math.random().toString();return a=a.slice(2,a.length)},_onRadioClicked:function(){a.setStyle(this.flcContainer,"display","none");a.setStyle(this.hflcContainer,"display","none");a.setStyle(this.flscContainer,"display","none");this.mapRadio.checked?(a.setStyle(this.flcContainer,"display","block"),this.operationTip.innerHTML=this.nls.selectLayer):this.portalRadio.checked?(a.setStyle(this.hflcContainer,"display","block"),this.operationTip.innerHTML=this.nls.chooseItem):
this.urlRadio.checked&&(a.setStyle(this.flscContainer,"display","block"),this.operationTip.innerHTML=this.nls.setServiceUrl);this._updateOperationTip()},_updateOperationTip:function(){this.mapRadio.checked?this.operationTip.innerHTML=this.flcMap.operationTip:this.portalRadio.checked?this.operationTip.innerHTML=this.flcPortal.operationTip:this.urlRadio.checked&&(this.operationTip.innerHTML=this.flcUrl.operationTip)}})})},"jimu/dijit/_FeaturelayerChooserWithButtons":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin jimu/dijit/FeaturelayerChooserFromMap".split(" "),
function(d,g,k,f,l,b,a,c,h){return l([b,a,c,g],{baseClass:"jimu-layer-chooser-with-buttons jimu-feature-layer-chooser-with-buttons",declaredClass:"jimu.dijit.FeaturelayerChooserWithButtons",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"chooser-container" data-dojo-attach-point\x3d"chooserContainer"\x3e\x3c/div\x3e\x3cdiv class\x3d"footer"\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.cancel}\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1 jimu-state-disabled" data-dojo-attach-point\x3d"btnOk"\x3e${nls.ok}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
layerChooserFromMap:null,constructor:function(a){this.options=a},postMixInProperties:function(){this.nls=k.clone(window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.layerChooser=this.layerChooserFromMap?this.layerChooserFromMap:new h(this.options);this.layerChooser.placeAt(this.chooserContainer);f.setStyle(this.layerChooser.domNode,{width:"100%",height:"100%"});this.own(d(this.layerChooser,"tree-click",k.hitch(this,function(){0<this.getSelectedItems().length?f.removeClass(this.btnOk,
"jimu-state-disabled"):f.addClass(this.btnOk,"jimu-state-disabled")})));this.own(d(this.btnOk,"click",k.hitch(this,function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)})));this.own(d(this.btnCancel,"click",k.hitch(this,function(){this.emit("cancel")})))},getSelectedItems:function(){return this.layerChooser.getSelectedItems()},startup:function(){this.inherited(arguments);this.layerChooser.startup()}})})},"jimu/dijit/FeaturelayerChooserFromMap":function(){define(["dojo/_base/declare",
"dojo/Deferred","dojo/_base/html","dojo/_base/lang","./LayerChooserFromMap"],function(d,g,k,f,l){return d([l],{baseClass:"jimu-featurelayer-chooser-from-map",declaredClass:"jimu.dijit.FeaturelayerChooserFromMap",types:null,showLayerFromFeatureSet:!1,showTable:!1,onlyShowVisible:!1,ignoredFeaturelayerIds:null,mustSupportStatistics:!1,ignoreVirtualLayer:!1,postMixInProperties:function(){this.inherited(arguments);this.ignoredFeaturelayerIds||(this.ignoredFeaturelayerIds=[]);this.basicFilter=f.hitch(this,
this.basicFilter);this.filter=l.createFeaturelayerFilter(this.types,this.showLayerFromFeatureSet,this.showTable,this.mustSupportStatistics);this.ignoreVirtualLayer&&(this.filter=l.andCombineFilters([this.filter,f.hitch(this,this._ignoreVirtualLayerFilter)]))},postCreate:function(){this.inherited(arguments);k.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},_ignoreVirtualLayerFilter:function(b){return b.getLayerType().then(function(a){return!("ArcGISDynamicMapServiceLayer"===a||"ArcGISTiledMapServiceLayer"===
a||"GroupLayer"===a)})},basicFilter:function(b){var a=new g;0<=this.ignoredFeaturelayerIds.indexOf(b.id)?a.resolve(!1):this.onlyShowVisible&&"Table"!==b.getLayerType()?a.resolve(b.isShowInMap()):a.resolve(!0);return a},getHandledItem:function(b){var a=this.inherited(arguments),c=b&&b.layerInfo,c=c&&c.layerObject;a.url=c&&c.url||"";return a}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(d,g,k,f,l,b,a,c,h,n,p,e,q,t,r,m,u,x){var w=k([f,l,b,g],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,
updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,displayTooltipForTreeNode:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);q.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new x({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=e.hitch(this,this.basicFilter);this.filter=w.andCombineFilters([this.basicFilter,
this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(a){var b=new c;this.onlyShowVisible?b.resolve(a.isShowInMap()):b.resolve(!0);return b},filter:function(a){a=new c;a.resolve(!0);return a},getSelectedItems:function(){var a=this.tree.getSelectedItems();return t.map(a,e.hitch(this,function(a){return this.getHandledItem(a)}))},getAllItems:function(){var a=this.tree.getAllItems(),b=[];t.forEach(a,e.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),
b.push(a))}));return b},getHandledItem:function(a){return{name:a.name,layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(a){this.createMapResponse=a;u.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(e.hitch(this,function(a){this.layerInfosObj=a;this.own(d(this.layerInfosObj,"layerInfosChanged",e.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&this.own(d(this.layerInfosObj,"layerInfosIsShowInMapChanged",
e.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(a,b){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(a){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(a){this._clear();q.setStyle(this.errorTipSection,"display","block");var b=[];this.onlyShowWebMapLayers?(b=a.getLayerInfoArrayOfWebmap(),b=b.concat(a.getTableInfoArrayOfWebmap())):(b=a.getLayerInfoArray(),
b=b.concat(a.getTableInfoArray()));0!==b.length&&(q.setStyle(this.errorTipSection,"display","none"),t.forEach(b,e.hitch(this,function(a){this._addDirectLayerInfo(a)})))},_addDirectLayerInfo:function(a){a&&a.getLayerObject().then(e.hitch(this,function(){this._addItem("root",a)}),e.hitch(this,function(a){console.error(a)}))},_clear:function(){var a=this._store.query({parent:"root"});t.forEach(a,e.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_addItem:function(a,b){var c=null,
d=b.getLayerType(),f=this.filter(b);p({layerType:d,valid:f}).then(e.hitch(this,function(d){if(d.valid){var f=e.hitch(this,function(e,f){this._id++;c={name:b.title||"",parent:a,layerInfo:b,type:d.layerType,layerClass:b.layerObject.declaredClass,id:this._id.toString(),isLeaf:e,hasChildren:f};this._store.add(c)}),g=b.getSubLayers(),h=0===g.length;h?f(h,!1):(g=t.map(g,e.hitch(this,function(a){return this.filter(a)})),p(g).then(e.hitch(this,function(a){(a=t.some(a,function(a){return a}))&&f(h,a)})))}}))},
_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var b=this._getRootItem(),b=new a({data:[b],getChildren:function(a){return this.query({parent:a.id})}});this._store=new h(b);b=new n({store:this._store,query:{id:"root"},mayHaveChildren:e.hitch(this,this._mayHaveChildren)});this.tree=new m({multiple:this.multiple,model:b,showRoot:!1,isLeafItem:e.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:e.hitch(this,function(a,b){"root"!==
a.id&&this._onTreeOpen(a,b)}),onClick:e.hitch(this,function(a,b,c){this._onTreeClick(a,b,c);this.emit("tree-click",a,b,c)}),getIconStyle:e.hitch(this,function(a,b){var c=null;if(!a||"root"===a.id)return null;var d={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},e=window.location.protocol+"//"+window.location.host+require.toUrl("jimu");if(a=this._getIconInfo(a,b).imageName)d.backgroundImage="url("+e+"/css/images/"+a+")",c=d;return c}),
getIconClass:e.hitch(this,function(a,b){return this._getIconInfo(a,b).className}),getTooltip:e.hitch(this,function(a){return this.displayTooltipForTreeNode?a.layerInfo.title:""})});q.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},_getIconInfo:function(a,b){var c="",d="";"ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===a.type?b?(c="mapserver_open.png",d="mapservice-layer-icon open"):
(c="mapserver_close.png",d="mapservice-layer-icon close"):"GroupLayer"===a.type?b?(c="group_layer2.png",d="group-layer-icon open"):(c="group_layer1.png",d="group-layer-icon close"):"FeatureLayer"===a.type?(a=r.getTypeByGeometryType(a.layerInfo.layerObject.geometryType),"point"===a?(c="point_layer1.png",d="point-layer-icon"):"polyline"===a?(c="line_layer1.png",d="line-layer-icon"):"polygon"===a&&(c="polygon_layer1.png",d="polygon-layer-icon")):"Table"===a.type?(c="table.png",d="table-icon"):"ArcGISImageServiceLayer"===
a.type||"ArcGISImageServiceVectorLayer"===a.type?(c="image_layer.png",d="iamge-layer-icon"):b?(c="mapserver_open.png",d="mapservice-layer-icon open"):(c="mapserver_close.png",d="mapservice-layer-icon close");return{imageName:c,className:d}},_onTreeOpen:function(a,b){if("root"!==a.id){var c=[];b=[];c=a.layerInfo.getSubLayers();a.checked||(this.shelter.show(),b=t.map(c,e.hitch(this,function(a){return a.getLayerObject()})),p(b).then(e.hitch(this,function(){this.domNode&&(t.forEach(c,e.hitch(this,function(b){this._addItem(a.id,
b)})),a.checked=!0,this.shelter.hide())}),e.hitch(this,function(a){console.error(a);this.shelter.hide()})))}},_onTreeClick:function(a,b,c){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});w.createFilterByLayerType=function(a){e.isArrayLike(a)||(a=[]);return function(b){var d=new c;if(0===a.length)d.resolve(!0);else{var e=[];b.traversal(function(a){e.push(a.getLayerType())});p(e).then(function(b){for(var c=0;c<
b.length;c++)for(var e=0;e<a.length;e++)if(b[c]===a[e]){d.resolve(!0);return}d.resolve(!1)},function(a){console.error(a);d.reject(a)})}return d}};w.createFeaturelayerFilter=function(a,b,c,d){var e=["point","polyline","polygon"];a&&0<a.length?(a=t.filter(a,function(a){return 0<=e.indexOf(a)}),0===a.length&&(a=e)):a=e;return function(e){var f=e.getLayerType();e=e.getLayerObject();return p({layerType:f,layerObject:e}).then(function(e){var f=e.layerType;e=e.layerObject;if("ArcGISDynamicMapServiceLayer"===
f||"ArcGISTiledMapServiceLayer"===f||"GroupLayer"===f||"FeatureCollection"===f)return!0;if("FeatureLayer"===f){var f=r.getTypeByGeometryType(e.geometryType),f=0<=t.indexOf(a,f),g=w._shouldPassStatisticsCheck(d,e);return e.url?(e=r.isFeaturelayerUrlSupportQuery(e.url,e.capabilities),f&&e&&g):b&&f}return"Table"===f?(f=r.isFeaturelayerUrlSupportQuery(e.url,e.capabilities),e=w._shouldPassStatisticsCheck(d,e),c&&f&&e):!1})}};w.createImageServiceLayerFilter=function(a,b){return function(c){var d=c.getLayerType();
c=c.getLayerObject();return p({layerType:d,layerObject:c}).then(function(c){var d=c.layerType,e=c.layerObject;return"ArcGISImageServiceLayer"===d||"ArcGISImageServiceVectorLayer"===d?a?r.isImageServiceSupportQuery(c.layerObject.capabilities)?b?w._shouldPassStatisticsCheck(b,e):!0:!1:!0:!1})}};w._shouldPassStatisticsCheck=function(a,b){return a?(a=!1,a=b.advancedQueryCapabilities?!!b.advancedQueryCapabilities.supportsStatistics:!!b.supportsStatistics):!0};w.createQueryableLayerFilter=function(a){var b=
w.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,a);a=w.createImageServiceLayerFilter(!0,a);return w.orCombineFilters([b,a])};w.andCombineFilters=function(a){return w._combineFilters(a,!0)};w.orCombineFilters=function(a){return w._combineFilters(a,!1)};w._combineFilters=function(a,b){return function(d){var e=new c,f=t.map(a,function(a){return a(d)});p(f).then(function(a){var c=!1,c=b?t.every(a,function(a){return a}):t.some(a,function(a){return a});e.resolve(c)},function(a){console.error(a);
e.reject(a)});return e}};return w})},"jimu/dijit/FeaturelayerChooserFromPortal":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/FeaturelayerChooserFromPortal.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/Deferred dojo/Evented dojo/promise/all jimu/dijit/ItemSelector jimu/dijit/FeaturelayerServiceBrowser jimu/portalUrlUtils esri/request".split(" "),function(d,g,k,f,l,b,a,c,h,n,p,e,q,t,
r,m,u){return d([g,k,f,e],{templateString:l,declaredClass:"jimu.dijit.FeaturelayerChooserFromPortal",baseClass:"jimu-service-chooser-from-portal jimu-featurelayer-chooser-from-portal",_serviceBrowserDef:null,portalUrl:null,multiple:!1,postMixInProperties:function(){this.nls=b.mixin({},window.jimuNls.common);this.nls=b.mixin(this.nls,window.jimuNls.featureLayerChooserFromPortal);this.portalUrl=m.getStandardPortalUrl(this.portalUrl);this.multiple=!0===this.multiple?!0:!1},postCreate:function(){this.inherited(arguments);
this._initSelf()},getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},_initSelf:function(){this.selector=new t({portalUrl:this.portalUrl,itemTypes:["Feature Service","Map Service"],onlyShowOnlineFeaturedItems:!1});this.own(h(this.selector,"item-selected",b.hitch(this,this._onItemSelected)));this.own(h(this.selector,"none-item-selected",b.hitch(this,this._onNoneItemSelected)));this.selector.placeAt(this.selectorContainer);this.selector.startup();this.serviceBrowser=new r({multiple:this.multiple});
this.own(h(this.serviceBrowser,"tree-click",b.hitch(this,this._onServiceBrowserClicked)));this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup()},_onItemSelected:function(){a.removeClass(this.btnNext,"jimu-state-disabled")},_onNoneItemSelected:function(){a.addClass(this.btnNext,"jimu-state-disabled")},_onBtnBackClicked:function(){this._serviceBrowserDef&&!this._serviceBrowserDef.isFulfilled()&&this._serviceBrowserDef.cancel();a.setStyle(this.btnOk,"display","none");
a.setStyle(this.btnNext,"display","block");a.setStyle(this.btnBack,"display","none");a.addClass(this.btnOk,"jimu-state-disabled");a.setStyle(this.selectorContainer,"display","block");a.setStyle(this.serviceBrowserContainer,"display","none");this.serviceBrowser.reset();this.emit("back")},_onBtnOkClicked:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnNextClicked:function(){var c=this.selector.getSelectedItem();c&&(a.setStyle(this.btnNext,"display","none"),a.setStyle(this.btnBack,
"display","block"),a.setStyle(this.btnOk,"display","block"),a.addClass(this.btnOk,"jimu-state-disabled"),a.setStyle(this.selectorContainer,"display","none"),a.setStyle(this.serviceBrowserContainer,"display","block"),this.serviceBrowser.reset(),this._serviceBrowserDef=this.serviceBrowser.setUrl(c.url||c.item),this._serviceBrowserDef.then(b.hitch(this,function(){this._serviceBrowserDef=null;this._setOkStateBySelectedItems()}),b.hitch(this,function(){this._serviceBrowserDef=null})),this.emit("next"))},
_setOkStateBySelectedItems:function(){0<this.serviceBrowser.getSelectedItems().length?a.removeClass(this.btnOk,"jimu-state-disabled"):a.addClass(this.btnOk,"jimu-state-disabled")},_onServiceBrowserClicked:function(){this._setOkStateBySelectedItems()},_onBtnCancelClicked:function(){this.emit("cancel")}})})},"jimu/dijit/ItemSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemSelector.html dojo/Evented dojo/_base/lang dojo/_base/config dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/promise/all dojo/query dojo/on dojo/dom-style jimu/utils jimu/portalUtils jimu/tokenUtils jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/Search jimu/dijit/TabContainer3 jimu/dijit/_ItemTable jimu/dijit/BindLabelPropsMixin dijit/form/RadioButton".split(" "),
function(d,g,k,f,l,b,a,c,h,n,p,e,q,t,r,m,u,x,w,v,B,z,C,F,y){return d([k,f,l,y,a],{templateString:b,declaredClass:"jimu.dijit.ItemSelector",baseClass:"jimu-item-selector",tab:null,_user:null,_group:null,_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_isPublicTabShow:!1,_signIn:!1,_itemTypeQueryString:"",
_typeKeywordQueryString:"",portalUrl:null,itemTypes:"",typeKeywords:"",showOnlineItems:!0,onlyShowOnlineFeaturedItems:!1,showMyContent:!0,showMyOrganization:!0,showMyGroups:!0,showPublic:!0,showOnlyEditableGroups:!1,postMixInProperties:function(){this.portalUrl=v.getStandardPortalUrl(this.portalUrl);this.showOnlineItems=!1===this.showOnlineItems?!1:!0;this.itemTypes&&0<this.itemTypes.length||(this.itemTypes=[]);this._itemTypes="";n.forEach(this.itemTypes,c.hitch(this,function(a,b){this._itemTypes+=
'"'+a+'"';b!==this.itemTypes.length-1&&(this._itemTypes+=",")}));this._itemTypes="["+this._itemTypes+"]";this.typeKeywords&&0<this.typeKeywords.length||(this.typeKeywords=[]);this._typeKeywords="";n.forEach(this.typeKeywords,c.hitch(this,function(a,b){this._typeKeywords+='"'+a+'"';b!==this.typeKeywords.length-1&&(this._typeKeywords+=",")}));this._typeKeywords="["+this._typeKeywords+"]";this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);var a=this._getPortalUrl();
this.portal=x.getPortal(a);this._initOptions();this._initSearchQuery();this._initTabs();this._initPortalRadio();this._initItemTables();this._initPublic();this._initPrivate();this._updateUIbySignIn()},_initOptions:function(){this._itemTypeQueryString=u.getItemQueryStringByTypes(this.itemTypes);this._typeKeywordQueryString=u.getItemQueryStringByTypeKeywords(this.typeKeywords)},_initTabs:function(){var a={title:this.nls.myContent,content:this.mycontentTabNode},b={title:this.nls.myOrganization,content:this.organizationTabNode},
d={title:this.nls.myGroup,content:this.groupTabNode},e={title:this.nls.publicMap,content:this.publicTabNode};m.set(this.mycontentTabNode,"display","none");m.set(this.organizationTabNode,"display","none");m.set(this.groupTabNode,"display","none");m.set(this.publicTabNode,"display","none");var f=[];this.showMyContent&&(f.push(a),m.set(this.mycontentTabNode,"display","block"));this.showMyOrganization&&(f.push(b),m.set(this.organizationTabNode,"display","block"));this.showMyGroups&&(f.push(d),m.set(this.groupTabNode,
"display","block"));this.showPublic&&(f.push(e),m.set(this.publicTabNode,"display","block"));this.tab=new C({tabs:f},this.tabNode);this.own(r(this.tab,"tabChanged",c.hitch(this,function(a){p.setStyle(this.signinSection,"display","none");a!==this.nls.publicMap?(this._isPublicTabShow=!1,this._updateUIbySignIn()):this._isPublicTabShow=!0})))},_updateUIbySignIn:function(){p.setStyle(this.signinSection,"display","none");var a=t(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",
this.domNode);w.userHaveSignInPortal(this._getPortalUrl())?a.style("display","block"):(a.style("display","none"),this._isPublicTabShow||p.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){var a=this._getPortalUrl(),a=v.getServerByUrl(a);this.portalPublicRaido.set("disabled",!1);this.onlinePublicRaido.set("disabled",!1);this.portalPublicRaido.set("checked",!0);var b=!1;v.isArcGIScom(a)?(b=!0,this.portalPublicLabel.innerHTML="ArcGIS.com"):(this.portalPublicLabel.innerHTML=
a,b=this.showOnlineItems?!1:!0);b&&(this.onlinePublicRaido.set("disabled",!0),p.setStyle(this.onlinePublicRaido,"display","none"),p.setStyle(this.onlinePublicLabel,"display","none"))},_initSearchQuery:function(){var a="esri_"+(h.locale&&h.locale.slice(0,2)||"en").toLowerCase(),b=n.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
c.hitch(this,function(b){return b!==a})),d="";n.forEach(b,c.hitch(this,function(a){d+=" -owner:"+a+" "}));b=" ";this.portal&&this.portal.user&&this.portal.user.orgId&&(b=" orgid:"+this.portal.user.orgId+" ");b=b+this._itemTypeQueryString+" AND access:public "+d+" "+this._typeKeywordQueryString;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:b});this._filterPublicPortalQuery=this._getQuery({q:b,basicQ:b});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",
sortOrder:"desc",q:(this.onlyShowOnlineFeaturedItems?' (group:"c755678be14e4a0984af36a15f5b643e"  OR group:"b8787a74b4d74f7fb9b8fac918735153") ':" ")+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._filterPublicOnlineQuery=this._getQuery({q:this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=
this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return c.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return v.getStandardPortalUrl(this.portalUrl)},_initItemTables:function(){"function"===typeof this.onCreateItemContent&&(this.mycontentItemTable.onCreateItemContent=this.onCreateItemContent,this.organizationItemTable.onCreateItemContent=this.onCreateItemContent,this.groupItemTable.onCreateItemContent=this.onCreateItemContent,
this.publicPortalItemTable.onCreateItemContent=this.onCreateItemContent,this.publicOnlineItemTable.onCreateItemContent=this.onCreateItemContent);this.own(r(this.publicPortalItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));this.own(r(this.publicOnlineItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));this.own(r(this.organizationItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));this.own(r(this.groupItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));
this.own(r(this.mycontentItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));this.own(r(this.publicPortalItemTable,"update",c.hitch(this,this._onItemTableUpdate)));this.own(r(this.publicOnlineItemTable,"update",c.hitch(this,this._onItemTableUpdate)));this.own(r(this.organizationItemTable,"update",c.hitch(this,this._onItemTableUpdate)));this.own(r(this.groupItemTable,"update",c.hitch(this,this._onItemTableUpdate)));this.own(r(this.mycontentItemTable,"update",c.hitch(this,this._onItemTableUpdate)));
var a=this._getPortalUrl();this.portalPublicRaido.get("disabled")||(this.publicPortalItemTable.set("portalUrl",a),this.publicPortalItemTable.searchAllItems(this._allPublicPortalQuery),this.publicPortalItemTable.set("filteredQuery",this._filterPublicPortalQuery));this.onlinePublicRaido.get("disabled")||(this.publicOnlineItemTable.set("portalUrl",window.location.protocol+"//www.arcgis.com"),this.publicOnlineItemTable.searchAllItems(this._allPublicOnlineQuery),this.publicOnlineItemTable.set("filteredQuery",
this._filterPublicOnlineQuery))},_initPublic:function(){this.own(r(this.portalPublicRaido,"click",c.hitch(this,this._onPublicRaidoClicked)));this.own(r(this.onlinePublicRaido,"click",c.hitch(this,this._onPublicRaidoClicked)));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.get("checked")?(this.publicPortalItemTable.show(),this.publicOnlineItemTable.hide()):this.onlinePublicRaido.get("checked")&&(this.publicPortalItemTable.hide(),this.publicOnlineItemTable.show())},
_onPublicSearch:function(a){(a=a&&c.trim(a))?(this.publicPortalItemTable.showFilterItemsSection(),this.publicOnlineItemTable.showFilterItemsSection(),this.portalPublicRaido.get("checked")?(this._filterPublicPortalQuery.q=a+" "+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalItemTable.searchFilteredItems(this._filterPublicPortalQuery)):this.onlinePublicRaido.get("checked")&&(this._filterPublicOnlineQuery.q=a+" "+this._itemTypeQueryString+" AND access:public "+
this._typeKeywordQueryString,this._filterPublicOnlineQuery.start=1,this.publicOnlineItemTable.searchFilteredItems(this._filterPublicOnlineQuery))):(this.publicPortalItemTable.showAllItemsSection(),this.publicOnlineItemTable.showAllItemsSection())},_initPrivate:function(){this._resetPortalMaps();this.own(r(this.groupsSelect,"change",c.hitch(this,this._onGroupsSelectChange)));var a=v.getServerByUrl(this._getPortalUrl());v.isArcGIScom(a)&&(a="ArcGIS.com");w.userHaveSignInPortal(this._getPortalUrl())&&
this._onSignIn()},_onOrganizationSearch:function(a){if(a=a&&c.trim(a)){if(this._allOrganizationQuery){var b=this._allOrganizationQuery.q;b&&(this._filterOrganizationQuery.q=a+" "+b,this._filterOrganizationQuery.start=1,this.organizationItemTable.searchFilteredItems(this._filterOrganizationQuery))}}else this.organizationItemTable.showAllItemsSection()},_onMyContentSearch:function(a){if(a=a&&c.trim(a)){if(this._allMyContentQuery){var b=this._allMyContentQuery.q;b&&(this._filterMyContentQuery.q=a+" "+
b,this._filterMyContentQuery.start=1,this.mycontentItemTable.searchFilteredItems(this._filterMyContentQuery))}}else this.mycontentItemTable.showAllItemsSection()},_onGroupSearch:function(a){if(a=a&&c.trim(a)){if(this._allGroupQuery){var b=this._allGroupQuery.q;b&&(this._filterGroupQuery.q=a+" "+b,this._filterGroupQuery.start=1,this.groupItemTable.searchFilteredItems(this._filterGroupQuery))}}else this.groupItemTable.showAllItemsSection()},_onSignIn:function(){this._updateUIbySignIn();if(!this._signIn){this._signIn=
!0;var a=this._getPortalUrl();x.getPortal(a).getUser().then(c.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),this._searchMyContent(a),this._searchGroups(a))}))}},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationItemTable.clear();this.mycontentItemTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){this.organizationItemTable.clear();a=" orgid:"+a.orgId+
" AND "+this._itemTypeQueryString+" AND (access:org OR access:public) "+this._typeKeywordQueryString;var b=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:a});this._filterOrganizationQuery=this._getQuery({q:a});this.organizationItemTable.set("portalUrl",b);this.organizationItemTable.searchAllItems(this._allOrganizationQuery)},_searchMyContent:function(a){this.mycontentItemTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;
this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentItemTable.set("portalUrl",b);this.mycontentItemTable.searchAllItems(this._allMyContentQuery)},_searchGroups:function(a){this._resetGroupsSection();p.setStyle(this.groupsSection,"display","flex");a=a.getGroups();if(0<a.length){p.setStyle(this.groupSearch.domNode,"display","block");this.groupItemTable.show();p.empty(this.groupsSelect);for(var b=0;b<a.length;b++){var c=a[b];p.create("option",
{value:c.id,innerHTML:c.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length)},_resetGroupsSection:function(){p.setStyle(this.groupsSection,"display","none");p.empty(this.groupsSelect);p.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupItemTable.clear();p.setStyle(this.groupSearch.domNode,"display","none");this.groupItemTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?p.setStyle(this.groupsSection,
"top","15px"):p.setStyle(this.groupsSection,"top","50px")},_onGroupsSelectChange:function(){var a=this.groupsSelect.value;this.groupItemTable.clear();if("nodata"===a)p.setStyle(this.groupSearch,"display","none"),this.groupItemTable.hide();else{p.setStyle(this.groupSearch,"display","block");this.groupItemTable.show();var b=this._getPortalUrl(),a="group:"+a+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});
this.groupItemTable.set("portalUrl",b);this.groupItemTable.searchAllItems(this._allGroupQuery)}},_onItemTableUpdate:function(){this.emit("update")},_onItemDomClicked:function(a){var b=p.hasClass(a,"jimu-state-active");t(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active");b&&p.addClass(a,"jimu-state-active");(a=this.getSelectedItem())?this.emit("item-selected",a):this.emit("none-item-selected")},getSelectedItem:function(){var a=null,b=t(".item.jimu-state-active",this.domNode);
0<b.length&&(a=c.mixin({},b[0].item));return a}})})},"jimu/dijit/_ItemTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),function(d,g,k,f,l,b,a,c,h,n,p,e,q,t,r,m){return d([g,k,f,b],{templateString:l,declaredClass:"jimu.dijit.ItemTable",
baseClass:"jimu-item-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"desktopapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&0<this.types.length||(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=r.getStandardPortalUrl(this.portalUrl));
this.showAllItemsSection();this.searchAllItems()},show:function(){h.setStyle(this.domNode,"display","block")},hide:function(){h.setStyle(this.domNode,"display","none")},searchAllItems:function(b){this.showAllItemsSection();b&&(this.query=a.mixin({},b),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),t.getPortal(this.portalUrl).queryItems(this.query).then(a.hitch(this,function(a){this.domNode&&(this.allItemsShelter.hide(),
this.query.start=a.nextStart,this._createItems(a,this.allItemTbody))}),a.hitch(this,function(a){console.error(a);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(b){this.showFilterItemsSection();b&&(this.filteredQuery=a.clone(b),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredItemShelter.show(),t.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(a.hitch(this,function(a){this.domNode&&
(this.showFilterItemsSection(),b&&this.clearFilteredItemsSection(),this.filteredQuery.start=a.nextStart,this._createItems(a,this.filteredItemsTbody),this._filterItemCallback())}),a.hitch(this,function(a){console.error(a);this.domNode&&this._filterItemCallback()})))},_filterItemCallback:function(){this.filteredItemShelter.hide();0<this._getItemCount(this.filteredItemsTbody)?(h.setStyle(this.filteredItemsTableDiv,"display","block"),h.setStyle(this.searchNoneTipSection,"display","none")):(h.setStyle(this.filteredItemsTableDiv,
"display","none"),h.setStyle(this.searchNoneTipSection,"display","block"))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){h.empty(this.allItemTbody)},clearFilteredItemsSection:function(){h.empty(this.filteredItemsTbody)},showAllItemsSection:function(){h.setStyle(this.allItemsSection,"display","block");h.setStyle(this.filteredItemsSection,"display","none")},showFilterItemsSection:function(){h.setStyle(this.allItemsSection,"display","none");
h.setStyle(this.filteredItemsSection,"display","block");h.setStyle(this.filteredItemsTableDiv,"display","block");h.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&this.searchFilteredItems()},_isScrollToBottom:function(a){return q.isScrollToBottom(a)},_createItems:function(b,d){b=b.results;var e=
c.map(this.types,a.hitch(this,function(a){return a.toLowerCase()}));b=c.filter(b,a.hitch(this,function(a){a=a.type&&a.type.toLowerCase()||"";return 0<=c.indexOf(e,a)}));if(0!==b.length){var f,g=p("td.empty",d),k;if(0<g.length){var l=Math.min(b.length,g.length),m=b.splice(0,l);for(k=0;k<l;k++){var n=g[k];f=this._createItem(m[k]);h.place(f,n);h.removeClass(n,"empty")}}if(0!==b.length){g=Math.ceil(b.length/2);for(k=0;k<g;k++)for(f=h.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),
h.place(f,d),l=p("td",f),m=0;m<l.length;m++)n=l[m],(f=b[2*k+m])?(f=this._createItem(f),h.place(f,n)):h.addClass(n,"empty");this.emit("update")}}},_getItemCount:function(a){return p(".item",a).length},_createItem:function(a){var b=h.toDom('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
b.item=a;var c=p(".item-thumbnail",b)[0],d=p(".item-name",b)[0],e=p(".item-type-owner",b)[0],f=p(".item-date",b)[0],g=p(".item-details",b)[0],k=p(".none-thumbnail-tip",b)[0];if(!a.thumbnailUrl){var l=this._defaultThumbnail[a.type];l&&(a.thumbnailUrl=require.toUrl("jimu")+"/images/"+l)}a.thumbnailUrl?h.setStyle(c,"backgroundImage","url("+a.thumbnailUrl+")"):k.innerHTML=this.nls.noneThumbnail;"function"===typeof this.onCreateItemContent?(f=p(".item-info",b)[0],this.onCreateItemContent(a,f)):(d.innerHTML=
a.title,d.title=d.innerHTML,e.innerHTML=a.type+" by "+a.owner,e.title=e.innerHTML,c=new Date,c.setTime(a.modified),f.innerHTML=c.toLocaleString(),f.title=f.innerHTML,g.innerHTML=this.nls.moreDetails,g.href=a.detailsPageUrl||"#");return b},_onItemsTableClicked:function(a){var b=a.target||a.srcElement;a=null;h.hasClass(b,"item-thumbnail")?a=b.parentNode:h.hasClass(b,"none-thumbnail-tip")&&(a=b.parentNode.parentNode);a&&(b=h.hasClass(a,"jimu-state-active"),p(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active"),
b?h.removeClass(a,"jimu-state-active"):h.addClass(a,"jimu-state-active"),this.emit("item-dom-clicked",a))},getSelectedItem:function(){var b=null,c=p(".item.jimu-state-active",this.domNode);0<c.length&&(b=a.mixin({},c[0].item));return b}})})},"jimu/dijit/FeaturelayerServiceBrowser":function(){define(["dojo/_base/declare","./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array","jimu/serviceBrowserRuleUtils"],function(d,g,k,f,l){return d([g],{baseClass:"jimu-featurelayer-service-browser",declaredClass:"jimu.dijit.FeaturelayerServiceBrowser",
url:"",multiple:!1,types:null,isSupportQuery:!0,postMixInProperties:function(){this.inherited(arguments);this.rule=l.getFeaturelayerServiceBrowserRule(this.types,this.isSupportQuery)},getSelectedItems:function(){var b=this.inherited(arguments);return b=f.map(b,k.hitch(this,function(a){return{name:a.name,url:a.url,definition:a.definition}}))}})})},"jimu/dijit/_FeaturelayerServiceChooserContent":function(){define(["dojo/_base/declare","./_BasicServiceChooserContent","./FeaturelayerServiceBrowser"],
function(d,g,k){return d([g],{baseClass:"jimu-featurelayer-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/MapServer","http://myserver/arcgis/rest/services/myservice/FeatureServer"],_createServiceBrowser:function(d){return new k(d)}})})},"dojo/NodeList-data":function(){define(["./_base/kernel","./query","./_base/lang","./_base/array","./dom-attr"],function(d,g,k,f,l){var b=g.NodeList,
a={},c=0,h=function(a){var b=l.get(a,"data-dojo-dataid");b||(b="pid"+c++,l.set(a,"data-dojo-dataid",b));return b},n=d._nodeData=function(b,c,d){var e=h(b),f;a[e]||(a[e]={});if(1==arguments.length)return a[e];"string"==typeof c?2<arguments.length?a[e][c]=d:f=a[e][c]:f=k.mixin(a[e],c);return f},p=d._removeNodeData=function(b,c){b=h(b);a[b]&&(c?delete a[b][c]:delete a[b])};b._gcNodeData=d._gcNodeData=function(){var b=g("[data-dojo-dataid]").map(h),c;for(c in a)0>f.indexOf(b,c)&&delete a[c]};k.extend(b,
{data:b._adaptWithCondition(n,function(a){return 0===a.length||1==a.length&&"string"==typeof a[0]}),removeData:b._adaptAsForEach(p)});return b})},"widgets/PublicNotification/setting/SettingBoxedDivs":function(){define(["dojo/_base/declare","./settingComponents","./SettingObject"],function(d,g,k){return d(k,{constructor:function(d,k){this._mainDiv=g.container(null,null,k)}})})},"widgets/PublicNotification/setting/SettingDropdownLabeled":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/on",
"./settingComponents","./SettingObject"],function(d,g,k,f,l){return d(l,{_inputControl:null,_inputControlDiv:null,_inputControlOnChange:null,_disableNextOnChange:!1,constructor:function(b,a,c,d,l,p,e,q){b=[];e=f.dropdownCtl(null,"full-width",e);b.push(e.div);this._inputControl=e.ctl;this._inputControlDiv=e.div;this._inputControlOnChange=q;this.own(k(this._inputControl,"change",g.hitch(this,this._onChange)));p&&b.push(f.text("hint",p));this._mainDiv=f.container("flexbox "+(a||""),"minorTrailingHorizGap",
[f.container("inline-block "+(c?c:""),"",[f.text("static-text",l)]),f.container("inline-block "+(d?d:""),"minorTrailingVertGap",b)])},setValue:function(b){this._inputControl&&this._inputControl.set("value",b)},getValue:function(){return this._inputControl?this._inputControl.get("value"):null},setConfig:function(){this._inputControl&&this._config&&this._config!==this.getValue()&&(this._disableNextOnChange=!0,this.setValue(this._config))},getConfig:function(b,a){this._inputControl&&(this._config=this.getValue())},
setOptions:function(b){this._inputControl&&this._inputControl.destroy();this._inputControl=f.dropdown(this._inputControlDiv,"full-width",b,this._inputControlOnChange)},_onChange:function(b){this._disableNextOnChange?this._disableNextOnChange=!1:this._inputControlOnChange(b)}})})},"widgets/PublicNotification/setting/SettingFieldListLabeled":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/on dojo/query jimu/dijit/CheckBox jimu/dijit/Popup ./settingComponents ./SettingObject".split(" "),
function(d,g,k,f,l,b,a,c,h,n,p,e,q){return g(q,{_echoArea:null,_fieldMenuItems:[],_fieldsCheckBoxes:[],_fieldsPopup:null,_nls:null,_label:"",constructor:function(a,b,d,f,g,h,l,n){a=[];var m=[];this._nls=b;this._label=h;this._fieldMenuItems=n;this._echoArea=e.text("variable-width inline-block readOnlyTextField");m.push(this._echoArea);b=e.iconButton("edit-button",b.tooltips.openFieldSelector);this.own(c(b,"click",k.hitch(this,this._onFieldsSelectorClick)));m.push(b);a.push(e.container("full-width flexbox",
"minorTrailingHorizGap",m));l&&a.push(e.text("hint",l));this._mainDiv=e.container("flexbox "+(d||""),"minorTrailingHorizGap",[e.container("inline-block "+(f?f:""),"",[e.text("static-text",h)]),e.container("inline-block "+(g?g:""),"minorTrailingVertGap",a)])},setDisplay:function(a){this._echoArea&&(this._echoArea.innerHTML=Array.isArray(a)&&0<a.length?a.join(","):"")},setConfig:function(){var a=[];Array.isArray(this._config)&&0<this._config.length&&d.forEach(this._config,k.hitch(this,function(b){d.some(this._fieldMenuItems,
function(c){return b===c.value?(a.push(c.label),!0):!1})}));this.setDisplay(a)},setFieldList:function(a){this._fieldMenuItems=a},_onFieldsSelectorClick:function(){var c=b.create("div",{style:{maxHeight:"480px"}});this._fieldsCheckBoxes=[];d.forEach(this._fieldMenuItems,k.hitch(this,function(b,d){var e=new n({checked:this._arrayContains(this._config,b.value),label:b.label});l.add(e.domNode,"fields-checkbox");l.add(e.labelNode,"jimu-ellipsis");f.set(e.domNode,"title",b.label);0===d%3&&(window.isRTL?
a.set(e.domNode,"marginRight",0):a.set(e.domNode,"marginLeft",0));e.placeAt(c);h(e.domNode).data("fieldName",b.value);this._fieldsCheckBoxes.push(e)}));this._fieldsPopup=new p({titleLabel:this._label,autoHeight:!0,content:c,container:window.jimuConfig.layoutId,width:640,maxHeight:600,buttons:[{label:jimuNls.common.ok,onClick:k.hitch(this,"_onSearchFieldsOk")},{label:jimuNls.common.cancel,classNames:["jimu-btn-vacation"]}],onClose:k.hitch(this,function(){this._fieldsPopup=null})});l.add(this._fieldsPopup.domNode,
"jimu-widget-public-notification-setting-fields")},_arrayContains:function(a,b){return d.some(a,function(a){return a===b})},_onSearchFieldsOk:function(){var a=[],b=[];d.forEach(this._fieldsCheckBoxes,function(c){if(c.getValue()){var d=h(c.domNode).data("fieldName");a.push(d[0]);h(c.domNode).removeData();b.push(c.label)}});this._config=a;this.setDisplay(b);this._fieldsPopup.close()}})})},"widgets/PublicNotification/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css",
"dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/_BasicServiceChooserContent.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"content-section"\x3e\r\n\t\t\x3ctable class\x3d"layout"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"80px" align\x3d"right"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"170px"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3eURL:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlInput" data-dojo-type\x3d"jimu/dijit/URLInput" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"jimu-btn jimu-state-disabled validate-btn jimu-float-trailing" data-dojo-attach-point\x3d"btnValidate" data-dojo-attach-event\x3d"onclick:_onBtnValidateClick"\x3e${nls.validate}\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"exampleTr" class\x3d"example-tr"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td" style\x3d"padding-top:5px;"\x3e\r\n\t\t\t\t\t\t\x3cspan title\x3d"${nls.example}:"\x3e${nls.example}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"exampleTd" colspan\x3d"2" style\x3d"padding-top:5px;font-style:italic;color:#ccc;"\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\r\n\t\t\t\x3cdiv class\x3d"error-section" data-dojo-attach-point\x3d"errorSection"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"error-message" data-dojo-attach-point\x3d"errorNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operations"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_onBtnCancelClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing jimu-state-disabled ok" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClick"\x3e${nls.ok}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/PublicNotification/setting/QuerySourceSetting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"source-url-section"\x3e\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.layerSource}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"sourceUrl" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true,disabled:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"third"\x3e\r\n            \x3cspan title\x3d"${nls.set}" class\x3d"jimu-btn" data-dojo-attach-event\x3d"click:_onSetSourceClick"\x3e${nls.set}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"messageTr"\x3e\r\n          \x3ctd class\x3d"first"\x3e\x3c/td\x3e\r\n          \x3ctd class\x3d"second" colspan\x3d"2"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"messageNode" class\x3d"tip error-message"\x3e\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"source-details-section"\x3e\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.name}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"sourceName" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-event\x3d"Blur:_onSourceNameBlur" data-dojo-props\x3d"trim:true,required:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.placeholder}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"placeholder" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-event\x3d"Blur:_onPlaceholderBlur" data-dojo-props\x3d"trim:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.searchFields}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv class\x3d"search-fields"\x3e\r\n            \x3c!-- \x3cspan class\x3d"fields jimu-float-leading" data-dojo-attach-point\x3d"fieldsNode"\x3e\x3c/span\x3e --\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"searchFields" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true,disabled:true,style:{width:\'95%\'}"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"search-fields-selector jimu-float-trailing" data-dojo-attach-point\x3d"fieldsSelectorNode" data-dojo-attach-event\x3d"click:_onFieldsSelectorClick"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.displayField}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"displayField" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d\'style:{width:"100%"}\'\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.maxSuggestions}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv class\x3d"source-tips" title\x3d"${nls.searchLayerTips}" data-dojo-attach-point\x3d"tipsNode"\x3e\r\n            \x3cem\x3e${nls.searchLayerTips}\x3c/em\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"maxSuggestions" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1,places:0},style:{width:\'100%\'},value:6"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.maxResults}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"maxResults" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1,places:0},style:{width:\'100%\'},value:6"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr data-dojo-attach-point\x3d"zoomScaleTr"\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.zoomScale}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cspan class\x3d"jimu-float-leading" style\x3d"line-height:30px;"\x3e1: \x3c/span\x3e\r\n          \x3cdiv class\x3d"jimu-float-trailing" data-dojo-attach-point\x3d"zoomScale" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1},style:{width:\'96%\'}"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/table\x3e\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"exactMatch"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"searchInCurrentMapExtent"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/FeaturelayerSource.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"map-td" nowrap data-dojo-attach-point\x3d"mapTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"mapLabel"\x3e${nls.selectFromMap}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"portal-td" nowrap data-dojo-attach-point\x3d"portalTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalLabel"\x3e${nls.selectFromPortal}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"url-td" nowrap data-dojo-attach-point\x3d"urlTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"urlLabel"\x3e${nls.addServiceUrl}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"source-content"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"operationTip" class\x3d"operation-tip"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"flcContainer" class\x3d"dijit-container map-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"hflcContainer" class\x3d"dijit-container portal-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"flscContainer" class\x3d"dijit-container url-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/FeaturelayerChooserFromPortal.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"selector-container" data-dojo-attach-point\x3d"selectorContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"footer"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-point\x3d"btnCancel" data-dojo-attach-event\x3d"onclick:_onBtnCancelClicked"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing next jimu-state-disabled" data-dojo-attach-point\x3d"btnNext" data-dojo-attach-event\x3d"onclick:_onBtnNextClicked"\x3e${nls.next}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-state-disabled" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClicked"\x3e${nls.ok}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing back" data-dojo-attach-point\x3d"btnBack" data-dojo-attach-event\x3d"onclick:_onBtnBackClicked"\x3e${nls.back}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/ItemSelector.html":'\r\n\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"setting-tab-container"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cdiv\x3e${nls.groups}:\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:85px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cfieldset id\x3d"publicSearchRaido"\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" data-dojo-type\x3d"dijit/form/RadioButton" \r\n\t\t\t\t\t\t\tdata-label-id\x3d"portalPublicRaido" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalPublicLabel" data-label-for\x3d"portalPublicRaido" class\x3d"jimu-float-leading portal-public-label"\x3ePortal\x3c/label\x3e\r\n\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" data-dojo-type\x3d"dijit/form/RadioButton"\r\n\t\t\t\t\t\t\tdata-label-id\x3d"onlinePublicRaido" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlinePublicLabel" data-label-for\x3d"onlinePublicRaido" class\x3d"jimu-float-leading portal-public-label"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\t\x3c/fieldset\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicItemSection" class\x3d"public-item-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip jimu-state-error-text"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/PublicNotification/setting/Setting.html":'\x3cdiv data-dojo-attach-point\x3d"mainContainer" class\x3d"main-container"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"tabsContainer" class\x3d"full-height"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/PublicNotification/setting/css/style.css":'.jimu-widget-public-notification-setting .addTextButton-button {margin: 8px 0; display: inline-block; position: relative; padding-left: 22px; color: #518dca; background: url("images/add_icon.png") no-repeat left; cursor: pointer;}.jimu-rtl .jimu-widget-public-notification-setting .addTextButton-button {padding-left: 0; padding-right: 22px; background-position: right;}.jimu-widget-public-notification-setting .addTextButton-button .addTextButton-menu {position: absolute; display: none; list-style-type: none; top: 16px; left: 0; margin: 0; padding: 0; background: #fafafa; color: #7989a0; z-index: 999;}.jimu-rtl .jimu-widget-public-notification-setting .addTextButton-button .addTextButton-menu {right: 0; left: auto;}.jimu-widget-public-notification-setting .addTextButton-button:hover .addTextButton-menu {display: inline-block;}.jimu-widget-public-notification-setting .addTextButton-menu .addTextButton-item {white-space: nowrap; height: 30px; padding: 0 25px; line-height: 30px;}.jimu-widget-public-notification-setting .addTextButton-menu .addTextButton-item:hover {background: #edf2f5; color: #15a4fa;}.jimu-widget-public-notification-setting .fieldset {height: auto; width: 100%; border: 1px solid #a0acbf; border-radius: 5px; color: #596679; min-width: 0px;}.jimu-ltr .jimu-widget-public-notification-setting .fieldsetLegend {margin-left: 20px;}.jimu-rtl .jimu-widget-public-notification-setting .fieldsetLegend {margin-right: 20px;}.jimu-widget-public-notification-setting .fieldsetMainContainer {padding: 8px;}.jimu-widget-public-notification-setting.main-container {width: 100%; height: 100%; overflow: hidden; font-size: 14px;}.jimu-widget-public-notification-setting .jimu-viewstack {height: calc(100% - 42px);}.jimu-widget-public-notification-setting .view {overflow: auto;}.jimu-widget-public-notification-setting .tab-contents {padding: 10px 2px 1px 2px;}.jimu-widget-public-notification-setting .category-panel {width: 270px; overflow-y: auto; overflow-x: hidden;}.jimu-widget-public-notification-setting .details-panel {width: calc(100% - 290px); overflow-y: auto; overflow-x: hidden;}.jimu-widget-public-notification-setting .details-label {width: 120px; vertical-align: top;}.jimu-widget-public-notification-setting .details-value {width: calc(100% - 125px);}.jimu-widget-public-notification-setting .jimu-btn {line-height: 28px;}.jimu-ltr .jimu-widget-public-notification-setting .majorTrailingHorizGap {margin-right: 24px;}.jimu-rtl .jimu-widget-public-notification-setting .majorTrailingHorizGap {margin-left: 24px;}.jimu-ltr .jimu-widget-public-notification-setting .minorTrailingHorizGap {margin-right: 5px;}.jimu-rtl .jimu-widget-public-notification-setting .minorTrailingHorizGap {margin-left: 5px;}.jimu-widget-public-notification-setting .majorTrailingVertGap {margin-bottom: 12px;}.jimu-widget-public-notification-setting .minorTrailingVertGap {margin-bottom: 2px;}.jimu-widget-public-notification-setting .edit-button {background: url(images/edit_icon.png) no-repeat center; cursor: pointer; width: 20px; height: 30px; -webkit-flex-shrink: 0; flex-shrink: 0;}.jimu-widget-public-notification-setting .edit-button:hover {background-color: rgba(36, 181, 204, 0.4);}.jimu-widget-public-notification-setting .hint {font-size: 12px; font-style: italic; color: #999999; margin-top: 5px;}.jimu-widget-public-notification-setting .static-text {margin-top: 5px;}.jimu-ltr .jimu-widget-public-notification-setting .dijitNumberTextBox .dijitInputInner {text-align: left;}.jimu-rtl .jimu-widget-public-notification-setting .dijitNumberTextBox .dijitInputInner {text-align: right;}.jimu-widget-public-notification-setting .italic {font-style: italic;}.jimu-widget-public-notification-setting .full-width {width: 100%;}.jimu-widget-public-notification-setting .full-height {height: 100%;}.jimu-widget-public-notification-setting .half-width {width: 50%;}.jimu-widget-public-notification-setting .third-width {width: 33%;}.jimu-widget-public-notification-setting .two-thirds-width {width: 66%;}.jimu-ltr .jimu-widget-public-notification-setting .indented {padding-left: 22px;}.jimu-rtl .jimu-widget-public-notification-setting .indented {padding-right: 22px;}.jimu-widget-public-notification-setting .clear {clear: both;}.jimu-widget-public-notification-setting .inline-block {display: inline-block;}.jimu-widget-public-notification-setting .flexbox {display: -webkit-flex; display: flex;}.jimu-widget-public-notification-setting .variable-width {-webkit-flex-grow: 1; flex-grow: 1;}.jimu-widget-public-notification-setting .optionsTableHeaderHeight {margin-top: 36px;}.jimu-widget-public-notification-setting .hidden {visibility: hidden;}.jimu-widget-public-notification-setting .hiddenEmpty {display: none;}.jimu-widget-public-notification-setting .readOnlyTextField {border: solid #d9dde0 1px; padding: 5px 10px; min-height: 30px;}.jimu-widget-public-notification-setting-fields .fields-checkbox {width: 167px; margin-bottom: 20px; color: #596679; font-size: 14px; margin-left: 30px;}.jimu-widget-public-notification-setting-fields .fields-checkbox .label {width: 140px;}.jimu-rtl .jimu-widget-public-notification-setting-fields .fields-checkbox {margin-right: 30px; margin-left: auto;}.jimu-widget-public-notification-setting .wrapText {word-wrap: break-word; overflow-wrap: break-word;}.override-geocode-service-chooser-content {width: 580px !important; min-height: 150px !important;}.override-geocode-service-chooser-content .service-browser-container{display: none;}.jimu-widget-public-notification-setting .esriCTMarginZero {margin-bottom: 0px; color: #596679;}',
"*now":function(d){d(['dojo/i18n!*preload*widgets/PublicNotification/setting/nls/Setting*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/on dojo/string jimu/BaseWidgetSetting jimu/dijit/Message jimu/dijit/TabContainer3 jimu/LayerInfos/LayerInfos ./convert ./SettingAddresseesBlock ./SettingBufferBlock ./SettingCheckbox ./SettingCheckboxLabeled ./SettingContainer ./SettingInputLabeled ./SettingLabelFormats ./SettingOptionsTable ./SettingSearchSourcesBlock ./SettingStaticText dojo/domReady!".split(" "),function(d,g,k,f,l,b,a,c,h,n,p,e,q,
t,r,m,u,x,w,v,B,z){return g([c],{baseClass:"jimu-widget-public-notification-setting",_descriptions:[],_guidance:null,_webmapFeatureLayers:[],postCreate:function(){this.inherited(arguments);p.getInstance(this.map,this.map.itemInfo).then(k.hitch(this,function(a){this._webmapFeatureLayers=this._getWebmapFeatureLayers(a);this._descriptions=[];this._descriptions.push(this._createSearchSourceSettings());this._descriptions.push(this._createAddressSourceSettings());this._descriptions.push(this._createNotificationSettings());
this._updateAddresseeSources(a);this.setConfig(this.config);this._initTabs(this.tabsContainer,this._descriptions)}))},setConfig:function(a){this.config=k.mixin({},a||{},this.config);this.config.searchSourceSettings.drawing.tools=e.toolCodesToLabels(this.nls.propertyLabels,this.config.searchSourceSettings.drawing.tools);this.config.searchSourceSettings.drawing.buffer.bufferUnitsMenu=e.unitCodesToLabels(jimuNls.units,this.config.searchSourceSettings.drawing.buffer.bufferUnitsMenu);this.config.notificationSettings.labelFormats=
this._initializeLabelFormats(this.config.notificationSettings.labelFormats,this.config.labelFormatTemplates);d.forEach(this._descriptions,k.hitch(this,function(a){a.content.setConfig(this.config)}))},getConfig:function(){var a=[];d.forEach(this._descriptions,k.hitch(this,function(b){b.content.getConfig(this.config,a)}));this.config.searchSourceSettings.search&&this.config.searchSourceSettings.search.sources&&0!==this.config.searchSourceSettings.search.sources.length||a.push(this.nls.problems.noSearchSourcesConfigured);
this.config.searchSourceSettings.geometryServiceURL||a.push(this.nls.problems.noGeometryServiceURL);0>this.config.searchSourceSettings.drawing.buffer.bufferUnitsMenu[0].indexOf("1")&&a.push(this.nls.problems.noBufferUnitsForDrawingTools);this.config.searchSourceSettings.drawing.tools=e.labelsToToolCodes(this.nls.propertyLabels,this.config.searchSourceSettings.drawing.tools);this.config.searchSourceSettings.drawing.buffer.bufferUnitsMenu=e.labelsToUnitCodes(jimuNls.units,this.config.searchSourceSettings.drawing.buffer.bufferUnitsMenu);
return 0<a.length?(new h({message:"\x3cul\x3e\x3cli\x3e"+a.join("\x3c/li\x3e\x3cli\x3e")+"\x3c/li\x3e\x3c/ul\x3e"}),!1):this.config},getDataSources:function(){},destroy:function(){d.forEach(this._descriptions,function(a){a.node&&l.destroy(a.node)});this._descriptions=[];this.inherited(arguments)},_initializeLabelFormats:function(b,c){var e;if(Array.isArray(b)&&2<=b.length)return b;e=[a.rep("0",c.length)];d.forEach(c,function(b){var c={hint:""};"CSV"===b.labelSpec.type?c.name=this.nls.placeholders.descriptionCSV:
(c.name=a.substitute(this.nls.placeholders.descriptionPDF,b.descriptionPDF),b.descriptionPDF.averyPartNumber&&(c.hint=a.substitute(this.nls.placeholders.averyExample,b.descriptionPDF)));c.labelSpec=k.clone(b.labelSpec);e.push(c)},this);return e},_getWebmapFeatureLayers:function(a){var b=[];a=a.getLayerInfoArray();d.forEach(a,function(a){"ArcGISFeatureLayer"===a.originOperLayer.layerType&&b.push({name:a.title,layerId:a.id,url:a.originOperLayer.url,displayField:a.originOperLayer.layerObject.displayField,
fields:a.originOperLayer.layerObject.fields})});return b},_updateAddresseeSources:function(a){var b=[],c=[""],e;a=a.getLayerInfoArray();d.forEach(a,function(a){a.originOperLayer.popupInfo&&a.originOperLayer.popupInfo.description&&b.push(a)});this.config.addresseeSourceSettings.sources=this.config.addresseeSourceSettings.sources||[""];e=this.config.addresseeSourceSettings.sources[0];a=this.config.addresseeSourceSettings.sources.slice(1);d.forEach(a,function(a,f){var g=-1;d.some(b,function(b,c){return b.title===
a.name?(g=c,!0):!1})&&(c[0]+=e[f],c.push(a),b.splice(g,1))});d.forEach(b,function(a){c[0]+="0";c.push({name:a.title,useRelatedRecords:0===a.layerObject.relationships.length?null:!1})});this.config.addresseeSourceSettings.sources=c},_initTabs:function(a,c){var e=[],f;d.forEach(c,function(a){e.push({title:a.title,content:a.node})});f=new n({tabs:e,"class":"full-height"});f.placeAt(a);this.own(b(f,"tabChanged",k.hitch(this,function(){f.containerNode.scrollTop=0})))},_createSearchSourceSettings:function(){var a,
b=this.nls;a={title:b.searchSourceSetting.title,node:l.create("div",{"class":"tab-contents"}),content:null};a.content=new u("searchSourceSettings","","majorTrailingVertGap",[new z(null,"full-width hint",b.searchSourceSetting.mainHint),new x("geometryServiceURL",!1,"full-width","details-label","details-value",b.propertyLabels.urlToGeometryService),new B("search",b,"",this.map,this._webmapFeatureLayers,this.appConfig.portalUrl),new u("drawing","flexbox","majorTrailingHorizGap",b.groupingLabels.drawingTools,
"full-width",[new u("","","majorTrailingVertGap",[new v("tools","category-panel","",b.propertyLabels.tool,null,b.hints.selectionListOfOptionsToDisplay),new r("select",b.propertyLabels.useSelectionDrawTools)]),new t("buffer",b,"details-panel","details-label","details-value",this.config.bufferTemplate,b.propertyLabels.bufferDefaultDistance,"100")])]);l.place(a.content.div(),a.node);return a},_createAddressSourceSettings:function(){var a,b=this.nls;a={title:b.addressSourceSetting.title,node:l.create("div",
{"class":"tab-contents"}),content:null};var c=new r("showReviewButton",b.propertyLabels.reviewCheckboxLabel);f.add(c._mainDiv,"esriCTMarginZero");a.content=new u("addresseeSourceSettings","","majorTrailingVertGap",[new z(null,"full-width hint",b.addressSourceSetting.mainHint),new q("sources",b),c,new z(null,"full-width hint",b.hints.reviewButtonHint)]);l.place(a.content.div(),a.node);return a},_createNotificationSettings:function(){var a,b=this.nls;a={title:b.notificationSetting.title,node:l.create("div",
{"class":"tab-contents"}),content:null};this._guidance=new u("guidance","inline-block indented"+(this.config.notificationSettings.labelPageOptions.showGuidance?"":" hiddenEmpty"),"majorTrailingVertGap",[new m("showLabelOutlines","full-width","half-width","half-width",b.propertyLabels.showLabelOutlines),new m("showGrid","full-width","half-width","half-width",b.propertyLabels.showGridTickMarks),new x("noteFontSizePx",!0,"full-width","half-width","half-width",b.propertyLabels.fontSizeAlignmentNote,"7",
"","",b.propertyLabels.pixels,{min:4,max:12,places:0}),new x("gridBlackPercent",!0,"full-width","half-width","half-width",b.propertyLabels.gridDarkness,"25","","",b.propertyLabels.percentBlack,{min:0,max:100,places:0}),new x("labelBorderBlackPercent",!0,"full-width","half-width","half-width",b.propertyLabels.labelBorderDarkness,"100","","",b.propertyLabels.percentBlack,{min:0,max:100,places:0}),new x("leftIn",!0,"full-width","half-width","half-width",b.propertyLabels.gridlineLeftInset,"0.1667","",
"",jimuNls.units.inches,{min:0}),new x("rightIn",!0,"full-width","half-width","half-width",b.propertyLabels.gridlineRightInset,"0.1667","","",jimuNls.units.inches,{min:0}),new x("majorTickIn",!0,"full-width","half-width","half-width",b.propertyLabels.gridlineMajorTickMarksGap,"1","","",jimuNls.units.inches,{min:.039}),new x("minorTickIn",!0,"full-width","half-width","half-width",b.propertyLabels.gridlineMinorTickMarksGap,"0.1","","",jimuNls.units.inches,{min:.039})]);a.content=new u("notificationSettings",
"","majorTrailingVertGap",[new z(null,"full-width hint",b.notificationSetting.mainHint),new w("labelFormats",b,""),new u("labelPageOptions","flexbox","majorTrailingHorizGap",b.groupingLabels.printingOptions,"full-width",[new u(null,"half-width inline-block","majorTrailingVertGap",[new x("rasterResolutionPxPerIn",!0,"full-width hiddenEmpty","","full-width",b.propertyLabels.rasterResolution,"150",b.hints.rasterResolution,"",b.propertyLabels.pixelsPerInch,{min:100,max:200,places:0}),new r("useVectorFonts",
b.propertyLabels.useVectorFonts),new r("addCSVHeader",b.propertyLabels.addCSVHeader)]),new u(null,"half-width inline-block","majorTrailingVertGap",[new r("showGuidance",b.propertyLabels.showAlignmentAids,"",k.hitch(this,this._showHideGuidance)),this._guidance])])]);l.place(a.content.div(),a.node);return a},_showHideGuidance:function(a){a?f.remove(this._guidance._mainDiv,"hiddenEmpty"):f.add(this._guidance._mainDiv,"hiddenEmpty")}})});