//>>built
require({cache:{"fx3d/views/3d/support/fx3dUtils":function(){define("dojo/_base/array dojox/validate/regexp esri/core/mathUtils esri/core/libs/gl-matrix-2/vec3f64 esri/core/libs/gl-matrix-2/mat4f64 esri/core/libs/gl-matrix-2/vec3 esri/core/libs/gl-matrix-2/mat4 esri/views/3d/support/earthUtils dojo/text!../effects/config.json".split(" "),function(p,a,k,m,e,f,g,h,l){m=m.vec3f64;e=e.mat4f64;f=f.vec3;g=g.mat4;var c=h.earthRadius,b=k.deg2rad(1),d=k.rad2deg(1),n=m.fromValues(0,0,1),t=f.normalize(m.fromValues(1,
1,1),m.fromValues(1,1,1)),r=e.create(),w=m.create(),u=m.create(),q=m.create(),E=m.create();l=JSON.parse(l);var x;window.fx3d={version:"1.2.3",description:"javascript library for 3D data visualization",copyright:"Esri R\x26D Center Beijing"};var z={layerId:"3dfx-",enableAddTesting:!0,debug_timeCost:!0,debug_showPoint:!1,debug_clearEarth:!1,KeySplit:"$",NotFound:"NULL",CSVDateFileSuffix:"_dates",DataFormatNotSupported:"not-supported",DateToValueOfTime:-1,wgs84ToSphericalEngineCoords:function(d,n,a,
e){var v=c+d[n+2],f=b*d[n+1];d=b*d[n];n=Math.cos(f);a[e++]=Math.cos(d)*n*v;a[e++]=Math.sin(d)*n*v;a[e]=Math.sin(f)*v},sphericalEngineCoordsToWGS84:function(b,n,a,e){var v=b[n],f=b[n+1],q=b[n+2],v=Math.sqrt(v*v+f*f+q*q),f=k.asinClamped(b[n+2]/v);b=(0<b[n+1]?1:-1)*k.acosClamped(b[n]/(Math.cos(f)*v));a[e++]=d*b;a[e++]=d*f;a[e]=v-c},wgs84ToWebMerc:function(d,n,a,e){var v=.4999999*Math.PI,f=b*d[n+1],f=z.clamp(f,-v,v),v=Math.sin(f);a[e++]=b*d[n]*c;a[e++]=c/2*Math.log((1+v)/(1-v));a[e]=d[n+2]},webMercToWGS84:function(b,
n,a,e){a[e++]=d*(b[n++]/c);a[e++]=d*(Math.PI/2-2*Math.atan(Math.exp(-1*b[n++]/c)));a[e]=b[n]},clamp:function(b,d,c){return b<d?d:b>c?c:b},checkTimeSlider:function(b){var d=null;return b instanceof Array&&p.some(b,function(b){if(b.attributes.pointId===z.DateToValueOfTime){d={};for(var c in b.attributes)c.startWith("valueOfTime")&&(d[c]=b.attributes[c]);return!0}}),d},isDigit:function(b){return null!==/^-?\d+\.?\d*$/.exec(b)&&""!==b},rgba2float:function(b){return b[0]/256+b[1]/65536+b[2]/16777216},
endsWith:function(b,d){return-1!==b.indexOf(d,b.length-d.length)},mod:function(b,d){var c;return c=parseInt(b/d,10),b-=c*d,0>b&&(b+=d),b},nextHighestPowerOfTwo:function(b){--b;for(var d=1;32>d;d<<=1)b|=b>>d;return b+1},isPowerOfTwo:function(b){return 0===(b&b-1)&&0!==b},doubleTo2Floats:function(b){var d,c,n;return 0<=b?(n=65536*Math.floor(b/65536),d=n,c=b-d):(n=65536*Math.floor(-b/65536),d=-n,c=b+n),[d,c]},vec3DoubleTo2Floats:function(b){if(b instanceof Array){for(var d=[],c=0;c<b.length;c++)d.push(this.doubleTo2Floats(b[c]));
return d}},littleEndian:function(){var b=new ArrayBuffer(2);return(new DataView(b)).setInt16(0,256,!0),256===(new Int16Array(b))[0]}(),Log:{Info:0,Warn:1,Error:2,msg:function(b,d,c){if("number"==typeof b&&"string"==typeof d&&"string"==typeof c)switch(b){case this.Info:console.info(d+": "+c);break;case this.Warn:console.warn(d+": "+c);break;case this.Error:console.error(d+": "+c)}}},ExpDataSourceType:{CSV:"csv",FeatureServer:"featureserver",Grib2:"grib2",Volume:"volume"},EffectType:{AreaExtrude:"AreaExtrude",
DensityMesh:"DensityMesh",PointExtrude:"PointExtrude",Bounce:"Bounce",Pulse:"Pulse",Fireball:"Fireball",JetTrail:"JetTrail",LineBox:"LineBox",Worm:"Worm",HeatLine:"HeatLine",DensityWall:"DensityWall",HeatGrid:"HeatGrid",Current:"Current",Cascade:"Cascade",Volume:"Volume"},EffectDataFormat:{AreaExtrude:{keyFields:["boundaryId"],checkRules:["multi time values"]},DensityMesh:{keyFields:["areaId"],checkRules:["multi time values"]},PointExtrude:{keyFields:["pointId"],checkRules:["multi time values"]},
Bounce:{keyFields:["pointId"],checkRules:["multi time values"]},Pulse:{keyFields:["pointId"],checkRules:["single time value"]},Fireball:{keyFields:["pointId","pathId"],checkRules:["single time value"]},JetTrail:{keyFields:["pointId","pathId"],checkRules:["single time value"]},LineBox:{keyFields:["pointId","pathId"],checkRules:["single time value"]},Worm:{keyFields:["pointId","pathId"],checkRules:["single time value"]},HeatLine:{keyFields:["pointId","pathId"],checkRules:["multi time values"]},DensityWall:{keyFields:["pointId",
"pathId"],checkRules:["multi time values"]},HeatGrid:{keyFields:["gfs"],checkRules:["multi time values"]},Current:{keyFields:["gfs"],checkRules:["multi time values"]},Cascade:{keyFields:["pointId","pathId"],checkRules:["multi time values"]}},EffectDataType:{AreaType:["DensityMesh"],BoundaryType:["AreaExtrude"],PathType:"Cascade Fireball JetTrail LineBox Worm HeatLine DensityWall".split(" "),PointType:["PointExtrude","Bounce","Pulse"],GfsType:["HeatGrid","Current"],VolumeType:["Volume"]},getLayerTypeOfVolume:function(b){switch(b){case "Q":return 1;
case "N":case "N2":return 2;case "P2s":return 3;case "P1x":return 4;case "P1s":return 5;case "C2t":case "C3t":return 6;case "C2b":return 7;case "O1l":case "O1+2":return 8}return 0},groupLayerType:function(b){var d,c;for(d in b)if("N"===d)for(c in b)"N2"===c&&delete b[c];else if("N2"===d)for(c in b)"N"===c&&delete b[c];else if("O1l"===d)for(c in b)"O1+2"===c&&delete b[c];else if("O1+2"===d)for(c in b)"O1l"===c&&delete b[c];else if("C2t"===d)for(c in b)"C3t"===c&&delete b[c];else if("C3t"===d)for(c in b)"C2t"===
c&&delete b[c]},addTestEffect:function(b,d){if("string"==typeof b&&"string"==typeof d){var c;"point"===d?c=this.EffectDataType.PointType:"area"===d?c=this.EffectDataType.AreaType:"path"===d?c=this.EffectDataType.PathType:"boundary"===d?c=this.EffectDataType.BoundaryType:"gfs"===d?c=this.EffectDataType.GfsType:"volume"===d&&(c=this.EffectDataType.Volume);c instanceof Array&&(this.EffectType[b]=b,c.push(b))}},TypeCheckResult:{NOT_MATHCH:1,TYPE_FIELD_MISSED:2,ALL_FIELDS_MISSED:3,ITEM_VALUE_INVALID:4,
SUCCESS:100,SUCCESS_AreaType:101,SUCCESS_BoundaryType:102,SUCCESS_PathType:103,SUCCESS_PointType:104,SUCCESS_GfsType:105,SUCCESS_VolumeType:106},pairCheck:function(b,d){if("string"==typeof b&&"string"==typeof d)for(var c=this.EffectDataType[b],n=0;n<c.length;n++)if(c[n]===d)return this.TypeCheckResult["SUCCESS_"+b];return this.TypeCheckResult.NOT_MATHCH},checkDataEffect:function(b,d){var c=this.TypeCheckResult.SUCCESS;if(b instanceof Array){for(var n=c=!1,a=!1,e=!1,f=!1,q=0;q<b.length;q++)c||"pointid"!=
b[q].toLowerCase()||(c=!0),n||"pathid"!=b[q].toLowerCase()||(n=!0),a||"areaid"!=b[q].toLowerCase()||(a=!0),e||"boundaryid"!=b[q].toLowerCase()||(e=!0),f||"bhid"!=b[q].toLowerCase()||(f=!0);c=!a||e||n||!c||f?a||!e||n||!c||f?a||e||!n||!c||f?a||e||n||!c||f?a||e||n||c||!f?this.TypeCheckResult.TYPE_FIELD_MISSED:this.pairCheck("VolumeType",d):this.pairCheck("PointType",d):this.pairCheck("PathType",d):this.pairCheck("BoundaryType",d):this.pairCheck("AreaType",d)}else c=this.TypeCheckResult.ALL_FIELDS_MISSED;
return c},GFSDataGroupLen:{HeatGrid:1,Current:2},checkEffectGFSPair:function(b,c){return"number"==typeof b&&"string"==typeof c&&b===this.GFSDataGroupLen[c]},isInforAttrChanged:function(b,c){function d(b,c){var e,f=!1;if("function"==typeof b&&"function"==typeof c||b instanceof Date&&c instanceof Date||b instanceof RegExp&&c instanceof RegExp||b instanceof String&&c instanceof String||b instanceof Array&&c instanceof Array||b instanceof Number&&c instanceof Number)b.toString()!==c.toString()&&0<c.toString().length&&
(f=!0);else if("object"==typeof b&&"object"==typeof c){if(null!==c)for(e in c)if(b.hasOwnProperty(e)){if(n.push(b),a.push(c),d(b[e],c[e])){f=!0;b[e]=c[e];break}n.pop();a.pop()}}else isNaN(b)&&isNaN(c)&&"number"==typeof b&&"number"==typeof c&&(f=!1),b!==c&&(f=!0);return f}var n,a;return n=[],a=[],d(b,c)},ColorUtil:{_colors:[],_pos:[],_min:0,_max:1,setColors:function(b){var c,d;if(b||(b=[[220,220,220],[20,20,20]]),this._colors=[],this._pos=[],b instanceof Array){b=b.slice(0);for(c=0;c<b.length;c++)if(col=
b[c],col instanceof Array){for(d in col)0>col[d]&&(col[d]=0),255<col[d]&&(col[d]=255);this._colors.push(col)}for(c=0;c<this._colors.length;c++)this._pos.push(c/(this._colors.length-1))}},getColor:function(b){var c,d,n,a,e;c=(b-this._min)/(this._max-this._min);c=Math.min(1,Math.max(0,c));for(b=0;b<this._pos.length;b++){if(d=this._pos[b],c<=d){n=this._colors[b];break}if(c>=d&&b===this._pos.length-1){n=this._colors[b];break}if(c>d&&c<this._pos[b+1]){a=this._colors[b];e=this._colors[b+1];a instanceof
Array&&e instanceof Array||(n=[123,123,123]);c=(c-d)/(this._pos[b+1]-d);(!c||0>c)&&(c=.5);n=[a[0]+c*(e[0]-a[0]),a[1]+c*(e[1]-a[1]),a[2]+c*(e[2]-a[2])];break}}return[n[0],n[1],n[2]]}},createColorBarTexture:function(b,c,d){b=b||32;c=c||1;x||(x=document.createElement("canvas"));x.width=b;x.height=c;var n,a,e=x.getContext("2d"),f=e.createImageData(b,c),q=0;z.ColorUtil.setColors(d);for(d=0;d<c;d++)for(a=0;a<b;a++)n=a/(b-1),n=z.ColorUtil.getColor(n),f.data[q++]=n[0],f.data[q++]=n[1],f.data[q++]=n[2],f.data[q++]=
255;return e.putImageData(f,0,0),x},CatmullRomUtil:{getPoints:function(b,c){b||(b=10);for(var d=[],n=0;n<=b;n++)d.push(this._getPoint(n/b,c));return d},_getPoint:function(b,c){var d,n,a,e,f=[];b*=c.length-1;e=Math.floor(b);b-=e;f[0]=0===e?e:e-1;f[1]=e;f[2]=e>c.length-2?c.length-1:e+1;f[3]=e>c.length-3?c.length-1:e+2;e=c[f[0]];var q=c[f[1]],t=c[f[2]];c=c[f[3]];return d=this._interpolate(b,e[0],q[0],t[0],c[0]),n=this._interpolate(b,e[1],q[1],t[1],c[1]),a=this._interpolate(b,e[2],q[2],t[2],c[2]),[d,
n,a]},_interpolate:function(b,c,d,n,a){c=.5*(n-c);a=.5*(a-d);var e=b*b;return(2*d-2*n+c+a)*b*e+(-3*d+3*n-2*c-a)*e+c*b+d}},createTextTexture:function(b,c,d,n,a,e){x||(x=document.createElement("canvas"));var f=x.getContext("2d");f.font=c+"px "+a;var q,t,r,g=function(b){var c;c=b.ownerDocument;b=b.getBoundingClientRect();var d=c.body,n=c.documentElement;c=null!=c&&c==c.window?c:9===c.nodeType&&(c.defaultView||c.parentWindow);return{top:b.top+(c.pageYOffset||n.scrollTop||d.scrollTop)-(n.clientTop||d.clientTop||
0),left:b.left+(c.pageXOffset||n.scrollLeft||d.scrollLeft)-(n.clientLeft||d.clientLeft||0)}},g=function(b){for(var c=1;c<b;)c*=2;return c},h=function(b,c,d,n){c=c.replace("\n"," ");var a,e,f=c,q=0,t=0,r=c.split(" ");for(c=e=r.length;b.measureText(f).width>d&&1<c;){c--;for(var f=a="",g=0;g<e;g++)g<c?(f+=r[g],g+1<c&&(f+=" ")):(a+=r[g],g+1<e&&(a+=" "))}return n.push(f),t=b.measureText(f).width,a&&(q=h(b,a,d,n),q>t&&(t=q)),t},l=512,v=[];switch(l&&f.measureText(b).width>l?(l=h(f,b,l,v),q=g(l)):(v.push(b),
q=g(f.measureText(b).width)),t=g(c*(v.length+1)),q<t&&(q=t),x.width=q,x.height=t,n){case "left":r=0;break;case "center":r=q/2;break;case "right":r=q}b=t/2;f.fillStyle=e;f.fillRect(0,0,f.canvas.width,f.canvas.height);f.fillStyle=d;f.textAlign=n;f.textBaseline="middle";f.font=c+"px "+a;g=.5*(t-c*(v.length+1));for(d=0;d<v.length;d++)1<v.length&&(b=(d+1)*c+g),f.fillText(v[d],r,b);return x},createLinearHaloTexture:function(b,c){b instanceof Array&&3===b.length||(b=[255,255,255]);c instanceof Array&&3===
c.length||(c=[255,255,0]);x||(x=document.createElement("canvas"));x.width=128;x.height=2;var d=x.getContext("2d"),n=d.createLinearGradient(0,1,x.width,1);b="rgba("+b[0]+","+b[1]+","+b[2]+",1.0)";c="rgba("+c[0]+","+c[1]+","+c[2]+",0.05)";return n.addColorStop(0,c),n.addColorStop(.4,b),n.addColorStop(.6,b),n.addColorStop(1,c),d.fillStyle=n,d.fillRect(0,0,x.width,x.height),x},createRadialTexture:function(b,c){b instanceof Array&&3===b.length||(b=[255,255,255]);c instanceof Array&&3===c.length||(c=[0,
0,0]);x||(x=document.createElement("canvas"));x.width=256;x.height=256;var d=x.getContext("2d"),n=[.5*x.width,.5*x.height],n=d.createRadialGradient(n[0],n[1],0,n[0],n[1],.5*Math.min(x.height,x.width));c="rgba("+c[0]+","+c[1]+","+c[2]+",1.0)";return n.addColorStop(0,"rgba("+b[0]+","+b[1]+","+b[2]+",1.0)"),n.addColorStop(.5,c),n.addColorStop(1,"rgba(0, 0, 0, 0.0)"),d.fillStyle=n,d.fillRect(0,0,x.width,x.height),d.fillRect(0,0,x.width,x.height),x},rgb2hexExt:function(b){return b instanceof Array&&3===
b.length?"#"+("0"+parseInt(b[0],10).toString(16)).slice(-2)+("0"+parseInt(b[1],10).toString(16)).slice(-2)+("0"+parseInt(b[2],10).toString(16)).slice(-2):"#000000"},toPercent:function(b){return(100*parseFloat(b)).toString()+"%"},updateColorBar:function(b,c,d,n){if(b&&d instanceof Array&&c instanceof Array){var a=c.length;c="bottom: 4px;right: 4px;font-size: 12px;";n?(c+="width: "+60*a+"px;",c+="height: 80px;"):(c+="width: 80px;",c+="height: "+50*a+"px;");b.style.cssText="position: absolute; display: block; z-index: 110; background-color: rgb(0,0,0); background-color: rgba(0,0,0,0.5); border-width: 0px; border-radius: 1px; border-style: solid; border-color: rgba(255,255,255,0.3); -webkit-box-shadow: 0 1px 1px rgba(0,0,0,0.05); box-shadow: 0 1px 1px rgba(0,0,0,0.05);";
b.style.cssText+=c;c=document.createElement("canvas");n?(c.height=.4*b.clientHeight,c.width=b.clientWidth):(c.height=b.clientHeight,c.width=.4*b.clientWidth);for(var a=c.getContext("2d"),e=null,e=n?a.createLinearGradient(0,0,c.width,c.height):a.createLinearGradient(0,0,0,c.height),f=0;f<d.length;f++)!(d[f]instanceof Object)||null===d[f].step&&null==d[f].step||null===d[f].color&&null==d[f].color||e.addColorStop(d[f].step,this.rgb2hexExt(d[f].color));a.fillStyle=e;a.fillRect(0,0,c.width,c.height);a=
document.getElementById("3dexpColorBar");a.src=c.toDataURL();a.style.width=c.width+" px";a.style.height=c.height+" px";a=document.getElementsByClassName("3dexpSpanLabel");if(b&&0<a.length)for(;0<a.length;)b.removeChild(a[0]);for(a=0;a<d.length;a++)!(d[a]instanceof Object)||null===d[a].label&&null==d[a].label||null===d[a].step&&null==d[a].step||(e=document.createElement("span"),e.className="3dexpSpanLabel",e.style.cssText="position: absolute; left: 46px; font-family: 'Arial', sans-serif; font-size: 12px; color: #e0e0e0; font-style: italic;",
n?(e.style.cssText+="top: "+1.5*c.height+"px",e.style.cssText+="left: "+this.toPercent(.99<d[a].step?d[a].step-.14:d[a].step)+";"):(e.style.cssText+="left: "+1.5*c.width+"px",e.style.cssText+="top: "+this.toPercent(.99<d[a].step?d[a].step-.06:d[a].step)+";"),e.innerHTML="\x3cspan\x3e"+d[a].label+d[a].unit+"\x3c/span\x3e",b.appendChild(e))}},createColorBar:function(){var b=document.createElement("div");document.body.appendChild(b);var c=document.createElement("img");return c.id="3dexpColorBar",b.appendChild(c),
b},showColorBar:function(b,c){b&&(c?b.style.display="block":b.style.display="none")},isEqual:function(b,c){function d(b,c){var e;if(null===b&&null===c||"undefined"==typeof b&&"undefined"==typeof c)return!0;if(null===b&&null!==c||null===c&&null!==b||"undefined"==typeof b&&"undefined"!=typeof c||"undefined"==typeof c&&"undefined"!=typeof b)return!1;if(isNaN(b)&&isNaN(c)&&"number"==typeof b&&"number"==typeof c||b===c)return!0;if("function"==typeof b&&"function"==typeof c||b instanceof Date&&c instanceof
Date||b instanceof RegExp&&c instanceof RegExp||b instanceof String&&c instanceof String||b instanceof Number&&c instanceof Number)return b.toString()===c.toString();if(-1<n.indexOf(b)||-1<a.indexOf(c))return!1;if(null!==c){for(e in c)if(c.hasOwnProperty(e)!==b.hasOwnProperty(e)||typeof c[e]!=typeof b[e])return!1;for(e in b){if(c.hasOwnProperty(e)!==b.hasOwnProperty(e)||typeof c[e]!=typeof b[e])return!1;switch(typeof b[e]){case "object":case "function":if(n.push(b),a.push(c),!d(b[e],c[e]))return!1;
n.pop();a.pop();break;default:if(b[e]!==c[e])return!1}}}return!0}var n,a;return n=[],a=[],!!d(b,c)},equals:function(b,c){var d,n;return b===c||typeof b==typeof c&&("object"==typeof b?b.constructor===b.constructor&&(b instanceof Array?b.length===c.length&&b.every(function(b,d){return equals(b,c[d])}):b instanceof RegExp?b.toString()===c.toString():(d=Object.keys(b),n=Object.keys(c),d.length===n.length&&d.every(function(d){return equals(b[d],c[d])}))):"function"==typeof b?b.toString()===c.toString():
b===c)},isUrl:function(b){var c="^"+a.url({allowNamed:!0,allowLocal:!0});return(new RegExp(c,"g")).test(b)},_isRequiredTypesIn:function(b,c){var d=0;return p.forEach(c,function(c){for(var n=0;n<b.length;n++)b[n].type!=c||d++}),c.length===d},availableVizTypes:function(b,c){return(b=l[b])?b:[]},effectConfig:function(b){var c=Object.getOwnPropertyNames(l),d=null;return p.some(c,function(c){return p.some(l[c],function(c){if(b.toLowerCase()===c.name.toLowerCase())return d=c,!0})}),d},extensionsMessage:function(){var b=
document.createElement("div");b.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+y+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e";b.style.position="fixed";b.style.top="0";b.style.width="100%";b.style.color="#ff0000";b.style.zIndex=1E6;document.body.appendChild(b)},sortHelper:function(b,c,d){return b===c?0:b<c?d?1:-1:
b>c?d?-1:1:0},spriteImg:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2hpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxQzIyMkFCODFFMjA2ODExODNEMTgzRDNCQjcwNzU3NCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3QTc4QjM3QTI0OTAxMUU2ODFGMjk2MjI2NkE0Q0FCMiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3QTc4QjM3OTI0OTAxMUU2ODFGMjk2MjI2NkE0Q0FCMiIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MUMyMjJBQjgxRTIwNjgxMTgzRDE4M0QzQkI3MDc1NzQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MUMyMjJBQjgxRTIwNjgxMTgzRDE4M0QzQkI3MDc1NzQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5DNIzlAABfxElEQVR42uy9WZPkSJIeaGqAR0QedXR1T0+T3JndEcrKCsmVlX3lC388fwRnH1Yo2xSSc3edmRkRDpiumanaCTPAAHePjOwyK4nKCHcADsChqp9+egEiir766uvXuWS/BX311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX3311RVAX311BdBXX311BdBXX311BdBXX311BdBXX311BdBXX311BdBXX311BdBXX311BdBXX311BdBXX3198Wv84w9bm6D+gd0HxuYXd3x25TTggvNcO27Tu203AbB+H+Cm3zBc+qWVjwGlveEqF4OHH5flkfCix+/mX84tV5s8jF0HXv97d3KAUH3q4IbPGlxBflaPAeX3YK+Ab9377ICIl3+P2B/trgCuLfDQchDWBRD/sbILXO2aUkOABeGGgwIEjYqh5ZgtSgsK+hR3qhm4Bi7tCuDPSejhckUB+7ZvEfprIk+04BwWlh2W+mlTQKBB3GADk+KB68YKNIFt4L8p5fBrVgbjr1Lo94kZNL4BFavfqgxu5RZsCV3kwa8qiTV5gh3bHLHCC9RQ9K4KqApbjo9Fc4BdAfw5w3u42B24ZLuaMOy1yrAB5VEc50hlYS/cgPG4UykcheZQQAO48zvADRGHX4MiGH9VQl9+B/YeD/YqGgwPLLYJvvv3UncBrnjvzKlLSAUCM2Hc8u+hwQ63cBNY+GXx2VhGP0ukAE3KCbsC+FKF/pgDAA0fsHmMqhsARdgNC1jeKj4tAHf/MVoRCWRE4xH/fo+LAFt2HOv3tCbMUOMb/py5gvHPR+hha0s4qkRgWwCq++O2IED13+vQgqkOuiytYy2CsOfIa67CljuBsYlfuefpsbBZmB2iaXEpsCuAV2Dl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CqJE8rUn/kCS1tsSVgSs8xJ5M48tZZEKnm+7kXQMqoUn11qe733o4nODBn99FRX4PmC4VAI7j7umBLYU1jbvUE5tWx8Uus0HvCrBf00KoEkR7BD4xXsbKb2lqDxA+QFZt9zYTEK2wP9YGUEForfCcmx8KNeCm3tj3EvSDG3TEKi00gKxj1EP+yz3VDuE78iE3erwG/hCBP81KoC9imBVGUC7osAEBItijHerJ0HV8kcoBjLbgqtEG1bDpwt+YtPSQzLFqJWfaR3BttfCYoXEKyUmtR//eorrMApYuWkoXukaxetdLdN/F9tA2/4Li5+RV7nLsKl0cFsRbNcU5FThuhLMQ4uljLZm6B9mb1Zh9ZoL1Y4IsNi5pxUFrMP7ddx1iyy9Lwbqf4kKoFkRQCMqWLwPdXSAdSRQPl7bXOOjAyzLyAEWCuOwAqgYMBQNpdB7/O2oZ0CpmErtIPD2ps7uF+66Ct7sOAziy1ij+HJWS+Rgy1rngrNat7DSMbaZTMSWMGOLQAbYDI0CckQBtEL//dY1gv0c/0e8TKHUPqelLfiR9/DAfegK4DO6B0vhhP18QsEdKPl9LSHFkudbhrxl/3/dBaj9np78lhsAWIfdRx5+zK6pHc7v/5wlosArQHVcmT74BQv+l64AWq39PmRQcRWcUFRKhKv74naTk3JUHzZh+VbaqhDH0lBLnwcXC2Qd3quGe7M3t34rFoMHr+nPSvD/XBTAPmVQTkZpjjZsDJFYcwvaG5vCzWD4HuHHnWwFVoS7ul3TyPhtf79tMgNeqBzrGYKiK4AvyUUAITb6xG+iA4y2ySDCnszFMnLIpw+V3sEdDyVUmfbq+UJ9dt5Ra3iUh9gJ1Re9yFuyMvAK19cVwBeDCrDJq92FDnCDH2iy+ssmpVjAAulZx21B9vvQrT4+iFIfwn2CsQfeH4fhAEeQwK9S6H9NCqD+ZZZ6Ee3gBSow1m+3Mjxliwis9xssh/6uIUhrVXdw8XG2XZJbWWJcvdO/UqH/tSqA8hedwu69D0d7tmLdTWhJsnFjQ3OlhVVrCk3KR6yglaMt17eU0kXCvpLk0XbcuvP1q1y/ZgVwRLCP7Iebj99aglECc/eNbL8IUu+7J9ew7tgquyJrbYaXf9+iK4C+9vIARxTCnhqDvedwtYcayhKGV76vu/aBl//cX8UCxH5v+urr17pkvwV99dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF999dUVQF99dQXQV199dQXQV199dQXQV199dQXQV199dQXQV199dQXQV199dQXQV199dQXQV199dQXQV199ffHr/xdgAKO3NCOK/8ywAAAAAElFTkSuQmCC",
rgbNames:{aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],
darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,
144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,
216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,
170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,
232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,
128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},calculatePerfectPosition:function(c,d,a,e){(null==e||1E-6>Math.abs(e))&&(e=32.25);f.set(E,c[0],c[1],c[2]);f.cross(w,E,n);0==f.dot(w,w)&&f.cross(w,E,t);g.identity(r);g.rotate(r,
r,-b*a,E);g.rotate(r,r,-b*e,w);f.normalize(u,E);f.scale(q,u,d);f.add(E,E,q);f.transformMat4(f.negate(u,u),f.negate(u,u),r);return f.scale(u,u,d*Math.tan(b*e)),f.add(E,E,u),E}},y='The 3DFx requires a browser that supports `OES_element_index_uint` and `OES_texture_float` extensions of WebGL. \x3cbr/\x3e\x3ca href\x3d"https://www.khronos.org/registry/webgl/extensions"\x3eClick here for more information.\x3c/a\x3e';return z})},"dojox/validate/regexp":function(){define(["dojo/_base/lang","dojo/regexp",
"dojox/main"],function(p,a,k){var m=p.getObject("validate.regexp",!0,k);return m=k.validate.regexp={ipAddress:function(a){a="object"==typeof a?a:{};"boolean"!=typeof a.allowDottedDecimal&&(a.allowDottedDecimal=!0);"boolean"!=typeof a.allowDottedHex&&(a.allowDottedHex=!0);"boolean"!=typeof a.allowDottedOctal&&(a.allowDottedOctal=!0);"boolean"!=typeof a.allowDecimal&&(a.allowDecimal=!0);"boolean"!=typeof a.allowHex&&(a.allowHex=!0);"boolean"!=typeof a.allowIPv6&&(a.allowIPv6=!0);"boolean"!=typeof a.allowHybrid&&
(a.allowHybrid=!0);var e=[];a.allowDottedDecimal&&e.push("((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");a.allowDottedHex&&e.push("(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]");a.allowDottedOctal&&e.push("(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]");a.allowDecimal&&e.push("(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])");
a.allowHex&&e.push("0[xX]0*[\\da-fA-F]{1,8}");a.allowIPv6&&e.push("([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}");a.allowHybrid&&e.push("([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");a="";0<e.length&&(a="("+e.join("|")+")");return a},host:function(a){a="object"==typeof a?a:{};"boolean"!=typeof a.allowIP&&(a.allowIP=!0);"boolean"!=typeof a.allowLocal&&(a.allowLocal=!1);"boolean"!=typeof a.allowPort&&(a.allowPort=!0);"boolean"!=typeof a.allowNamed&&
(a.allowNamed=!1);var e=a.allowPort?"(\\:\\d+)?":"",g="((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.?)";a.allowIP&&(g+="|"+m.ipAddress(a));a.allowLocal&&(g+="|localhost");a.allowNamed&&(g+="|^[^-][a-zA-Z0-9_-]*");return"("+g+")"+e},url:function(e){e="object"==typeof e?e:{};"scheme"in e||(e.scheme=[!0,!1]);return a.buildGroupRE(e.scheme,function(a){return a?"(https?|ftps?)\\://":""})+m.host(e)+"(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?"},
emailAddress:function(a){a="object"==typeof a?a:{};"boolean"!=typeof a.allowCruft&&(a.allowCruft=!1);a.allowPort=!1;var e="([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@"+m.host(a);a.allowCruft&&(e="\x3c?(mailto\\:)?"+e+"\x3e?");return e},emailAddressList:function(a){a="object"==typeof a?a:{};"string"!=typeof a.listSeparator&&(a.listSeparator="\\s;,");var e=m.emailAddress(a);return"("+e+"\\s*["+a.listSeparator+"]\\s*)*"+e+"\\s*["+a.listSeparator+"]?\\s*"},numberFormat:function(e){e=
"object"==typeof e?e:{};"undefined"==typeof e.format&&(e.format="###-###-####");return a.buildGroupRE(e.format,function(e){return a.escapeString(e,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d")})},ca:{postalCode:function(){return"([A-Z][0-9][A-Z] [0-9][A-Z][0-9])"},province:function(){return"(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)"}},us:{state:function(a){a="object"==typeof a?a:{};"boolean"!=typeof a.allowTerritories&&(a.allowTerritories=!0);"boolean"!=typeof a.allowMilitary&&(a.allowMilitary=!0);
var e="AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";a.allowTerritories&&(e+="|AS|FM|GU|MH|MP|PW|PR|VI");a.allowMilitary&&(e+="|AA|AE|AP");return"("+e+")"}}}})},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(p,a){var k={};a.setObject("dojo.regexp",k);k.escapeString=function(a,e){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(a){return e&&-1!=e.indexOf(a)?
a:"\\"+a})};k.buildGroupRE=function(a,e,f){if(!(a instanceof Array))return e(a);for(var g=[],h=0;h<a.length;h++)g.push(e(a[h]));return k.group(g.join("|"),f)};k.group=function(a,e){return"("+(e?"?:":"")+a+")"};return k})},"dojox/main":function(){define(["dojo/_base/kernel"],function(p){return p.dojox})},"esri/core/libs/gl-matrix-2/mat4f64":function(){define(["require","exports","./factories/mat4f64"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});a.mat4f64=k})},"esri/core/libs/gl-matrix-2/factories/mat4f64":function(){define(["require",
"exports"],function(p,a){function k(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Object.defineProperty(a,"__esModule",{value:!0});a.create=k;a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]};a.fromValues=function(a,e,f,g,h,l,c,b,d,n,t,r,w,u,q,k){return[a,e,f,g,h,l,c,b,d,n,t,r,w,u,q,k]};a.createView=function(a,e){return new Float64Array(a,e,16)};a.IDENTITY=k()})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["require","exports","./math/mat4"],
function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});a.mat4=k})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["require","exports","../factories/vec3f64","./common"],function(p,a,k,m){function e(c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c}function f(c,b,d){var n=b[0],a=b[1],e=b[2],f=b[3],g=b[4],q=b[5],h=b[6],l=b[7],m=b[8],k=b[9],v=b[10],A=b[11],B=b[12],C=b[13],L=b[14];b=b[15];var p=d[0],K=
d[1],D=d[2],G=d[3];c[0]=p*n+K*g+D*m+G*B;c[1]=p*a+K*q+D*k+G*C;c[2]=p*e+K*h+D*v+G*L;c[3]=p*f+K*l+D*A+G*b;p=d[4];K=d[5];D=d[6];G=d[7];c[4]=p*n+K*g+D*m+G*B;c[5]=p*a+K*q+D*k+G*C;c[6]=p*e+K*h+D*v+G*L;c[7]=p*f+K*l+D*A+G*b;p=d[8];K=d[9];D=d[10];G=d[11];c[8]=p*n+K*g+D*m+G*B;c[9]=p*a+K*q+D*k+G*C;c[10]=p*e+K*h+D*v+G*L;c[11]=p*f+K*l+D*A+G*b;p=d[12];K=d[13];D=d[14];G=d[15];c[12]=p*n+K*g+D*m+G*B;c[13]=p*a+K*q+D*k+G*C;c[14]=p*e+K*h+D*v+G*L;c[15]=p*f+K*l+D*A+G*b;return c}function g(c,b,d){var n=b[0],a=b[1],e=b[2],
f=b[3],g=n+n,q=a+a,h=e+e;b=n*g;var l=n*q,n=n*h,m=a*q,a=a*h,e=e*h,g=f*g,q=f*q,f=f*h;c[0]=1-(m+e);c[1]=l+f;c[2]=n-q;c[3]=0;c[4]=l-f;c[5]=1-(b+e);c[6]=a+g;c[7]=0;c[8]=n+q;c[9]=a-g;c[10]=1-(b+m);c[11]=0;c[12]=d[0];c[13]=d[1];c[14]=d[2];c[15]=1;return c}function h(c,b,d){c[0]=b[0]-d[0];c[1]=b[1]-d[1];c[2]=b[2]-d[2];c[3]=b[3]-d[3];c[4]=b[4]-d[4];c[5]=b[5]-d[5];c[6]=b[6]-d[6];c[7]=b[7]-d[7];c[8]=b[8]-d[8];c[9]=b[9]-d[9];c[10]=b[10]-d[10];c[11]=b[11]-d[11];c[12]=b[12]-d[12];c[13]=b[13]-d[13];c[14]=b[14]-
d[14];c[15]=b[15]-d[15];return c}Object.defineProperty(a,"__esModule",{value:!0});a.copy=function(c,b){c[0]=b[0];c[1]=b[1];c[2]=b[2];c[3]=b[3];c[4]=b[4];c[5]=b[5];c[6]=b[6];c[7]=b[7];c[8]=b[8];c[9]=b[9];c[10]=b[10];c[11]=b[11];c[12]=b[12];c[13]=b[13];c[14]=b[14];c[15]=b[15];return c};a.set=function(c,b,d,n,a,e,f,g,q,h,l,m,k,v,A,B,C){c[0]=b;c[1]=d;c[2]=n;c[3]=a;c[4]=e;c[5]=f;c[6]=g;c[7]=q;c[8]=h;c[9]=l;c[10]=m;c[11]=k;c[12]=v;c[13]=A;c[14]=B;c[15]=C;return c};a.identity=e;a.transpose=function(c,b){if(c===
b){var d=b[1],n=b[2],a=b[3],e=b[6],f=b[7],g=b[11];c[1]=b[4];c[2]=b[8];c[3]=b[12];c[4]=d;c[6]=b[9];c[7]=b[13];c[8]=n;c[9]=e;c[11]=b[14];c[12]=a;c[13]=f;c[14]=g}else c[0]=b[0],c[1]=b[4],c[2]=b[8],c[3]=b[12],c[4]=b[1],c[5]=b[5],c[6]=b[9],c[7]=b[13],c[8]=b[2],c[9]=b[6],c[10]=b[10],c[11]=b[14],c[12]=b[3],c[13]=b[7],c[14]=b[11],c[15]=b[15];return c};a.invert=function(c,b){var d=b[0],a=b[1],e=b[2],f=b[3],g=b[4],h=b[5],q=b[6],l=b[7],m=b[8],k=b[9],y=b[10],v=b[11],A=b[12],B=b[13],C=b[14];b=b[15];var L=d*h-
a*g,p=d*q-e*g,K=d*l-f*g,D=a*q-e*h,G=a*l-f*h,H=e*l-f*q,I=m*B-k*A,J=m*C-y*A,N=m*b-v*A,P=k*C-y*B,M=k*b-v*B,Q=y*b-v*C,O=L*Q-p*M+K*P+D*N-G*J+H*I;if(!O)return null;O=1/O;c[0]=(h*Q-q*M+l*P)*O;c[1]=(e*M-a*Q-f*P)*O;c[2]=(B*H-C*G+b*D)*O;c[3]=(y*G-k*H-v*D)*O;c[4]=(q*N-g*Q-l*J)*O;c[5]=(d*Q-e*N+f*J)*O;c[6]=(C*K-A*H-b*p)*O;c[7]=(m*H-y*K+v*p)*O;c[8]=(g*M-h*N+l*I)*O;c[9]=(a*N-d*M-f*I)*O;c[10]=(A*G-B*K+b*L)*O;c[11]=(k*K-m*G-v*L)*O;c[12]=(h*J-g*P-q*I)*O;c[13]=(d*P-a*J+e*I)*O;c[14]=(B*p-A*D-C*L)*O;c[15]=(m*D-k*p+y*
L)*O;return c};a.adjoint=function(c,b){var d=b[0],a=b[1],e=b[2],f=b[3],g=b[4],h=b[5],q=b[6],l=b[7],m=b[8],k=b[9],y=b[10],v=b[11],A=b[12],B=b[13],C=b[14];b=b[15];c[0]=h*(y*b-v*C)-k*(q*b-l*C)+B*(q*v-l*y);c[1]=-(a*(y*b-v*C)-k*(e*b-f*C)+B*(e*v-f*y));c[2]=a*(q*b-l*C)-h*(e*b-f*C)+B*(e*l-f*q);c[3]=-(a*(q*v-l*y)-h*(e*v-f*y)+k*(e*l-f*q));c[4]=-(g*(y*b-v*C)-m*(q*b-l*C)+A*(q*v-l*y));c[5]=d*(y*b-v*C)-m*(e*b-f*C)+A*(e*v-f*y);c[6]=-(d*(q*b-l*C)-g*(e*b-f*C)+A*(e*l-f*q));c[7]=d*(q*v-l*y)-g*(e*v-f*y)+m*(e*l-f*q);
c[8]=g*(k*b-v*B)-m*(h*b-l*B)+A*(h*v-l*k);c[9]=-(d*(k*b-v*B)-m*(a*b-f*B)+A*(a*v-f*k));c[10]=d*(h*b-l*B)-g*(a*b-f*B)+A*(a*l-f*h);c[11]=-(d*(h*v-l*k)-g*(a*v-f*k)+m*(a*l-f*h));c[12]=-(g*(k*C-y*B)-m*(h*C-q*B)+A*(h*y-q*k));c[13]=d*(k*C-y*B)-m*(a*C-e*B)+A*(a*y-e*k);c[14]=-(d*(h*C-q*B)-g*(a*C-e*B)+A*(a*q-e*h));c[15]=d*(h*y-q*k)-g*(a*y-e*k)+m*(a*q-e*h);return c};a.determinant=function(c){var b=c[0],d=c[1],a=c[2],e=c[3],f=c[4],g=c[5],h=c[6],q=c[7],l=c[8],m=c[9],k=c[10],y=c[11],v=c[12],A=c[13],B=c[14];c=c[15];
return(b*g-d*f)*(k*c-y*B)-(b*h-a*f)*(m*c-y*A)+(b*q-e*f)*(m*B-k*A)+(d*h-a*g)*(l*c-y*v)-(d*q-e*g)*(l*B-k*v)+(a*q-e*h)*(l*A-m*v)};a.multiply=f;a.translate=function(c,b,d){var a=d[0],e=d[1];d=d[2];var f=void 0,g=void 0,h=void 0,q=void 0,l=void 0,m=void 0,k=void 0,y=void 0,v=void 0,A=void 0,B=void 0,C=void 0;b===c?(c[12]=b[0]*a+b[4]*e+b[8]*d+b[12],c[13]=b[1]*a+b[5]*e+b[9]*d+b[13],c[14]=b[2]*a+b[6]*e+b[10]*d+b[14],c[15]=b[3]*a+b[7]*e+b[11]*d+b[15]):(f=b[0],g=b[1],h=b[2],q=b[3],l=b[4],m=b[5],k=b[6],y=b[7],
v=b[8],A=b[9],B=b[10],C=b[11],c[0]=f,c[1]=g,c[2]=h,c[3]=q,c[4]=l,c[5]=m,c[6]=k,c[7]=y,c[8]=v,c[9]=A,c[10]=B,c[11]=C,c[12]=f*a+l*e+v*d+b[12],c[13]=g*a+m*e+A*d+b[13],c[14]=h*a+k*e+B*d+b[14],c[15]=q*a+y*e+C*d+b[15]);return c};a.scale=function(c,b,d){var a=d[0],e=d[1];d=d[2];c[0]=b[0]*a;c[1]=b[1]*a;c[2]=b[2]*a;c[3]=b[3]*a;c[4]=b[4]*e;c[5]=b[5]*e;c[6]=b[6]*e;c[7]=b[7]*e;c[8]=b[8]*d;c[9]=b[9]*d;c[10]=b[10]*d;c[11]=b[11]*d;c[12]=b[12];c[13]=b[13];c[14]=b[14];c[15]=b[15];return c};a.rotate=function(c,b,d,
a){var n=a[0],e=a[1];a=a[2];var f=Math.sqrt(n*n+e*e+a*a),g=void 0,q=void 0,h=void 0,l=void 0,k=void 0,y=void 0,v=void 0,A=void 0,B=void 0,C=void 0,L=void 0,p=void 0,K=void 0,D=void 0,G=void 0,H=void 0,I=void 0,J=void 0,N=void 0,P=void 0,M=void 0,Q=void 0,q=g=void 0;if(f<m.EPSILON)return null;f=1/f;n*=f;e*=f;a*=f;g=Math.sin(d);q=Math.cos(d);h=1-q;l=b[0];k=b[1];y=b[2];v=b[3];A=b[4];B=b[5];C=b[6];L=b[7];p=b[8];K=b[9];D=b[10];G=b[11];H=n*n*h+q;I=e*n*h+a*g;J=a*n*h-e*g;N=n*e*h-a*g;P=e*e*h+q;M=a*e*h+n*g;
Q=n*a*h+e*g;g=e*a*h-n*g;q=a*a*h+q;c[0]=l*H+A*I+p*J;c[1]=k*H+B*I+K*J;c[2]=y*H+C*I+D*J;c[3]=v*H+L*I+G*J;c[4]=l*N+A*P+p*M;c[5]=k*N+B*P+K*M;c[6]=y*N+C*P+D*M;c[7]=v*N+L*P+G*M;c[8]=l*Q+A*g+p*q;c[9]=k*Q+B*g+K*q;c[10]=y*Q+C*g+D*q;c[11]=v*Q+L*g+G*q;b!==c&&(c[12]=b[12],c[13]=b[13],c[14]=b[14],c[15]=b[15]);return c};a.rotateX=function(c,b,d){var a=Math.sin(d);d=Math.cos(d);var e=b[4],f=b[5],g=b[6],h=b[7],q=b[8],l=b[9],m=b[10],k=b[11];b!==c&&(c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3],c[12]=b[12],c[13]=b[13],c[14]=
b[14],c[15]=b[15]);c[4]=e*d+q*a;c[5]=f*d+l*a;c[6]=g*d+m*a;c[7]=h*d+k*a;c[8]=q*d-e*a;c[9]=l*d-f*a;c[10]=m*d-g*a;c[11]=k*d-h*a;return c};a.rotateY=function(c,b,d){var a=Math.sin(d);d=Math.cos(d);var e=b[0],f=b[1],g=b[2],h=b[3],q=b[8],l=b[9],m=b[10],k=b[11];b!==c&&(c[4]=b[4],c[5]=b[5],c[6]=b[6],c[7]=b[7],c[12]=b[12],c[13]=b[13],c[14]=b[14],c[15]=b[15]);c[0]=e*d-q*a;c[1]=f*d-l*a;c[2]=g*d-m*a;c[3]=h*d-k*a;c[8]=e*a+q*d;c[9]=f*a+l*d;c[10]=g*a+m*d;c[11]=h*a+k*d;return c};a.rotateZ=function(c,b,d){var a=Math.sin(d);
d=Math.cos(d);var e=b[0],f=b[1],g=b[2],h=b[3],q=b[4],l=b[5],m=b[6],k=b[7];b!==c&&(c[8]=b[8],c[9]=b[9],c[10]=b[10],c[11]=b[11],c[12]=b[12],c[13]=b[13],c[14]=b[14],c[15]=b[15]);c[0]=e*d+q*a;c[1]=f*d+l*a;c[2]=g*d+m*a;c[3]=h*d+k*a;c[4]=q*d-e*a;c[5]=l*d-f*a;c[6]=m*d-g*a;c[7]=k*d-h*a;return c};a.fromTranslation=function(c,b){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=b[0];c[13]=b[1];c[14]=b[2];c[15]=1;return c};a.fromScaling=function(c,b){c[0]=b[0];c[1]=
0;c[2]=0;c[3]=0;c[4]=0;c[5]=b[1];c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=b[2];c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.fromRotation=function(c,b,d){var a=d[0],e=d[1];d=d[2];var f=Math.sqrt(a*a+e*e+d*d),g=void 0,h=void 0,q=void 0;if(f<m.EPSILON)return null;f=1/f;a*=f;e*=f;d*=f;g=Math.sin(b);h=Math.cos(b);q=1-h;c[0]=a*a*q+h;c[1]=e*a*q+d*g;c[2]=d*a*q-e*g;c[3]=0;c[4]=a*e*q-d*g;c[5]=e*e*q+h;c[6]=d*e*q+a*g;c[7]=0;c[8]=a*d*q+e*g;c[9]=e*d*q-a*g;c[10]=d*d*q+h;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};
a.fromXRotation=function(c,b){var d=Math.sin(b);b=Math.cos(b);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=b;c[6]=d;c[7]=0;c[8]=0;c[9]=-d;c[10]=b;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.fromYRotation=function(c,b){var d=Math.sin(b);b=Math.cos(b);c[0]=b;c[1]=0;c[2]=-d;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=d;c[9]=0;c[10]=b;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.fromZRotation=function(c,b){var d=Math.sin(b);b=Math.cos(b);c[0]=b;c[1]=d;c[2]=0;c[3]=0;c[4]=-d;c[5]=b;c[6]=0;c[7]=0;
c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.fromRotationTranslation=g;a.fromQuat2=function(c,b){var d=l,a=-b[0],e=-b[1],f=-b[2],h=b[3],m=b[4],q=b[5],k=b[6],x=b[7],z=a*a+e*e+f*f+h*h;0<z?(d[0]=2*(m*h+x*a+q*f-k*e)/z,d[1]=2*(q*h+x*e+k*a-m*f)/z,d[2]=2*(k*h+x*f+m*e-q*a)/z):(d[0]=2*(m*h+x*a+q*f-k*e),d[1]=2*(q*h+x*e+k*a-m*f),d[2]=2*(k*h+x*f+m*e-q*a));g(c,b,d);return c};var l=k.create();a.getTranslation=function(c,b){c[0]=b[12];c[1]=b[13];c[2]=b[14];return c};a.getScaling=function(c,
b){var d=b[0],a=b[1],e=b[2],f=b[4],g=b[5],h=b[6],q=b[8],l=b[9];b=b[10];c[0]=Math.sqrt(d*d+a*a+e*e);c[1]=Math.sqrt(f*f+g*g+h*h);c[2]=Math.sqrt(q*q+l*l+b*b);return c};a.getRotation=function(c,b){var d=b[0]+b[5]+b[10],a=0;0<d?(a=2*Math.sqrt(d+1),c[3]=.25*a,c[0]=(b[6]-b[9])/a,c[1]=(b[8]-b[2])/a,c[2]=(b[1]-b[4])/a):b[0]>b[5]&&b[0]>b[10]?(a=2*Math.sqrt(1+b[0]-b[5]-b[10]),c[3]=(b[6]-b[9])/a,c[0]=.25*a,c[1]=(b[1]+b[4])/a,c[2]=(b[8]+b[2])/a):b[5]>b[10]?(a=2*Math.sqrt(1+b[5]-b[0]-b[10]),c[3]=(b[8]-b[2])/a,
c[0]=(b[1]+b[4])/a,c[1]=.25*a,c[2]=(b[6]+b[9])/a):(a=2*Math.sqrt(1+b[10]-b[0]-b[5]),c[3]=(b[1]-b[4])/a,c[0]=(b[8]+b[2])/a,c[1]=(b[6]+b[9])/a,c[2]=.25*a);return c};a.fromRotationTranslationScale=function(c,b,d,a){var e=b[0],n=b[1],f=b[2],g=b[3],h=e+e,l=n+n,m=f+f;b=e*h;var k=e*l,e=e*m,y=n*l,n=n*m,f=f*m,h=g*h,l=g*l,g=g*m,m=a[0],v=a[1];a=a[2];c[0]=(1-(y+f))*m;c[1]=(k+g)*m;c[2]=(e-l)*m;c[3]=0;c[4]=(k-g)*v;c[5]=(1-(b+f))*v;c[6]=(n+h)*v;c[7]=0;c[8]=(e+l)*a;c[9]=(n-h)*a;c[10]=(1-(b+y))*a;c[11]=0;c[12]=d[0];
c[13]=d[1];c[14]=d[2];c[15]=1;return c};a.fromRotationTranslationScaleOrigin=function(c,b,d,a,e){var n=b[0],f=b[1],g=b[2],h=b[3],l=n+n,m=f+f,t=g+g;b=n*l;var k=n*m,v=n*t,n=f*m,f=f*t,A=g*t,g=h*l,m=h*m,B=h*t,C=a[0],L=a[1],t=a[2];a=e[0];h=e[1];e=e[2];var l=(1-(n+A))*C,p=(k+B)*C,C=(v-m)*C,k=(k-B)*L,A=(1-(b+A))*L,L=(f+g)*L,v=(v+m)*t,f=(f-g)*t;b=(1-(b+n))*t;c[0]=l;c[1]=p;c[2]=C;c[3]=0;c[4]=k;c[5]=A;c[6]=L;c[7]=0;c[8]=v;c[9]=f;c[10]=b;c[11]=0;c[12]=d[0]+a-(l*a+k*h+v*e);c[13]=d[1]+h-(p*a+A*h+f*e);c[14]=d[2]+
e-(C*a+L*h+b*e);c[15]=1;return c};a.fromQuat=function(c,b){var d=b[0],a=b[1],e=b[2];b=b[3];var f=d+d,g=a+a,h=e+e,d=d*f,l=a*f,a=a*g,m=e*f,k=e*g,e=e*h,f=b*f,g=b*g;b*=h;c[0]=1-a-e;c[1]=l+b;c[2]=m-g;c[3]=0;c[4]=l-b;c[5]=1-d-e;c[6]=k+f;c[7]=0;c[8]=m+g;c[9]=k-f;c[10]=1-d-a;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.frustum=function(c,b,d,a,e,f,g){var n=1/(d-b),h=1/(e-a),l=1/(f-g);c[0]=2*f*n;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=2*f*h;c[6]=0;c[7]=0;c[8]=(d+b)*n;c[9]=(e+a)*h;c[10]=(g+f)*l;c[11]=-1;c[12]=
0;c[13]=0;c[14]=g*f*2*l;c[15]=0;return c};a.perspective=function(c,b,d,a,e){b=1/Math.tan(b/2);var n=void 0;c[0]=b/d;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=b;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[11]=-1;c[12]=0;c[13]=0;c[15]=0;null!=e&&Infinity!==e?(n=1/(a-e),c[10]=(e+a)*n,c[14]=2*e*a*n):(c[10]=-1,c[14]=-2*a);return c};a.perspectiveFromFieldOfView=function(c,b,d,a){var e=Math.tan(b.upDegrees*Math.PI/180),n=Math.tan(b.downDegrees*Math.PI/180),f=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/
180);var g=2/(f+b),h=2/(e+n);c[0]=g;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=h;c[6]=0;c[7]=0;c[8]=-((f-b)*g*.5);c[9]=(e-n)*h*.5;c[10]=a/(d-a);c[11]=-1;c[12]=0;c[13]=0;c[14]=a*d/(d-a);c[15]=0;return c};a.ortho=function(c,b,d,a,e,f,g){var n=1/(b-d),h=1/(a-e),l=1/(f-g);c[0]=-2*n;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=-2*h;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=2*l;c[11]=0;c[12]=(b+d)*n;c[13]=(e+a)*h;c[14]=(g+f)*l;c[15]=1;return c};a.lookAt=function(c,b,d,a){var n=void 0,f=void 0,g=void 0,h=void 0,l=void 0,k=void 0,x=void 0,
z=void 0,y=void 0,v=void 0,A=b[0],B=b[1];b=b[2];g=a[0];h=a[1];a=a[2];x=d[0];z=d[1];d=d[2];if(Math.abs(A-x)<m.EPSILON&&Math.abs(B-z)<m.EPSILON&&Math.abs(b-d)<m.EPSILON)return e(c);x=A-x;z=B-z;y=b-d;v=1/Math.sqrt(x*x+z*z+y*y);x*=v;z*=v;y*=v;n=h*y-a*z;f=a*x-g*y;g=g*z-h*x;(v=Math.sqrt(n*n+f*f+g*g))?(v=1/v,n*=v,f*=v,g*=v):g=f=n=0;h=z*g-y*f;l=y*n-x*g;k=x*f-z*n;(v=Math.sqrt(h*h+l*l+k*k))?(v=1/v,h*=v,l*=v,k*=v):k=l=h=0;c[0]=n;c[1]=h;c[2]=x;c[3]=0;c[4]=f;c[5]=l;c[6]=z;c[7]=0;c[8]=g;c[9]=k;c[10]=y;c[11]=0;
c[12]=-(n*A+f*B+g*b);c[13]=-(h*A+l*B+k*b);c[14]=-(x*A+z*B+y*b);c[15]=1;return c};a.targetTo=function(c,b,d,a){var e=b[0],n=b[1];b=b[2];var f=a[0],g=a[1],h=a[2];a=e-d[0];var l=n-d[1];d=b-d[2];var m=a*a+l*l+d*d;0<m&&(m=1/Math.sqrt(m),a*=m,l*=m,d*=m);var k=g*d-h*l,h=h*a-f*d,f=f*l-g*a,m=k*k+h*h+f*f;0<m&&(m=1/Math.sqrt(m),k*=m,h*=m,f*=m);c[0]=k;c[1]=h;c[2]=f;c[3]=0;c[4]=l*f-d*h;c[5]=d*k-a*f;c[6]=a*h-l*k;c[7]=0;c[8]=a;c[9]=l;c[10]=d;c[11]=0;c[12]=e;c[13]=n;c[14]=b;c[15]=1;return c};a.str=function(c){return"mat4("+
c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+", "+c[6]+", "+c[7]+", "+c[8]+", "+c[9]+", "+c[10]+", "+c[11]+", "+c[12]+", "+c[13]+", "+c[14]+", "+c[15]+")"};a.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+Math.pow(c[6],2)+Math.pow(c[7],2)+Math.pow(c[8],2)+Math.pow(c[9],2)+Math.pow(c[10],2)+Math.pow(c[11],2)+Math.pow(c[12],2)+Math.pow(c[13],2)+Math.pow(c[14],2)+Math.pow(c[15],2))};a.add=function(c,b,
d){c[0]=b[0]+d[0];c[1]=b[1]+d[1];c[2]=b[2]+d[2];c[3]=b[3]+d[3];c[4]=b[4]+d[4];c[5]=b[5]+d[5];c[6]=b[6]+d[6];c[7]=b[7]+d[7];c[8]=b[8]+d[8];c[9]=b[9]+d[9];c[10]=b[10]+d[10];c[11]=b[11]+d[11];c[12]=b[12]+d[12];c[13]=b[13]+d[13];c[14]=b[14]+d[14];c[15]=b[15]+d[15];return c};a.subtract=h;a.multiplyScalar=function(c,b,d){c[0]=b[0]*d;c[1]=b[1]*d;c[2]=b[2]*d;c[3]=b[3]*d;c[4]=b[4]*d;c[5]=b[5]*d;c[6]=b[6]*d;c[7]=b[7]*d;c[8]=b[8]*d;c[9]=b[9]*d;c[10]=b[10]*d;c[11]=b[11]*d;c[12]=b[12]*d;c[13]=b[13]*d;c[14]=b[14]*
d;c[15]=b[15]*d;return c};a.multiplyScalarAndAdd=function(c,b,d,a){c[0]=b[0]+d[0]*a;c[1]=b[1]+d[1]*a;c[2]=b[2]+d[2]*a;c[3]=b[3]+d[3]*a;c[4]=b[4]+d[4]*a;c[5]=b[5]+d[5]*a;c[6]=b[6]+d[6]*a;c[7]=b[7]+d[7]*a;c[8]=b[8]+d[8]*a;c[9]=b[9]+d[9]*a;c[10]=b[10]+d[10]*a;c[11]=b[11]+d[11]*a;c[12]=b[12]+d[12]*a;c[13]=b[13]+d[13]*a;c[14]=b[14]+d[14]*a;c[15]=b[15]+d[15]*a;return c};a.exactEquals=function(c,b){return c[0]===b[0]&&c[1]===b[1]&&c[2]===b[2]&&c[3]===b[3]&&c[4]===b[4]&&c[5]===b[5]&&c[6]===b[6]&&c[7]===b[7]&&
c[8]===b[8]&&c[9]===b[9]&&c[10]===b[10]&&c[11]===b[11]&&c[12]===b[12]&&c[13]===b[13]&&c[14]===b[14]&&c[15]===b[15]};a.equals=function(c,b){var d=c[0],a=c[1],e=c[2],f=c[3],g=c[4],h=c[5],l=c[6],k=c[7],x=c[8],z=c[9],y=c[10],v=c[11],A=c[12],B=c[13],C=c[14];c=c[15];var L=b[0],p=b[1],K=b[2],D=b[3],G=b[4],H=b[5],I=b[6],J=b[7],N=b[8],P=b[9],M=b[10],Q=b[11],O=b[12],V=b[13],aa=b[14];b=b[15];return Math.abs(d-L)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(a-p)<=m.EPSILON*Math.max(1,Math.abs(a),
Math.abs(p))&&Math.abs(e-K)<=m.EPSILON*Math.max(1,Math.abs(e),Math.abs(K))&&Math.abs(f-D)<=m.EPSILON*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(g-G)<=m.EPSILON*Math.max(1,Math.abs(g),Math.abs(G))&&Math.abs(h-H)<=m.EPSILON*Math.max(1,Math.abs(h),Math.abs(H))&&Math.abs(l-I)<=m.EPSILON*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(k-J)<=m.EPSILON*Math.max(1,Math.abs(k),Math.abs(J))&&Math.abs(x-N)<=m.EPSILON*Math.max(1,Math.abs(x),Math.abs(N))&&Math.abs(z-P)<=m.EPSILON*Math.max(1,Math.abs(z),Math.abs(P))&&
Math.abs(y-M)<=m.EPSILON*Math.max(1,Math.abs(y),Math.abs(M))&&Math.abs(v-Q)<=m.EPSILON*Math.max(1,Math.abs(v),Math.abs(Q))&&Math.abs(A-O)<=m.EPSILON*Math.max(1,Math.abs(A),Math.abs(O))&&Math.abs(B-V)<=m.EPSILON*Math.max(1,Math.abs(B),Math.abs(V))&&Math.abs(C-aa)<=m.EPSILON*Math.max(1,Math.abs(C),Math.abs(aa))&&Math.abs(c-b)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(b))};a.mul=f;a.sub=h})},"esri/views/3d/support/earthUtils":function(){define("require exports ../../../core/mathUtils ../../../core/wgs84Constants ../../../core/libs/gl-matrix-2/vec3 ../../../core/libs/gl-matrix-2/vec3f64 ../../../geometry/Point ./projectionUtils".split(" "),
function(p,a,k,m,e,f,g,h){function l(b,c,d,e){var f,n;b instanceof g&&c instanceof g&&(d=c.longitude,e=c.latitude,n=b.latitude,f=b.longitude);b=k.deg2rad(n);e=k.deg2rad(e);f=k.deg2rad(f);c=k.deg2rad(d);d=Math.sin((b-e)/2);f=Math.sin((f-c)/2);d=2*k.asinClamped(Math.sqrt(d*d+Math.cos(b)*Math.cos(e)*f*f))*a.earthRadius;return Math.round(1E4*d)/1E4}function c(b,c){b/=15;c||(b=Math.round(b));return b}Object.defineProperty(a,"__esModule",{value:!0});a.earthRadius=m.wgs84Radius;a.halfEarthRadius=a.earthRadius/
2;a.halfEarthCircumference=Math.PI*a.earthRadius;a.earthCircumference=2*a.halfEarthCircumference;a.metersPerDegree=a.halfEarthCircumference/180;a.getGreatCircleDistance=l;a.getGreatCircleSpanAt=function(b,c,d){var a=c.spatialReference,e=new g(c.x,b.y,a),f=new g(d.x,b.y,a);c=new g(b.x,c.y,a);b=new g(b.x,d.y,a);return{lon:l(e,f),lat:l(c,b)}};a.getLonDeltaForDistance=function(b,c){c/=a.earthRadius;b=k.deg2rad(b);c=Math.sin(c/2);b=Math.cos(b);b=2*k.asinClamped(Math.sqrt(c*c/(b*b)));return k.rad2deg(b)};
a.getLatDeltaForDistance=function(b){return k.rad2deg(b/a.earthRadius)};a.getMaxCameraAltitude=function(b){b=k.deg2rad(b/2);return(1-Math.sin(b))*a.earthRadius/Math.sin(b)};a.getViewExtentDistance=function(b,c){c=k.deg2rad(c/2);return 2*k.acosClamped((Math.pow(b+a.earthRadius,2)+Math.pow(a.earthRadius,2)-Math.pow((b+a.earthRadius)*Math.cos(c)-Math.sqrt(Math.pow(Math.cos(c)*(b+a.earthRadius),2)-b*b-2*b*a.earthRadius),2))/(2*(b+a.earthRadius)*a.earthRadius))*a.earthRadius};a.computeCartesianDistance=
function(c,a){c=h.wgs84ComparableLonLatToECEF(b,c.longitude,c.latitude,c.z||0);a=h.wgs84ComparableLonLatToECEF(d,a.longitude,a.latitude,a.z||0);a=[a[0]-c[0],a[1]-c[1],a[2]-c[2]];return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])};a.longitudeToTimezone=c;a.positionToTimezone=function(b,d){d||(d={hours:0,minutes:0,seconds:0});d.hours=c(b[0],!0);b=d.hours%1;d.hours-=b;d.minutes=60*b;b=d.minutes%1;d.minutes-=b;d.seconds=Math.round(60*b);return d};a.distanceToIdealHorizon=function(b,c){c=c||a.earthRadius;
b=e.vec3.dot(b,b);return Math.sqrt(Math.abs(b-c*c))};var b=f.vec3f64.create(),d=f.vec3f64.create()})},"esri/views/3d/support/projectionUtils":function(){define("require exports ../../../core/mathUtils ../../../core/maybe ../../../core/unitUtils ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/vec3 ../../../core/libs/gl-matrix-2/vec3f64 ../../../geometry/Point ../../../geometry/SpatialReference ../../../geometry/support/aaBoundingRect ../../../layers/graphics/dehydratedFeatures ./earthUtils ../webgl-engine/lib/BufferVectorMath".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n,t){function r(b,c,d,a){2===b.length?(F[0]=b[0],F[1]=b[1],F[2]=0,b=F):b===d&&(g.vec3.copy(F,b),b=F);return w(b,c,0,d,a,0,1)}function w(b,c,d,a,e,f,n){void 0===n&&(n=1);c=L(c,e,aa);if(m.isNone(c))return!1;if(c===q){if(b===a&&d===f)return!0;for(c=d+3*n;d<c;d++,f++)a[f]=b[d];return!0}for(n=d+3*n;d<n;d+=3,f+=3)c(b,d,a,f);return!0}function u(b,c){if(c.spatialReference===b)return c.spatialReferenceId;c.spatialReference=b;"metersPerUnit"in c&&(c.metersPerUnit=e.getMetersPerUnitForSR(b,
1));return b.wkt===a.SphericalECEFSpatialReference.wkt?c.spatialReferenceId=1:b.isWGS84?c.spatialReferenceId=2:b.isWebMercator?c.spatialReferenceId=3:b.wkt===a.WGS84ECEFSpatialReference.wkt?c.spatialReferenceId=4:4490===b.wkid?c.spatialReferenceId=5:c.spatialReferenceId=0}function q(b,c,d,a){d[a++]=b[c++];d[a++]=b[c++];d[a]=b[c]}function E(b,c,d,a){d[a++]=W*(b[c++]/n.earthRadius);d[a++]=W*(Math.PI/2-2*Math.atan(Math.exp(-1*b[c++]/n.earthRadius)));d[a]=b[c]}function x(b,c,d,a){var e=.4999999*Math.PI,
e=k.clamp(T*b[c+1],-e,e),e=Math.sin(e);d[a++]=T*b[c]*n.earthRadius;d[a++]=n.halfEarthRadius*Math.log((1+e)/(1-e));d[a]=b[c+2]}function z(b,c,d){c=u(c,O);c=Q[c][6];if(m.isNone(c))return!1;c(b,0,F,0);d!==F&&(d[0]=F[0],d[1]=F[1],2<d.length&&(d[2]=F[2]));return!0}function y(b,c){F[0]=b.x;F[1]=b.y;F[2]=b.hasZ?b.z:0;return z(F,b.spatialReference,c)}function v(b,c,d,a){var e=n.earthRadius+b[c+2],f=T*b[c+1];b=T*b[c];c=Math.cos(f);d[a++]=Math.cos(b)*c*e;d[a++]=Math.sin(b)*c*e;d[a]=Math.sin(f)*e}function A(b,
c,d,a){var e=t.Vec3Compact.length(b,c),f=k.asinClamped(b[c+2]/(0===e?1:e));b=Math.atan2(b[c+1],b[c]);d[a++]=W*b;d[a++]=W*f;d[a]=e-n.earthRadius}function B(b,c,d,a){var e=X,f=T*b[c],n=T*b[c+1];b=b[c+2];c=Math.sin(n);var n=Math.cos(n),g=e.a/Math.sqrt(1-e.e2*c*c);d[a++]=(g+b)*n*Math.cos(f);d[a++]=(g+b)*n*Math.sin(f);d[a++]=(g*(1-e.e2)+b)*c}function C(b,c,d,a){var e=X,f=b[c],n=b[c+1];b=b[c+2];var g,h,l,q,m,k;c=Math.abs(b);g=f*f+n*n;h=Math.sqrt(g);l=g+b*b;q=Math.sqrt(l);f=Math.atan2(n,f);m=b*b/l;l=g/l;
n=e.a2/q;g=e.a3-e.a4/q;.3<l?(m=c/q*(1+l*(e.a1+n+m*g)/q),q=Math.asin(m),n=m*m,l=Math.sqrt(1-n)):(l=h/q*(1-m*(e.a5-n-l*g)/q),q=Math.acos(l),n=1-l*l,m=Math.sqrt(n));k=1-e.e2*n;n=e.a/Math.sqrt(k);e=e.a6*n;n=h-n*l;g=c-e*m;c=l*n+m*g;h=l*g-m*n;e=h/(e/k+c);q+=e;0>b&&(q=-q);d[a++]=W*f;d[a++]=W*q;d[a]=c+h*e/2}function L(b,c,d){void 0===d&&(d=K());return R(b,c,d).projector}function R(b,c,d){if(d.source.spatialReference===b&&d.dest.spatialReference===c)return d;var a=u(b,d.source),e=u(c,d.dest);0===a&&0===e?
b.equals(c)?d.projector=q:d.projector=null:d.projector=Q[a][e];return d}function K(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:q}}Object.defineProperty(a,"__esModule",{value:!0});var D,G,H,I,J,N,P,M;a.SphericalECEFSpatialReference=new c({wkt:'GEOCCS["Spherical geocentric",\n  DATUM["Not specified",\n    SPHEROID["Sphere",\' + earthUtils.earthRadius + \',0]],\n  PRIMEM["Greenwich",0.0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",EAST],\n  AXIS["Geocentric Z",NORTH]\n]'});
a.WGS84ECEFSpatialReference=new c({wkt:'GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",6378137,298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]'});a.canProject=function(b,c){return!!L(b,c,aa)};a.vectorToVector=r;a.pointToPoint=
function(b,c,d,a){void 0===d&&(d=c.spatialReference);void 0===a&&(a=0);F[0]=b.x;F[1]=b.y;var e=b.z;F[2]=void 0!==e?e:a;if(!w(F,b.spatialReference,0,F,d,0,1))return!1;c.x=F[0];c.y=F[1];c.spatialReference=d;void 0!==e?(c.z=F[2],c.hasZ=!0):(c.z=void 0,c.hasZ=!1);return!0};a.pointToVector=function(b,c,d,a){void 0===a&&(a=0);F[0]=b.x;F[1]=b.y;var e=b.z;F[2]=void 0!==e?e:a;return w(F,b.spatialReference,0,c,d,0,1)};a.vectorToPoint=function(b,c,a,e){a instanceof l?e=e||a.spatialReference:d.isPoint(a)?(a.hasZ=
!0,e=e||a.spatialReference):(e=a,a=new l({spatialReference:e}));return w(b,c,0,F,e,0,1)?(a.x=F[0],a.y=F[1],a.z=F[2],a.spatialReference=e,a):null};a.xyzToVector=function(b,c,d,a,e,f){F[0]=b;F[1]=c;F[2]=d;return w(F,a,0,e,f,0,1)};a.bufferToBuffer=w;a.localLinearScaleFactors=function(b,c,d,a){var e=u(c,O),f=u(a,V);if(e===f&&0!==e||c.equals(a))return d[0]=1,d[1]=1,d[2]=1,!0;if(1===e){c=g.vec3.length(b);b=c/Math.sqrt(b[0]*b[0]+b[1]*b[1]);c/=n.earthRadius;if(3===f)return d[0]=b*c,d[1]=b*c,d[2]=1,!0;if(2===
f||5===f)return f=180/(n.earthRadius*Math.PI),d[0]=f*b*c,d[1]=f*c,d[2]=1,!0}return!1};a.computeLinearTransformation=function(b,c,d,a){var e=u(b,O),n=u(a,V);if(e===n&&1!==n&&(0!==e||b.equals(a)))return f.mat4.identity(d),f.mat4.translate(d,d,c),!0;if(1===n){b=Q[e][6];n=Q[6][n];if(m.isNone(b)||m.isNone(n))return!1;b(c,0,S,0);n(S,0,U,0);b=T*S[0];n=T*S[1];c=Math.sin(b);b=Math.cos(b);a=Math.sin(n);n=Math.cos(n);d[0]=-c;d[4]=-a*b;d[8]=n*b;d[12]=U[0];d[1]=b;d[5]=-a*c;d[9]=n*c;d[13]=U[1];d[2]=0;d[6]=n;d[10]=
a;d[14]=U[2];d[3]=0;d[7]=0;d[11]=0;d[15]=1;return!0}if(3===n&&(2===e||1===e)){b=Q[e][6];if(m.isNone(b))return!1;b(c,0,S,0);c=T*S[1];x(S,0,U,0);f.mat4.identity(d);f.mat4.translate(d,d,U);c=1/Math.cos(c);f.mat4.scale(d,d,[c,c,1]);return!0}return!1};a.transformDirection=function(b,c,d,a,e){g.vec3.copy(Y,b);g.vec3.add(Z,b,c);r(Y,d,Y,e);r(Z,d,Z,e);g.vec3.subtract(a,Z,Y);g.vec3.normalize(a,a)};a.mbsToMbs=function(b,c,d,a){c=R(c,a,ba);if(c.projector===q)return d[0]=b[0],d[1]=b[1],d[2]=b[2],d[3]=b[3],!0;
if(m.isNone(c.projector))return!1;a=c.source;var e=c.dest;if(3===e.spatialReferenceId){c=Q[a.spatialReferenceId][2];if(m.isNone(c))return!1;c(b,0,S,0);c=Math.abs(T*S[1])+Math.asin(b[3]/(n.earthRadius+b[2]));x(S,0,d,0);d[3]=c>.9999*Math.PI?Number.MAX_VALUE:1/Math.cos(c)*b[3];return!0}c.projector(b,0,d,0);d[3]=b[3]*a.metersPerUnit/e.metersPerUnit;return!0};a.extentToBoundingBox=function(b,c,d){if(null==b)return!1;var a;F[0]=null!=b.xmin?b.xmin:0;F[1]=null!=b.ymin?b.ymin:0;F[2]=null!=b.zmin?b.zmin:0;
a=w(F,b.spatialReference,0,c,d,0,1);F[0]=null!=b.xmax?b.xmax:0;F[1]=null!=b.ymax?b.ymax:0;F[2]=null!=b.zmax?b.zmax:0;a=a&&w(F,b.spatialReference,0,c,d,3,1);null==b.xmin&&(c[0]=-Infinity);null==b.ymin&&(c[1]=-Infinity);null==b.zmin&&(c[2]=-Infinity);null==b.xmax&&(c[3]=Infinity);null==b.ymax&&(c[4]=Infinity);null==b.zmax&&(c[5]=Infinity);return a};a.extentToBoundingRect=function(b,c,d){if(null==b)return!1;var a;F[0]=null!=b.xmin?b.xmin:0;F[1]=null!=b.ymin?b.ymin:0;F[2]=null!=b.zmin?b.zmin:0;a=w(F,
b.spatialReference,0,F,d,0,1);c[0]=F[0];c[1]=F[1];F[0]=null!=b.xmax?b.xmax:0;F[1]=null!=b.ymax?b.ymax:0;F[2]=null!=b.zmax?b.zmax:0;a=a&&w(F,b.spatialReference,0,F,d,0,1);c[2]=F[0];c[3]=F[1];null==b.xmin&&(c[0]=-Infinity);null==b.ymin&&(c[1]=-Infinity);null==b.xmax&&(c[2]=Infinity);null==b.ymax&&(c[3]=Infinity);return a};a.boundingRectToBoundingRect=function(c,d,a,e){if(null==c)return!1;if(d.equals(e))return b.set(a,c),!0;F[0]=c[0];F[1]=c[1];F[2]=0;if(!w(F,d,0,F,e,0,1))return!1;a[0]=F[0];a[1]=F[1];
F[0]=c[2];F[1]=c[3];F[2]=0;if(!w(F,d,0,F,e,0,1))return!1;a[2]=F[0];a[3]=F[1];return!0};(function(b){b.x2lon=function(b){return b/n.earthRadius};b.y2lat=function(b){return Math.PI/2-2*Math.atan(Math.exp(-1*b/n.earthRadius))};b.lon2x=function(b){return b*n.earthRadius};b.lat2y=function(b){b=Math.sin(b);return n.earthRadius/2*Math.log((1+b)/(1-b))}})(a.webMercator||(a.webMercator={}));a.canProjectToWGS84ComparableLonLat=function(b){b=u(b,O);return!!Q[b][6]};a.vectorToWGS84ComparableLonLat=z;a.pointToWGS84ComparableLonLat=
y;a.pointToWGS84ComparableLonLatPoint=function(b,c){var d=u(c.spatialReference,V);return m.isNone(Q[6][d])?!1:y(b,F)?(c.x=F[0],c.y=F[1],c.z=F[2],!0):!1};a.wgs84ComparableLonLatToECEF=function(b,c,d,a){void 0===a&&(a=0);a=n.earthRadius+a;var e=Math.cos(d);b[0]=Math.cos(c)*e*a;b[1]=Math.sin(c)*e*a;b[2]=Math.sin(d)*a};var Q=(D={},D[2]=(G={},G[5]=null,G[6]=q,G[1]=v,G[0]=null,G[3]=x,G[2]=q,G[4]=B,G),D[5]=(H={},H[5]=q,H[6]=q,H[1]=v,H[0]=null,H[3]=null,H[2]=null,H[4]=B,H),D[3]=(I={},I[5]=null,I[6]=E,I[1]=
function(b,c,d,a){E(b,c,d,a);v(d,a,d,a)},I[0]=null,I[3]=q,I[2]=E,I[4]=function(b,c,d,a){E(b,c,d,a);B(d,a,d,a)},I),D[4]=(J={},J[5]=C,J[6]=C,J[1]=function(b,c,d,a){C(b,c,d,a);v(d,a,d,a)},J[0]=null,J[3]=function(b,c,d,a){C(b,c,d,a);x(d,a,d,a)},J[2]=C,J[4]=q,J),D[1]=(N={},N[5]=A,N[6]=A,N[1]=q,N[0]=null,N[3]=function(b,c,d,a){A(b,c,d,a);x(d,a,d,a)},N[2]=A,N[4]=function(b,c,d,a){A(b,c,d,a);B(d,a,d,a)},N),D[0]=(P={},P[5]=null,P[6]=null,P[1]=null,P[0]=q,P[3]=null,P[2]=null,P[4]=null,P),D[6]=(M={},M[5]=null,
M[6]=q,M[1]=v,M[0]=null,M[3]=null,M[2]=q,M[4]=B,M),D);a.getProjector=L;var O={spatialReference:null,spatialReferenceId:0},V={spatialReference:null,spatialReferenceId:0},aa=K(),ba=K(),T=k.deg2rad(1),W=k.rad2deg(1),X={a:6378137,e2:.006694379990137799,a1:42697.67270715754,a2:1.8230912546075456E9,a3:142.91722289812412,a4:4.557728136518864E9,a5:42840.589930055656,a6:.9933056200098622},F=h.vec3f64.create(),S=h.vec3f64.create(),U=h.vec3f64.create(),Y=h.vec3f64.create(),Z=h.vec3f64.create()})},"esri/views/3d/webgl-engine/lib/BufferVectorMath":function(){define(["require",
"exports"],function(p,a){Object.defineProperty(a,"__esModule",{value:!0});(function(a){a.length=function(a,e){var f=a[e],g=a[e+1];a=a[e+2];return Math.sqrt(f*f+g*g+a*a)};a.normalize=function(a,e){var f=a[e],g=a[e+1],h=a[e+2],f=1/Math.sqrt(f*f+g*g+h*h);a[e]*=f;a[e+1]*=f;a[e+2]*=f};a.scale=function(a,e,f){a[e]*=f;a[e+1]*=f;a[e+2]*=f};a.add=function(a,e,f,g,h,l){void 0===l&&(l=e);h=h||a;h[l]=a[e]+f[g];h[l+1]=a[e+1]+f[g+1];h[l+2]=a[e+2]+f[g+2]};a.subtract=function(a,e,f,g,h,l){void 0===l&&(l=e);h=h||
a;h[l]=a[e]-f[g];h[l+1]=a[e+1]-f[g+1];h[l+2]=a[e+2]-f[g+2]}})(a.Vec3Compact||(a.Vec3Compact={}))})},"dojo/text":function(){define(["./_base/kernel","require","./has","./has!host-browser?./request"],function(p,a,k,m){var e;k("host-browser")?e=function(c,b,d){m(c,{sync:!!b,headers:{"X-Requested-With":null}}).then(d)}:a.getText?e=a.getText:console.error("dojo/text plugin failed to load because loader does not support getText");var f={},g=function(c){if(c){c=c.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,
"");var b=c.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);b&&(c=b[1])}else c="";return c},h={},l={};p.cache=function(c,b,d){var n;"string"==typeof c?/\//.test(c)?(n=c,d=b):n=a.toUrl(c.replace(/\./g,"/")+(b?"/"+b:"")):(n=c+"",d=b);c=void 0!=d&&"string"!=typeof d?d.value:d;d=d&&d.sanitize;if("string"==typeof c)return f[n]=c,d?g(c):c;if(null===c)return delete f[n],null;n in f||e(n,!0,function(b){f[n]=b});return d?g(f[n]):f[n]};return{dynamic:!0,normalize:function(c,b){c=c.split("!");var d=c[0];return(/^\./.test(d)?
b(d):d)+(c[1]?"!"+c[1]:"")},load:function(c,b,d){c=c.split("!");var a=1<c.length,m=c[0],k=b.toUrl(c[0]);c="url:"+k;var w=h,u=function(b){d(a?g(b):b)};m in f?w=f[m]:b.cache&&c in b.cache?w=b.cache[c]:k in f&&(w=f[k]);if(w===h)if(l[k])l[k].push(u);else{var q=l[k]=[u];e(k,!b.async,function(b){f[m]=f[k]=b;for(var c=0;c<q.length;)q[c++](b);delete l[k]})}else u(w)}}})},"fx3d/views/3d/layers/FxLayerView3D":function(){define("dojo/_base/lang dojo/_base/array esri/core/declare esri/views/layers/LayerView ./SnapshotController esri/geometry/Point esri/geometry/Extent esri/views/3d/support/projectionUtils esri/core/libs/gl-matrix-2/vec3f64 esri/core/libs/gl-matrix-2/vec3 esri/geometry/SpatialReference esri/core/watchUtils esri/core/Collection esri/Graphic esri/symbols/PictureMarkerSymbol esri/geometry/support/centroid ../effects/FxEffectRenderer ../effects/FxEffectFactory ../support/fx3dUtils".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n,t,r,w,u,q,E){l=l.vec3f64;c=c.vec3;var x=l.create(),z=l.create(),y=l.create(),v=l.create(),A=l.create();return k(m,{declaredClass:"esri.views.3d.layers.FxLayerView3D",constructor:function(c){this._perPageScale=1;this.supportsDraping=!1;this._fx3dSpatialReference=b.WGS84;c.layer&&(this.layer=c.layer);c.view&&(this.view=c.view);this.availableFields=["*"];this.initialize()},initialize:function(){this.layer.when().then(function(){u.init(this.view);this._eventHandles=
[];this.loadedGraphics=null;this._graphicsLoading=!0;this._graphicsCollectionEventHandle=null;this._graphicsControllerEventHandles=[];var b=this._initEffect();b.then(p.hitch(this,this._initGraphicsController));this.layer.addResolvingPromise(b);this._eventHandles.push(this.layer.on("destroy-fxlayer",function(){u.pause();u.destroy(this._layerVizType,this._layerId);this.view.map.remove(this.layer)}.bind(this)));this._eventHandles.push(this.layer.on("show-feature-label",p.hitch(this,this._onShowFeatureLabel)));
this._eventHandles.push(this.layer.on("hide-feature-label",function(){this.layer&&this.layer._labelsLayer&&(this.layer._labelsLayer.removeAll(),this._selectedFeature=null)}.bind(this)));this._eventHandles.push(this.view.on("click",p.hitch(this,this._viewClicked)))}.bind(this))},destroy:function(){this._viewModelHandler&&(this._viewModelHandler.remove(),this._viewModelHandler=null);var b=function(b){b.remove()};this.controller&&(this.controller.destroy(),this.controller=null);this._graphicsCollectionEventHandle&&
this._graphicsCollectionEventHandle.remove();this._graphicsControllerEventHandles&&this._graphicsControllerEventHandles.forEach(b);this._tilingSchemeHandle&&this._tilingSchemeHandle.remove();this._eventHandles&&this._eventHandles.forEach(b);this.inherited(arguments)},getLoadedGraphics:function(){return this.loadedGraphics&&this.loadedGraphics.toArray?[].concat(this.loadedGraphics.toArray()):[]},_initEffect:function(){return q.make({layer:this.layer,layerView:this,view:this.view})},_calculateExtentCenter:function(b){var c=
b.length;if(c){var d,a,e,f,n,h,l;if("point"==this.layer.geometryType)for(d=a=b[0].geometry.longitude,e=f=b[0].geometry.latitude,h=1;h<c;h++)n=b[h],null!=n.geometry&&(n.geometry.longitude<d&&(d=n.geometry.longitude),n.geometry.longitude>a&&(a=n.geometry.longitude),n.geometry.latitude<e&&(e=n.geometry.latitude),n.geometry.latitude>f&&(f=n.geometry.latitude));else if("polyline"==this.layer.geometryType||"polygon"==this.layer.geometryType)for(l=b[0].geometry.extent,d=l.xmin,a=l.xmax,e=l.ymin,f=l.ymax,
h=1;h<c;h++)n=b[h],null!=n.geometry&&null!=n.geometry.extent&&(l=n.geometry.extent,l.xmin<d&&(d=l.xmin),l.xmax>a&&(a=l.xmax),l.ymin<e&&(e=l.ymin),l.ymax>f&&(f=l.ymax));return this._minDelta=6937.5*Math.min(a-d,f-e),new g(d,e,a,f,this._fx3dSpatialReference)}return null},_getGeomZFromPolyline:function(b,d){return c.set(z,b[0],b[1],b[2]||1),E.wgs84ToSphericalEngineCoords(z,0,z,0),c.set(y,d[0],d[1],d[2]||1),E.wgs84ToSphericalEngineCoords(y,0,y,0),c.subtract(A,z,y),c.add(v,z,y),c.scale(v,v,.5),c.length(v)+
.6*c.length(A)-6378137},_calculatePerfectPosition:function(b){var c={};if(null==b||null==b.geometry)return console.warn("Feature or geometry is invalid."),c;var d,a,e,f=b.geometry;if("point"===this.layer.geometryType)c.x=f.longitude,c.y=f.latitude,f=this.layer._labelDefaultHeight,c.z=5E3,f&&this.layer._currentVizFieldMinMax&&(e=this.layer._currentVizFieldMinMax.max-this.layer._currentVizFieldMinMax.min,isNaN(e)||"number"==typeof this.layer._currentVizPage&&(d=this.layer.vizFields[this.layer._currentVizPage],
a=b.attributes[d],null!=a&&(0===f.flag?(c.z+=f.max,0!=e?c.z*=(a-this.layer._currentVizFieldMinMax.min)/e:c.z=f.min):1===f.flag&&(f.max===f.min?c.z+=f.max:0!=e?c.z+=1.2*(f.min+(f.max-f.min)*(a-this.layer._currentVizFieldMinMax.min)/e):0!=this.layer._currentVizFieldMinMax.max?c.z+=f.max:c.z=f.min))));else if("polyline"===this.layer.geometryType){if(null==f.paths)return console.warn("Paths of feature is invalid."),c;b=f.paths[0];d=b.length;c.x=(b[0][0]+b[d-1][0])/2;c.y=(b[0][1]+b[d-1][1])/2;c.z=1.1*
this._getGeomZFromPolyline(b[0],b[d-1])}else if("polygon"===this.layer.geometryType){if(null==f.rings)return console.warn("Rings of feature is invalid."),c;e=w.polygonCentroid({rings:f.rings,hasZ:!1});if(isNaN(e[0])||isNaN(e[1]))return null;c.x=e[0];c.y=e[1];f=this.layer._labelDefaultHeight;c.z=10;e=this.layer._currentVizFieldMinMax.max-this.layer._currentVizFieldMinMax.min;isNaN(e)||(d=this.layer.vizFields[this.layer._currentVizPage],a=b.attributes[d],null!=a&&(0===f.flag?(c.z+=f.max,0!=e?c.z*=(a-
this.layer._currentVizFieldMinMax.min)/e:c.z=f.min):1===f.flag&&(f.max===f.min?c.z+=f.max:0!=e?c.z+=1.3*(f.min+(f.max-f.min)*(a-this.layer._currentVizFieldMinMax.min)/e):0!=this.layer._currentVizFieldMinMax.max?c.z+=f.max:c.z=f.min)))}return isNaN(c.z)&&(c.z=null),c},_calculatePerfectHeight:function(){var b=this.layer._labelDefaultHeight,c=10;this.layer._currentVizFieldMinMax.max==this.layer._currentVizFieldMinMax.min&&0==this.layer._currentVizFieldMinMax.max?c=b&&b.min||1E3:b&&(0===b.flag?c+=b.max:
1===b.flag&&(c+=b.max===b.min?b.max:1.2*(b.min+(b.max-b.min))));b=Math.abs(c)/111E3;return"local"==this.view.viewModel&&(b=Math.abs(c)/235596.8),10<b&&(b=10),{z:c,lonD:b}},_onShowFeatureLabel:function(b){if(this.layer._labelsLayer&&this.layer._labelsLayer.visible){if(this._selectedFeature=null,b.feature){if(null==b.feature.geometry)return void console.warn("The feature with FID has no geometry content.");this.layer._labelsLayer.removeAll();var c=this._calculatePerfectPosition(b.feature);if(null==
c.x||null==c.y)return;null==c.z?c.z=10:c.z+=1E3;var d=E.createTextTexture(""+b.feature.attributes[this.layer.displayField],14,"#ffffff","center","Arial","rgba(0,0,0,0.5)"),d=new r({url:d.toDataURL(),width:d.width,height:d.height,contentType:"image/png"}),a=new f(c.x,c.y,c.z,this._fx3dSpatialReference),d=new t(a,d,b.feature.attributes,this.layer.popupTemplate);this.layer._labelsLayer.add(d);d=Math.abs(c.z)/111E3;a=Math.abs(c.z)/(111E3*Math.cos(c.y*Math.PI/180));"local"==this.view.viewModel&&(d=Math.abs(c.z)/
111319.5,a=Math.abs(c.z)/235596.8);10<a&&(a=10);20<d&&(d=20);d=new g(c.x-d,c.y-a,c.x+d,c.y+a,this._fx3dSpatialReference);d.zmin=c.z-1;d.zmax=c.z;this._animateTo(d)}else this.layer._labelsLayer.removeAll();this._selectedFeature=b.feature}},_updateSelectedFeatureLabel:function(){if(this.layer._labelsLayer){var b=0<this.layer._labelsLayer.graphics.toArray().length;this.layer._labelsLayer.removeAll();b&&this._selectedFeature&&this._onShowFeatureLabel({feature:this._selectedFeature})}},_viewClicked:function(b){if(b.graphic)if(this.layer._labelsLayer&&
b.graphic.layer===this.layer._labelsLayer)0==this.layer._labelsLayer.graphics.length&&this._onShowFeatureLabel({feature:b.graphic});else{if(b.graphic.layer===this.layer&&this.view&&this.view.popup.viewModel.selectedFeature){b=this.view.popup.viewModel.selectedFeature;var c=new t({attributes:p.clone(b.attributes),geometry:b.geometry&&b.geometry.clone()||null,popupTemplate:b.popupTemplate||null,symbol:b.symbol||null,visible:b.visible});null!=c&&(this._onShowFeatureLabel({feature:c}),this.layer.emit("selected-feature-from-globe",
{selectedFeature:c}),this.view.popup.viewModel._set("selectedFeature",null))}}else if(this.layer&&this.layer._labelsLayer&&0<this.layer._labelsLayer.graphics.length&&(this.layer._labelsLayer.removeAll(),this._selectedFeature=null,this.layer.emit("abandon-selected-feature"),this.view&&this.view.popup.viewModel._set("selectedFeature",null)),this.view&&this.view.popup.viewModel.selectedFeature)try{this.view.popup.viewModel.selectedFeature.symbol=null,this.view.popup.viewModel.selectedFeature.popupTemplate=
null,c=this.view.popup.viewModel.selectedFeature.clone(),this._onShowFeatureLabel({feature:c}),this.layer.emit("selected-feature-from-globe",{selectedFeature:c})}finally{this.view.popup.viewModel._set("selectedFeature",null)}},_animateTo:function(b,c,d){this.view&&this.view.goTo({target:b,heading:this.view.camera.heading,tilt:this.view.camera.tilt})},_initGraphicsController:function(b){if(this._layerId=this.layer.id,this._layerVizType=this.layer.vizType,u.add(this.layer,b)){var c=this.view.map.layers.find(function(b){return b.url===
this.layer.url&&"esri.layers.FeatureLayer"===b.declaredClass&&"Feature Layer"===b.type&&!0===b.loaded}.bind(this)),a=this;b=function(){var b=n.ofType(t),b={layer:a.layer,layerView:a,maxPageSize:300,graphics:new b};a.controller=new e(b);d.whenTrueOnce(a.view,"basemapTerrain.ready",function(){a.controller.when().then(function(){var b=null;a.loadedGraphics=a.controller.graphics;a._graphicsCollectionEventHandle=a.loadedGraphics.on("change",a._collectionChangeHandler.bind(a));0<a.loadedGraphics.length&&
(b=a.loadedGraphics.toArray(),a._add([].concat(b)));a._graphicsControllerEventHandles.push(a.controller.on("query-end",function(){a._graphicsLoading=!1}));a.controller.startup()},function(b){console.log(b)})})};if(c){var f=this.view.layerViews.find(function(b){return b.layer.url===c.url&&b.layer.id===c.id}.bind(this));f?(c.source&&this.layer._initLayerProperties(c.source),this.loadedGraphics=f.loadedGraphics,0<this.loadedGraphics.length&&this._add([].concat(this.loadedGraphics.toArray())),this.layer.on("can-locating-now",
function(){var b=this._calculateExtentCenter(this.loadedGraphics);if(b){var c=this._calculatePerfectHeight();b.zmax=c.z;b.zmin=c.z-1;b.xmax+=2+c.lonD;b.xmin-=2+c.lonD;b.ymax+=1+c.lonD;b.ymin-=1+c.lonD;this._animateTo(b)}}.bind(this)),this.layer.emit("all-features-loaded",{graphics:[].concat(this.loadedGraphics.toArray())})):b()}else b()}},_collectionChangeHandler:function(b){this._add([].concat(b.added));this._remove([].concat(b.removed))},_add:function(b){function c(b){var c,e;b=[].concat(b);a.forEach(b,
function(b){if(c=b.geometry)if("point"==d.layer.geometryType)h.xyzToVector(c.x,c.y,c.z,c.spatialReference,x,d._fx3dSpatialReference),c.longitude=x[0],c.latitude=x[1],c.altitude=isNaN(x[2])?null:x[2];else{if("polyline"==d.layer.geometryType||"polygon"==d.layer.geometryType)for(e=c.paths||c.rings,b=0;b<e.length;b++)for(var a=0;a<e[b].length;a++)h.xyzToVector(e[b][a][0],e[b][a][1],e[b][a][2],c.spatialReference,x,d._fx3dSpatialReference),e[b][a][0]=x[0],e[b][a][1]=x[1],e[b][a][2]=isNaN(x[2])?null:x[2]}else console.warn("No geometry information found in feature: "+
b.attributes.FID)});d.layer.emit("fx3d-add-graphics",{graphics:b});d._graphicsLoading||(d.layer.on("can-locating-now",function(){var b=d._calculateExtentCenter(d.getLoadedGraphics());if(b){var c=d._calculatePerfectHeight();b.zmax=c.z;b.zmin=c.z-1;b.xmax+=2+c.lonD;b.xmin-=2+c.lonD;b.ymax+=1+c.lonD;b.ymin-=1+c.lonD;d._animateTo(b)}}),d.layer.emit("all-features-loaded",{graphics:d.getLoadedGraphics()}))}if(p.isArray(b)&&0<b.length){var d=this;this.isResolved()?c(b):this.when().then(function(){c(b)})}},
_remove:function(b){p.isArray(b)&&0<b.length}})})},"fx3d/views/3d/layers/SnapshotController":function(){define("require exports esri/config esri/core/tsSupport/declareExtendsHelper esri/core/tsSupport/decorateHelper esri/core/tsSupport/assignHelper esri/core/Accessor esri/core/Error esri/core/Evented esri/core/Handles esri/core/Logger esri/core/Promise esri/core/promiseUtils esri/core/accessorSupport/decorators esri/geometry/support/WKIDUnitConversion ./GraphicsManager ./Graphics3DVerticalScale".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n,t,r,w,u){function q(b){var c,d,a;(b&&("object"==typeof b?(c=b.wkid,d=b.wkt):"number"==typeof b?c=b:"string"==typeof b&&(d=b)),c)?a=A.values[A[c]]:d&&-1!==d.search(/^PROJCS/i)&&(b=v.exec(d))&&b[1]&&(a=parseFloat(b[1].split(",")[1]));return a}function E(b,c){c=c||b.extent;b=b.width;var d=q(c&&c.spatialReference);return c&&b?c.width/b*(d||y)*z*k.screenDPI:0}var x=b.getLogger("esri.layers.graphics.controllers.SnapshotController"),z=39.37,y=6378137*Math.PI/180,v=/UNIT\[([^\]]+)\]\]$/i,
A=r;return function(b){function d(d){d=b.call(this)||this;return d.type="snapshot",d._gManager=null,d._verticalScale=null,d._handles=new c,d._source=null,d._started=!1,d._pendingQueries=new Map,d.extent=null,d.hasAllFeatures=!1,d.hasFeatures=!1,d.layer=null,d.layerView=null,d.maxPageSize=null,d.defaultReturnZ=void 0,d.defaultReturnM=void 0,d.pageSize=null,d.paginationEnabled=!1,d}return m(d,b),d.prototype.initialize=function(){var b=this,c=this.layer.when(function(){return b._verifyCapabilities()}).then(function(){return b._init()});
this.addResolvingPromise(c)},d.prototype.destroy=function(){this.cancelQuery();this._gManager&&(this._gManager.destroy(),this._gManager=null);this._handles.destroy();this._pendingQueries=this._handles=null},Object.defineProperty(d.prototype,"updating",{get:function(){return!!(this._pendingQueries&&0<this._pendingQueries.size)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"graphics",{set:function(b){var c=this._get("graphics");c!==b&&(this._handles.remove("graphics"),b&&(this._collectionChanged({added:b.toArray(),
removed:c&&c.toArray()}),this._handles.add(b.on("change",this._collectionChanged.bind(this)),"graphics")),this._set("graphics",b))},enumerable:!0,configurable:!0}),d.prototype.cancelQuery=function(){var b=this;this._pendingQueries&&(this._pendingQueries.forEach(function(c,d){c.isFulfilled()||c.cancel(Error(b._cancelErrorMsg))}),this._pendingQueries.clear(),this.notifyChange("updating"))},d.prototype.refresh=function(){this.isResolved()&&this._started&&this._queryFeatures()},d.prototype.startup=function(){this._started||
(this._started=!0,this._resolutionParams=this._getResolutionParams(),this._queryFeatures())},d.prototype.update=function(){this.startup()},d.prototype._init=function(){var b=this.layer;this.paginationEnabled=!!b.get("capabilities.query.supportsPagination");this._source=b.source;var c=b.maxRecordCount||4E3;this.pageSize=null==this.maxPageSize?c:Math.min(c,this.maxPageSize);this._gManager=new w({graphics:this.graphics,objectIdField:b.objectIdField});this._verticalScale=new u({sourceSpatialReference:b.spatialReference,
destSpatialReference:this.layerView.view.spatialReference});this._setupStateWatchers()},d.prototype._getResolutionParams=function(){var b,c=this.layer,d=c.get("capabilities.query.supportsQuantization");if("polyline"===c.geometryType||"polygon"===c.geometryType){var a=q(this.layerView.view.spatialReference);null!=a&&(b=this._featureResolution.scale,a=this._featureResolution.value/a,b=c.maxScale?c.maxScale:c.minScale?Math.min(b,c.minScale):Math.min(b,E(this.layerView.view,c.fullExtent)),b*=a/this._featureResolution.scale)}return b?
{maxAllowableOffset:d?null:b,quantizationParameters:d?{mode:"view",originPosition:"upperLeft",tolerance:b,extent:c.fullExtent}:null}:null},d.prototype._setupStateWatchers=function(){var b=this;this._handles.add([this.watch("extent",this.refresh.bind(this)),this.layer.watch("outFields",function(c,d){c&&d?-1===d.indexOf("*")&&(c.sort(),d.sort(),JSON.stringify(c)!==JSON.stringify(d)&&b.refresh()):b.refresh()}),this.layer.watch("definitionExpression, historicMoment",this.refresh.bind(this)),this.layer.on("edits",
this._editsHandler.bind(this))])},d.prototype._createQueryParams=function(){var b=this.layer,c=this.layerView,d=b.createQuery();d.outSpatialReference=c.view.spatialReference;d.geometry=this.extent;b=b.capabilities&&b.capabilities.data;return b&&b.supportsZ&&null==d.returnZ&&null!=this.defaultReturnZ&&(d.returnZ=this.defaultReturnZ),b&&b.supportsM&&null==d.returnM&&null!=this.defaultReturnM&&(d.returnM=this.defaultReturnM),d.set(this._resolutionParams),this.paginationEnabled&&(d.start=0,d.num=this.pageSize),
d},d.prototype._queryFeatures=function(){this.cancelQuery();this.hasAllFeatures=this.hasFeatures=!1;this._gManager.beginPagedUpdate();this.emit("query-start");this._executeQuery(this._createQueryParams())},d.prototype._executeQuery=function(b){var c=this,d=this._source.queryFeatures(b),a=this._gManager.createIntentToAdd();this._querySetup(a,d);d.then(this._processFeatureSet.bind(this,b,a))["catch"](function(b){return c._queryError(a,b)}).then(function(){return c._queryTeardown(a)},function(){return c._queryTeardown(a)})},
d.prototype._hydrate=function(b,c,d){if(b){var a=b.translate[0],e=b.translate[1],f=b.scale[0],n=b.scale[1],g=function(b,c,d){return"esriGeometryPoint"===b?function(b){b.x=c(b.x);b.y=d(b.y)}:"polyline"===b||"polygon"===b?function(b){var a,e,f,n,g,h,l,q=b.rings||b.paths;b=0;for(a=q.length;b<a;b++)for(n=q[b],e=0,f=n.length;e<f;e++)g=n[e],0<e?(h+=g[0],l+=g[1]):(h=g[0],l=g[1]),g[0]=c(h),g[1]=d(l)}:"extent"===b?function(b){b.xmin=c(b.xmin);b.ymin=d(b.ymin);b.xmax=c(b.xmax);b.ymax=d(b.ymax)}:"multipoint"===
b?function(b){var a,e,f,n,g=b.points;b=0;for(a=g.length;b<a;b++)e=g[b],0<b?(f+=e[0],n+=e[1]):(f=e[0],n=e[1]),e[0]=c(f),e[1]=d(n)}:void 0}(c,function(b){return b*f+a},function(b){return e-b*n});b=0;for(c=d.length;b<c;b++)d[b].geometry&&g(d[b].geometry)}},d.prototype._processFeatureSet=function(b,c,d){d.transform&&this._hydrate(d.transform,d.geometryType,d.features);var a=d.exceededTransferLimit,e=d.features,f=this._maxFeatures[this.layer.geometryType]||0,n=e?e.length:0,g=this._gManager.numGraphics+
n,h=g>=f;h&&(x.warn('Feature limit exceeded on layer "',this.layer.title,'". Not all features are shown.'),(f=g-f)&&e.splice(n-f,f));b=!(!a||!this.paginationEnabled||h)&&this._queryNextPage(b);return this._verticalScale.adjust(e),e&&this._gManager.addPage(e,c),this.hasFeatures=!0,b||(this._gManager.endPagedUpdate(),this.hasAllFeatures=!a,this.emit("query-end",{success:!0})),d},d.prototype._queryNextPage=function(b){return b.start+=this.pageSize,this._executeQuery(b),!0},d.prototype._queryError=function(b,
c){if(c&&"cancel"===c.dojoType&&!this.hasFeatures?this._gManager.revertPagedUpdate():this._gManager.endPagedUpdate(),this.emit("query-end",{success:!1}),c&&"cancel"===c.dojoType)return n.reject(c);b=new h("snapshotcontroller:tile-request-failed","Failed to query for features",{error:c});return x.error(b),n.reject(b)},d.prototype._querySetup=function(b,c){this._pendingQueries.set(b,c);this.notifyChange("updating")},d.prototype._queryTeardown=function(b){this._gManager.removeIntent(b);this._pendingQueries["delete"](b);
this.notifyChange("updating")},d.prototype._processRefetch=function(b,c){(c=c.features)&&this._gManager.add(c,b)},d.prototype._refetchError=function(b,c){},d.prototype._verifyCapabilities=function(){if(!this.layer.get("capabilities.operations.supportsQuery"))throw new h("graphicscontroller:query-capability-required","Service requires query capabilities to be used as a feature layer",{layer:this.layer});},d.prototype._collectionChanged=function(b){var c=b.added;if(c)for(var d=0;d<c.length;d++)c[d].layer=
this.layer,c[d].sourceLayer=this.layer;if(c=b.removed)for(d=0;d<c.length;d++)c[d].layer=null,c[d].sourceLayer=null},d.prototype._editsHandler=function(b){var c=this,d=function(b){return b.objectId},a=b.deletedFeatures.map(d);this._gManager["delete"](a);b=b.addedFeatures.concat(b.updatedFeatures).map(d);if(b.length){d=this._createQueryParams();d.objectIds=b;var d=this._source.queryFeatures(d),e=this._gManager.createIntentToAdd(b);this._querySetup(e,d);d.then(this._processRefetch.bind(this,e))["catch"](this._refetchError.bind(this,
e)).then(function(){return c._queryTeardown(e)},function(){return c._queryTeardown(e)})}},e([t.shared("SnapshotController: query cancelled")],d.prototype,"_cancelErrorMsg",void 0),e([t.property({readOnly:!0})],d.prototype,"type",void 0),e([t.shared({value:.25,scale:945})],d.prototype,"_featureResolution",void 0),e([t.shared({point:16E3,multipoint:8E3,polyline:4E3,polygon:4E3,multipatch:4E3})],d.prototype,"_maxFeatures",void 0),e([t.property()],d.prototype,"_pendingQueries",void 0),e([t.property({dependsOn:["_pendingQueries"]})],
d.prototype,"updating",null),e([t.property()],d.prototype,"graphics",null),e([t.property()],d.prototype,"extent",void 0),e([t.property()],d.prototype,"hasAllFeatures",void 0),e([t.property()],d.prototype,"hasFeatures",void 0),e([t.property()],d.prototype,"layer",void 0),e([t.property()],d.prototype,"layerView",void 0),e([t.property()],d.prototype,"maxPageSize",void 0),e([t.property()],d.prototype,"defaultReturnZ",void 0),e([t.property()],d.prototype,"defaultReturnM",void 0),e([t.property()],d.prototype,
"pageSize",void 0),e([t.property()],d.prototype,"paginationEnabled",void 0),d=e([t.subclass("esri.layers.graphics.controllers.SnapshotController")],d)}(t.declared(g,d.EsriPromise,l))})},"fx3d/views/3d/layers/GraphicsManager":function(){define(["esri/core/Accessor"],function(p){var a=0;return p.createSubclass({constructor:function(){this._deletedGraphicsIndex=new Set;this._intentsIndex=new Map},destroy:function(){this.removeAll();this._intentsIndex=this._deletedGraphicsIndex=null},properties:{graphics:null,
indexById:{value:null,dependsOn:["graphics","objectIdField"],get:function(){return this._createIndexById(this.graphics&&this.graphics.toArray(),this.objectIdField)}},numGraphics:{value:0,dependsOn:["indexById"],get:function(){return this.indexById?this.indexById.size:0}},objectIdField:null,updating:{value:!1,dependsOn:["_intentsIndex"],get:function(){return!!(this._intentsIndex&&0<this._intentsIndex.size)}},_intentsIndex:{value:null}},_oldIndex:null,_deletedGraphicsIndex:null,beginPagedUpdate:function(){this._oldIndex=
this.indexById;this.indexById=null;this.notifyChange("numGraphics")},addPage:function(a,m){this.add(a,m)},revertPagedUpdate:function(){var a=this._removeLeftOnly(this.indexById,this._oldIndex);this.indexById=this._oldIndex;this._oldIndex=null;this.graphics.removeMany(a);this.notifyChange("numGraphics")},endPagedUpdate:function(){var a=this._removeLeftOnly(this._oldIndex,this.indexById);this._oldIndex=null;this.graphics.removeMany(a);this.notifyChange("numGraphics")},findGraphic:function(a){return(a=
this.indexById&&this.indexById.get(a))&&a.graphic},removeAll:function(){this.indexById=this._oldIndex=null;this.graphics.removeAll();this.notifyChange("numGraphics")},add:function(a,m){if(a&&a.length){for(var e=this.objectIdField,f=this.indexById=this.indexById||new Map,g=this._oldIndex,h=this._createIndexById(a,e),h=this._extractObjectIds(h),f=this._extractObjectIds(f),g=this._extractObjectIds(g),f=f.concat(g),l=[],c=f.length,g=0;g<c;g++){var b=f[g];-1<h.indexOf(b)&&l.push(b)}l.length&&this._remove(l,
!1);m=this.findIntent(m);h=new Map;f=a.length;for(g=0;g<f;g++)(l=a[g])&&l.attributes&&h.set(l.attributes[e],m);a.length&&this._add(a,h)}},remove:function(a){this._remove(a,!1)},"delete":function(a){this._remove(a,!0)},isDeleted:function(a){return this._deletedGraphicsIndex.has(a)},createIntentToAdd:function(k){k&&this._intentsIndex.forEach(function(a,f){k.forEach(function(e){a.ignoredIds.add(e)})},this);var m=a++;return this._intentsIndex.set(m,{ignoredIds:new Set}),this.notifyChange("updating"),
m},findIntent:function(a){return this._intentsIndex.get(a)},removeIntent:function(a){this._intentsIndex["delete"](a);this.notifyChange("updating")},update:function(a,m){if(a&&a.length){var e=this.objectIdField,f=this.indexById=this.indexById||new Map,g=this._oldIndex;a=this._createIndexById(a,e);for(var e=this._extractObjectIds(a),h=this._extractObjectIds(f),l=this._extractObjectIds(g),h=h.concat(l),l=[],c=h.length,b=0;b<c;b++){var d=h[b];if(-1===e.indexOf(d))l.push(d);else{var n=f.get(d)||g.get(d),
n=n&&n.graphic&&n.graphic._ts,k=a.get(d);(k&&k.graphic&&k.graphic._ts)>n&&l.push(d)}}f=[];g=e.length;for(b=0;b<g;b++)d=e[b],(-1===h.indexOf(d)||-1<l.indexOf(d))&&f.push(d);l.length&&this._remove(l,!1);f.length&&this._add(this._extractGraphics(f,a),m)}},_createIndexById:function(a,m){var e;if(a&&a.length&&m){var f,g,h;e=new Map;for(f=0;g=a[f];f++)h=g.attributes&&g.attributes[m],null!=h&&e.set(h,{graphic:g,refCount:1})}return e},_add:function(a,m){var e=this.objectIdField;a.forEach(function(a){var f=
m.get(a.attributes&&a.attributes[e]);this._addToIndex(a,this.indexById,f)},this);this.graphics.addMany(a);this.notifyChange("numGraphics")},_addToIndex:function(a,m,e){var f=a.attributes&&a.attributes[this.objectIdField];m&&null!=f&&(m.has(f)?e&&e.ignoredIds.has(f)||(e=m.get(f),m.set(f,{graphic:a,refCount:e.refCount+1})):this.isDeleted(f)||m.set(f,{graphic:a,refCount:1}))},_remove:function(a,m){a=a||[];a="object"==typeof a[0]?a.map(function(a){return a.attributes&&a.attributes[this.objectIdField]}.bind(this)):
a;var e=this._extractGraphics(a,this._oldIndex),f=this._extractGraphics(a,this.indexById);a.forEach(function(a){m&&this._deletedGraphicsIndex.add(a);this._removeFromIndex(a,this._oldIndex,m);this._removeFromIndex(a,this.indexById,m)}.bind(this));this.graphics.removeMany(e.concat(f));this.notifyChange("numGraphics")},_removeFromIndex:function(a,m,e){if(m&&m.has(a))if(e)m["delete"](a);else{e=m.get(a);var f=e.refCount-1;0===f?m["delete"](a):e.refCount=f}},_removeLeftOnly:function(a,m){var e=[];return a&&
a.forEach(function(f,g){var h=f.graphic;!h||m&&m.has(g)||(--f.refCount,0===f.refCount&&a["delete"](g),e.push(h))}),e},_extractGraphics:function(a,m){return a&&m?a.map(function(a){return(a=m.get(a))&&a.graphic}):[]},_extractObjectIds:function(a){var m=[];return a&&a.forEach(function(a,f){m.push(f)}),m}})})},"fx3d/views/3d/layers/Graphics3DVerticalScale":function(){define(["esri/core/declare","esri/core/maybe","esri/core/unitUtils"],function(p,a,k){return p({constructor:function(a){this.sourceSpatialReference=
a.sourceSpatialReference;this.destSpatialReference=a.destSpatialReference},adjust:function(a){var e=this._getVerticalUnitScale();1!==e&&this._scaleVerticalUnits(a,e)},_getVerticalUnitScale:function(){if(this.sourceSpatialReference&&!this.sourceSpatialReference.equals(this.destSpatialReference)){var a=k.getMetersPerVerticalUnitForSR(this.sourceSpatialReference),e=k.getMetersPerVerticalUnitForSR(this.destSpatialReference);return a/e}return 1},_vertexListsScaleZ:function(a,e){for(var f=0;f<a.length;++f)for(var g=
a[f],h=0;h<g.length;++h)g[h][2]*=e},_scaleVerticalUnits:function(m,e){for(var f=0;f<m.length;++f){var g=m[f].geometry;!a.isNone(g)&&g.hasZ&&(this._geometryIsPoint(g)?null!==g.z&&(g.z*=e):this._geometryIsPolyline(g)?this._vertexListsScaleZ(g.paths,e):this._geometryIsPolygon(g)&&this._vertexListsScaleZ(g.rings,e))}},_geometryIsPoint:function(a){return"point"===a.type},_geometryIsPolygon:function(a){return"polygon"===a.type},_geometryIsPolyline:function(a){return"polyline"===a.type}})})},"fx3d/views/3d/effects/FxEffectRenderer":function(){define("dojo/_base/lang dojo/_base/array esri/core/declare esri/core/scheduling esri/core/watchUtils ../webgl-engine-extensions/ShaderSnippets esri/views/3d/support/earthUtils esri/core/libs/gl-matrix-2/vec3f64 esri/core/libs/gl-matrix-2/mat4f64 esri/core/libs/gl-matrix-2/vec3 esri/core/libs/gl-matrix-2/mat4 esri/views/3d/externalRenderers/RenderContext esri/layers/GraphicsLayer ./Effect ../support/fx3dUtils dojo/text!./CommonShaders.xml".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n,t,r,w){var u=l.mat4f64;b=b.mat4;var q=h.vec3f64;c=c.vec3;var E=null,x=k(null,{declaredClass:"esri.views.3d.effects.FxEffectRenderer",canRender:!0,constructor:function(){this._sceneView=null;this._internallyReady=!1;this._effects=[];this._shaderSnippets=this._fx3dFrameTask=null;this._normalMatrix=u.create();this._viewDirection=q.create()},_init:function(b){!this._internallyReady&&p.isObject(b)&&(this._sceneView=b,e.whenTrue(this._sceneView,"ready",this._viewReadyHandler.bind(this)))},
_viewReadyHandler:function(){this._sceneView._stage&&(this.context=new d(this._sceneView),this._sceneView._stage.addRenderPlugin([6,8],this),this._labelsLayer=new n({id:"-labelinfo-layer",listMode:"hide"}),this._sceneView.map.add(this._labelsLayer))},_enableExtensions:function(b){var c=null;return window.WebGLRenderingContext&&this._gl instanceof window.WebGLRenderingContext?c=this._gl.getExtension("OES_texture_float")||this._gl.getExtension("OES_texture_float_linear")||this._gl.getExtension("OES_texture_half_float")||
this._gl.getExtension("OES_texture_half_float_linear"):window.WebGL2RenderingContext&&this._gl instanceof window.WebGL2RenderingContext&&(c={}),null==c?console.error("Float texture extension is not supported in this browser."):this._vaoExt=b.vao,!!c},initializeRenderContext:function(b){if(this.context.gl=b.rctx.gl,this.context.rctx=b.rctx,this.needsRender=!1,this._gl=b.rctx.gl,!0!==this._internallyReady)this._enableExtensions(b.rctx.extensions||b.rctx.capabilities)?(this._shaderSnippets||(this._shaderSnippets=
new f,this._shaderSnippets._parse(w)),this._internallyReady=!0,this.needsRender=!0,this._webglStateReset()):(this._sceneView._stage&&this._sceneView._stage.removeRenderPlugin(this),r.extensionsMessage())},uninitializeRenderContext:function(b){},_updateContext:function(c){this.context.camera.copyFrom(c.camera);var d={};d.direction=c.scenelightingData.old.direction;d.ambient=c.scenelightingData.old.ambient.color;d.diffuse=c.scenelightingData.old.diffuse.color;d.specular=[.2,.2,.2,.2];d.ambient[3]=c.scenelightingData.old.ambient.intensity;
d.diffuse[3]=c.scenelightingData.old.diffuse.intensity;this.context.lightingData=d;this.context._renderTargetHelper=c.offscreenRenderingHelper;b.copy(this._normalMatrix,c.camera.viewInverseTransposeMatrix);this._normalMatrix[3]=this._normalMatrix[7]=this._normalMatrix[11]=0},_webglStateReset:function(){this.context.rctx.resetState();this.context._renderTargetHelper&&this.context._renderTargetHelper.bindFramebuffer()},intersect:function(){},prepareRender:function(b){},render:function(b){1!=b.pass&&
(this._updateContext(b),this._webglStateReset(),E=b.rctx||this._sceneView._stage.view._rctx,this._effects.forEach(function(b){b.effect.preRender();b.effect.render({zoom:this._sceneView.zoom,proj:this.context.camera.projectionMatrix,view:this.context.camera.viewMatrix,viewInvTransp:this.context.camera.viewInverseTransposeMatrix,normalMat:this._normalMatrix,camPos:this.context.camera._eye,lightingData:this.context.lightingData,viewport:this.context.camera.viewport},E);b.effect.update()}.bind(this)),
this._sceneView._stage.renderView.setNeedsRender())},renderTransparent:function(b){},dispose:function(){},_add:function(b,c){if(p.isObject(b)&&"esri.layers.FxLayer"===b.declaredClass&&c instanceof t){if(0<a.filter(this._effects,function(d){return d.id===b.id&&d.effect.effectName==c.effectName}).length)return console.warn("Layer "+b.id+" in "+c.effectName+" effect has already existed."),!1;if(p.isObject(c))return b.emit("hide-feature-label"),this._labelsLayer.id=b.id+this._labelsLayer.id,b._labelsLayer=
this._labelsLayer,this._labelsLayer.visible=b.visible,b.watch("visible",function(c,d,a){this._labelsLayer&&(b.emit("hide-feature-label"),this._labelsLayer.set("visible",!!c))}.bind(this)),this._effects.push({id:b.id,effect:c}),"function"==typeof c.setContext&&c.setContext({gl:this._gl,vaoExt:this._vaoExt,shaderSnippets:this._shaderSnippets}),!0}return!1},_remove:function(b,c){if(b&&c){var d=-1,e=a.filter(this._effects,function(a,e){return a.id===c&&b==a.effect.effectName&&(d=e,!0)});0<e.length&&-1<
d&&(e[0].effect.destroy(),this._effects.splice(d,1));0===this._effects.length&&(this._fx3dFrameTask&&(this._fx3dFrameTask.remove(),this._fx3dFrameTask=null),this._internallyReady=!1,this._sceneView._stage&&this._sceneView._stage.removeRenderPlugin(this),this._labelsLayer&&(this._labelsLayer.removeAll(),this._sceneView.map.remove(this._labelsLayer)))}},_initializeFrameTask:function(){var b=this;this._frameTask={preRender:function(){b._update();b._effects.forEach(function(b){b.effect.preRender()})},
render:function(){b._effects.forEach(function(c){c.effect.render({proj:b._projMatrix,view:b._viewMatrix,normalMat:b._normalMatrix,camPos:b._cameraPos,lightingData:b._lightingData,viewport:b._viewport,viewInvTransp:b._sceneView.state.camera.viewInverseTransposeMatrix},b._sceneView._stage.renderView._rctx)})},update:function(){b._effects.forEach(function(b){b.effect.update()});b._sceneView._stage.renderView.setNeedsRender()}};this._fx3dFrameTask=m.addFrameTask(this._frameTask)},_showGround:function(b){"boolean"==
typeof b&&this._sceneView.map&&this._sceneView.map.ground&&this._sceneView.map.ground.layers.forEach(function(c){c&&c.set("visible",b)})},_viewReadyHandler_bak:function(){this._gl=this._sceneView._stage&&this._sceneView._stage.view&&this._sceneView._stage.view._gl;this._gl instanceof window.WebGLRenderingContext&&(!0!==this._internallyReady&&(this._enableExtensions()?(this._shaderSnippets||(this._shaderSnippets=new f,this._shaderSnippets._parse(w)),this._internallyReady=!0):r.extensionsMessage()),
this._internallyReady&&(this._fx3dFrameTask||this._initializeFrameTask()))},_update:function(){this.context=new d(this._sceneView);this._camera=this._sceneView._stage&&this._sceneView._stage.getCamera();this._cameraPos=this._camera._eye;this._viewMatrix=this._camera.viewMatrix;this._projMatrix=this._camera.projectionMatrix;this._viewInverseTransposeMatrix=this._camera.viewInverseTransposeMatrix;this._viewport=this._camera.viewport;b.copy(this._normalMatrix,this._viewInverseTransposeMatrix);this._normalMatrix[3]=
this._normalMatrix[7]=this._normalMatrix[11]=0;c.set(this._viewDirection,this._viewMatrix[12],this._viewMatrix[13],this._viewMatrix[14])}}),z=null;return x.init=function(b){z||(z=new x);z._init(b)},x.add=function(b,c){return!!z&&z._add(b,c)},x.destroy=function(b,c){z&&z._remove(b,c)},x.pause=function(){z&&(z._fx3dFrameTask&&z._fx3dFrameTask.pause(),z.needsRender=!1)},x})},"fx3d/views/3d/webgl-engine-extensions/ShaderSnippets":function(){define(["require","exports","dojox/xml/parser","esri/views/3d/webgl-engine/lib/Util"],
function(p,a,k,m){return function(){function a(a){var e=m.VertexAttrConstants,f;for(f in e)this[e[f]]=m.VertexAttrConstants[f];if(a)for(var l in a)this[l]=a[l]}return a.prototype._parse=function(a){a=k.parse(a).getElementsByTagName("snippet");for(var e=/\$[a-zA-Z0-9_]+[ \t]*/,f=/[\$\s]+/g,l=0;l<a.length;l++){var c=a[l].getAttribute("name");m.assert(null==this[c]);for(var b=a[l].textContent;;){var d=b.match(e);if(null==d)break;var n=this[d[0].replace(f,"")];m.assert(void 0!==n);b=b.replace(d[0],n)}this[c]=
b}},a}()})},"dojox/xml/parser":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(p){p.getObject("xml.parser",!0,dojox);dojox.xml.parser.parse=function(a,k){var m=p.doc,e;k=k||"text/xml";if(a&&p.trim(a)&&"DOMParser"in p.global){e=(new DOMParser).parseFromString(a,k);a=e.documentElement;if("parsererror"==a.nodeName&&"http://www.mozilla.org/newlayout/xml/parsererror.xml"==a.namespaceURI){if(m=a.getElementsByTagNameNS("http://www.mozilla.org/newlayout/xml/parsererror.xml",
"sourcetext")[0])m=m.firstChild.data;throw Error("Error parsing text "+a.firstChild.data+" \n"+m);}return e}if("ActiveXObject"in p.global){m=function(a){return"MSXML"+a+".DOMDocument"};m=["Microsoft.XMLDOM",m(6),m(4),m(3),m(2)];p.some(m,function(a){try{e=new ActiveXObject(a)}catch(h){return!1}return!0});if(a&&e&&(e.async=!1,e.loadXML(a),a=e.parseError,0!==a.errorCode))throw Error("Line: "+a.line+"\nCol: "+a.linepos+"\nReason: "+a.reason+"\nError Code: "+a.errorCode+"\nSource: "+a.srcText);if(e)return e}else if(m.implementation&&
m.implementation.createDocument){if(a&&p.trim(a)&&m.createElement){k=m.createElement("xml");k.innerHTML=a;var f=m.implementation.createDocument("foo","",null);p.forEach(k.childNodes,function(a){f.importNode(a,!0)});return f}return m.implementation.createDocument("","",null)}return null};dojox.xml.parser.textContent=function(a,k){if(1<arguments.length)return dojox.xml.parser.replaceChildren(a,(a.ownerDocument||p.doc).createTextNode(k)),k;if(void 0!==a.textContent)return a.textContent;var m="";a&&p.forEach(a.childNodes,
function(a){switch(a.nodeType){case 1:case 5:m+=dojox.xml.parser.textContent(a);break;case 3:case 2:case 4:m+=a.nodeValue}});return m};dojox.xml.parser.replaceChildren=function(a,k){var m=[];p.isIE&&p.forEach(a.childNodes,function(a){m.push(a)});dojox.xml.parser.removeChildren(a);p.forEach(m,p.destroy);p.isArray(k)?p.forEach(k,function(e){a.appendChild(e)}):a.appendChild(k)};dojox.xml.parser.removeChildren=function(a){for(var k=a.childNodes.length;a.hasChildNodes();)a.removeChild(a.firstChild);return k};
dojox.xml.parser.innerXML=function(a){return a.innerXML?a.innerXML:a.xml?a.xml:"undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(a):null};return dojox.xml.parser})},"esri/views/3d/webgl-engine/lib/Util":function(){define("require exports ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64".split(" "),
function(p,a,k,m,e,f,g,h,l){function c(b,c){if(!b)throw c=c||"assert",b=Error(c),b.stack&&console.log(b.stack),new w(c);}function b(b){for(var c in b)return c}function d(b,c){b[12]=c[0];b[13]=c[1];b[14]=c[2]}function n(b,c){void 0===c&&(c=0);for(var d=0,a=0;4>a;a++)d+=b[c+a]*q[a];return d}function t(b){return b-Math.floor(b)}Object.defineProperty(a,"__esModule",{value:!0});var r=l.vec4f64.create(),w=function(){function b(b){this.message=b}b.prototype.toString=function(){return"AssertException: "+
this.message};return b}();a.AssertException=w;a.VertexAttrConstants={POSITION:"position",NORMAL:"normal",NORMALCOMPRESSED:"normalCompressed",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",COLOR:"color",SYMBOLCOLOR:"symbolColor",SIZE:"size",REGION:"region",COMPONENTINDEX:"componentIndex",TANGENT:"tangent"};a.assert=c;a.verify=function(b,c){b||console.warn("Verify failed: "+(c||"")+"\n"+Error("verify").stack)};a.encodeInt16=function(b){return k.clamp(Math.round(32767*b),-32767,32767)};a.encodeNormal=
function(b,c){var d=Math.abs(b[0]),a=Math.abs(b[1]),e=1/(d+a+Math.abs(b[2])),f=Math.min(b[2]*e,0);c[0]=(0>b[0]?-1:1)*(d*e-f);c[1]=(0>b[1]?-1:1)*(a*e-f)};a.fallbackIfUndefined=function(b,c){return void 0===b?c:b};a.hex2rgb=function(b){b=Math.floor(b);return[(b>>16&255)/255,(b>>8&255)/255,(b&255)/255]};a.rgb2hex=function(b){var c=k.clamp(Math.round(255*b[0]),0,255),d=k.clamp(Math.round(255*b[1]),0,255);b=k.clamp(Math.round(255*b[2]),0,255);return"0x"+((c<<16)+(d<<8)+b).toString(16)};a.dec2hex=function(b){b=
b.toString(16);return"00000000".substr(0,8-b.length)+b};a.rayTriangle3D=function(b,c,d,a,e,f,n,h,l){void 0===l&&(l=g.vec3f64.create());var q=a[n]-d[f],m=a[n+1]-d[f+1],k=a[n+2]-d[f+2];a=e[h]-d[f];n=e[h+1]-d[f+1];e=e[h+2]-d[f+2];var r=c[1]*e-n*c[2],v=c[2]*a-e*c[0],t=c[0]*n-a*c[1];h=q*r+m*v+k*t;if(-1E-5<h&&1E-5>h)return!1;h=1/h;var w=b[0]-d[f],u=b[1]-d[f+1];b=b[2]-d[f+2];l[1]=h*(w*r+u*v+b*t);if(0>l[1]||1<l[1])return!1;d=u*k-m*b;b=b*q-k*w;q=w*m-q*u;l[2]=h*(c[0]*d+c[1]*b+c[2]*q);if(0>l[2]||1<l[1]+l[2])return!1;
l[0]=h*(a*d+n*b+e*q);return!0};a.rayBoxTest=function(b,c,d,a){var e,f=(d[0]-b[0])/c[0],n=(a[0]-b[0])/c[0];f>n&&(e=f,f=n,n=e);var h=(d[1]-b[1])/c[1],g=(a[1]-b[1])/c[1];h>g&&(e=h,h=g,g=e);if(f>g||h>n)return!1;h>f&&(f=h);g<n&&(n=g);d=(d[2]-b[2])/c[2];b=(a[2]-b[2])/c[2];d>b&&(e=d,d=b,b=e);if(f>b||d>n)return!1;b<n&&(n=b);return 0>n?!1:!0};a.rayRay2D=function(b,c,d,a,e,n){void 0===n&&(n=f.vec2f64.create());var h=(a[e]-d[e])*(c[0]-b[0])-(a[0]-d[0])*(c[e]-b[e]);if(0===h)return!1;d=((a[0]-d[0])*(b[e]-d[e])-
(a[e]-d[e])*(b[0]-d[0]))/h;n[0]=b[0]+d*(c[0]-b[0]);n[1]=b[e]+d*(c[e]-b[e]);return!0};a.project=function(b,d,a,e,f){f||(f=b);r[0]=b[0];r[1]=b[1];r[2]=b[2];r[3]=1;h.vec4.transformMat4(r,r,d);2<f.length&&(f[2]=-r[2]);h.vec4.transformMat4(r,r,a);c(0!==r[3]);f[0]=r[0]/r[3];f[1]=r[1]/r[3];f[2]=r[2]/r[3];f[0]=(.5*f[0]+.5)*e[2]+e[0];f[1]=(.5*f[1]+.5)*e[3]+e[1]};a.getFirstObjectKey=b;a.getFirstObjectValue=function(c){return c[b(c)]};a.objectEmpty=function(b){for(var c in b)return!1;return!0};a.logWithBase=
function(b,c){return Math.log(b)/Math.log(c)};a.setMatrixTranslation=d;a.setMatrixTranslation3=function(b,c,d,a){b[12]=c;b[13]=d;b[14]=a};a.getMatrixTranslation=function(b,c){void 0===c&&(c=g.vec3f64.create());c[0]=b[12];c[1]=b[13];c[2]=b[14];return c};a.createTranslationMatrix=function(b,c){b=m.mat4.identity(b);d(b,c);return b};a.isTranslationMatrix=function(b){return 1===b[0]&&0===b[1]&&0===b[2]&&0===b[3]&&0===b[4]&&1===b[5]&&0===b[6]&&0===b[7]&&0===b[8]&&0===b[9]&&1===b[10]&&0===b[11]&&1===b[15]};
a.fovx2fovy=function(b,c,d){return 2*Math.atan(d*Math.tan(.5*b)/c)};a.fovy2fovx=function(b,c,d){return 2*Math.atan(c*Math.tan(.5*b)/d)};a.fovx2fovd=function(b,c,d){return 2*Math.atan(Math.sqrt(c*c+d*d)*Math.tan(.5*b)/c)};a.fovy2fovd=function(b,c,d){return 2*Math.atan(Math.sqrt(c*c+d*d)*Math.tan(.5*b)/d)};a.fovd2fovx=function(b,c,d){return 2*Math.atan(c*Math.tan(.5*b)/Math.sqrt(c*c+d*d))};a.fovd2fovy=function(b,c,d){return 2*Math.atan(d*Math.tan(.5*b)/Math.sqrt(c*c+d*d))};a.packFloatRGBA=function(b,
c,d){void 0===d&&(d=0);b=k.clamp(b,0,E);for(var a=0;4>a;a++)c[d+a]=Math.floor(256*t(b*u[a]))};a.unpackFloatRGBA=n;var u=[1,256,65536,16777216],q=[1/256,1/65536,1/16777216,1/4294967296],E=n(new Uint8ClampedArray([255,255,255,255]));a.inverseProjectionInfo=function(b,c,d,a,f){0===b[11]?(a[0]=2/(c*b[0]),a[1]=2/(d*b[5]),a[2]=(1+b[12])/b[0],a[3]=(1+b[13])/b[5],e.vec2.set(f,0,1)):(a[0]=-2/(c*b[0]),a[1]=-2/(d*b[5]),a[2]=(1-b[8])/b[0],a[3]=(1-b[9])/b[5],e.vec2.set(f,1,0))}})},"esri/core/libs/gl-matrix-2/vec2":function(){define(["require",
"exports","./math/vec2"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});a.vec2=k})},"esri/core/libs/gl-matrix-2/math/vec2":function(){define(["require","exports","./common"],function(p,a,k){function m(b,c,a){b[0]=c[0]-a[0];b[1]=c[1]-a[1];return b}function e(b,c,a){b[0]=c[0]*a[0];b[1]=c[1]*a[1];return b}function f(b,c,a){b[0]=c[0]/a[0];b[1]=c[1]/a[1];return b}function g(b,c){var d=c[0]-b[0];b=c[1]-b[1];return Math.sqrt(d*d+b*b)}function h(b,c){var d=c[0]-b[0];b=c[1]-b[1];return d*
d+b*b}function l(b){var c=b[0];b=b[1];return Math.sqrt(c*c+b*b)}function c(b){var c=b[0];b=b[1];return c*c+b*b}Object.defineProperty(a,"__esModule",{value:!0});a.copy=function(b,c){b[0]=c[0];b[1]=c[1];return b};a.set=function(b,c,a){b[0]=c;b[1]=a;return b};a.add=function(b,c,a){b[0]=c[0]+a[0];b[1]=c[1]+a[1];return b};a.subtract=m;a.multiply=e;a.divide=f;a.ceil=function(b,c){b[0]=Math.ceil(c[0]);b[1]=Math.ceil(c[1]);return b};a.floor=function(b,c){b[0]=Math.floor(c[0]);b[1]=Math.floor(c[1]);return b};
a.min=function(b,c,a){b[0]=Math.min(c[0],a[0]);b[1]=Math.min(c[1],a[1]);return b};a.max=function(b,c,a){b[0]=Math.max(c[0],a[0]);b[1]=Math.max(c[1],a[1]);return b};a.round=function(b,c){b[0]=Math.round(c[0]);b[1]=Math.round(c[1]);return b};a.scale=function(b,c,a){b[0]=c[0]*a;b[1]=c[1]*a;return b};a.scaleAndAdd=function(b,c,a,e){b[0]=c[0]+a[0]*e;b[1]=c[1]+a[1]*e;return b};a.distance=g;a.squaredDistance=h;a.length=l;a.squaredLength=c;a.negate=function(b,c){b[0]=-c[0];b[1]=-c[1];return b};a.inverse=
function(b,c){b[0]=1/c[0];b[1]=1/c[1];return b};a.normalize=function(b,c){var d=c[0],a=c[1],d=d*d+a*a;0<d&&(d=1/Math.sqrt(d),b[0]=c[0]*d,b[1]=c[1]*d);return b};a.dot=function(b,c){return b[0]*c[0]+b[1]*c[1]};a.cross=function(b,c,a){c=c[0]*a[1]-c[1]*a[0];b[0]=b[1]=0;b[2]=c;return b};a.lerp=function(b,c,a,e){var d=c[0];c=c[1];b[0]=d+e*(a[0]-d);b[1]=c+e*(a[1]-c);return b};a.random=function(b,c){c=c||1;var d=2*k.RANDOM()*Math.PI;b[0]=Math.cos(d)*c;b[1]=Math.sin(d)*c;return b};a.transformMat2=function(b,
c,a){var d=c[0];c=c[1];b[0]=a[0]*d+a[2]*c;b[1]=a[1]*d+a[3]*c;return b};a.transformMat2d=function(b,c,a){var d=c[0];c=c[1];b[0]=a[0]*d+a[2]*c+a[4];b[1]=a[1]*d+a[3]*c+a[5];return b};a.transformMat3=function(b,c,a){var d=c[0];c=c[1];b[0]=a[0]*d+a[3]*c+a[6];b[1]=a[1]*d+a[4]*c+a[7];return b};a.transformMat4=function(b,c,a){var d=c[0];c=c[1];b[0]=a[0]*d+a[4]*c+a[12];b[1]=a[1]*d+a[5]*c+a[13];return b};a.rotate=function(b,c,a,e){var d=c[0]-a[0];c=c[1]-a[1];var f=Math.sin(e);e=Math.cos(e);b[0]=d*e-c*f+a[0];
b[1]=d*f+c*e+a[1];return b};a.angle=function(b,c){var d=b[0];b=b[1];var a=c[0];c=c[1];var e=d*d+b*b;0<e&&(e=1/Math.sqrt(e));var f=a*a+c*c;0<f&&(f=1/Math.sqrt(f));d=(d*a+b*c)*e*f;return 1<d?0:-1>d?Math.PI:Math.acos(d)};a.str=function(b){return"vec2("+b[0]+", "+b[1]+")"};a.exactEquals=function(b,c){return b[0]===c[0]&&b[1]===c[1]};a.equals=function(b,c){var d=b[0];b=b[1];var a=c[0];c=c[1];return Math.abs(d-a)<=k.EPSILON*Math.max(1,Math.abs(d),Math.abs(a))&&Math.abs(b-c)<=k.EPSILON*Math.max(1,Math.abs(b),
Math.abs(c))};a.len=l;a.sub=m;a.mul=e;a.div=f;a.dist=g;a.sqrDist=h;a.sqrLen=c})},"esri/core/libs/gl-matrix-2/vec2f64":function(){define(["require","exports","./factories/vec2f64"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});a.vec2f64=k})},"esri/core/libs/gl-matrix-2/factories/vec2f64":function(){define(["require","exports"],function(p,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){return[0,0]};a.clone=function(a){return[a[0],a[1]]};a.fromValues=function(a,
m){return[a,m]};a.fromArray=function(a){for(var m=[0,0],e=Math.min(2,a.length),f=0;f<e;++f)m[f]=a[f];return m};a.createView=function(a,m){return new Float64Array(a,m,2)};a.zeros=function(){return[0,0]};a.ones=function(){return[1,1]};a.unitX=function(){return[1,0]};a.unitY=function(){return[0,1]};a.ZEROS=[0,0];a.ONES=[1,1];a.UNIT_X=[1,0];a.UNIT_Y=[0,1]})},"esri/core/libs/gl-matrix-2/vec4":function(){define(["require","exports","./math/vec4"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});
a.vec4=k})},"esri/core/libs/gl-matrix-2/math/vec4":function(){define(["require","exports","./common"],function(p,a,k){function m(b,c,a){b[0]=c[0]-a[0];b[1]=c[1]-a[1];b[2]=c[2]-a[2];b[3]=c[3]-a[3];return b}function e(b,c,a){b[0]=c[0]*a[0];b[1]=c[1]*a[1];b[2]=c[2]*a[2];b[3]=c[3]*a[3];return b}function f(b,c,a){b[0]=c[0]/a[0];b[1]=c[1]/a[1];b[2]=c[2]/a[2];b[3]=c[3]/a[3];return b}function g(b,c){var d=c[0]-b[0],a=c[1]-b[1],e=c[2]-b[2];b=c[3]-b[3];return Math.sqrt(d*d+a*a+e*e+b*b)}function h(b,c){var d=
c[0]-b[0],a=c[1]-b[1],e=c[2]-b[2];b=c[3]-b[3];return d*d+a*a+e*e+b*b}function l(b){var c=b[0],a=b[1],e=b[2];b=b[3];return Math.sqrt(c*c+a*a+e*e+b*b)}function c(b){var c=b[0],a=b[1],e=b[2];b=b[3];return c*c+a*a+e*e+b*b}Object.defineProperty(a,"__esModule",{value:!0});a.copy=function(b,c){b[0]=c[0];b[1]=c[1];b[2]=c[2];b[3]=c[3];return b};a.set=function(b,c,a,e,f){b[0]=c;b[1]=a;b[2]=e;b[3]=f;return b};a.add=function(b,c,a){b[0]=c[0]+a[0];b[1]=c[1]+a[1];b[2]=c[2]+a[2];b[3]=c[3]+a[3];return b};a.subtract=
m;a.multiply=e;a.divide=f;a.ceil=function(b,c){b[0]=Math.ceil(c[0]);b[1]=Math.ceil(c[1]);b[2]=Math.ceil(c[2]);b[3]=Math.ceil(c[3]);return b};a.floor=function(b,c){b[0]=Math.floor(c[0]);b[1]=Math.floor(c[1]);b[2]=Math.floor(c[2]);b[3]=Math.floor(c[3]);return b};a.min=function(b,c,a){b[0]=Math.min(c[0],a[0]);b[1]=Math.min(c[1],a[1]);b[2]=Math.min(c[2],a[2]);b[3]=Math.min(c[3],a[3]);return b};a.max=function(b,c,a){b[0]=Math.max(c[0],a[0]);b[1]=Math.max(c[1],a[1]);b[2]=Math.max(c[2],a[2]);b[3]=Math.max(c[3],
a[3]);return b};a.round=function(b,c){b[0]=Math.round(c[0]);b[1]=Math.round(c[1]);b[2]=Math.round(c[2]);b[3]=Math.round(c[3]);return b};a.scale=function(b,c,a){b[0]=c[0]*a;b[1]=c[1]*a;b[2]=c[2]*a;b[3]=c[3]*a;return b};a.scaleAndAdd=function(b,c,a,e){b[0]=c[0]+a[0]*e;b[1]=c[1]+a[1]*e;b[2]=c[2]+a[2]*e;b[3]=c[3]+a[3]*e;return b};a.distance=g;a.squaredDistance=h;a.length=l;a.squaredLength=c;a.negate=function(b,c){b[0]=-c[0];b[1]=-c[1];b[2]=-c[2];b[3]=-c[3];return b};a.inverse=function(b,c){b[0]=1/c[0];
b[1]=1/c[1];b[2]=1/c[2];b[3]=1/c[3];return b};a.normalize=function(b,c){var a=c[0],d=c[1],e=c[2];c=c[3];var f=a*a+d*d+e*e+c*c;0<f&&(f=1/Math.sqrt(f),b[0]=a*f,b[1]=d*f,b[2]=e*f,b[3]=c*f);return b};a.dot=function(b,c){return b[0]*c[0]+b[1]*c[1]+b[2]*c[2]+b[3]*c[3]};a.lerp=function(b,c,a,e){var d=c[0],f=c[1],h=c[2];c=c[3];b[0]=d+e*(a[0]-d);b[1]=f+e*(a[1]-f);b[2]=h+e*(a[2]-h);b[3]=c+e*(a[3]-c);return b};a.random=function(b,c){c=c||1;var a,d,e,f,h,g;do a=2*k.RANDOM()-1,d=2*k.RANDOM()-1,h=a*a+d*d;while(1<=
h);do e=2*k.RANDOM()-1,f=2*k.RANDOM()-1,g=e*e+f*f;while(1<=g);h=Math.sqrt((1-h)/g);b[0]=c*a;b[1]=c*d;b[2]=c*e*h;b[3]=c*f*h;return b};a.transformMat4=function(b,c,a){var d=c[0],e=c[1],f=c[2];c=c[3];b[0]=a[0]*d+a[4]*e+a[8]*f+a[12]*c;b[1]=a[1]*d+a[5]*e+a[9]*f+a[13]*c;b[2]=a[2]*d+a[6]*e+a[10]*f+a[14]*c;b[3]=a[3]*d+a[7]*e+a[11]*f+a[15]*c;return b};a.transformQuat=function(b,c,a){var d=c[0],e=c[1],f=c[2],h=a[0],g=a[1],l=a[2];a=a[3];var n=a*d+g*f-l*e,m=a*e+l*d-h*f,k=a*f+h*e-g*d,d=-h*d-g*e-l*f;b[0]=n*a+d*
-h+m*-l-k*-g;b[1]=m*a+d*-g+k*-h-n*-l;b[2]=k*a+d*-l+n*-g-m*-h;b[3]=c[3];return b};a.str=function(b){return"vec4("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+")"};a.exactEquals=function(b,c){return b[0]===c[0]&&b[1]===c[1]&&b[2]===c[2]&&b[3]===c[3]};a.equals=function(b,c){var a=b[0],d=b[1],e=b[2];b=b[3];var f=c[0],h=c[1],g=c[2];c=c[3];return Math.abs(a-f)<=k.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(d-h)<=k.EPSILON*Math.max(1,Math.abs(d),Math.abs(h))&&Math.abs(e-g)<=k.EPSILON*Math.max(1,Math.abs(e),
Math.abs(g))&&Math.abs(b-c)<=k.EPSILON*Math.max(1,Math.abs(b),Math.abs(c))};a.sub=m;a.mul=e;a.div=f;a.dist=g;a.sqrDist=h;a.len=l;a.sqrLen=c})},"esri/core/libs/gl-matrix-2/vec4f64":function(){define(["require","exports","./factories/vec4f64"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});a.vec4f64=k})},"esri/core/libs/gl-matrix-2/factories/vec4f64":function(){define(["require","exports"],function(p,a){function k(){return[0,0,0,0]}function m(){return[1,1,1,1]}function e(){return[1,
0,0,0]}function f(){return[0,1,0,0]}function g(){return[0,0,1,0]}function h(){return[0,0,0,1]}Object.defineProperty(a,"__esModule",{value:!0});a.create=k;a.clone=function(a){return[a[0],a[1],a[2],a[3]]};a.fromValues=function(a,c,b,d){return[a,c,b,d]};a.fromArray=function(a){for(var c=k(),b=Math.min(4,a.length),d=0;d<b;++d)c[d]=a[d];return c};a.createView=function(a,c){return new Float64Array(a,c,4)};a.zeros=function(){return k()};a.ones=m;a.unitX=e;a.unitY=f;a.unitZ=g;a.unitW=h;a.ZEROS=k();a.ONES=
m();a.UNIT_X=e();a.UNIT_Y=f();a.UNIT_Z=g();a.UNIT_W=h()})},"esri/views/3d/externalRenderers/RenderContext":function(){define(["require","exports","../../../core/libs/gl-matrix-2/vec3f64","../webgl-engine/lib/Camera"],function(p,a,k,m){return function(){function a(a){this.view=a;this._renderTargetHelper=null;this.camera=new m.default;this.sunLight={direction:k.vec3f64.create(),diffuse:{color:k.vec3f64.create(),intensity:1},ambient:{color:k.vec3f64.create(),intensity:1}}}a.prototype.resetWebGLState=
function(){null!=this.rctx&&(this.rctx.enforceState(),this._renderTargetHelper&&this._renderTargetHelper.bindFramebuffer())};a.prototype.bindRenderTarget=function(){if(this._renderTargetHelper){var a=this._renderTargetHelper.framebuffer;a.initialize();this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.glName)}};return a}()})},"esri/views/3d/webgl-engine/lib/Camera":function(){define("require exports ../../../../core/mathUtils ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64 ../../support/geometryUtils ../../support/mathUtils ../../support/geometryUtils/vector ./Util".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n,t){function r(b,c){var a=c[0]-b[0],d=c[1]-b[1],e=c[2]-b[2];b=c[3]-b[3];return a*a+d*d+e*e+b*b}function w(b,c){return b[0]===c[0]&&b[1]===c[1]&&b[2]===c[2]}function u(b,c){return b[0]===c[0]&&b[1]===c[1]&&b[2]===c[2]&&b[3]===c[3]}Object.defineProperty(a,"__esModule",{value:!0});p=function(){function a(a,d,e){void 0===a&&(a=h.vec3f64.create());void 0===d&&(d=h.vec3f64.create());void 0===e&&(e=h.vec3f64.fromValues(0,0,1));this._viewUp=h.vec3f64.create();this._viewForward=
h.vec3f64.create();this._viewRight=h.vec3f64.create();this._ray=b.ray.createWrapper();this._viewport=c.vec4f64.fromValues(0,0,1,1);this._padding=c.vec4f64.fromValues(0,0,0,0);this._fov=55/180*Math.PI;this._near=1;this._far=1E3;this._viewDirty=!0;this._viewMatrix=f.mat4f64.create();this._projectionDirty=!0;this._projectionMatrix=f.mat4f64.create();this._viewProjectionDirty=!0;this._viewProjectionMatrix=f.mat4f64.create();this._viewInverseTransposeMatrixDirty=!0;this._viewInverseTransposeMatrix=f.mat4f64.create();
this._frustumDirty=!0;this._frustum=b.frustum.create();this._fullViewport=null;this.pixelRatio=1;this.relativeElevation=0;this._eye=h.vec3f64.clone(a);this._center=h.vec3f64.clone(d);this._up=h.vec3f64.clone(e);this._padding=c.vec4f64.create()}Object.defineProperty(a.prototype,"eye",{get:function(){return this._eye},set:function(b){this._compareAndSetView(b,this._eye)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"center",{get:function(){return this._center},set:function(b){this._compareAndSetView(b,
this._center)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"ray",{get:function(){this._ray.origin=this.eye;this._ray.direction||(this._ray.direction=h.vec3f64.create());g.vec3.subtract(this._ray.direction,this.center,this.eye);return this._ray},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"up",{get:function(){return this._up},set:function(b){this._compareAndSetView(b,this._up)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"viewMatrix",
{get:function(){this._ensureViewClean();return this._viewMatrix},set:function(b){e.mat4.copy(this._viewMatrix,b);this._viewDirty=!1;this._frustumDirty=this._viewProjectionDirty=this._viewInverseTransposeMatrixDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"viewForward",{get:function(){this._ensureViewClean();return this._viewForward},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"viewUp",{get:function(){this._ensureViewClean();return this._viewUp},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"viewRight",{get:function(){this._ensureViewClean();return this._viewRight},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"near",{get:function(){return this._near},set:function(b){this._near!==b&&(this._near=b,this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"far",{get:function(){return this._far},set:function(b){this._far!==
b&&(this._far=b,this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"viewport",{get:function(){return this._viewport},set:function(b){this.x=b[0];this.y=b[1];this.width=b[2];this.height=b[3]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"x",{get:function(){return this._viewport[0]},set:function(b){b+=this._padding[3];this._viewport[0]!==b&&(this._viewport[0]=b,this._frustumDirty=this._viewProjectionDirty=
this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"y",{get:function(){return this._viewport[1]},set:function(b){b+=this._padding[2];this._viewport[1]!==b&&(this._viewport[1]=b,this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"width",{get:function(){return this._viewport[2]},set:function(b){this._viewport[2]!==b&&(this._viewport[2]=b,this._frustumDirty=this._viewProjectionDirty=
this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this._viewport[3]},set:function(b){this._viewport[3]!==b&&(this._viewport[3]=b,this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullWidth",{get:function(){return this._viewport[2]+this._padding[1]+this._padding[3]},set:function(b){this.width=b-(this._padding[1]+this._padding[3])},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"fullHeight",{get:function(){return this._viewport[3]+this._padding[0]+this._padding[2]},set:function(b){this.height=b-(this._padding[0]+this._padding[2])},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullViewport",{get:function(){this._fullViewport||(this._fullViewport=c.vec4f64.create());this._fullViewport[0]=this._viewport[0]-this._padding[3];this._fullViewport[1]=this._viewport[1]-this._padding[2];this._fullViewport[2]=
this.fullWidth;this._fullViewport[3]=this.fullHeight;return this._fullViewport},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"aspect",{get:function(){return this.width/this.height},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"padding",{get:function(){return this._padding},set:function(b){if(this._padding[0]!==b[0]||this._padding[1]!==b[1]||this._padding[2]!==b[2]||this._padding[3]!==b[3])this._viewport[0]+=b[3]-this._padding[3],this._viewport[1]+=b[2]-this._padding[2],
this._viewport[2]-=b[1]+b[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=b[0]+b[2]-(this._padding[0]+this._padding[2]),l.vec4.copy(this._padding,b),this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"viewProjectionMatrix",{get:function(){this._viewProjectionDirty&&(e.mat4.multiply(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1);return this._viewProjectionMatrix},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"projectionMatrix",{get:function(){if(this._projectionDirty){var b=this.width,c=this.height,a=this.near*Math.tan(this.fovY/2),d=a*this.aspect;e.mat4.frustum(this._projectionMatrix,-d*(1+2*this._padding[3]/b),d*(1+2*this._padding[1]/b),-a*(1+2*this._padding[2]/c),a*(1+2*this._padding[0]/c),this.near,this.far);this._projectionDirty=!1}return this._projectionMatrix},set:function(b){e.mat4.copy(this._projectionMatrix,b);this._projectionDirty=
!1;this._frustumDirty=this._viewProjectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fov",{get:function(){return this._fov},set:function(b){this._fov=b;this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fovX",{get:function(){return t.fovd2fovx(this._fov,this.width,this.height)},set:function(b){this._fov=t.fovx2fovd(b,this.width,this.height);this._frustumDirty=this._viewProjectionDirty=
this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fovY",{get:function(){return t.fovd2fovy(this._fov,this.width,this.height)},set:function(b){this._fov=t.fovy2fovd(b,this.width,this.height);this._frustumDirty=this._viewProjectionDirty=this._projectionDirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"distance",{get:function(){return g.vec3.distance(this._center,this._eye)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"frustum",{get:function(){this._recomputeFrustum();return this._frustum},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"viewInverseTransposeMatrix",{get:function(){if(this._viewInverseTransposeMatrixDirty||this._viewDirty)this._viewInverseTransposeMatrix||(this._viewInverseTransposeMatrix=f.mat4f64.create()),e.mat4.invert(this._viewInverseTransposeMatrix,this.viewMatrix),e.mat4.transpose(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=
!1;return this._viewInverseTransposeMatrix},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"perRenderPixelRatio",{get:function(){return Math.tan(this.fovX/2)/(this.width/2)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"perScreenPixelRatio",{get:function(){return this.perRenderPixelRatio*this.pixelRatio},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"aboveGround",{get:function(){return 0<=this.relativeElevation},enumerable:!0,configurable:!0});
a.prototype.copyFrom=function(a){g.vec3.copy(this._eye,a._eye);g.vec3.copy(this._center,a._center);g.vec3.copy(this._up,a._up);l.vec4.copy(this._viewport,a._viewport);l.vec4.copy(this._padding,a._padding);this._near=a._near;this._far=a._far;this._fov=a._fov;this.relativeElevation=a.relativeElevation;this._viewDirty=a._viewDirty;this._viewDirty||(e.mat4.copy(this._viewMatrix,a._viewMatrix),g.vec3.copy(this._viewRight,a._viewRight),g.vec3.copy(this._viewUp,a._viewUp),g.vec3.copy(this._viewForward,a._viewForward));
a._projectionDirty?this._projectionDirty=!0:(e.mat4.copy(this._projectionMatrix,a._projectionMatrix),this._projectionDirty=!1);this._viewProjectionDirty=!0;this._frustumDirty=a._frustumDirty;this._frustumDirty||(b.frustum.copy(a._frustum,this._frustum),this._frustumDirty=!1);a._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(this._viewInverseTransposeMatrix?e.mat4.copy(this._viewInverseTransposeMatrix,a._viewInverseTransposeMatrix):this._viewInverseTransposeMatrix=f.mat4f64.clone(a._viewInverseTransposeMatrix),
this._viewInverseTransposeMatrixDirty=!1);a._fullViewport?this._fullViewport?l.vec4.copy(this._fullViewport,a._fullViewport):this._fullViewport=c.vec4f64.clone(a._fullViewport):this._fullViewport=null;this.pixelRatio=a.pixelRatio;return this};a.prototype.copyViewFrom=function(b){this.eye=b.eye;this.center=b.center;this.up=b.up};a.prototype.clone=function(){var b=new a;b.copyFrom(this);return b};a.prototype.equals=function(b){return w(this._eye,b._eye)&&w(this._center,b._center)&&w(this._up,b._up)&&
u(this._viewport,b._viewport)&&u(this._padding,b._padding)&&this._near===b._near&&this._far===b._far&&this._fov===b._fov&&this.pixelRatio===b.pixelRatio&&this.relativeElevation===b.relativeElevation};a.prototype.almostEquals=function(b,c,a){void 0===a&&(a=!1);c=g.vec3.distance(this._eye,this._center)*(c||5E-4);c*=c;a?(d.directionFromTo(x,b._eye,b._center),d.directionFromTo(z,this._eye,this._center),a=1E-10):(g.vec3.copy(x,b._center),g.vec3.copy(z,this._center),a=c);return g.vec3.squaredDistance(b._eye,
this._eye)<c&&g.vec3.squaredDistance(x,z)<a&&.001>Math.abs(b._fov-this._fov)&&.5>r(b._padding,this._padding)&&.5>r(b._viewport,this._viewport)&&this.pixelRatio===b.pixelRatio};a.prototype.markViewDirty=function(){this._viewProjectionDirty=this._frustumDirty=this._viewDirty=!0};a.prototype.computeRenderPixelSizeAt=function(b){return this.computeRenderPixelSizeAtDist(this.viewDirectionDistance(b))};a.prototype.computeRenderPixelSizeAtDist=function(b){return b*this.perRenderPixelRatio};a.prototype.computeScreenPixelSizeAt=
function(b){return this.computeScreenPixelSizeAtDist(this.viewDirectionDistance(b))};a.prototype.viewDirectionDistance=function(b){return Math.abs(n.projectPointSignedLength(this.viewForward,g.vec3.subtract(x,b,this._eye)))};a.prototype.computeScreenPixelSizeAtDist=function(b){return b*this.perScreenPixelRatio};a.prototype.computeDistanceFromRadius=function(b,c){return b/Math.tan(Math.min(this.fovX,this.fovY)/(2*(c||1)))};a.prototype.getScreenCenter=function(b){void 0===b&&(b=m.createScreenPointArray());
b[0]=(this.padding[3]+this.width/2)/this.pixelRatio;b[1]=(this.padding[0]+this.height/2)/this.pixelRatio;return b};a.prototype.getRenderCenter=function(b,c,a){void 0===c&&(c=.5);void 0===a&&(a=.5);b||(b=m.createRenderScreenPointArray3());b[0]=this.padding[3]+this.width*c;b[1]=this.padding[2]+this.height*a;2<b.length&&(b[2]=.5);return b};a.prototype.setGLViewport=function(b){var c=this.viewport,a=this.padding;b.setViewport(c[0]-a[3],c[1]-a[2],c[2]+a[1]+a[3],c[3]+a[0]+a[2])};a.prototype.applyProjection=
function(b,c,a){void 0===a&&(a=!1);b!==q&&g.vec3.copy(q,b);q[3]=1;a&&(c[2]=-q[2]);l.vec4.transformMat4(q,q,this.projectionMatrix);g.vec3.scale(q,q,1/Math.abs(q[3]));b=this.fullViewport;c[0]=k.lerp(0,b[0]+b[2],.5+.5*q[0]);c[1]=k.lerp(0,b[1]+b[3],.5+.5*q[1]);a||(c[2]=.5*(q[2]+1));return c};a.prototype.projectPoint=function(b,c){q[0]=b[0];q[1]=b[1];q[2]=b[2];q[3]=1;l.vec4.transformMat4(q,q,this.viewProjectionMatrix);if(0===q[3])return null;g.vec3.scale(q,q,1/Math.abs(q[3]));b=this.fullViewport;"x"in
c?(c.x=k.lerp(0,b[0]+b[2],.5+.5*q[0]),c.y=k.lerp(0,b[1]+b[3],.5+.5*q[1])):(c[0]=k.lerp(0,b[0]+b[2],.5+.5*q[0]),c[1]=k.lerp(0,b[1]+b[3],.5+.5*q[1]),2<c.length&&(c[2]=.5*(q[2]+1)));return c};a.prototype.unprojectPoint=function(b,c){e.mat4.multiply(E,this.projectionMatrix,this.viewMatrix);if(!e.mat4.invert(E,E))return null;var a=this.fullViewport;q[0]=2*(b[0]-a[0])/a[2]-1;q[1]=2*(b[1]-a[1])/a[3]-1;q[2]=2*b[2]-1;q[3]=1;l.vec4.transformMat4(q,q,E);if(0===q[3])return null;c[0]=q[0]/q[3];c[1]=q[1]/q[3];
c[2]=q[2]/q[3];return c};a.prototype.computeUp=function(b){"global"===b?this.computeUpGlobal():this.computeUpLocal()};a.prototype.screenToRender=function(b,c){var a=this.fullHeight-b[1]*this.pixelRatio;c[0]=b[0]*this.pixelRatio;c[1]=a;return c};a.prototype.renderToScreen=function(b,c){var a=(this.fullHeight-b[1])/this.pixelRatio;c[0]=b[0]/this.pixelRatio;c[1]=a;return c};a.prototype.computeUpGlobal=function(){g.vec3.subtract(x,this.center,this.eye);var b=g.vec3.length(this.center);1>b?(g.vec3.set(this.up,
0,0,1),this.markViewDirty()):Math.abs(g.vec3.dot(x,this.center))>.9999*g.vec3.length(x)*b||(g.vec3.cross(this.up,x,this.center),g.vec3.cross(this.up,this.up,x),g.vec3.normalize(this.up,this.up),this.markViewDirty())};a.prototype.computeUpLocal=function(){d.directionFromTo(x,this.eye,this.center);.9999>=Math.abs(x[2])&&(g.vec3.scale(x,x,x[2]),g.vec3.set(this.up,-x[0],-x[1],1-x[2]),g.vec3.normalize(this.up,this.up),this.markViewDirty())};a.prototype._compareAndSetView=function(b,c){w(b,c)||(g.vec3.copy(c,
b),this._viewProjectionDirty=this._frustumDirty=this._viewDirty=!0)};a.prototype._recomputeFrustum=function(){this._frustumDirty&&(b.frustum.fromMatrix(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)};a.prototype._ensureViewClean=function(){this._viewDirty&&(e.mat4.lookAt(this._viewMatrix,this._eye,this._center,this._up),g.vec3.set(this._viewForward,-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10]),g.vec3.set(this._viewUp,this._viewMatrix[1],this._viewMatrix[5],
this._viewMatrix[9]),g.vec3.set(this._viewRight,this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8]),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)};return a}();a.default=p;var q=c.vec4f64.create(),E=f.mat4f64.create(),x=h.vec3f64.create(),z=h.vec3f64.create()})},"esri/views/3d/support/geometryUtils":function(){define("require exports ./geometryUtils/axisAngle ./geometryUtils/boundedPlane ./geometryUtils/clipRay ./geometryUtils/frustum ./geometryUtils/lineSegment ./geometryUtils/plane ./geometryUtils/ray ./geometryUtils/sphere ./geometryUtils/triangle ./geometryUtils/vector".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d){Object.defineProperty(a,"__esModule",{value:!0});a.plane=h;a.boundedPlane=m;a.triangle=b;a.lineSegment=g;a.ray=l;a.clipRay=e;a.sphere=c;a.frustum=f;a.vector=d;a.axisAngle=k})},"esri/views/3d/support/geometryUtils/axisAngle":function(){define(["require","exports","../../../../core/libs/gl-matrix-2/vec3","../stack","./vector"],function(p,a,k,m,e){function f(e){void 0===e&&(e=a.UP);return[e[0],e[1],e[2],e[3]]}function g(a,e,c,b,d){void 0===d&&(d=f());d[0]=a;d[1]=e;d[2]=
c;d[3]=b;return d}Object.defineProperty(a,"__esModule",{value:!0});a.create=f;a.wrap=function(a,e,c,b){return g(a,e,c,b,m.sv4d.get())};a.wrapAxisAngle=function(a,e){return g(a[0],a[1],a[2],e,m.sv4d.get())};a.copy=function(a,e){void 0===e&&(e=f());return g(a[0],a[1],a[2],a[3],e)};a.fromValues=g;a.fromAxisAndAngle=function(a,e,c){void 0===c&&(c=f());k.vec3.copy(c,a);c[3]=e;return c};a.fromPoints=function(a,g,c){void 0===c&&(c=f());k.vec3.cross(c,a,g);k.vec3.normalize(c,c);c[3]=e.angle(a,g);return c};
a.UP=[0,0,1,0]})},"esri/views/3d/support/stack":function(){define(["require","exports","../../../core/VectorStack"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});a.sv2d=k.VectorStack.createVec2f64();a.sv3d=k.VectorStack.createVec3f64();a.sv4d=k.VectorStack.createVec4f64();a.sm3d=k.VectorStack.createMat3f64();a.sm4d=k.VectorStack.createMat4f64();a.sq4d=k.VectorStack.createQuatf64()})},"esri/core/VectorStack":function(){define("require exports ./nextTick ./libs/gl-matrix-2/mat3f64 ./libs/gl-matrix-2/mat4f64 ./libs/gl-matrix-2/quatf64 ./libs/gl-matrix-2/vec2f64 ./libs/gl-matrix-2/vec3f64 ./libs/gl-matrix-2/vec4f64".split(" "),
function(p,a,k,m,e,f,g,h,l){Object.defineProperty(a,"__esModule",{value:!0});p=function(){function b(b,c,a){var d=this;this.itemByteSize=b;this.itemCreate=c;this.buffers=[];this.items=[];this.itemsPtr=this.itemsPerBuffer=0;this.itemsPerBuffer=Math.ceil(a/this.itemByteSize);this.tickHandle=k.before(function(){return d.reset()})}b.prototype.destroy=function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=null);this.itemsPtr=0;this.buffers=this.items=null};b.prototype.get=function(){0===
this.itemsPtr&&k(function(){});for(var b=Math.floor(this.itemsPtr/this.itemsPerBuffer);this.buffers.length<=b;){for(var c=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize),a=0;a<this.itemsPerBuffer;++a)this.items.push(this.itemCreate(c,a*this.itemByteSize));this.buffers.push(c)}return this.items[this.itemsPtr++]};b.prototype.reset=function(){for(var b=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);this.buffers.length>b;)this.buffers.pop(),this.items.length=this.buffers.length*this.itemsPerBuffer;
this.itemsPtr=0};b.createVec2f64=function(a){void 0===a&&(a=c);return new b(16,g.vec2f64.createView,a)};b.createVec3f64=function(a){void 0===a&&(a=c);return new b(24,h.vec3f64.createView,a)};b.createVec4f64=function(a){void 0===a&&(a=c);return new b(32,l.vec4f64.createView,a)};b.createMat3f64=function(a){void 0===a&&(a=c);return new b(72,m.mat3f64.createView,a)};b.createMat4f64=function(a){void 0===a&&(a=c);return new b(128,e.mat4f64.createView,a)};b.createQuatf64=function(a){void 0===a&&(a=c);return new b(32,
f.quatf64.createView,a)};Object.defineProperty(b.prototype,"test",{get:function(){return{size:this.buffers.length*this.itemsPerBuffer*this.itemByteSize}},enumerable:!0,configurable:!0});return b}();a.VectorStack=p;var c=4096})},"esri/core/libs/gl-matrix-2/mat3f64":function(){define(["require","exports","./factories/mat3f64"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});a.mat3f64=k})},"esri/core/libs/gl-matrix-2/factories/mat3f64":function(){define(["require","exports"],function(p,
a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){return[1,0,0,0,1,0,0,0,1]};a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]]};a.fromValues=function(a,m,e,f,g,h,l,c,b){return[a,m,e,f,g,h,l,c,b]};a.createView=function(a,m){return new Float64Array(a,m,9)}})},"esri/core/libs/gl-matrix-2/quatf64":function(){define(["require","exports","./factories/quatf64"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});a.quatf64=k})},"esri/core/libs/gl-matrix-2/factories/quatf64":function(){define(["require",
"exports"],function(p,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){return[0,0,0,1]};a.clone=function(a){return[a[0],a[1],a[2],a[3]]};a.fromValues=function(a,m,e,f){return[a,m,e,f]};a.createView=function(a,m){return new Float64Array(a,m,4)}})},"esri/views/3d/support/geometryUtils/vector":function(){define(["require","exports","../../../../core/mathUtils","../../../../core/libs/gl-matrix-2/vec3"],function(p,a,k,m){Object.defineProperty(a,"__esModule",{value:!0});a.projectPoint=
function(a,f,g){f=m.vec3.dot(a,f)/m.vec3.dot(a,a);return m.vec3.scale(g,a,f)};a.projectPointSignedLength=function(a,f){return m.vec3.dot(a,f)/m.vec3.length(a)};a.angle=function(a,f){a=m.vec3.dot(a,f)/(m.vec3.length(a)*m.vec3.length(f));return-k.acosClamped(a)}})},"esri/views/3d/support/geometryUtils/boundedPlane":function(){define("require exports ../../../../core/compilerUtils ../../../../core/Logger ../../../../core/mathUtils ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../mathUtils ../stack ./lineSegment ./plane ./ray ./vector".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n,t,r,w){function u(b){void 0===b&&(b=a.UP);return{plane:t.create(b.plane),origin:c.vec3f64.clone(b.origin),basis1:c.vec3f64.clone(b.basis1),basis2:c.vec3f64.clone(b.basis2)}}function q(b,c){void 0===c&&(c=u());return E(b.origin,b.basis1,b.basis2,c)}function E(b,c,a,d){void 0===d&&(d=u());l.vec3.copy(d.origin,b);l.vec3.copy(d.basis1,c);l.vec3.copy(d.basis2,a);t.fromVectorsAndPoint(a,c,b,d.plane);b=d;1E-6<Math.abs(l.vec3.dot(b.basis1,b.basis2)/(l.vec3.length(b.basis1)*
l.vec3.length(b.basis2)))&&I.warn("fromValues()","Provided basis vectors are not perpendicular");1E-6<Math.abs(l.vec3.dot(b.basis1,b.plane))&&I.warn("fromValues()","Basis vectors and plane normal are not perpendicular");1E-6<Math.abs(-l.vec3.dot(b.plane,b.origin)-b.plane[3])&&I.warn("fromValues()","Plane offset is not consistent with plane origin");return d}function x(b,c,a){b!==a&&q(b,a);b=l.vec3.scale(d.sv3d.get(),b.plane,c);l.vec3.add(a.origin,a.origin,b);a.plane[3]-=c;return a}function z(b,c){void 0===
c&&(c=u());var a=(b[2]-b[0])/2,d=(b[3]-b[1])/2;l.vec3.set(c.origin,b[0]+a,b[1]+d,0);l.vec3.set(c.basis1,a,0,0);l.vec3.set(c.basis2,0,d,0);t.fromValues(0,0,1,0,c.plane);return c}function y(b,c,a){return t.intersectRay(b.plane,c,a)?K(b,a):!1}function v(c,a,f){var g=J.get(),h=J.get();H(c,a,g,h);for(var h=Number.POSITIVE_INFINITY,n=0,q=Q;n<q.length;n++){var m=G(c,q[n],N.get()),k=d.sv3d.get();t.intersectLineSegment(g,m,k)&&(m=b.directionFromTo(d.sv3d.get(),a.origin,k),m=Math.abs(e.acosClamped(l.vec3.dot(a.direction,
m))),m<h&&(h=m,l.vec3.copy(f,k)))}return h===Number.POSITIVE_INFINITY?A(c,a,f):f}function A(b,c,a){if(y(b,c,a))return a;var e=J.get(),f=J.get();H(b,c,e,f);for(var g=Number.POSITIVE_INFINITY,h=0,n=Q;h<n.length;h++){var q=G(b,n[h],N.get()),m=d.sv3d.get();t.intersectLineSegmentClamp(e,q,m)&&(q=r.distance2(c,m),t.isPointInside(f,m)&&q<g&&(g=q,l.vec3.copy(a,m)))}L(b,c.origin)<g&&B(b,c.origin,a);return a}function B(b,c,a){var e=t.projectPoint(b.plane,c,d.sv3d.get());c=n.projectPointClamp(D(b,b.basis1),
e,-1,1,d.sv3d.get());e=n.projectPointClamp(D(b,b.basis2),e,-1,1,d.sv3d.get());l.vec3.subtract(a,l.vec3.add(d.sv3d.get(),c,e),b.origin);return a}function C(b,c,a){var e=b.origin,f=b.basis1,g=b.basis2;c=l.vec3.subtract(d.sv3d.get(),c,e);f=w.projectPointSignedLength(f,c);g=w.projectPointSignedLength(g,c);b=w.projectPointSignedLength(b.plane,c);return l.vec3.set(a,f,g,b)}function L(b,c){c=C(b,c,d.sv3d.get());var a=b.basis2;b=l.vec3.length(b.basis1);a=l.vec3.length(a);b=Math.max(Math.abs(c[0])-b,0);a=
Math.max(Math.abs(c[1])-a,0);c=c[2];return b*b+a*a+c*c}function R(b,c){var a=-b.plane[3];return w.projectPointSignedLength(b.plane,c)-a}function K(b,c){var a=l.vec3.subtract(d.sv3d.get(),c,b.origin);c=l.vec3.squaredLength(b.basis1);var e=l.vec3.squaredLength(b.basis2),f=l.vec3.dot(b.basis1,a);b=l.vec3.dot(b.basis2,a);return 0>-f-c&&0>f-c&&0>-b-e&&0>b-e}function D(b,c){var a=N.get();l.vec3.copy(a.origin,b.origin);l.vec3.copy(a.vector,c);return a}function G(b,c,a){var e=b.basis1,f=b.basis2;b=b.origin;
var g=l.vec3.scale(d.sv3d.get(),e,c.origin[0]),h=l.vec3.scale(d.sv3d.get(),f,c.origin[1]);l.vec3.add(a.origin,g,h);l.vec3.add(a.origin,a.origin,b);e=l.vec3.scale(d.sv3d.get(),e,c.direction[0]);c=l.vec3.scale(d.sv3d.get(),f,c.direction[1]);l.vec3.scale(a.vector,l.vec3.add(e,e,c),2);return a}function H(b,c,a,d){b=b.plane;t.fromVectorsAndPoint(b,c.direction,c.origin,a);t.fromVectorsAndPoint(a,b,c.origin,d)}Object.defineProperty(a,"__esModule",{value:!0});var I=m.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");
p=function(){return function(){this.plane=t.create();this.origin=c.vec3f64.create();this.basis1=c.vec3f64.create();this.basis2=c.vec3f64.create()}}();a.BoundedPlaneClass=p;a.create=u;a.wrap=function(b,c,a){var d=M.get();d.origin=b;d.basis1=c;d.basis2=a;d.plane=t.fromVectorsAndPoint(a,c,b,t.wrap(0,0,0,0));return d};a.copy=q;a.fromValues=E;a.elevate=x;a.setExtent=function(b,c,a){z(c,a);x(a,R(b,b.origin),a);return a};a.fromAABoundingRect=z;a.intersectRay=y;a.intersectRayClosestSilhouette=function(b,
c,a){if(y(b,c,a))return a;b=v(b,c,d.sv3d.get());l.vec3.add(a,c.origin,l.vec3.scale(d.sv3d.get(),c.direction,l.vec3.distance(c.origin,b)/l.vec3.length(c.direction)));return a};a.closestPointOnSilhouette=v;a.closestPoint=A;a.projectPoint=B;a.projectPointLocal=C;a.distance2=L;a.distance=function(b,c){return Math.sqrt(L(b,c))};a.distanceToSilhouette=function(b,c){for(var a=Number.NEGATIVE_INFINITY,d=0,e=Q;d<e.length;d++){var f=G(b,e[d],N.get()),f=n.distance2(f,c);f>a&&(a=f)}return Math.sqrt(a)};a.extrusionContainsPoint=
function(b,c){return t.isPointInside(b.plane,c)&&K(b,c)};a.axisAt=function(b,c,a,d){switch(a){case 0:l.vec3.copy(d,b.basis1);l.vec3.normalize(d,d);break;case 1:l.vec3.copy(d,b.basis2);l.vec3.normalize(d,d);break;case 2:l.vec3.copy(d,b.plane);break;default:k.neverReached(a)}return d};a.altitudeAt=R;a.setAltitudeAt=function(b,c,a,d){var e=R(b,c);b=l.vec3.scale(P,b.plane,a-e);l.vec3.add(d,c,b);return d};a.transform=function(b,c,a){b!==a&&q(b,a);g.mat4.invert(O,c);g.mat4.transpose(O,O);l.vec3.transformMat4(a.basis1,
b.basis1,O);l.vec3.transformMat4(a.basis2,b.basis2,O);l.vec3.transformMat4(a.plane,b.plane,O);l.vec3.transformMat4(a.origin,b.origin,c);t.setOffsetFromPoint(a.plane,a.origin,a.plane);return a};a.UP={plane:t.create(),origin:c.vec3f64.fromValues(0,0,0),basis1:c.vec3f64.fromValues(1,0,0),basis2:c.vec3f64.fromValues(0,1,0)};var J=new f.ObjectStack(t.create),N=new f.ObjectStack(n.create),P=c.vec3f64.create(),M=new f.ObjectStack(function(){return{origin:null,basis1:null,basis2:null,plane:null}}),Q=[{origin:[-1,
-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],O=h.mat4f64.create()})},"esri/core/ObjectStack":function(){define(["require","exports","./nextTick"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});p=function(){function a(a){var e=this;this.allocator=a;this.items=[];this.itemsPtr=0;this.tickHandle=k.before(function(){return e.reset()});this.grow()}a.prototype.destroy=function(){this.tickHandle&&(this.tickHandle.remove(),
this.tickHandle=null);this.items=null};a.prototype.get=function(){0===this.itemsPtr&&k(function(){});this.itemsPtr===this.items.length&&this.grow();return this.items[this.itemsPtr++]};a.prototype.reset=function(){this.items.length=Math.min(Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3*m),this.items.length);this.itemsPtr=0};a.prototype.grow=function(){for(var a=0;a<Math.max(8,Math.min(this.items.length,m));a++)this.items.push(this.allocator())};return a}();a.ObjectStack=p;var m=1024;a.default=
p})},"esri/views/3d/support/geometryUtils/lineSegment":function(){define("require exports ../../../../core/mathUtils ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../stack".split(" "),function(p,a,k,m,e,f,g){function h(b){return b?{origin:f.vec3f64.clone(b.origin),vector:f.vec3f64.clone(b.vector)}:{origin:f.vec3f64.create(),vector:f.vec3f64.create()}}function l(b,c){var a=r.get();a.origin=b;a.vector=c;return a}function c(b,c,a){void 0===
a&&(a=h());e.vec3.copy(a.origin,b);e.vec3.copy(a.vector,c);return a}function b(b,c){c=e.vec3.subtract(g.sv3d.get(),c,b.origin);var a=e.vec3.dot(b.vector,c),d=e.vec3.dot(b.vector,b.vector),a=k.clamp(a/d,0,1);b=e.vec3.subtract(g.sv3d.get(),e.vec3.scale(g.sv3d.get(),b.vector,a),c);return e.vec3.dot(b,b)}function d(b,c,a,d,f){var h=b.vector,l=b.origin;c=e.vec3.subtract(g.sv3d.get(),c,l);l=e.vec3.length(h);c=e.vec3.dot(h,c)/l;e.vec3.scale(f,h,k.clamp(c,a,d));return e.vec3.add(f,f,b.origin)}function n(b,
c,a,d){var f=b.origin,h=e.vec3.add(g.sv3d.get(),f,b.vector);b=c.origin;var l=e.vec3.add(g.sv3d.get(),b,c.vector),n=g.sv3d.get();c=g.sv3d.get();n[0]=f[0]-b[0];n[1]=f[1]-b[1];n[2]=f[2]-b[2];c[0]=l[0]-b[0];c[1]=l[1]-b[1];c[2]=l[2]-b[2];if(1E-6>Math.abs(c[0])&&1E-6>Math.abs(c[1])&&1E-6>Math.abs(c[2]))return!1;l=g.sv3d.get();l[0]=h[0]-f[0];l[1]=h[1]-f[1];l[2]=h[2]-f[2];if(1E-6>Math.abs(l[0])&&1E-6>Math.abs(l[1])&&1E-6>Math.abs(l[2]))return!1;var h=n[0]*c[0]+n[1]*c[1]+n[2]*c[2],q=c[0]*l[0]+c[1]*l[1]+c[2]*
l[2],m=c[0]*c[0]+c[1]*c[1]+c[2]*c[2],r=(l[0]*l[0]+l[1]*l[1]+l[2]*l[2])*m-q*q;if(1E-6>Math.abs(r))return!1;n=(h*q-(n[0]*l[0]+n[1]*l[1]+n[2]*l[2])*m)/r;h=(h+q*n)/m;a&&(n=k.clamp(n,0,1),h=k.clamp(h,0,1));a=g.sv3d.get();q=g.sv3d.get();a[0]=f[0]+n*l[0];a[1]=f[1]+n*l[1];a[2]=f[2]+n*l[2];q[0]=b[0]+h*c[0];q[1]=b[1]+h*c[1];q[2]=b[2]+h*c[2];d.tA=n;d.tB=h;d.pA=a;d.pB=q;d.distance2=e.vec3.squaredDistance(a,q);return!0}Object.defineProperty(a,"__esModule",{value:!0});a.create=h;a.wrap=l;a.copy=function(b,a){void 0===
a&&(a=h());return c(b.origin,b.vector,a)};a.fromValues=c;a.fromPoints=function(b,c,a){void 0===a&&(a=h());e.vec3.copy(a.origin,b);e.vec3.subtract(a.vector,c,b);return a};a.distance2=b;a.distance=function(c,a){return Math.sqrt(b(c,a))};a.projectPoint=function(b,c,a){return d(b,c,0,1,a)};a.pointAt=function(b,c,a){return e.vec3.add(a,b.origin,e.vec3.scale(a,b.vector,c))};a.projectPointClamp=d;a.closestRayDistance2=function(b,c){if(n(b,l(c.origin,c.direction),!1,t)){c=t.tA;var a=t.pB,d=t.distance2;if(0<=
c&&1>=c)return d;if(0>c)return e.vec3.squaredDistance(b.origin,a);if(1<c)return e.vec3.squaredDistance(e.vec3.add(g.sv3d.get(),b.origin,b.vector),a)}return null};a.closestLineSegmentPoint=function(b,c,a){return n(b,c,!0,t)?(e.vec3.copy(a,t.pA),!0):!1};a.closestLineSegmentDistance2=function(b,c){return n(b,c,!0,t)?t.distance2:null};var t={tA:0,tB:0,pA:f.vec3f64.create(),pB:f.vec3f64.create(),distance2:0},r=new m.ObjectStack(function(){return{origin:null,vector:null}})})},"esri/views/3d/support/geometryUtils/plane":function(){define(["require",
"exports","../../../../core/mathUtils","../../../../core/libs/gl-matrix-2/vec3","../stack"],function(p,a,k,m,e){function f(b){void 0===b&&(b=a.UP);return[b[0],b[1],b[2],b[3]]}function g(b,c){void 0===c&&(c=f());return h(b[0],b[1],b[2],b[3],c)}function h(b,c,a,d,e){void 0===e&&(e=f());e[0]=b;e[1]=c;e[2]=a;e[3]=d;return e}function l(b,a,d){void 0===d&&(d=f());m.vec3.copy(d,a);a=m.vec3.dot(a,a);1E-5<Math.abs(a-1)&&1E-12<a&&m.vec3.scale(d,d,1/Math.sqrt(a));c(d,b,d);return d}function c(b,c,a){b!==a&&g(b,
a);a[3]=-m.vec3.dot(a,c);return a}function b(b,c,a,d){void 0===d&&(d=f());b=m.vec3.cross(e.sv3d.get(),c,b);return l(a,b,d)}function d(b,c,a){b=m.vec3.scale(e.sv3d.get(),b,m.vec3.dot(b,c));m.vec3.subtract(a,c,b);return a}function n(b,c){return m.vec3.dot(b,c)+b[3]}function t(b,c,a,d,e,f){var h=m.vec3.dot(b,a);if(0===h)return!1;b=-(m.vec3.dot(b,c)+b[3])/h;e&&(b=d?Math.max(0,b):k.clamp(b,0,1));if(0>b||!d&&1<b)return!1;m.vec3.add(f,c,m.vec3.scale(f,a,b));return!0}Object.defineProperty(a,"__esModule",
{value:!0});a.create=f;a.wrap=function(b,c,a,d){return h(b,c,a,d,e.sv4d.get())};a.copy=g;a.fromValues=h;a.fromNormalAndOffset=function(b,c,a){void 0===a&&(a=f());m.vec3.copy(a,b);a[3]=c;return a};a.fromPositionAndNormal=l;a.fromPoints=function(c,a,d,h){void 0===h&&(h=f());return b(m.vec3.subtract(e.sv3d.get(),c,a),m.vec3.subtract(e.sv3d.get(),d,a),c,h)};a.setOffsetFromPoint=c;a.negate=function(b,c){c[0]=-b[0];c[1]=-b[1];c[2]=-b[2];c[3]=-b[3];return c};a.fromVectorsAndPoint=b;a.intersectRay=function(b,
c,a){return t(b,c.origin,c.direction,!0,!1,a)};a.intersectLineSegment=function(b,c,a){return t(b,c.origin,c.vector,!1,!1,a)};a.intersectLineSegmentClamp=function(b,c,a){return t(b,c.origin,c.vector,!1,!0,a)};a.isSphereFullyInside=function(b,c){var a=c.radius;return 0<=n(b,c.center)-a};a.isSphereFullyOutside=function(b,c){var a=c.radius;return 0>n(b,c.center)+a};a.isPointInside=function(b,c){return 0<=n(b,c)};a.isPointOutside=function(b,c){return 0>n(b,c)};a.isAABBFullyInside=function(b,c){var a=c[0],
d=c[1],e=c[2],f=c[3],h=c[4];c=c[5];return 0<=b[0]*(0<b[0]?a:f)+b[1]*(0<b[1]?d:h)+b[2]*(0<b[2]?e:c)+b[3]};a.clip=function(b,c){var a=m.vec3.dot(b,c.ray.direction);b=-n(b,c.ray.origin);if(0>b&&0<=a)return!1;if(-1E-6<a&&1E-6>a)return 0<b;if((0>b||0>a)&&!(0>b&&0>a))return!0;b/=a;0<a?b<c.c1&&(c.c1=b):b>c.c0&&(c.c0=b);return c.c0<=c.c1};a.clipInfinite=function(b,c){var a=m.vec3.dot(b,c.ray.direction);b=-n(b,c.ray.origin);if(-1E-6<a&&1E-6>a)return 0<b;b/=a;0<a?b<c.c1&&(c.c1=b):b>c.c0&&(c.c0=b);return c.c0<=
c.c1};a.projectPoint=function(b,c,a){var f=m.vec3.scale(e.sv3d.get(),b,-b[3]);c=m.vec3.subtract(e.sv3d.get(),c,f);b=d(b,c,e.sv3d.get());m.vec3.add(a,b,f);return a};a.projectVector=d;a.distance=function(b,c){return Math.abs(n(b,c))};a.signedDistance=n;a.UP=[0,0,1,0]})},"esri/views/3d/support/geometryUtils/ray":function(){define("require exports ../../../../core/ObjectStack ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../stack".split(" "),
function(p,a,k,m,e,f,g,h){function l(b){return b?{origin:g.vec3f64.clone(b.origin),direction:g.vec3f64.clone(b.direction)}:{origin:g.vec3f64.create(),direction:g.vec3f64.create()}}function c(b,c,a){void 0===a&&(a=l());f.vec3.copy(a.origin,b);f.vec3.copy(a.direction,c);return a}function b(b,c,a){void 0===a&&(a=l());var d=m.castRenderScreenPointArray3(e.vec2.copy(h.sv3d.get(),c));d[2]=0;b.unprojectPoint(d,a.origin);c=m.castRenderScreenPointArray3(e.vec2.copy(h.sv3d.get(),c));c[2]=1;b=b.unprojectPoint(c,
h.sv3d.get());f.vec3.subtract(a.direction,b,a.origin);return a}function d(b,c,a){void 0===a&&(a=l());f.vec3.copy(a.origin,b.eye);c=f.vec3.set(h.sv3d.get(),c[0],c[1],1);b=b.unprojectPoint(c,h.sv3d.get());f.vec3.subtract(a.direction,b,a.origin);return a}function n(b,c){b=f.vec3.cross(h.sv3d.get(),f.vec3.normalize(h.sv3d.get(),b.direction),f.vec3.subtract(h.sv3d.get(),c,b.origin));return f.vec3.dot(b,b)}function t(){return{origin:null,direction:null}}Object.defineProperty(a,"__esModule",{value:!0});
a.create=l;a.wrap=function(b,c){var a=r.get();a.origin=b;a.direction=c;return a};a.copy=function(b,a){void 0===a&&(a=l());return c(b.origin,b.direction,a)};a.fromPoints=function(b,c,a){void 0===a&&(a=l());f.vec3.copy(a.origin,b);f.vec3.subtract(a.direction,c,b);return a};a.fromValues=c;a.fromScreen=function(c,a,d){void 0===d&&(d=l());return b(c,c.screenToRender(a,m.castRenderScreenPointArray3(h.sv3d.get())),d)};a.fromRender=b;a.fromScreenAtEye=function(b,c,a){void 0===a&&(a=l());return d(b,b.screenToRender(c,
m.castRenderScreenPointArray3(h.sv3d.get())),a)};a.fromRenderAtEye=d;a.distance2=n;a.distance=function(b,c){return Math.sqrt(n(b,c))};a.closestPoint=function(b,c,a){c=f.vec3.dot(b.direction,f.vec3.subtract(a,c,b.origin));f.vec3.add(a,b.origin,f.vec3.scale(a,b.direction,c));return a};a.createWrapper=t;var r=new k.ObjectStack(t)})},"esri/views/3d/support/geometryUtils/clipRay":function(){define("require exports ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/vec3 ../stack ./ray".split(" "),
function(p,a,k,m,e,f){function g(b){return b?{ray:f.create(b.ray),c0:b.c0,c1:b.c1}:{ray:f.create(),c0:0,c1:Number.MAX_VALUE}}function h(b,c,a,e){void 0===e&&(e=g());f.copy(b,e.ray);e.c0=c;e.c1=a;return e}function l(b,c,a){void 0===a&&(a=g());var d=m.vec3.length(b.vector);f.fromValues(b.origin,c,a.ray);a.c0=0;a.c1=d;return a}function c(b,c,a){return m.vec3.add(a,b.ray.origin,m.vec3.scale(a,b.ray.direction,c))}Object.defineProperty(a,"__esModule",{value:!0});a.create=g;a.wrap=function(c,a,e){var d=
b.get();d.ray=c;d.c0=a;d.c1=e;return d};a.copy=function(b,c){void 0===c&&(c=g());return h(b.ray,b.c0,b.c1,c)};a.fromValues=h;a.fromRay=function(b,c){void 0===c&&(c=g());f.copy(b,c.ray);c.c0=0;c.c1=Number.MAX_VALUE;return c};a.fromLineSegment=function(b,c){void 0===c&&(c=g());var a=m.vec3.normalize(e.sv3d.get(),b.vector);return l(b,a,c)};a.fromLineSegmentAndDirection=l;a.getStart=function(b,a){return c(b,b.c0,a)};a.getEnd=function(b,a){return c(b,b.c1,a)};a.getAt=c;var b=new k.ObjectStack(function(){return{c0:0,
c1:0,ray:null}})})},"esri/views/3d/support/geometryUtils/frustum":function(){define("require exports ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/vec4 ../../../../core/libs/gl-matrix-2/vec4f64 ../stack ./clipRay ./plane".split(" "),function(p,a,k,m,e,f,g,h,l,c,b){function d(c){if(c){var a=c.planes;c=c.points;return{planes:[b.create(a[0]),b.create(a[1]),b.create(a[2]),
b.create(a[3]),b.create(a[4]),b.create(a[5])],points:[f.vec3f64.clone(c[0]),f.vec3f64.clone(c[1]),f.vec3f64.clone(c[2]),f.vec3f64.clone(c[3]),f.vec3f64.clone(c[4]),f.vec3f64.clone(c[5]),f.vec3f64.clone(c[6]),f.vec3f64.clone(c[7])]}}return{planes:[b.create(),b.create(),b.create(),b.create(),b.create(),b.create()],points:[f.vec3f64.create(),f.vec3f64.create(),f.vec3f64.create(),f.vec3f64.create(),f.vec3f64.create(),f.vec3f64.create(),f.vec3f64.create(),f.vec3f64.create()]}}function n(c,a,f){void 0===
f&&(f=d());for(var h=0;6>h;h++)b.copy(c[h],f.planes[h]);for(h=0;8>h;h++)e.vec3.copy(f.points[h],a[h]);return f}function t(c){var a=c.planes;c=c.points;b.fromPoints(c[4],c[0],c[3],a[0]);b.fromPoints(c[1],c[5],c[6],a[1]);b.fromPoints(c[4],c[5],c[1],a[2]);b.fromPoints(c[3],c[2],c[6],a[3]);b.fromPoints(c[0],c[1],c[2],a[4]);b.fromPoints(c[5],c[4],c[7],a[5])}function r(c,a){for(var d=0;6>d;d++)if(!b.clip(c[d],a))return!1;return!0}Object.defineProperty(a,"__esModule",{value:!0});a.create=d;a.copy=function(b,
c){void 0===c&&(c=d());return n(b.planes,b.points,c)};a.fromValues=n;a.fromMatrix=function(b,c,a){void 0===a&&(a=d());var f=a.points;b=m.mat4.multiply(l.sm4d.get(),c,b);m.mat4.invert(b,b);for(c=0;8>c;++c){var h=g.vec4.transformMat4(l.sv4d.get(),w[c],b);e.vec3.set(f[c],h[0]/h[3],h[1]/h[3],h[2]/h[3])}t(a);return a};a.recomputePlanes=t;a.intersectsSphere=function(c,a){for(var d=0;6>d;d++)if(b.isSphereFullyInside(c[d],a))return!1;return!0};a.intersectsRay=function(b,a){return r(b,c.fromRay(a,u.get()))};
a.intersectClipRay=function(c,a){for(var d=0;6>d;d++)if(!b.clipInfinite(c[d],a))return!1;return!0};a.intersectsLineSegment=function(b,a,d){return r(b,c.fromLineSegmentAndDirection(a,d,u.get()))};a.intersectsPoint=function(c,a){for(var d=0;6>d;d++)if(0<b.signedDistance(c[d],a))return!1;return!0};a.intersectsAABB=function(c,a){for(var d=0;6>d;d++)if(b.isAABBFullyInside(c[d],a))return!1;return!0};a.planePointIndices={bottom:[5,1,0,4],near:[0,1,2,3],far:[5,4,7,6],right:[1,5,6,2],left:[4,0,3,7],top:[7,
3,2,6]};var w=[h.vec4f64.fromValues(-1,-1,-1,1),h.vec4f64.fromValues(1,-1,-1,1),h.vec4f64.fromValues(1,1,-1,1),h.vec4f64.fromValues(-1,1,-1,1),h.vec4f64.fromValues(-1,-1,1,1),h.vec4f64.fromValues(1,-1,1,1),h.vec4f64.fromValues(1,1,1,1),h.vec4f64.fromValues(-1,1,1,1)],u=new k.ObjectStack(c.create)})},"esri/views/3d/support/geometryUtils/sphere":function(){define("require exports ../../../../core/compilerUtils ../../../../core/Logger ../../../../core/mathUtils ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../geometryUtils ../mathUtils ../stack ./ray".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n){function t(b){return b?{radius:b.radius,center:l.vec3f64.clone(b.center)}:{radius:1,center:l.vec3f64.create()}}function r(b,c){void 0===c&&(c=t());return w(b.radius,b.center,c)}function w(b,c,a){void 0===a&&(a=t());h.vec3.copy(a.center,c);a.radius=b;return a}function u(b,c,a){var e=h.vec3.subtract(d.sv3d.get(),c.origin,b.center),f=h.vec3.dot(c.direction,c.direction),g=2*h.vec3.dot(c.direction,e);b=h.vec3.dot(e,e)-b.radius*b.radius;b=g*g-4*f*b;if(0>b)return!1;e=
Math.sqrt(b);b=(-g-e)/(2*f);f=(-g+e)/(2*f);if(0>b||f<b&&0<f)b=f;if(0>b)return!1;a&&h.vec3.add(a,c.origin,h.vec3.scale(d.sv3d.get(),c.direction,b));return!0}function q(b,a,e){var f=d.sv3d.get(),l=d.sm4d.get();h.vec3.cross(f,a.origin,a.direction);h.vec3.cross(e,f,a.origin);h.vec3.scale(e,e,1/h.vec3.length(e)*b.radius);b=x(b,a.origin);a=c.vector.angle(a.origin,e);g.mat4.identity(l);g.mat4.rotate(l,l,a+b,f);h.vec3.transformMat4(e,e,l);return e}function E(b,c,a){c=h.vec3.subtract(d.sv3d.get(),c,b.center);
c=h.vec3.scale(d.sv3d.get(),c,b.radius/h.vec3.length(c));return h.vec3.add(a,c,b.center)}function x(b,c){c=h.vec3.subtract(d.sv3d.get(),c,b.center);c=h.vec3.length(c);return e.acosClamped(b.radius/(b.radius+Math.abs(b.radius-c)))}function z(c,a,d,e){c=h.vec3.subtract(A,a,c.center);switch(d){case 0:return c=b.cartesianToSpherical(c,A),c=c[2],h.vec3.set(e,-Math.sin(c),Math.cos(c),0);case 1:return c=b.cartesianToSpherical(c,A),d=c[1],c=c[2],a=Math.sin(d),h.vec3.set(e,-a*Math.cos(c),-a*Math.sin(c),Math.cos(d));
case 2:return h.vec3.normalize(e,c);default:k.neverReached(d)}}function y(b,c){c=h.vec3.subtract(R,c,b.center);return h.vec3.length(c)-b.radius}Object.defineProperty(a,"__esModule",{value:!0});var v=m.getLogger("esri.views.3d.support.geometryUtils.sphere");a.create=t;a.wrap=function(b,c){var a=B.get();a.radius=b;a.center=c||L;return a};a.copy=r;a.fromValues=w;a.elevate=function(b,c,a){b!==a&&h.vec3.copy(a.center,b.center);a.radius=b.radius+c;return a};a.setExtent=function(b,c,a){v.error("sphere.setExtent is not yet supported");
return b===a?a:r(b,a)};a.intersectRay=u;a.intersectScreen=function(b,c,a,d){c=n.fromScreenAtEye(c,a,C);return u(b,c,d)};a.intersectsRay=function(b,c){return u(b,c,null)};a.intersectRayClosestSilhouette=function(b,c,a){if(u(b,c,a))return a;b=q(b,c,d.sv3d.get());h.vec3.add(a,c.origin,h.vec3.scale(d.sv3d.get(),c.direction,h.vec3.distance(c.origin,b)/h.vec3.length(c.direction)));return a};a.closestPointOnSilhouette=q;a.closestPoint=function(b,c,a){if(u(b,c,a))return a;n.closestPoint(c,b.center,a);return E(b,
a,a)};a.projectPoint=E;a.distanceToSilhouette=function(b,c){c=h.vec3.subtract(d.sv3d.get(),c,b.center);c=h.vec3.squaredLength(c);return Math.sqrt(Math.abs(c-b.radius*b.radius))};a.angleToSilhouette=x;var A=l.vec3f64.create();a.axisAt=z;a.altitudeAt=y;a.setAltitudeAt=function(b,c,a,d){var e=y(b,c);b=z(b,c,2,R);a=h.vec3.scale(R,b,a-e);h.vec3.add(d,c,a);return d};var B=new f.ObjectStack(function(){return{center:null,radius:0}}),C=n.create(),L=l.vec3f64.create(),R=l.vec3f64.create();Object.freeze(L)})},
"esri/views/3d/support/geometryUtils/triangle":function(){define("require exports ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../stack ./lineSegment".split(" "),function(p,a,k,m,e,f,g,h){function l(b){return b?{p0:f.vec3f64.clone(b.p0),p1:f.vec3f64.clone(b.p1),p2:f.vec3f64.clone(b.p2)}:{p0:f.vec3f64.create(),p1:f.vec3f64.create(),p2:f.vec3f64.create()}}function c(b,c,a,d){void 0===d&&(d=l());e.vec3.copy(d.p0,
b);e.vec3.copy(d.p1,c);e.vec3.copy(d.p2,a);return d}function b(b,c,a){var d=m.vec2.distance(b,c);c=m.vec2.distance(c,a);b=m.vec2.distance(a,b);a=(d+c+b)/2;d=a*(a-d)*(a-c)*(a-b);return 0>=d?0:Math.sqrt(d)}Object.defineProperty(a,"__esModule",{value:!0});a.create=l;a.wrap=function(b,c,a){var d=n.get();d.p0=b;d.p1=c;d.p2=a;return d};a.copy=function(b,a){void 0===a&&(a=l());return c(b.p0,b.p1,b.p2,a)};a.fromValues=c;a.distance2=function(b,c){var a=b.p0,f=b.p1;b=b.p2;var l=e.vec3.subtract(g.sv3d.get(),
f,a),n=e.vec3.subtract(g.sv3d.get(),b,f),m=e.vec3.subtract(g.sv3d.get(),a,b),k=e.vec3.subtract(g.sv3d.get(),c,a),t=e.vec3.subtract(g.sv3d.get(),c,f),r=e.vec3.subtract(g.sv3d.get(),c,b),u=e.vec3.cross(l,l,m),w=e.vec3.dot(e.vec3.cross(g.sv3d.get(),l,u),k),t=e.vec3.dot(e.vec3.cross(g.sv3d.get(),n,u),t),r=e.vec3.dot(e.vec3.cross(g.sv3d.get(),m,u),r);if(0<w&&0<t&&0<r)return c=e.vec3.dot(u,k),c*c/e.vec3.dot(u,u);a=h.distance2(h.fromValues(a,l,d.get()),c);f=h.distance2(h.fromValues(f,n,d.get()),c);c=h.distance2(h.fromValues(b,
m,d.get()),c);return Math.min(a,f,c)};a.intersectRay=function(b,c,a){var d=c.direction;c=c.origin;var f=b.p0,h=b.p1,g=b.p2,l=h[0]-f[0],n=h[1]-f[1],m=h[2]-f[2],h=g[0]-f[0];b=g[1]-f[1];var g=g[2]-f[2],q=d[1]*g-b*d[2],k=d[2]*h-g*d[0],t=d[0]*b-h*d[1],r=l*q+n*k+m*t;if(-1E-5<r&&1E-5>r)return!1;var r=1/r,u=c[0]-f[0],w=c[1]-f[1],f=c[2]-f[2],q=r*(u*q+w*k+f*t);if(0>q||1<q)return!1;k=w*m-n*f;m=f*l-m*u;l=u*n-l*w;n=r*(d[0]*k+d[1]*m+d[2]*l);if(0>n||1<q+n)return!1;a&&(e.vec3.scale(a,d,r*(h*k+b*m+g*l)),e.vec3.add(a,
c,a));return!0};a.areaPoints2d=b;a.area2d=function(c){return b(c.p0,c.p1,c.p2)};a.areaPoints3d=function(b,c,a){e.vec3.subtract(t,c,b);e.vec3.subtract(r,a,b);return e.vec3.length(e.vec3.cross(t,t,r))/2};var d=new k.ObjectStack(h.create),n=new k.ObjectStack(function(){return{p0:null,p1:null,p2:null}}),t=f.vec3f64.create(),r=f.vec3f64.create()})},"esri/layers/GraphicsLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/accessorSupport/decorators ./Layer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d){return function(c){function a(a){a=c.call(this,a)||this;a.elevationInfo=null;a.graphics=new b.default;a.screenSizePerspectiveEnabled=!0;a.type="graphics";return a}k(a,c);a.prototype.destroy=function(){this.removeAll()};a.prototype.add=function(b){this.graphics.add(b);return this};a.prototype.addMany=function(b){this.graphics.addMany(b);return this};a.prototype.removeAll=function(){this.graphics.removeAll();return this};a.prototype.remove=function(b){this.graphics.remove(b)};
a.prototype.removeMany=function(b){this.graphics.removeMany(b)};a.prototype.on=function(b,c){return this.inherited(arguments,[b,c])};a.prototype.graphicChanged=function(b){this.emit("graphic-update",b)};m([h.property({type:d})],a.prototype,"elevationInfo",void 0);m([h.property(b.graphicsCollectionProperty)],a.prototype,"graphics",void 0);m([h.property({type:["show","hide"]})],a.prototype,"listMode",void 0);m([h.property()],a.prototype,"screenSizePerspectiveEnabled",void 0);m([h.property({readOnly:!0})],
a.prototype,"type",void 0);return a=m([h.subclass("esri.layers.GraphicsLayer")],a)}(h.declared(c.ScaleRangeLayer(l)))})},"fx3d/views/3d/effects/Effect":function(){define("dojo/_base/lang dojo/_base/array esri/core/declare esri/core/Accessor esri/core/Evented esri/core/now esri/geometry/support/webMercatorUtils esri/geometry/Extent esri/views/3d/webgl-engine/lib/Util esri/core/libs/gl-matrix-2/vec3f64 esri/core/libs/gl-matrix-2/vec2f64 esri/core/libs/gl-matrix-2/vec2 esri/views/3d/webgl-engine/lib/GridLocalOriginFactory esri/views/3d/support/projectionUtils ../webgl-engine-extensions/GLVerTexture ../support/fx3dUtils".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n,t,r,w){var u,q,E,x,z,y=b.vec2f64;d=d.vec2;l=c.vec3f64;var v=(l.create(),l.create()),A={};k=k([m,e],{declaredClass:"esri.views.3d.effects.Effect",effectName:"Effect",constructor:function(b){this._view=b.view;this._layerView=b.layerView;this._renderCoordsHelper=b.view.renderCoordsHelper;this._renderSpatialReference=b.view.renderSpatialReference;this._layer=b.layer;this._wgs84SpatialReference=this._layerView._fx3dSpatialReference;this._stateStack=[];this._currentVizPage=
0;this._preVizId=-1;this._repeatCount=0;this._hasSentReady=this._isReachedRepeatLimit=!1;this._vizFieldDefault="default";this._vizFields=b.layer.vizFields;this._vizFieldMinMaxs={};this._vizFieldMinMaxs[this._vizFieldDefault]={min:0,max:0,maxFeature:null};a.forEach(this._vizFields,function(b){this._vizFieldMinMaxs[b]={min:null,max:null,maxFeature:null}}.bind(this));this._eventHandlers=[];this._vizFieldVerTextureSize=y.create();this._vizFieldVerTextures={};this._allLoaded=this._needsAllLoaded=!1;this._material=
this._shaderSnippets=this._gl=null;this._addedGraphicsCount=this._toAddGraphicsIndex=0;this._addedGraphics=[];this._resetState();this._resetTime();this._pause=!1;this._eventHandlers.push(this._layer.watch("pauseTag",function(b,c,a){this.ready&&(this._pause=b,b?b&&(this._pausedTime=this.time):this._lastTime=f())}.bind(this)));this._spin=!1;this._eventHandlers.push(this._layer.watch("spinTag",function(b,c,a){return b&&"local"==this._view.viewingMode?(console.warn("Spinning operation is not supported in local scene."),
void(this._layer.spinTag=!1)):(this._interactionHandlers||(this._interactionHandlers=[],this._stopPropagation=function(b){b["native"].preventDefault();b.stopPropagation()}),1==b?(this._interactionHandlers.push(this.view.on("mouse-wheel",this._stopPropagation)),this._interactionHandlers.push(this.view.on("click",this._stopPropagation)),this._interactionHandlers.push(this.view.on("double-click",this._stopPropagation)),this._interactionHandlers.push(this.view.on("hold",this._stopPropagation)),this._interactionHandlers.push(this.view.on("drag",
this._stopPropagation)),this._interactionHandlers.push(this.view.on("key-down",this._stopPropagation)),this._interactionHandlers.push(this.view.on("key-up",this._stopPropagation)),this._interactionHandlers.push(this.view.on("pointer-down",this._stopPropagation)),this._interactionHandlers.push(this.view.on("pointer-up",this._stopPropagation)),this._interactionHandlers.push(this.view.on("pointer-move",this._stopPropagation))):this._interactionHandlers instanceof Array&&(this._interactionHandlers.forEach(function(b){b&&
(b.remove(),b=null)}),this._interactionHandlers=[]),void(this._spin=b))}.bind(this)));this._addLayerWatchHandler("visible");this.renderingInfo={visible:!0,repeat:5,transparency:100,animationInterval:5};this.orderId=0},_addLayerWatchHandler:function(b){p.isString(b)&&this._eventHandlers.push(this._layer.watch(b,function(c,a,d){this.renderingInfo[d]=c;"visible"===b.toLowerCase()&&this.ready&&(c?this._lastTime=f():c||(this._pausedTime=this.time))}.bind(this)))},_resetState:function(){this._pause=this.ready=
!1;this._shapeDirty=this._vacDirty=!0;this._isAddingGeometry=!1;this._colorBarDirty=this._colourMapDirty=this._renderingInfoDirty=!0;this._hasSentReady=this._firstAnimatedTo=this._isReachedRepeatLimit=this._shadersReady=!1},_resetTime:function(){this._pausedTime=this.time=this._lastTime=0},_pushState:function(b){for(var c=0;c<this._stateStack.length;c++)if(this._stateStack[c][0]==b[0])return;this._stateStack.push(b)},_restoreState:function(b){for(var c=0;c<this._stateStack.length;c++)"function"==
typeof b[this._stateStack[c][0]]&&b[this._stateStack[c][0]].apply(b,this._stateStack[c][1]instanceof Array?this._stateStack[c][1]:[this._stateStack[c][1]]);this._stateStack=[]},destroy:function(){a.forEach(this._eventHandlers,function(b){"function"==typeof b.remove&&b.remove()||"function"==typeof b.destroy&&b.destroy()});this._eventHandlers=[];this._interactionHandlers instanceof Array&&(a.forEach(this._interactionHandlers,function(b){"function"==typeof b.remove&&b.remove()||"function"==typeof b.destroy&&
b.destroy();b=null}),this._interactionHandlers=[]);this._resetState();this._destroy("_material");var b=Object.getOwnPropertyNames(this._vizFieldVerTextures);a.forEach(b,function(b){this._vizFieldVerTextures[b]instanceof r&&this._vizFieldVerTextures[b].dispose()}.bind(this))},_dispose:function(b){this[b]&&(this[b].dispose(),delete this[b]);this[b]=null},_destroy:function(b){this[b]&&(this[b].destroy(),delete this[b]);this[b]=null},setContext:function(b){this._gl=b.gl;this._shaderSnippets=b.shaderSnippets;
this._vaoExt=b.vaoExt;this._effectConfig=w.effectConfig(this.effectName);this._initRenderingInfo(this._effectConfig);var c=this._layer._get("renderingInfo");if(this._layer&&c){b=Object.getOwnPropertyNames(c);var d=Object.getOwnPropertyNames(this.renderingInfo),e=this;a.forEach(b,function(b){d?a.some(d,function(a){if(b.toLowerCase()===a.toLowerCase())return"shapetype"===b.toLowerCase()?e.renderingInfo[a]=c[b].toLowerCase():e.renderingInfo[a]=c[b],!0}):e.renderingInfo[b]=c[b]})}this._renderingInfoChange(this.renderingInfo);
this._updateDefaultLabelHeight();this._vizFieldVerTextures[this._vizFieldDefault]=new r(this._gl);a.forEach(this._vizFields,function(b){this._vizFieldVerTextures[b]=new r(this._gl)}.bind(this));this._eventHandlers.push(this._layer.on("fx3d-add-graphics",function(b){this._needsAllLoaded||this._addGraphicsHandler(b)}.bind(this)));this._eventHandlers.push(this._layer.on("all-features-loaded",function(b){this._needsAllLoaded&&(this._addGraphicsHandler(b),this._allLoaded=!0);this._initVizFieldVertextures();
this._layer.emit("can-locating-now")}.bind(this)));this._eventHandlers.push(this._layer.on("fx3d-active-viz-field",p.hitch(this,this._activeVizFieldHandler)));this._eventHandlers.push(this._layer.watch("renderingInfo",this._renderingInfoChange.bind(this)))},_toWGS84Extent:function(b){var c={xmin:b.xmin,ymin:b.ymin,xmax:b.xmax,ymax:b.ymax};return b.spatialReference&&(A.x=b.xmin,A.y=b.ymin,A.z=0,A.spatialReference=b.spatialReference,t.pointToVector(A,v,this._wgs84SpatialReference),c.xmin=v[0],c.ymin=
v[1],A.x=b.xmax,A.y=b.ymax,t.pointToVector(A,v,this._wgs84SpatialReference),c.xmax=v[0],c.ymax=v[1]),c},_calculateExtentCenter:function(b){var c=b.length;if(c){var a,d,e,f,g,l,n;if("point"==this._layer.geometryType)for(a=d=b[0].geometry.longitude,e=f=b[0].geometry.latitude,l=1;l<c;l++)g=b[l],null!=g.geometry&&(g.geometry.longitude<a&&(a=g.geometry.longitude),g.geometry.longitude>d&&(d=g.geometry.longitude),g.geometry.latitude<e&&(e=g.geometry.latitude),g.geometry.latitude>f&&(f=g.geometry.latitude));
else if("polyline"==this._layer.geometryType||"polygon"==this._layer.geometryType)for(n=b[0].geometry.extent,a=n.xmin,d=n.xmax,e=n.ymin,f=n.ymax,l=1;l<c;l++)g=b[l],null!=g.geometry&&null!=g.geometry.extent&&(n=g.geometry.extent,n.xmin<a&&(a=n.xmin),n.xmax>d&&(d=n.xmax),n.ymin<e&&(e=n.ymin),n.ymax>f&&(f=n.ymax));return new h(a,e,d,f,this._wgs84SpatialReference)}return null},_addGraphicsHandler:function(b){p.isArray(b.graphics)&&0<b.graphics.length&&(this._toAddGraphicsIndex=this._addedGraphicsCount,
this._addedGraphicsCount+=b.graphics.length,this._needsAllLoaded?this._addedGraphics=b.graphics:this._addedGraphics=this._addedGraphics.concat(b.graphics),this._isAddingGeometry=!0,this._shapeDirty=!0)},_activeVizFieldHandler:function(b){"number"==typeof b.currentVizPage&&((0>this._currentVizPage||this._currentVizPage>=this._vizFields.length)&&(this._currentVizPage=0),this.ready=!1,this._hasSentReady=!1,this._restoreRenderingInfo(),p.isObject(b.newRenderingInfo)&&p.mixin(this.renderingInfo,b.newRenderingInfo),
this._shapeDirty=!1,this._colorBarDirty=!1,this._colourMapDirty=!1,this._renderingInfoChange(this.renderingInfo),this._updateDefaultLabelHeight(),this.update(),this._resetAnimation(),this._currentVizPage=b.currentVizPage,this._updateVizFieldMinMaxToLayer(),this._layerView._updateSelectedFeatureLabel(),this._emitSyncEvent())},_resetAnimation:function(){this._repeatCount=0;this._preVizId=-1;this._isReachedRepeatLimit=!1;this._resetTime();this._layer.startAnimation()},_resetAddGeometries:function(){this._addedGraphics=
[]},_allGraphics:function(){return this._layerView.getLoadedGraphics()},_renderingInfoChange:function(b,c,a){b!==c&&b&&p.isObject(b)&&this._doRenderingInfoChange(b)},_doRenderingInfoChange:function(b){this._renderingInfoDirty=!0;for(var c in b)b.hasOwnProperty(c)&&this.renderingInfo.hasOwnProperty(c)&&("visible"===c.toLowerCase()?(this._layer&&(this._layer[c]=b[c]),this.renderingInfo[c]=b[c]):"repeat"!==c.toLowerCase()&&"animationinterval"!==c.toLowerCase()||(this._resetAnimation(),this._clampScope(b,
c),this.renderingInfo[c]=b[c]))},_initRenderingInfo:function(b){this._scopes={};b&&p.isObject(b)&&p.isArray(b.renderingInfo)&&a.forEach(b.renderingInfo,function(b){"shapetype"===b.name.toLowerCase()?this.renderingInfo[b.name]=b.defaultValue.toLowerCase():this.renderingInfo[b.name]=b.defaultValue;p.isArray(b.scope)&&(this._scopes[b.name]=b.scope)}.bind(this))},_restoreRenderingInfo:function(){this.renderingInfo={visible:!0,repeat:5,transparency:100,animationInterval:5};this._initRenderingInfo(this._effectConfig);
var b=this._layer._get("renderingInfo");if(this._layer&&b){var c=Object.getOwnPropertyNames(b),d=Object.getOwnPropertyNames(this.renderingInfo),e=this;a.forEach(c,function(c){d?a.some(d,function(a){if(c.toLowerCase()===a.toLowerCase())return"shapetype"===c.toLowerCase()?e.renderingInfo[a]=b[c].toLowerCase():e.renderingInfo[a]=b[c],!0}):e.renderingInfo[c]=b[c]})}this._updateDefaultLabelHeight()},_clampScope:function(b,c){var a=this._scopes[c];p.isArray(a)&&"number"==typeof b[c]&&"number"==typeof a[0]&&
"number"==typeof a[1]&&(b[c]<a[0]?b[c]=a[0]:b[c]>a[1]&&(b[c]=a[1]),0>b[c]&&(b[c]=0))},_updateRenderingInfo:function(){var b=!0;(!this._needsAllLoaded||this._needsAllLoaded&&this._allLoaded)&&0<this._allGraphics().length&&(this._colorBarDirty?(b=this._initColorBar(),b&&(this._colorBarDirty=!1)):b=!0,this._colourMapDirty&&b?(b=this._initColourMap(),b&&(this._colourMapDirty=!1)):b=!0,b=!(!this._renderingInfoDirty||!b),this._renderingInfoDirty=!b)},_updateRenderingGeometry:function(){var b=!0;(!this._needsAllLoaded||
this._needsAllLoaded&&this._allLoaded)&&0<this._allGraphics().length&&(b=this._initRenderContext(),b?(b=this._initVizFieldVertextures(),this._shapeDirty=!b):this._shapeDirty=!0,!0===this._shapeDirty&&(this._isAddingGeometry=!1))},preRender:function(){this.renderingInfo.visible&&(this._shadersReady||(this._shadersReady=this._loadShaders()))},_emitSyncEvent:function(){this._layer&&0<this._repeatCount&&(0>=this.renderingInfo.repeat||0<this.renderingInfo.repeat&&this._repeatCount<=this.renderingInfo.repeat)&&
this._layer.emit("sync-viz-timer",{vizPage:this._currentVizPage,repeat:this._repeatCount})},_calculateRepeatCount:function(){z=Math.floor(this.time/this.renderingInfo.animationInterval);this._preVizId!==z&&(this._repeatCount++,this._preVizId=z,this._emitSyncEvent())},_updateVizPage:function(){0<this.renderingInfo.repeat?this._repeatCount<=this.renderingInfo.repeat?this._calculateRepeatCount():this._isReachedRepeatLimit||(this._isReachedRepeatLimit=!0,this._layer.pauseAnimation(),this._layer.emit("reached-repeat-limit")):
0>this.renderingInfo.repeat?(this._calculateRepeatCount(),this._isReachedRepeatLimit&&(this._isReachedRepeatLimit=!1)):this._isReachedRepeatLimit||(this._isReachedRepeatLimit=!0)},render:function(b,c){this.renderingInfo.visible&&(b.time=this.time,b.reachedRepeatLimit=this._isReachedRepeatLimit)},update:function(){this.renderingInfo.visible&&(this._renderingInfoDirty&&this._updateRenderingInfo(),this._shapeDirty&&this._updateRenderingGeometry(),this._renderingInfoDirty||this._shapeDirty||!this._shadersReady?
this.ready=!1:this.ready=!0,this._updateSelfTime(),this._updateVizPage(),this._spin&&this._doSpin())},_doSpin:function(){u=this._view.camera.position;q=g.webMercatorToGeographic(u);E=q.x-1;-180>=E&&(E=179);x=u.z;8E6>x&&(x=8E6);this._view.goTo({position:[E,0,x],tilt:0,heading:0})},_bindPramsReady:function(){return 0<=this._currentVizPage&&this._currentVizPage<Object.getOwnPropertyNames(this._vizFieldMinMaxs).length&&this._currentVizPage<Object.getOwnPropertyNames(this._vizFieldVerTextures).length},
_updateSelfTime:function(){this.ready&&!this._pause&&(0!==this._lastTime?this.time=this._pausedTime+.001*(f()-this._lastTime):(this._lastTime=f(),this.time=0))},_loadShaders:function(){return!0},_initVertexLayout:function(){return!0},_initRenderContext:function(){return!0},_initVizFieldVertextures:function(){var b=this._allGraphics();if(0<b.length){var c=this._gl.getParameter(3379),e=b.length,f=w.nextHighestPowerOfTwo(e);f>c&&(f=c,console.warn("Too many graphics, and extra features will be discarded."));
var h=Math.ceil(e/f),h=w.nextHighestPowerOfTwo(h);h>c&&(h=c,console.warn("Too many graphics, and extra features will be discarded."));this._vizFieldVerTextures[this._vizFieldDefault].setData(f,h,new Float32Array(f*h*4));var g,l,n,m;return a.forEach(this._vizFields,function(c){var a=new Float32Array(f*h*4);(l=b[0].attributes[c])||(l=0);(!l||"number"!=typeof l||0>l)&&(l=0);n=m=l;for(var d=b[0],e=0;e<b.length;e++)g=b[e].attributes,l=g[c],(!l||"number"!=typeof l||0>l)&&(l=0),a[4*e]=l,m<l&&(m=l,d=b[e]),
n>l&&(n=l);this._vizFieldVerTextures[c].setData(f,h,a);this._vizFieldMinMaxs[c].min=n;this._vizFieldMinMaxs[c].max=m;this._vizFieldMinMaxs[c].maxFeature=d;this._updateVizFieldMinMaxToLayer()}.bind(this)),d.set(this._vizFieldVerTextureSize,f,h),!0}return!1},_updateVizFieldMinMaxToLayer:function(){this._layer._currentVizPage=this._currentVizPage;this._layer._currentVizFieldMinMax=this._vizFieldMinMaxs[this._vizFields[this._currentVizPage]]},_initColourMap:function(){return!0},_initColorBar:function(){return!0},
_updateDefaultLabelHeight:function(){}});return k.createLocalOriginFactory=function(){return new n},k})},"esri/views/3d/webgl-engine/lib/GridLocalOriginFactory":function(){define("require exports ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/SpatialReference ../../support/projectionUtils ./Geometry ./GeometryData ./Layer ./localOrigin ./Object3D ./Util ../materials/RibbonLineMaterial".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n,t,r){var w=0;p=function(){function a(){this.ROOT_ORIGIN_ID="rg_root_"+w++;this._origins=new Map;this._gridSize=42E5}a.prototype.getOrigin=function(b){var c=this._origins.get(this.ROOT_ORIGIN_ID);if(null==c){if(k.isSome(a.testOrigin)){var f=a.testOrigin;this._origins.set(this.ROOT_ORIGIN_ID,d.fromValues(f[0],f[1],f[2],this.ROOT_ORIGIN_ID));return this.getOrigin(b)}f=d.fromValues(b[0]+Math.random()-.5,b[1]+Math.random()-.5,b[2]+Math.random()-.5,this.ROOT_ORIGIN_ID);
this._origins.set(this.ROOT_ORIGIN_ID,f);return f}e.vec3.subtract(u,b,c.vec3);u[0]=Math.abs(u[0]);u[1]=Math.abs(u[1]);u[2]=Math.abs(u[2]);f=this._gridSize;if(u[0]<f&&u[1]<f&&u[2]<f)return c;var c=Math.round(b[0]/f),h=Math.round(b[1]/f);b=Math.round(b[2]/f);var g="rg_"+c+"/"+h+"/"+b,l=this._origins.get(g);l||(l=d.fromValues(c*f,h*f,b*f,g),this._origins.set(g,l));return l};a.prototype._drawOriginBox=function(a){var d=window.view,e=d._stage;if(null==this._object){this._material=new r({width:2,color:[0,
1,0,1]},"GridLocalOriginMaterial");e.add(3,this._material);var f=new b("GridLocalOrigin",{isPickable:!1});e.add(0,f);this._object=new n({idHint:"GridLocalOrigin",castShadow:!1});e.add(1,this._object);f.addObject(this._object);e.addToViewContent([f.id])}for(var k=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],q=k.length,u=new Float32Array(3*q),f=new Uint32Array(2*(q-1)),p=.5*this._gridSize,w=0;w<q;w++)u[3*w+0]=a[0]+(k[w]&1?p:-p),u[3*w+1]=a[1]+(k[w]&2?p:-p),u[3*w+2]=a[2]+(k[w]&4?p:-p),0<w&&(f[2*w+0]=w-1,f[2*
w+1]=w);h.bufferToBuffer(u,g.WebMercator,0,u,d.spatialReference,0,q);d={};d[t.VertexAttrConstants.POSITION]={size:3,data:u};u={};u[t.VertexAttrConstants.POSITION]=f;f=new c.GeometryData(d,u,void 0,"line");f=new l(f,"GridLocalOriginBox");e.add(2,f);this._object.addGeometry(f,this._material,m.mat4f64.IDENTITY);console.log(this._origins.size,a)};return a}();var u=f.vec3f64.create();(p||(p={})).testOrigin=null;return p})},"esri/views/3d/webgl-engine/lib/Geometry":function(){define("require exports ./BoundingInfo ./ComponentUtils ./geometryDataUtils ./IdGen ./Util ./Util".split(" "),
function(p,a,k,m,e,f,g,h){return function(){function a(c,b,d){this._componentAABBs=this._boundingInfo=null;this._id=a.__idGen.gen(b);this._data=c;this._boundingInfo=d}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0});a.prototype.getIndices=function(c){return this.data.getIndices(c)};Object.defineProperty(a.prototype,"indexCount",{get:function(){return this.data.indexCount},
enumerable:!0,configurable:!0});a.prototype.getAttribute=function(c){return this.data.getAttribute(c)};Object.defineProperty(a.prototype,"componentCount",{get:function(){return m.componentCount(this.data.componentOffsets)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"componentOffsets",{get:function(){return this.data.componentOffsets},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"vertexCount",{get:function(){return this.data.indexCount},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"faceCount",{get:function(){return this.data.indexCount/3},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"boundingInfo",{get:function(){null==this._boundingInfo&&(this._boundingInfo=this._calculateBoundingInfo());return this._boundingInfo},enumerable:!0,configurable:!0});a.prototype.computeAttachmentOrigin=function(c){return"triangle"===this.data.primitiveType?this.computeAttachmentOriginTriangles(c):this.computeAttachmentOriginPoints(c)};a.prototype.computeAttachmentOriginTriangles=
function(c){var b=this.getIndices(h.VertexAttrConstants.POSITION),a=this.getAttribute(h.VertexAttrConstants.POSITION);return e.computeAttachmentOriginTriangles(a,b,c)};a.prototype.computeAttachmentOriginPoints=function(c){var b=this.getIndices(h.VertexAttrConstants.POSITION),a=this.getAttribute(h.VertexAttrConstants.POSITION);return e.computeAttachmentOriginPoints(a,b,c)};a.prototype.invalidateBoundingInfo=function(){this._componentAABBs=this._boundingInfo=null};a.prototype.getComponentAABB=function(c,
b){null==this._componentAABBs&&(this._componentAABBs=this._computeComponentAABBs());for(var a=0;6>a;a++)b[a]=this._componentAABBs[6*c+a];return b};a.prototype._computeComponentAABBs=function(){for(var c=this.componentCount,b=new Float32Array(6*c),a=0;a<c;a++)this._calculateAABB(a,b,6*a);return b};a.prototype._calculateAABB=function(c,b,a){var d=this.data.getIndices(h.VertexAttrConstants.POSITION),e=this.data.getAttribute(h.VertexAttrConstants.POSITION),f=this.data.componentOffsets,g=f.length?f[c+
1]:d.length,l=Infinity,m=Infinity,k=Infinity,x=-Infinity,p=-Infinity,y=-Infinity,v=e.offsetIdx,A=e.strideIdx;for(c=f.length?f[c]:0;c<g;c++)var B=v+A*d[c],f=e.data[B],C=e.data[B+1],B=e.data[B+2],l=Math.min(l,f),m=Math.min(m,C),k=Math.min(k,B),x=Math.max(x,f),p=Math.max(p,C),y=Math.max(y,B);b[a]=l;b[a+1]=m;b[a+2]=k;b[a+3]=x;b[a+4]=p;b[a+5]=y};a.prototype._calculateBoundingInfo=function(){var c=this.data.getIndices(h.VertexAttrConstants.POSITION),b=this.data.getAttribute(h.VertexAttrConstants.POSITION),
a="triangle"===this.data.primitiveType?3:1;if(0===c.length)for(var c=new Uint32Array(a),f=0;f<a;++f)c[f]=f;f=c.length;g.assert(0===f%a,"Indexing error: "+f.toFixed(0)+" not divisible by "+a.toFixed(0));f=e.generateDefaultIndexArray(f/a);return new k(f,a,c,b)};a.__idGen=new f.IdGen;return a}()})},"esri/views/3d/webgl-engine/lib/BoundingInfo":function(){define("require exports ../../../../core/PooledArray ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ./Util".split(" "),
function(p,a,k,m,e,f){p=function(){function a(h,g,c,b){this.primitiveIndices=h;this._numIndexPerPrimitive=g;this.indices=c;this._position=b;this.center=e.vec3f64.create();f.assert(1<=h.length);f.assert(0===c.length%this._numIndexPerPrimitive);f.assert(c.length>=h.length*this._numIndexPerPrimitive);f.assert(3===this._position.size||4===this._position.size);b=this._position;g=b.data;var d=b.offsetIdx,l=b.strideIdx;b=0;var k=h.length,r=d+l*c[this._numIndexPerPrimitive*h[b]];a.tmpIndices.clear();a.tmpIndices.push(r);
this.bbMin=e.vec3f64.fromValues(g[r],g[r+1],g[r+2]);for(this.bbMax=e.vec3f64.clone(this.bbMin);b<k;++b)for(var p=this._numIndexPerPrimitive*h[b],u=0;u<this._numIndexPerPrimitive;++u){r=d+l*c[p+u];a.tmpIndices.push(r);var q=g[r];this.bbMin[0]=Math.min(q,this.bbMin[0]);this.bbMax[0]=Math.max(q,this.bbMax[0]);q=g[r+1];this.bbMin[1]=Math.min(q,this.bbMin[1]);this.bbMax[1]=Math.max(q,this.bbMax[1]);q=g[r+2];this.bbMin[2]=Math.min(q,this.bbMin[2]);this.bbMax[2]=Math.max(q,this.bbMax[2])}m.vec3.lerp(this.center,
this.bbMin,this.bbMax,.5);this.bsRadius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);h=this.bsRadius*this.bsRadius;for(b=0;b<a.tmpIndices.length;++b)r=a.tmpIndices.data[b],c=g[r]-this.center[0],d=g[r+1]-this.center[1],r=g[r+2]-this.center[2],l=c*c+d*d+r*r,l<=h||(l=Math.sqrt(l),k=.5*(l-this.bsRadius),this.bsRadius+=k,h=this.bsRadius*this.bsRadius,l=k/l,this.center[0]+=c*l,this.center[1]+=d*l,this.center[2]+=r*l);a.tmpIndices.clear()}a.prototype.getCenter=
function(){return this.center};a.prototype.getBSRadius=function(){return this.bsRadius};a.prototype.getBBMin=function(){return this.bbMin};a.prototype.getBBMax=function(){return this.bbMax};a.prototype.getPrimitiveIndices=function(){return this.primitiveIndices};a.prototype.getIndices=function(){return this.indices};a.prototype.getPosition=function(){return this._position};a.prototype.getChildren=function(){if(this._children)return this._children;if(1<m.vec3.squaredDistance(this.bbMin,this.bbMax)){for(var f=
m.vec3.lerp(e.vec3f64.create(),this.bbMin,this.bbMax,.5),g=this.primitiveIndices.length,c=new Uint8Array(g),b=Array(8),d=0;8>d;++d)b[d]=0;for(var d=this._position,n=d.data,k=d.offsetIdx,r=d.strideIdx,d=0;d<g;++d){for(var p=0,u=this._numIndexPerPrimitive*this.primitiveIndices[d],q=k+r*this.indices[u],E=n[q],x=n[q+1],z=n[q+2],y=1;y<this._numIndexPerPrimitive;++y){var q=k+r*this.indices[u+y],v=n[q],A=n[q+1],q=n[q+2];v<E&&(E=v);A<x&&(x=A);q<z&&(z=q)}E<f[0]&&(p|=1);x<f[1]&&(p|=2);z<f[2]&&(p|=4);c[d]=p;
++b[p]}for(d=f=0;8>d;++d)0<b[d]&&++f;if(2>f)return;f=Array(8);for(d=0;8>d;++d)f[d]=0<b[d]?new Uint32Array(b[d]):void 0;for(d=0;8>d;++d)b[d]=0;for(d=0;d<g;++d)p=c[d],f[p][b[p]++]=this.primitiveIndices[d];this._children=Array(8);for(d=0;8>d;++d)void 0!==f[d]&&(this._children[d]=new a(f[d],this._numIndexPerPrimitive,this.indices,this._position))}return this._children};return a}();(p||(p={})).tmpIndices=new k({deallocator:null});return p})},"esri/views/3d/webgl-engine/lib/ComponentUtils":function(){define(["require",
"exports","../../../../core/arrayUtils","../../../../core/maybe"],function(p,a,k,m){function e(b,a,d,e){if(d>=a)return b;null==b&&(b=c());var f=b.data,h=8*f.BYTES_PER_ELEMENT,g=d/h|0,l=d-h*g,n=f;e=e===b.isVisibleBit;d<n.length*h||!e||(d=Math.max(g+1,Math.ceil(1.5*n.length)),d=Math.min(d,((a-1)/h|0)+1),f=new Uint32Array(d),f.set(n));g<f.length&&(f[g]=f[g]&~(1<<l)|(e?1:0)<<l);b.data=f;return b}function f(b,c){if(null==b)return!0;var a=b.isVisibleBit,d=b.data,e=8*d.BYTES_PER_ELEMENT;return c<d.length*
e?t(a,d,c,e):!b.isVisibleBit}function g(b){return m.isSome(b.component)?b.component:-1}function h(b,c,a,d){f(c,d)&&l(b,a[d],a[d+1]-1)}function l(b,c,a){var d=0<b.length?b[b.length-1]:null;(d?d[1]:-1)>=c||b.push([c,a])}function c(b){void 0===b&&(b=!0);return{isVisibleBit:!b,data:new Uint32Array(0)}}function b(b,c){return!d(b,c,!1)}function d(b,c,a){b=b||w;var d=b.data;b=a===b.isVisibleBit;a=r(c);if(0===d.length||0===a)return!b;var e=8*d.BYTES_PER_ELEMENT;if(d.length*e<a&&!b)return!0;var f=u[e];c=u[0];
for(var h=0;h<d.length-1;h++)if(!b&&d[h]!==f||b&&d[h]!==c)return!0;f=d.length-1;a=u[(a-1)%e+1];return!b&&(d[f]&a)!==a||b&&(d[f]&a)!==c}function n(b){return 0<b.length}function t(b,c,a,d){var e=a/d|0;return 0!==(c[e]&1<<a-e*d)===b}function r(b){return Math.max(0,b.length-1)}Object.defineProperty(a,"__esModule",{value:!0});a.updateVisibility=function(b,c,a,d){return e(b,r(c),a,d)};a.updateVisibilityWithCount=e;a.getVisibility=f;a.hideAllComponents=function(b){if(null==b)return c(!1);b.isVisibleBit=
!0;for(var a=0;a<b.data.length;a++)b.data[a]=0;return b};a.unhideAllComponents=function(b){if(null==b)return null;b.isVisibleBit=!1;for(var c=0;c<b.data.length;c++)b.data[c]=0;return b};a.generateVisibleIndexRanges=function(b,c){var a;if(b)if(n(c))if(0===b.data.length)a=[],c=[[c[0],c[c.length-1]-1]],a=b.isVisibleBit?a:c;else{a=[];for(var d=b.isVisibleBit,e=b.data,f=8*e.BYTES_PER_ELEMENT,h=e.length*f,g=r(c),l=!1,m=0;m<h&&m<g;m++){var k=t(d,e,m,f);if(k!==l){var q=c[m];k?a.push([q,0]):(l=a[a.length-
1],l[1]=q-1);l=k}}b=!b.isVisibleBit;g>h&&b&&!l?a.push([c[h],c[g]-1]):l&&(l=a[a.length-1],l[1]=c[b?g:Math.min(g,h)]-1)}else a=[],a=b.isVisibleBit?a:null;else a=null;return a};a.addOccludee=function(b,c){b=b||[];b.push({id:c});return b};a.removeOccludee=function(b,c){if(!b)return b;b=b.filter(function(b){return b.id!==c});return 0===b.length?null:b};a.addHighlight=function(b,c,a){b=b||[];c={component:c,id:a};b.push(c);a=g(c);for(var d=b.length-1;0<d&&a<g(b[d-1]);)c=[b[d],b[d-1]],b[d-1]=c[0],b[d]=c[1],
--d;return b};a.removeHighlight=function(b,c){if(!b)return b;b=b.filter(function(b){return b.id!==c});return 0===b.length?null:b};a.generateHighlightedIndexRanges=function(c,a,d){if(!a)return null;if(!n(d))return c&&c.isVisibleBit?null:a.map(function(b){return null});for(var e=d[0],f=d[d.length-1]-1,g=[],k=b(c,d),q=0;q<a.length;++q){var t=a[q].component;if(m.isSome(t))h(g,c,d,t);else if(k)l(g,e,f);else for(t=0;t<r(d);++t)h(g,c,d,t)}return 0<g.length?g:null};a.hasHighlights=function(c,a,d){if(!a)return!1;
if(!n(d))return c&&c.isVisibleBit?!1:0<a.length;c=b(c,d);for(var e=0;e<a.length;e++)if(m.isSome(a[e].component)||c||0<r(d))return!0;return!1};a.defaultVisibilities=c;a.isAllVisible=b;a.isAllHidden=function(b,c){return!d(b,c,!0)};var w=c();a.createOffsets=function(b){return b instanceof Uint32Array?b:new Uint32Array(b)};a.hasComponents=n;var u=[];for(p=0;65>p;p++)u.push(Math.pow(2,p)-1);a.componentCount=r;a.componentFind=function(b,c){b=k.binaryIndexOf(b,c,!0);return 0<=b?b:null}})},"esri/views/3d/webgl-engine/lib/geometryDataUtils":function(){define(["require",
"exports","../../../../core/libs/gl-matrix-2/vec3","../../../../core/libs/gl-matrix-2/vec3f64","../../support/geometryUtils/triangle"],function(p,a,k,m,e){Object.defineProperty(a,"__esModule",{value:!0});var f=1,g=null,h=new Uint32Array([0]);a.generateDefaultIndexArray=function(b){if(1===b)return h;if(b>f||null==g){for(;b>f;)f*=2;g=new Uint32Array(f);for(var c=0;c<f;c++)g[c]=c}return new Uint32Array(g.buffer,0,b)};a.computeAttachmentOriginTriangles=function(a,f,h){if(!a)return!1;var g=a.strideIdx,
l=a.offsetIdx;a=a.data;k.vec3.set(h,0,0,0);k.vec3.set(n,0,0,0);for(var m=0,t=0,r=0;r<f.length-2;r+=3){var p=f[r+0]*g+l,v=f[r+1]*g+l,w=f[r+2]*g+l;k.vec3.set(c,a[p+0],a[p+1],a[p+2]);k.vec3.set(b,a[v+0],a[v+1],a[v+2]);k.vec3.set(d,a[w+0],a[w+1],a[w+2]);(p=e.areaPoints3d(c,b,d))?(k.vec3.add(c,c,b),k.vec3.add(c,c,d),k.vec3.scale(c,c,1/3*p),k.vec3.add(h,h,c),m+=p):(k.vec3.add(n,n,c),k.vec3.add(n,n,b),k.vec3.add(n,n,d),t+=3)}return 0===t&&0===m?!1:0!==m?(k.vec3.scale(h,h,1/m),!0):0!==t?(k.vec3.scale(h,n,
1/t),!0):!1};a.computeAttachmentOriginPoints=function(b,c,a){if(!b||!c)return!1;var d=b.strideIdx,e=b.offsetIdx;b=b.data;k.vec3.set(a,0,0,0);for(var f=-1,h=0,g=0;g<c.length;g++){var l=c[g]*d+e;f!==l&&(a[0]+=b[l+0],a[1]+=b[l+1],a[2]+=b[l+2],h++);f=l}1<h&&k.vec3.scale(a,a,1/h);return 0<h};a.computeAttachmentOriginLines=function(a,d,e,f){if(!a)return!1;var h=a.strideIdx,g=a.offsetIdx;a=a.data;k.vec3.set(f,0,0,0);k.vec3.set(n,0,0,0);var l=0,m=0,r=d?d.length-1:a.length/h-1;e=r+(e?2:0);for(var t=0;t<e;t+=
2){var u=t<r?t:r,p=t<r?t+1:0,u=(d?d[u]:u)*h+g,p=(d?d[p]:p)*h+g;c[0]=a[u+0];c[1]=a[u+1];c[2]=a[u+2];b[0]=a[p+0];b[1]=a[p+1];b[2]=a[p+2];k.vec3.scale(c,k.vec3.add(c,c,b),.5);p=k.vec3.dist(c,b);0<p?(k.vec3.add(f,f,k.vec3.scale(c,c,p)),l+=p):(k.vec3.add(n,n,c),m++)}return 0!==l?(k.vec3.scale(f,f,1/l),!0):0!==m?(k.vec3.scale(f,n,1/m),!0):!1};var l=0;a.getNewId=function(){return l++};var c=m.vec3f64.create(),b=m.vec3f64.create(),d=m.vec3f64.create(),n=m.vec3f64.create()})},"esri/views/3d/webgl-engine/lib/IdGen":function(){define(["require",
"exports"],function(p,a){Object.defineProperty(a,"__esModule",{value:!0});p=function(){function a(){this._count=0}a.prototype.gen=function(a){null==a&&(a="a");return a+"_"+this._count++};return a}();a.IdGen=p})},"esri/views/3d/webgl-engine/lib/GeometryData":function(){define(["require","exports","./ComponentUtils","./geometryDataUtils","./Util"],function(p,a,k,m,e){Object.defineProperty(a,"__esModule",{value:!0});p=function(){function a(f,h,l,c){void 0===h&&(h=a.DefaultIndices);void 0===l&&(l=a.DefaultOffsets);
void 0===c&&(c="triangle");var b={},d;for(d in f){var g=f[d],t=g.size;b[d]={data:g.data,size:t,offsetIdx:0,strideIdx:t}}if(h===a.DefaultIndices){h=e.getFirstObjectValue(b);h=null==h?0:h.data.length/h.size;f=m.generateDefaultIndexArray(h);h={};for(var r in b)h[r]=f}this._id=m.getNewId();this._vertexAttributes=b;this._indices=h;this._componentOffsets=k.createOffsets(l);this._primitiveType=c}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"vertexAttributes",{get:function(){return this._vertexAttributes},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"indices",{get:function(){return this._indices},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"componentOffsets",{get:function(){return this._componentOffsets},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"indexCount",{get:function(){var a=e.getFirstObjectValue(this._indices);return null==a?0:a.length},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"primitiveType",{get:function(){return this._primitiveType},enumerable:!0,configurable:!0});a.prototype.getVertexAttr=function(){return this.vertexAttributes};a.prototype.toRenderData=function(){return{id:this._id.toString(),indices:this._indices,vertexAttr:this._vertexAttributes}};a.prototype.getIndices=function(a){return this._indices[a]};a.prototype.getAttribute=function(a){return this._vertexAttributes[a]};a.prototype.estimateGpuMemoryUsage=function(){var a=0;
this._indices[e.VertexAttrConstants.POSITION]&&(a+=12*this._indices[e.VertexAttrConstants.POSITION].length);this._indices[e.VertexAttrConstants.NORMAL]&&(a+=12*this._indices[e.VertexAttrConstants.NORMAL].length);this._indices[e.VertexAttrConstants.UV0]&&(a+=8*this._indices[e.VertexAttrConstants.UV0].length);this._indices[e.VertexAttrConstants.COLOR]&&(a+=4*this._indices[e.VertexAttrConstants.COLOR].length);return a};a.DefaultIndices={};a.DefaultOffsets=new Uint32Array(0);return a}();a.GeometryData=
p})},"esri/views/3d/webgl-engine/lib/Layer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/arrayUtils ../../../../core/Evented ../../../../core/libs/gl-matrix-2/vec3f64 ./IdGen ./Octree".split(" "),function(p,a,k,m,e,f,g,h){return function(a){function c(b,d,e){var h=a.call(this)||this;h._parentStages=new Map;h._objects=new Set;h.id=c._idGen.gen(b);h.apiLayerUid=e;h.name=b;d=d||{};h.group=d.group||"";h.isVisible=null!=d.isVisible?d.isVisible:!0;h.isPickable=
null!=d.isPickable?d.isPickable:!0;h.isSliceable=!1;h.translation=d.translation?f.vec3f64.clone(d.translation):f.vec3f64.create();return h}k(c,a);c.prototype.addParentStage=function(b){if(!this._parentStages.has(b)){var c=this.on("dirty",function(c){b.notifyDirty(c.origin,c.dirtyType,c.subObject)});this._parentStages.set(b,c)}};c.prototype.removeParentStage=function(b){var c=this._parentStages.get(b);c&&(c.remove(),this._parentStages.delete(b));this.invalidateSpatialQueryAccelerator()};c.prototype.getName=
function(){return this.name};c.prototype.getGroup=function(){return this.group};c.prototype.getTranslation=function(){return this.translation};c.prototype.getObjectIds=function(){return m.keysOfSet(this._objects,function(b){return b.id})};c.prototype.getObjects=function(){return m.keysOfSet(this._objects)};c.prototype.addObject=function(b){this._objects.add(b);b.parentLayer=this;this.notifyDirty("layerObjectAdded",b);this._octree&&this._octree.add(b)};c.prototype.hasObject=function(b){return this._objects.has(b)};
c.prototype.removeObject=function(b){if(!this._objects.delete(b))return!1;b.parentLayer=null;this.notifyDirty("layerObjectRemoved",b);this._octree&&this._octree.remove(b);return!0};c.prototype.notifyObjectBBChanged=function(b,c){this._octree&&this._octree.update(b,c)};c.prototype.getSpatialQueryAccelerator=function(){!this._octree&&50<this._objects.size&&this._createOctree();return this._octree};c.prototype.shaderTransformationChanged=function(){this.notifyDirty("shaderTransformationChanged",null)};
c.prototype.invalidateSpatialQueryAccelerator=function(){this._octree&&(this._octree.destroy(),this._octree=null)};c.prototype.notifyDirty=function(b,c,a,e){this.emit("dirty",{origin:e||this,dirtyType:b,subObject:c})};c.prototype._createOctree=function(){this._octree=new h({getRadius:function(b){return b.getBSRadius()},getCenter:function(b){return b.getCenter()}});this._octree.add(m.keysOfSet(this._objects))};c._idGen=new g.IdGen;return c}(e)})},"esri/views/3d/webgl-engine/lib/Octree":function(){define("require exports ../../../../core/ObjectPool ../../../../core/PooledArray ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/geometryUtils ./Util".split(" "),
function(p,a,k,m,e,f,g,h){function l(b,c,a){a=a||b;a[0]=b[0]+c;a[1]=b[1]+c;a[2]=b[2]+c;return a}function c(b,c,a){return!g.frustum.intersectsSphere(a.planes,g.sphere.wrap(c,b))}function b(b,c,a){if(!D.length)for(var d=0;8>d;++d)D.push({index:0,distance:0});for(d=0;8>d;++d){var e=w[d];D.data[d].index=d;D.data[d].distance=n(b,c,e)}D.sort(function(b,c){return b.distance-c.distance});a.clear();for(d=0;8>d;++d)a.push(D.data[d].index)}function d(b,c){for(var a=Infinity,d=null,e=0;8>e;++e){var f=n(b,c,u[e]);
f<a&&(a=f,d=u[e])}return d}function n(b,c,a){return c*(b[0]*a[0]+b[1]*a[1]+b[2]*a[2])}function t(b){if(Array.isArray(b))return b;E[0]=b;return E}p=function(){function a(b,c){this._maximumObjectsPerNode=10;this._maximumDepth=20;this._degenerateObjects=new Set;this._objectCount=0;this._objectToBoundingSphere=b;c&&(void 0!==c.maximumObjectsPerNode&&(this._maximumObjectsPerNode=c.maximumObjectsPerNode),void 0!==c.maximumDepth&&(this._maximumDepth=c.maximumDepth));this._root=new r(null,f.vec3f64.fromValues(0,
0,0),0)}Object.defineProperty(a.prototype,"center",{get:function(){return this._root.center},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return 2*this._root.halfSize},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"root",{get:function(){return this._root.node},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maximumObjectsPerNode",{get:function(){return this._maximumObjectsPerNode},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"maximumDepth",{get:function(){return this._maximumDepth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"objectCount",{get:function(){return this._objectCount},enumerable:!0,configurable:!0});a.prototype.destroy=function(){this._degenerateObjects.clear();this._root=null;r.clearPool();E[0]=null;A.prune();D.prune();G.prune()};a.prototype.add=function(b,c){b=t(b);c=null==c?b.length:c;this._objectCount+=c;this._grow(b,c);for(var a=r.acquire(),d=0;d<c;d++){var e=b[d];this._isDegenerate(e)?
this._degenerateObjects.add(e):(a.init(this._root),this._add(e,a))}r.release(a)};a.prototype.remove=function(b,c){b=t(b);this._objectCount-=b.length;for(var a=r.acquire(),d=0;d<b.length;d++){var e=b[d],f=c||this._boundingSphereFromObject(e,B);this._isValidRadius(f.radius)?(a.init(this._root),this._remove(e,f,a)):this._degenerateObjects.delete(e)}r.release(a);this._shrink()};a.prototype.update=function(b,c){if(this._isValidRadius(c.radius)||!this._isDegenerate(b))this.remove(b,c),this.add(b)};a.prototype.forEachAlongRay=
function(b,c,a){var d=this,e=g.ray.wrap(b,c);this._forEachNode(this._root,function(b){if(!d._intersectsNode(e,b))return!1;b=b.node;b.terminals.forEach(function(b){d._intersectsObject(e,b)&&a(b)});null!==b.residents&&b.residents.forEach(function(b){d._intersectsObject(e,b)&&a(b)});return!0})};a.prototype.forEachAlongRayWithVerticalOffset=function(b,c,a,d){var e=this,f=g.ray.wrap(b,c);this._forEachNode(this._root,function(b){if(!e._intersectsNodeWithOffset(f,b,d))return!1;b=b.node;b.terminals.forEach(function(b){e._intersectsObjectWithOffset(f,
b,d)&&a(b)});null!==b.residents&&b.residents.forEach(function(b){e._intersectsObjectWithOffset(f,b,d)&&a(b)});return!0})};a.prototype.forEach=function(b){this._forEachNode(this._root,function(c){c=c.node;c.terminals.forEach(b);null!==c.residents&&c.residents.forEach(b);return!0});this._degenerateObjects.forEach(b)};a.prototype.forEachDegenerateObject=function(b){this._degenerateObjects.forEach(b)};a.prototype.findClosest=function(b,c,a,d,e){return this._findClosest(b,"front-to-back"===c?1:-1,a,d,
e)};a.prototype.forEachInDepthRange=function(b,c,a,d,e,f,h,g){this._forEachInDepthRange(b,c,"front-to-back"===a?1:-1,d,e,f,h,g)};a.prototype.forEachNode=function(b){this._forEachNode(this._root,function(c){return b(c.node,c.center,2*c.halfSize)})};a.prototype._intersectsNode=function(b,c){l(c.center,2*-c.halfSize,y);l(c.center,2*c.halfSize,v);return h.rayBoxTest(b.origin,b.direction,y,v)};a.prototype._intersectsNodeWithOffset=function(b,c,a){l(c.center,2*-c.halfSize,y);l(c.center,2*c.halfSize,v);
a.applyToMinMax(y,v);return h.rayBoxTest(b.origin,b.direction,y,v)};a.prototype._intersectsObject=function(b,c){var a=this._objectToBoundingSphere.getRadius(c);return 0<a?g.sphere.intersectsRay(g.sphere.wrap(a,this._objectToBoundingSphere.getCenter(c)),b):!0};a.prototype._intersectsObjectWithOffset=function(b,c,a){var d=this._objectToBoundingSphere.getRadius(c);return 0<d?g.sphere.intersectsRay(a.applyToBoundingSphere(d,this._objectToBoundingSphere.getCenter(c)),b):!0};a.prototype._forEachNode=function(b,
c){b=r.acquire().init(b);for(var a=[b];0!==a.length;){b=a.pop();if(c(b)&&!b.isLeaf())for(var d=0;d<b.node.children.length;d++)b.node.children[d]&&a.push(r.acquire().init(b).advance(d));r.release(b)}};a.prototype._forEachNodeDepthOrdered=function(c,a,d,e){void 0===e&&(e=1);c=r.acquire().init(c);var f=[c];for(b(d,e,G);0!==f.length;){c=f.pop();if(a(c)&&!c.isLeaf())for(d=7;0<=d;--d)e=G.data[d],e>=c.node.children.length||c.node.children[e]&&f.push(r.acquire().init(c).advance(e));r.release(c)}};a.prototype._findClosest=
function(b,a,f,h,g){var l=this,m=Infinity,k=Infinity,r=null,t=d(b,a),v=0,u=function(d){++v;if(!h||h(d)){var e=l._objectToBoundingSphere.getCenter(d),g=l._objectToBoundingSphere.getRadius(d);if(!f||!c(e,g,f)){var e=n(b,a,e),q=e-g;q<m&&(m=q,k=e+g,r=d)}}};this._forEachNodeDepthOrdered(this._root,function(d){if(null!=g&&v>=g||f&&c(d.center,d.halfSize*q,f))return!1;e.vec3.scale(z,t,d.halfSize);e.vec3.add(z,z,d.center);if(n(b,a,z)>k)return!1;d=d.node;d.terminals.forEach(function(b){u(b)});null!==d.residents&&
d.residents.forEach(function(b){u(b)});return!0},b,a);return r};a.prototype._forEachInDepthRange=function(b,a,f,h,g,l,m,k){var r=this,t=-Infinity,v=Infinity,u={setRange:function(b){1===f?(t=Math.max(t,b.near),v=Math.min(v,b.far)):(t=Math.max(t,-b.far),v=Math.min(v,-b.near))}};u.setRange(h);var p=n(a,f,b),w=d(a,f),I=d(a,-1*f),x=0,D=function(b){++x;if(!m||m(b)){var d=r._objectToBoundingSphere.getCenter(b),e=r._objectToBoundingSphere.getRadius(b),h=n(a,f,d)-p;h-e>v||h+e<t||l&&c(d,e,l)||g(b,u)}};this._forEachNodeDepthOrdered(this._root,
function(b){if(null!=k&&x>=k||l&&c(b.center,b.halfSize*q,l))return!1;e.vec3.scale(z,w,b.halfSize);e.vec3.add(z,z,b.center);if(n(a,f,z)-p>v)return!1;e.vec3.scale(z,I,b.halfSize);e.vec3.add(z,z,b.center);if(n(a,f,z)-p<t)return!1;b=b.node;b.terminals.forEach(function(b){D(b)});null!==b.residents&&b.residents.forEach(function(b){D(b)});return!0},a,f)};a.prototype._remove=function(b,c,a){A.clear();c=a.advanceTo(c,function(b,c){A.push(b.node);A.push(c)})?a.node.terminals:a.node.residents;c.removeUnordered(b);
if(0===c.length)for(b=A.length-2;0<=b&&this._purge(A.data[b],A.data[b+1]);b-=2);};a.prototype._nodeIsEmpty=function(b){if(0!==b.terminals.length)return!1;if(null!==b.residents)return 0===b.residents.length;for(var c=0;c<b.children.length;c++)if(b.children[c])return!1;return!0};a.prototype._purge=function(b,c){0<=c&&(b.children[c]=null);return this._nodeIsEmpty(b)?(null===b.residents&&(b.residents=new m({shrink:!0})),!0):!1};a.prototype._add=function(b,c){c.advanceTo(this._boundingSphereFromObject(b,
B))?c.node.terminals.push(b):(c.node.residents.push(b),c.node.residents.length>this._maximumObjectsPerNode&&c.depth<this._maximumDepth&&this._split(c))};a.prototype._split=function(b){var c=b.node.residents;b.node.residents=null;for(var a=0;a<c.length;a++){var d=r.acquire().init(b);this._add(c.data[a],d);r.release(d)}};a.prototype._grow=function(b,c){var a=this;0!==c&&(b=this._boundingSphereFromObjects(b,c,function(b,c){return a._boundingSphereFromObject(b,c)},C),this._isValidRadius(b.radius)&&!this._fitsInsideTree(b)&&
(this._nodeIsEmpty(this._root.node)?(e.vec3.copy(this._root.center,b.center),this._root.halfSize=1.25*b.radius):(c=r.acquire(),this._rootBoundsForRootAsSubNode(b,c),this._placingRootViolatesMaxDepth(c)?this._rebuildTree(b,c):this._growRootAsSubNode(c),r.release(c))))};a.prototype._rebuildTree=function(b,c){var a=this;e.vec3.copy(L.center,c.center);L.radius=c.halfSize;b=this._boundingSphereFromObjects([b,L],2,function(b){return b},R);c=r.acquire().init(this._root);this._root.initFrom(null,b.center,
1.25*b.radius);this._forEachNode(c,function(b){a.add(b.node.terminals.data,b.node.terminals.length);null!==b.node.residents&&a.add(b.node.residents.data,b.node.residents.length);return!0});r.release(c)};a.prototype._placingRootViolatesMaxDepth=function(b){var c=0;this._forEachNode(this._root,function(b){c=Math.max(c,b.depth);return!0});return c+Math.log(b.halfSize/this._root.halfSize)*Math.LOG2E>this._maximumDepth};a.prototype._rootBoundsForRootAsSubNode=function(b,c){var a=b.radius,d=b.center;b=
-Infinity;for(var e=this._root.center,f=this._root.halfSize,h=0;3>h;h++){var g=Math.max(0,Math.ceil((e[h]-f-(d[h]-a))/(2*f))),l=Math.max(0,Math.ceil((d[h]+a-(e[h]+f))/(2*f)))+1;b=Math.max(b,Math.pow(2,Math.ceil(Math.log(g+l)*Math.LOG2E)));K[h].min=g;K[h].max=l}for(h=0;3>h;h++)g=K[h].min,l=K[h].max,a=(b-(g+l))/2,g+=Math.ceil(a),l+=Math.floor(a),x[h]=e[h]-f-g*f*2+(l+g)*f;return c.initFrom(null,x,b*f,0)};a.prototype._growRootAsSubNode=function(b){var c=this._root.node;e.vec3.copy(C.center,this._root.center);
C.radius=this._root.halfSize;this._root.init(b);b.advanceTo(C,null,!0);b.node.children=c.children;b.node.residents=c.residents;b.node.terminals=c.terminals};a.prototype._shrink=function(){for(;;){var b=this._findShrinkIndex();if(-1===b)break;this._root.advance(b);this._root.depth=0}};a.prototype._findShrinkIndex=function(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;for(var b=null,c=this._root.node.children,a=0,d=0;d<c.length&&null==b;)a=d++,b=c[a];for(;d<c.length;)if(c[d++])return-1;
return a};a.prototype._isDegenerate=function(b){b=this._objectToBoundingSphere.getRadius(b);return!this._isValidRadius(b)};a.prototype._isValidRadius=function(b){return!isNaN(b)&&-Infinity!==b&&Infinity!==b&&0<b};a.prototype._fitsInsideTree=function(b){var c=this._root.center,a=this._root.halfSize,d=b.center;return b.radius<=a&&d[0]>=c[0]-a&&d[0]<=c[0]+a&&d[1]>=c[1]-a&&d[1]<=c[1]+a&&d[2]>=c[2]-a&&d[2]<=c[2]+a};a.prototype._boundingSphereFromObject=function(b,c){e.vec3.copy(c.center,this._objectToBoundingSphere.getCenter(b));
c.radius=this._objectToBoundingSphere.getRadius(b);return c};a.prototype._boundingSphereFromObjects=function(b,c,a,d){if(1===c){var f=a(b[0],C);e.vec3.copy(d.center,f.center);d.radius=f.radius}else{y[0]=Infinity;y[1]=Infinity;y[2]=Infinity;v[0]=-Infinity;v[1]=-Infinity;v[2]=-Infinity;for(var h=0;h<c;h++)if(f=a(b[h],C),this._isValidRadius(f.radius)){var g=y,l=f.center,n=f.radius;g[0]=Math.min(g[0],l[0]-n);g[1]=Math.min(g[1],l[1]-n);g[2]=Math.min(g[2],l[2]-n);g=v;l=f.center;f=f.radius;g[0]=Math.max(g[0],
l[0]+f);g[1]=Math.max(g[1],l[1]+f);g[2]=Math.max(g[2],l[2]+f)}e.vec3.lerp(d.center,y,v,.5);d.radius=Math.max(v[0]-y[0],v[1]-y[1],v[2]-y[2])/2}return d};return a}();var r=function(){function b(b,c,a){void 0===a&&(a=0);this.center=f.vec3f64.create();this.initFrom(b,c,a,0)}b.prototype.init=function(b){return this.initFrom(b.node,b.center,b.halfSize,b.depth)};b.prototype.initFrom=function(c,a,d,f){void 0===c&&(c=null);void 0===d&&(d=this.halfSize);void 0===f&&(f=this.depth);this.node=c||b.createEmptyNode();
a&&e.vec3.copy(this.center,a);this.halfSize=d;this.depth=f;return this};b.prototype.advance=function(c){var a=this.node.children[c];a||(a=b.createEmptyNode(),this.node.children[c]=a);this.node=a;this.halfSize/=2;this.depth++;c=w[c];this.center[0]+=c[0]*this.halfSize;this.center[1]+=c[1]*this.halfSize;this.center[2]+=c[2]*this.halfSize;return this};b.prototype.advanceTo=function(b,c,a){for(void 0===a&&(a=!1);;){if(this.isTerminalFor(b))return c&&c(this,-1),!0;if(this.isLeaf()&&!a)return c&&c(this,
-1),!1;this.isLeaf()&&(this.node.residents=null);var d=this._childIndex(b);c&&c(this,d);this.advance(d)}};b.prototype.isLeaf=function(){return null!=this.node.residents};b.prototype.isTerminalFor=function(b){return b.radius>this.halfSize/2};b.prototype._childIndex=function(b){b=b.center;for(var c=this.center,a=0,d=0;3>d;d++)c[d]<b[d]&&(a|=1<<d);return a};b.createEmptyNode=function(){return{children:[null,null,null,null,null,null,null,null],terminals:new m({shrink:!0}),residents:new m({shrink:!0})}};
b.acquire=function(){return b._pool.acquire()};b.release=function(c){b._pool.release(c)};b.clearPool=function(){b._pool.prune()};b._pool=new k(b);return b}(),w=[f.vec3f64.fromValues(-1,-1,-1),f.vec3f64.fromValues(1,-1,-1),f.vec3f64.fromValues(-1,1,-1),f.vec3f64.fromValues(1,1,-1),f.vec3f64.fromValues(-1,-1,1),f.vec3f64.fromValues(1,-1,1),f.vec3f64.fromValues(-1,1,1),f.vec3f64.fromValues(1,1,1)],u=[f.vec3f64.fromValues(-1,-1,-1),f.vec3f64.fromValues(-1,-1,1),f.vec3f64.fromValues(-1,1,-1),f.vec3f64.fromValues(-1,
1,1),f.vec3f64.fromValues(1,-1,-1),f.vec3f64.fromValues(1,-1,1),f.vec3f64.fromValues(1,1,-1),f.vec3f64.fromValues(1,1,1)],q=Math.sqrt(3),E=[null],x=f.vec3f64.create(),z=f.vec3f64.create(),y=f.vec3f64.create(),v=f.vec3f64.create(),A=new m,B={center:f.vec3f64.create(),radius:0},C={center:f.vec3f64.create(),radius:0},L={center:f.vec3f64.create(),radius:0},R={center:f.vec3f64.create(),radius:0},K=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],D=new m,G=new m;return p})},"esri/views/3d/webgl-engine/lib/localOrigin":function(){define(["require",
"exports","../../../../core/libs/gl-matrix-2/vec3f64"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});a.fromVector=function(a,e){return{vec3:k.vec3f64.clone(a),id:e}};a.fromValues=function(a,e,f,g){return{vec3:k.vec3f64.fromValues(a,e,f),id:g}}})},"esri/views/3d/webgl-engine/lib/Object3D":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/mathUtils ./ComponentUtils ./GeometryRecord ./IdGen ./Object3DStateSet ./Util".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n,t){p=function(){function a(b){void 0===b&&(b={});this._objectTransformation=f.mat4f64.create();this._bvObjectSpace=new w;this._bvWorldSpace=new w;this._bvDirty=!0;this._hasVolatileTransformation=!1;this._allComponentsVisibleDirty=this._allComponentsHiddenDirty=!0;this.id=a._idGen.gen(b.idHint);this.castShadow=null!=b.castShadow?b.castShadow:!0;(this.metadata=b.metadata)&&this.metadata.isElevationSource&&(this.metadata.lastValidElevationBB=new r);this.objectTransformation=
f.mat4f64.create();this._initializeGeometryRecords(b.geometries,b.materials,b.transformations,b.origins)}Object.defineProperty(a.prototype,"geometryRecords",{get:function(){return this._geometryRecords},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"geometries",{get:function(){return this._geometries},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"objectTransformation",{get:function(){return this._objectTransformation},set:function(b){e.mat4.copy(this._objectTransformation,
b);this._invalidateBoundingVolume();this._notifyDirty("objTransformation")},enumerable:!0,configurable:!0});a.prototype.dispose=function(){for(var c=0,a=this._geometryRecords;c<a.length;c++)b.pool.release(a[c]);this._geometries=this._geometryRecords=null};a.prototype._initializeGeometryRecords=function(c,a,d,e){if(Array.isArray(c)){t.assert(a.length===c.length,"Object3D: materials don't match geometries");t.assert(d.length===c.length,"Object3D: transformations don't match geometries");this._geometryRecords=
Array(c.length);this._geometries=c.slice();for(var h=0;h<c.length;h++)this._geometryRecords[h]=b.pool.acquire(c[h],a[h],f.mat4f64.clone(d[h]),{},e&&e[h]);this._hasVolatileTransformation=!1}else this._geometryRecords=[],this._geometries=[]};Object.defineProperty(a.prototype,"parentLayer",{get:function(){return this._parentLayer},set:function(b){t.assert(null==this._parentLayer||null==b,"Object3D can only be added to a single Layer");this._parentLayer=b},enumerable:!0,configurable:!0});a.prototype.getNumGeometryRecords=
function(){return this._geometryRecords.length};a.prototype.findGeometryRecords=function(b){for(var c=[],a=0;a<this._geometries.length;a++)this._geometries[a]===b&&c.push(this._geometryRecords[a]);return c};a.prototype.getGeometryRecord=function(b){t.assert(0<=b&&b<this._geometryRecords.length,"Object3d.getGeometryDataByIndex: index out of range");return this._geometryRecords[b]};a.prototype.addGeometry=function(c,a,d,e,h,g){d=d?d:f.mat4f64.IDENTITY;this._geometries.push(c);c=b.pool.acquire(c,a,d,
e||{},h,g);this._geometryRecords.push(c);this._hasVolatileTransformation=this._geometryRecords.some(function(b){return!!b.shaderTransformation});this._notifyDirty("objGeometryAdded",c);this._invalidateBoundingVolume();this._allComponentsVisibleDirty=this._allComponentsHiddenDirty=!0;return c};a.prototype.removeGeometry=function(c){var a=this._geometryRecords.splice(c,1)[0];b.pool.release(a);this._hasVolatileTransformation=this._geometryRecords.some(function(b){return!!b.shaderTransformation});this._geometries.splice(c,
1);this._notifyDirty("objGeometryRemoved",a);this._invalidateBoundingVolume();this._allComponentsVisibleDirty=this._allComponentsHiddenDirty=!0;return a};a.prototype.removeAllGeometries=function(){for(;0<this.getNumGeometryRecords();)this.removeGeometry(0)};a.prototype.geometryVertexAttrsUpdated=function(b){this._notifyDirty("vertexAttrsUpdated",this._geometryRecords[b]);this._invalidateBoundingVolume()};a.prototype.isHidden=function(){if(this._allComponentsHiddenDirty){this._allComponentsHiddenDirty=
!1;this._allComponentsHidden=!0;for(var b=0,a=this._geometryRecords;b<a.length;b++){var d=a[b];if(!c.isAllHidden(d.instanceParameters.componentVisibilities,d.geometry.data.componentOffsets)){this._allComponentsHidden=!1;break}}}return this._allComponentsHidden};a.prototype.isVisible=function(){if(this._allComponentsVisibleDirty){this._allComponentsVisibleDirty=!1;this._allComponentsVisible=!0;for(var b=0,a=this._geometryRecords;b<a.length;b++){var d=a[b];if(!c.isAllVisible(d.instanceParameters.componentVisibilities,
d.geometry.data.componentOffsets)){this._allComponentsVisible=!1;break}}}return this._allComponentsVisible};a.prototype.hide=function(){if(this._allComponentsHiddenDirty||!this._allComponentsHidden){for(var b=0,a=this._geometryRecords;b<a.length;b++){var d=a[b],e=c.hideAllComponents(d.instanceParameters.componentVisibilities);d.instanceParameters.componentVisibilities=e}this._notifyDirty("visibilityChanged");this._allComponentsVisibleDirty=this._allComponentsHiddenDirty=!1;this._allComponentsHidden=
!0;this._allComponentsVisible=!1}};a.prototype.unhide=function(){if(this._allComponentsVisibleDirty||!this._allComponentsVisible){for(var b=0,a=this._geometryRecords;b<a.length;b++){var d=a[b],e=c.unhideAllComponents(d.instanceParameters.componentVisibilities);d.instanceParameters.componentVisibilities=e}this._notifyDirty("visibilityChanged");this._allComponentsHidden=this._allComponentsVisibleDirty=this._allComponentsHiddenDirty=!1;this._allComponentsVisible=!0}};a.prototype.occlude=function(){for(var b=
n.generateObject3DStateId(1),a=0,d=this._geometryRecords;a<d.length;a++){var e=d[a];e.instanceParameters.occludees=c.addOccludee(e.instanceParameters.occludees,b)}this._notifyDirty("occlusionChanged");return b};a.prototype.removeOcclude=function(b){for(var a=0,d=this._geometryRecords;a<d.length;a++){var e=d[a];e.instanceParameters.occludees=c.removeOccludee(e.instanceParameters.occludees,b)}this._notifyDirty("occlusionChanged")};a.prototype.highlight=function(){for(var b=n.generateObject3DStateId(0),
a=0,d=this._geometryRecords;a<d.length;a++){var e=d[a];e.instanceParameters.componentHighlights=c.addHighlight(e.instanceParameters.componentHighlights,null,b)}this._notifyDirty("highlightChanged");return b};a.prototype.removeHighlight=function(b){for(var a=0,d=this._geometryRecords;a<d.length;a++){var e=d[a];e.instanceParameters.componentHighlights=c.removeHighlight(e.instanceParameters.componentHighlights,b)}this._notifyDirty("highlightChanged")};a.prototype.getComponentFromTriangleNr=function(b,
a){t.assert(0<=b&&b<this._geometryRecords.length,"Object3d.getComponentFromTriangleNr: index out of range");return c.componentFind(this._geometryRecords[b].geometry.data.componentOffsets,3*a)};a.prototype.setGeometryTransformation=function(c,a){t.assert(0<=c&&c<this._geometryRecords.length,"Object3d.setGeometryTransformation: index out of range");var d=this._geometryRecords[c];b.pool.release(d);a=b.pool.acquire(d.geometry,d.material,f.mat4f64.clone(a),d.instanceParameters);this._geometryRecords[c]=
a;this._notifyDirty("objGeometryReplaced",[d,a]);this._invalidateBoundingVolume()};a.prototype.getCombinedStaticTransformation=function(b,c){return e.mat4.multiply(m.unwrapOr(c,f.mat4f64.create()),this.objectTransformation,b.getStaticTransformation())};a.prototype.getCombinedShaderTransformation=function(b,c){c=c||f.mat4f64.create();e.mat4.multiply(c,this.objectTransformation,b.getShaderTransformation());return c};a.prototype.hasVolativeTransformation=function(){return this._hasVolatileTransformation};
a.prototype.getBBMin=function(b){this._validateBoundingVolume();return b?this._bvObjectSpace.bbMin:this._bvWorldSpace.bbMin};a.prototype.getBBMax=function(b){this._validateBoundingVolume();return b?this._bvObjectSpace.bbMax:this._bvWorldSpace.bbMax};a.prototype.getCenter=function(b){this._validateBoundingVolume();return b?this._bvObjectSpace.center:this._bvWorldSpace.center};a.prototype.getBSRadius=function(b){this._validateBoundingVolume();return b?this._bvObjectSpace.bsRadius:this._bvWorldSpace.bsRadius};
a.prototype._validateBoundingVolume=function(){if(this._bvDirty||this._hasVolatileTransformation){this._bvObjectSpace.init();this._bvWorldSpace.init();for(var b=0;b<this._geometryRecords.length;++b){var c=this._geometries[b],a=this._geometryRecords[b],c=c.boundingInfo;this._calculateTransformedBoundingVolume(c,this._bvObjectSpace,a.getShaderTransformation());this._calculateTransformedBoundingVolume(c,this._bvWorldSpace,this.getCombinedShaderTransformation(a))}g.vec3.lerp(this._bvObjectSpace.center,
this._bvObjectSpace.bbMin,this._bvObjectSpace.bbMax,.5);g.vec3.lerp(this._bvWorldSpace.center,this._bvWorldSpace.bbMin,this._bvWorldSpace.bbMax,.5);for(var a=h.vec3f64.create(),d=h.vec3f64.create(),e=l.maxScale(this.objectTransformation),b=0;b<this._geometryRecords.length;++b){var c=this._geometries[b],f=this._geometryRecords[b].getShaderTransformation(),n=l.maxScale(f),c=c.boundingInfo;g.vec3.transformMat4(a,c.getCenter(),f);f=g.vec3.distance(a,this._bvObjectSpace.center);c=c.getBSRadius()*n;this._bvObjectSpace.bsRadius=
Math.max(this._bvObjectSpace.bsRadius,f+c);g.vec3.transformMat4(d,a,this.objectTransformation);n=g.vec3.distance(d,this._bvWorldSpace.center);this._bvWorldSpace.bsRadius=Math.max(this._bvWorldSpace.bsRadius,n+c*e)}this._bvDirty=!1}};a.prototype._calculateTransformedBoundingVolume=function(b,c,a){var d=b.getBBMin();b=b.getBBMax();var e=h.vec3f64.clone(d),f=h.vec3f64.clone(b);g.vec3.transformMat4(e,e,a);g.vec3.transformMat4(f,f,a);for(var l=0;3>l;++l)c.bbMin[l]=Math.min(c.bbMin[l],e[l],f[l]),c.bbMax[l]=
Math.max(c.bbMax[l],e[l],f[l]);for(l=0;3>l;++l){g.vec3.copy(e,d);g.vec3.copy(f,b);e[l]=b[l];f[l]=d[l];g.vec3.transformMat4(e,e,a);g.vec3.transformMat4(f,f,a);for(var n=0;3>n;++n)c.bbMin[n]=Math.min(c.bbMin[n],e[n],f[n]),c.bbMax[n]=Math.max(c.bbMax[n],e[n],f[n])}};a.prototype._invalidateBoundingVolume=function(){this._bvDirty=!0;this._parentLayer&&this._parentLayer.notifyObjectBBChanged(this,{center:this._bvWorldSpace.center,radius:this._bvWorldSpace.bsRadius})};a.prototype._notifyDirty=function(b,
c,a,d){this._parentLayer&&this._parentLayer.notifyDirty(b,c,a||1,d||this)};Object.defineProperty(a.prototype,"test",{get:function(){var b=this;return{hasGeometry:function(c){return-1<b._geometries.indexOf(c)},getGeometryIndex:function(c){return b._geometries.indexOf(c)}}},enumerable:!0,configurable:!0});a._idGen=new d.IdGen;return a}();var r=function(){function b(){this.bbMin=h.vec3f64.fromValues(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this.bbMax=h.vec3f64.fromValues(-Number.MAX_VALUE,
-Number.MAX_VALUE,-Number.MAX_VALUE)}b.prototype.isEmpty=function(){return this.bbMax[0]<this.bbMin[0]&&this.bbMax[1]<this.bbMin[1]&&this.bbMax[2]<this.bbMin[2]};return b}(),w=function(b){function c(){var c=b.call(this)||this;c.center=h.vec3f64.create();c.bsRadius=0;return c}k(c,b);c.prototype.init=function(){g.vec3.set(this.bbMin,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);g.vec3.set(this.bbMax,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);g.vec3.set(this.center,0,0,0);this.bsRadius=
0};c.prototype.getCenter=function(){return this.center};c.prototype.getBSRadius=function(){return this.bsRadius};return c}(r);return p})},"esri/views/3d/webgl-engine/lib/GeometryRecord":function(){define(["require","exports","../../../../core/ObjectPool","../../../../core/libs/gl-matrix-2/vec3","./IdGen"],function(p,a,k,m,e){return function(){function a(e,f,l,c,b,d){this.id=a._idGen.gen(e&&e.id);this.geometry=e;this.material=f;this.transformation=l;this.instanceParameters=c;this.origin=b;this.shaderTransformation=
d}a.prototype.getStaticTransformation=function(){return this.transformation};a.prototype.getShaderTransformation=function(){return this.shaderTransformation?this.shaderTransformation(this.transformation):this.transformation};a.prototype.computeAttachmentOrigin=function(a){return(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,a):this.geometry.computeAttachmentOrigin(a))?(m.vec3.transformMat4(a,a,this.getStaticTransformation()),!0):!1};a._idGen=new e.IdGen;
a.pool=new k(a,!0);return a}()})},"esri/views/3d/webgl-engine/lib/Object3DStateSet":function(){define(["require","exports","./IdGen"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});var m=new k.IdGen;a.generateObject3DStateId=function(a){return{id:m.gen(0===a?"highlight":"occludee"),channel:a}};p=function(){function a(){this.items=[]}a.prototype.addObject=function(a,e){this.items.push({type:0,objectStateId:e,object:a})};a.prototype.addRenderGeometry=function(a,e,h){this.items.push({type:1,
objectStateId:e,renderGeometry:a,owner:h})};a.prototype.addExternal=function(a,e){this.items.push({type:2,objectStateId:e,remove:a})};a.prototype.remove=function(a){for(var e=this.items.length-1;0<=e;--e){var f=this.items[e];f.objectStateId===a&&(this._removeObjectStateItem(f),this.items.splice(e,1))}};a.prototype.removeObject=function(a){for(var e=this.items.length-1;0<=e;--e){var f=this.items[e];0===f.type&&f.object===a&&(this._removeObjectStateItem(f),this.items.splice(e,1))}};a.prototype.removeRenderGeometry=
function(a){for(var e=this.items.length-1;0<=e;--e){var f=this.items[e];1===f.type&&f.renderGeometry===a&&(this._removeObjectStateItem(f),this.items.splice(e,1))}};a.prototype.removeAll=function(){var a=this;this.items.forEach(function(e){a._removeObjectStateItem(e)});this.items=[]};a.prototype._removeObjectStateItem=function(a){switch(a.type){case 0:0===a.objectStateId.channel?a.object.removeHighlight(a.objectStateId):1===a.objectStateId.channel&&a.object.removeOcclude(a.objectStateId);break;case 1:a.owner.removeRenderGeometryObjectState(a.renderGeometry,
a.objectStateId);break;case 2:a.remove(a.objectStateId)}};return a}();a.Object3DStateSet=p})},"esri/views/3d/webgl-engine/materials/RibbonLineMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../support/geometryUtils ../../support/buffer/InterleavedLayout ../lib/ComponentUtils ../lib/geometryDataUtils ../lib/GLMaterial ../lib/Material ../lib/Util ./VisualVariableMaterialParameters ./internal/MaterialUtil ./renderers/MergedRenderer ../shaders/RibbonLineTechnique ../shaders/RibbonLineTechnique".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n,t,r,w,u,q,E,x,z,y,v){function A(b,c,a,d,e){for(var f=0;f<e;f++)a[d++]=b[c++];return d}var B=e.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial");p=function(b){function a(c,a){a=b.call(this,a)||this;a.techniqueConfig=new v.RibbonLineTechniqueConfiguration;a.params=x.copyParameters(c,L);a.validateParams();a.params.transparent=1>a.params.color[3]||a.params.transparent;a.layout=a.createLayout();return a}k(a,b);a.prototype.dispose=function(){};a.prototype.setParameterValues=
function(b){for(var c in b)"cap"===c?B.error("cap cannot be changed after creation"):"join"===c&&"round"===this.params[c]!==("round"===b[c])?B.error("join cannot be changed after creation"):"stipplePattern"===c&&!!this.params[c]!==!!b[c]?B.error("stippledness cannot be changed after creation"):this.params[c]=b[c];this.validateParams();this.parametersChanged()};a.prototype.getParameters=function(){return this.params};a.prototype.getPassParameters=function(){return this.params};a.prototype.getTechniqueConfig=
function(b){this.techniqueConfig.output=b;b=g.isSome(this.params.stipplePattern);this.techniqueConfig.stippleEnabled=b;this.techniqueConfig.stippleIntegerRepeatsEnabled=b&&this.params.stippleIntegerRepeats;this.techniqueConfig.stippleOffColorEnabled=b&&g.isSome(this.params.stippleOffColor);this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled;this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees;this.techniqueConfig.roundJoins="round"===this.params.join;this.techniqueConfig.roundCaps=
"round"===this.params.cap;this.techniqueConfig.transparent=this.params.transparent;this.techniqueConfig.polygonOffset=this.params.polygonOffset;this.techniqueConfig.writeDepth=this.params.writeDepth;this.techniqueConfig.vvColor=this.params.vvColorEnabled;this.techniqueConfig.vvOpacity=this.params.vvOpacityEnabled;this.techniqueConfig.vvSize=this.params.vvSizeEnabled;this.techniqueConfig.innerColorEnabled=0<this.params.innerWidth&&g.isSome(this.params.innerColor);this.techniqueConfig.falloffEnabled=
0<this.params.falloff;this.techniqueConfig.occluder=8===this.renderOccluded;return this.techniqueConfig};a.prototype.intersect=function(b,c,a,d,e,f,h,l,g){g?x.intersectDrapedRenderLineGeometry(b,d,f,this.params.width,h):this.intersectLineGeometry(b,c,a,d,this.params.width,h)};a.prototype.intersectLineGeometry=function(b,a,e,h,g,n){if(h.options.selectionMode&&!t.isAllHidden(a.componentVisibilities,b.componentOffsets))if(q.isTranslationMatrix(e)){a=b.data.getVertexAttr();b=a[v.RibbonVertexAttributeConstants.POSITION].data;
this.params.vvSizeEnabled?g*=f.clamp(this.params.vvSizeOffset[0]+a[v.RibbonVertexAttributeConstants.SIZEFEATUREATTRIBUTE].data[0]*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0]):a[v.RibbonVertexAttributeConstants.SIZE]&&(g*=a[v.RibbonVertexAttributeConstants.SIZE].data[0]);var m=h.camera,k=N;l.vec2.copy(k,h.point);g=g*m.pixelRatio/2+4*m.pixelRatio;c.vec3.set(X[0],k[0]-g,k[1]+g,0);c.vec3.set(X[1],k[0]+g,k[1]+g,0);c.vec3.set(X[2],k[0]+g,k[1]-g,0);c.vec3.set(X[3],
k[0]-g,k[1]-g,0);for(var r=0;4>r;r++)m.unprojectPoint(X[r],F[r]);d.plane.fromPoints(m.eye,F[0],F[1],S);d.plane.fromPoints(m.eye,F[1],F[2],U);d.plane.fromPoints(m.eye,F[2],F[3],Y);d.plane.fromPoints(m.eye,F[3],F[0],Z);a=Number.MAX_VALUE;for(var p=this.params.isClosed?b.length-2:b.length-5,r=0;r<p;r+=3){G[0]=b[r]+e[12];G[1]=b[r+1]+e[13];G[2]=b[r+2]+e[14];var u=(r+3)%b.length;H[0]=b[u]+e[12];H[1]=b[u+1]+e[13];H[2]=b[u+2]+e[14];if(!(0>d.plane.signedDistance(S,G)&&0>d.plane.signedDistance(S,H)||0>d.plane.signedDistance(U,
G)&&0>d.plane.signedDistance(U,H)||0>d.plane.signedDistance(Y,G)&&0>d.plane.signedDistance(Y,H)||0>d.plane.signedDistance(Z,G)&&0>d.plane.signedDistance(Z,H))){m.projectPoint(G,P);m.projectPoint(H,M);if(0>P[2]&&0<M[2]){c.vec3.subtract(I,G,H);var u=m.frustum,w=-d.plane.signedDistance(u.planes[4],G),u=w/c.vec3.dot(I,u.planes[4]);c.vec3.scale(I,I,u);c.vec3.add(G,G,I);m.projectPoint(G,P)}else if(0<P[2]&&0>M[2])c.vec3.subtract(I,H,G),u=m.frustum,w=-d.plane.signedDistance(u.planes[4],H),u=w/c.vec3.dot(I,
u.planes[4]),c.vec3.scale(I,I,u),c.vec3.add(H,H,I),m.projectPoint(H,M);else if(0>P[2]&&0>M[2])continue;P[2]=0;M[2]=0;u=d.lineSegment.distance2(d.lineSegment.fromPoints(P,M,V),k);u<a&&(a=u,c.vec3.copy(Q,G),c.vec3.copy(O,H))}}e=h.rayBeginPoint;h=h.rayEndPoint;a<g*g&&(b=Number.MAX_VALUE,d.lineSegment.closestLineSegmentPoint(d.lineSegment.fromPoints(Q,O,V),d.lineSegment.fromPoints(e,h,aa),J)&&(c.vec3.subtract(J,J,e),b=c.vec3.length(J),c.vec3.scale(J,J,1/b),b/=c.vec3.distance(e,h)),n(b,J))}else B.error("intersection assumes a translation-only matrix")};
a.prototype.computeAttachmentOrigin=function(b,c){var a=b.data;b="getVertexAttr"in a?a.getVertexAttr():"vertexAttr"in a?a.vertexAttr:null;if(!b)return null;var d=v.RibbonVertexAttributeConstants.POSITION,a="getVertexAttr"in a?a.getIndices(d):null;return r.computeAttachmentOriginLines(b[d],a,a&&this.params.isClosed,c)};a.prototype.createLayout=function(){var b=n.newLayout().vec3f(v.RibbonVertexAttributeConstants.POSITION).f32(v.RibbonVertexAttributeConstants.SUBDIVISIONFACTOR).vec2f(v.RibbonVertexAttributeConstants.UV0).vec3f(v.RibbonVertexAttributeConstants.AUXPOS1).vec3f(v.RibbonVertexAttributeConstants.AUXPOS2);
this.params.vvSizeEnabled?b.f32(v.RibbonVertexAttributeConstants.SIZEFEATUREATTRIBUTE):b.f32(v.RibbonVertexAttributeConstants.SIZE);this.params.vvColorEnabled?b.f32(v.RibbonVertexAttributeConstants.COLORFEATUREATTRIBUTE):b.vec4f(v.RibbonVertexAttributeConstants.COLOR);this.params.vvOpacityEnabled&&b.f32(v.RibbonVertexAttributeConstants.OPACITYFEATUREATTRIBUTE);return b};a.prototype.createBufferWriter=function(){return new R(this.layout,this.params)};a.prototype.createRenderer=function(b,c){return new z(b,
c,this,v.ribbonVertexAttributeLocations)};a.prototype.getGLMaterial=function(b){return 0===b.output||4===b.output?new C(b):void 0};a.prototype.validateParams=function(){this.params.width&&1<this.params.width&&(this.params.width=Math.round(this.params.width));"miter"!==this.params.join&&(this.params.miterLimit=0)};return a}(u.Material);var C=function(b){function c(c){c=b.call(this,c)||this;c.updateParameters();return c}k(c,b);c.prototype.updateParameters=function(){this.technique=this.techniqueRep.acquireAndReleaseExisting(y.RibbonLineTechnique,
this.material.getTechniqueConfig(this.output),this.technique)};c.prototype.beginSlot=function(b){return this.technique.configuration.occluder?3===b||10===b||11===b:0===this.output?(this.targetSlot=this.technique.configuration.writeDepth?5:8,b===this.targetSlot):3===b};c.prototype._updateOccludeeState=function(b){b.hasOccludees!==this.material.getParameters().sceneHasOcludees&&(this.material.setParameterValues({sceneHasOcludees:b.hasOccludees}),this.updateParameters())};c.prototype.ensureParameters=
function(b){0===this.output&&this._updateOccludeeState(b)};c.prototype.bind=function(b,c){b.bindProgram(this.technique.program);this.technique.bindPass(b,this.material.getPassParameters(),c)};c.prototype.getPipelineState=function(b,c){return c?this.technique.occludeePipeline:this.technique.configuration.occluder?11===b?this.technique.occluderPipelineTransparent:10===b?this.technique.occluderPipelineOpaque:this.technique.occluderPipelineMaskWrite:this.technique.pipeline};return c}(w.GLMaterial),L=
m({width:0,color:[1,1,1,1],join:"miter",cap:"butt",miterLimit:5,writeDepth:!0,polygonOffset:!1,stipplePattern:null,stippleIntegerRepeats:!1,stippleOffColor:null,slicePlaneEnabled:!1,vvFastUpdate:!1,transparent:!1,isClosed:!1,falloff:0,innerWidth:0,innerColor:null,sceneHasOcludees:!1},E.Default),R=function(){function b(b,c){this.params=c;this.numJoinSubdivisions=this.numCapSubdivisions=0;this.vertexBufferLayout=b;if(!c.isClosed)switch(this.params.cap){case "butt":this.numCapSubdivisions=0;break;case "square":this.numCapSubdivisions=
1;break;case "round":this.numCapSubdivisions=K}switch(this.params.join){case "miter":case "bevel":this.numJoinSubdivisions=c.stipplePattern?1:0;break;case "round":this.numJoinSubdivisions=D}}b.prototype.allocate=function(b){return this.vertexBufferLayout.createBuffer(b)};b.prototype.elementCount=function(b){var c=2*this.numCapSubdivisions+2,a=b.indices[v.RibbonVertexAttributeConstants.POSITION].length/2+1,d=this.params.isClosed,c=d?2:2*c,e=d?0:1,a=d?a:a-1;if(b.vertexAttr[v.RibbonVertexAttributeConstants.SUBDIVISIONS])for(b=
b.vertexAttr[v.RibbonVertexAttributeConstants.SUBDIVISIONS].data;e<a;++e)c+=4+2*b[e];else c+=(a-e)*(2*this.numJoinSubdivisions+4);return c+2};b.prototype.write=function(b,a,d,e){var f=this,h=ba,g=T,l=W,n=a.vertexAttr[v.RibbonVertexAttributeConstants.POSITION].data,m=a.indices&&a.indices[v.RibbonVertexAttributeConstants.POSITION];m&&m.length!==2*(n.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");m=null;a.vertexAttr[v.RibbonVertexAttributeConstants.SUBDIVISIONS]&&(m=a.vertexAttr[v.RibbonVertexAttributeConstants.SUBDIVISIONS].data);
var k=1,r=0;this.params.vvSizeEnabled?r=a.vertexAttr[v.RibbonVertexAttributeConstants.SIZEFEATUREATTRIBUTE].data[0]:a.vertexAttr[v.RibbonVertexAttributeConstants.SIZE]&&(k=a.vertexAttr[v.RibbonVertexAttributeConstants.SIZE].data[0]);var t=[1,1,1,1],q=0;this.params.vvColorEnabled?q=a.vertexAttr[v.RibbonVertexAttributeConstants.COLORFEATUREATTRIBUTE].data[0]:a.vertexAttr[v.RibbonVertexAttributeConstants.COLOR]&&(t=a.vertexAttr[v.RibbonVertexAttributeConstants.COLOR].data);var p=0;this.params.vvOpacityEnabled&&
(p=a.vertexAttr[v.RibbonVertexAttributeConstants.OPACITYFEATUREATTRIBUTE].data[0]);a=n.length/3;b=b.transformation;var u=new Float32Array(d.buffer);d=this.vertexBufferLayout.stride/4;var w=e*d;e=w;var D=function(b,c,a,d,e,h){u[w++]=c[0];u[w++]=c[1];u[w++]=c[2];u[w++]=d;u[w++]=e;u[w++]=h;u[w++]=b[0];u[w++]=b[1];u[w++]=b[2];u[w++]=a[0];u[w++]=a[1];u[w++]=a[2];f.params.vvSizeEnabled?u[w++]=r:u[w++]=k;f.params.vvColorEnabled?u[w++]=q:(u[w++]=t[0],u[w++]=t[1],u[w++]=t[2],u[w++]=t[3]);f.params.vvOpacityEnabled&&
(u[w++]=p)},w=w+d;c.vec3.set(g,n[0],n[1],n[2]);b&&c.vec3.transformMat4(g,g,b);var x=this.params.isClosed;if(x){var y=n.length-3;c.vec3.set(h,n[y],n[y+1],n[y+2]);b&&c.vec3.transformMat4(h,h,b)}else{c.vec3.copy(h,g);c.vec3.set(l,n[3],n[4],n[5]);b&&c.vec3.transformMat4(l,l,b);for(y=0;y<this.numCapSubdivisions;++y){var H=1-y/this.numCapSubdivisions;D(h,g,l,H,1,-4);D(h,g,l,H,1,4)}D(h,g,l,0,0,-4);D(h,g,l,0,0,4);c.vec3.copy(h,g);c.vec3.copy(g,l)}for(var I=x?a:a-1,y=x?0:1;y<I;y++){H=(y+1)%a*3;c.vec3.set(l,
n[H+0],n[H+1],n[H+2]);b&&c.vec3.transformMat4(l,l,b);D(h,g,l,0,1,-1);D(h,g,l,0,1,1);for(var z=m?m[y]:this.numJoinSubdivisions,B=0;B<z;++B)H=(B+1)/(z+1),D(h,g,l,H,1,-2),D(h,g,l,H,1,2);D(h,g,l,1,0,-2);D(h,g,l,1,0,2);c.vec3.copy(h,g);c.vec3.copy(g,l)}if(x)w=A(u,e+d,u,w,2*d);else for(D(h,g,l,0,1,-5),D(h,g,l,0,1,5),y=0;y<this.numCapSubdivisions;++y)H=(y+1)/this.numCapSubdivisions,D(h,g,l,H,1,-5),D(h,g,l,H,1,5);A(u,e+d,u,e,d);w=A(u,w-d,u,w,d)};return b}(),K=3,D=1,G=b.vec3f64.create(),H=b.vec3f64.create(),
I=b.vec3f64.create(),J=b.vec3f64.create(),N=b.vec3f64.create(),P=h.createRenderScreenPointArray3(),M=h.createRenderScreenPointArray3(),Q=b.vec3f64.create(),O=b.vec3f64.create(),V=d.lineSegment.create(),aa=d.lineSegment.create(),ba=b.vec3f64.create(),T=b.vec3f64.create(),W=b.vec3f64.create(),X=[h.createRenderScreenPointArray3(),h.createRenderScreenPointArray3(),h.createRenderScreenPointArray3(),h.createRenderScreenPointArray3()],F=[b.vec3f64.create(),b.vec3f64.create(),b.vec3f64.create(),b.vec3f64.create()],
S=d.plane.create(),U=d.plane.create(),Y=d.plane.create(),Z=d.plane.create();return p})},"esri/views/3d/support/buffer/InterleavedLayout":function(){define(["require","exports","./BufferView","./types"],function(p,a,k,m){Object.defineProperty(a,"__esModule",{value:!0});var e=function(){function a(a,e){this.layout=a;this.buffer="number"===typeof e?new ArrayBuffer(e*a.stride):e;e=0;for(var c=a.fieldNames;e<c.length;e++){var b=c[e],d=a.fields.get(b);this[b]=new d.constructor(this.buffer,d.offset,this.stride)}}
Object.defineProperty(a.prototype,"stride",{get:function(){return this.layout.stride},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"count",{get:function(){return this.buffer.byteLength/this.stride},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"byteLength",{get:function(){return this.buffer.byteLength},enumerable:!0,configurable:!0});a.prototype.getField=function(a,e){return(a=this[a])&&a.elementCount===e.ElementCount&&a.elementType===e.ElementType?a:null};
a.prototype.slice=function(e,f){return new a(this.layout,this.buffer.slice(e*this.stride,f*this.stride))};a.prototype.copyFrom=function(a,e,c,b){var d=this.stride;0===d%4?(a=new Uint32Array(a.buffer,e*d,b*d/4),c=new Uint32Array(this.buffer,c*d,b*d/4)):(a=new Uint8Array(a.buffer,e*d,b*d),c=new Uint8Array(this.buffer,c*d,b*d));c.set(a)};return a}();a.InterleavedBuffer=e;var f=function(){function a(){this.stride=0;this.fields=new Map;this.fieldNames=[]}a.prototype.vec2f=function(a,e){this.appendField(a,
k.BufferViewVec2f,e);return this};a.prototype.vec2f64=function(a,e){this.appendField(a,k.BufferViewVec2f64,e);return this};a.prototype.vec3f=function(a,e){this.appendField(a,k.BufferViewVec3f,e);return this};a.prototype.vec3f64=function(a,e){this.appendField(a,k.BufferViewVec3f64,e);return this};a.prototype.vec4f=function(a,e){this.appendField(a,k.BufferViewVec4f,e);return this};a.prototype.vec4f64=function(a,e){this.appendField(a,k.BufferViewVec4f64,e);return this};a.prototype.mat3f=function(a,e){this.appendField(a,
k.BufferViewMat3f,e);return this};a.prototype.mat3f64=function(a,e){this.appendField(a,k.BufferViewMat3f64,e);return this};a.prototype.mat4f=function(a,e){this.appendField(a,k.BufferViewMat4f,e);return this};a.prototype.mat4f64=function(a,e){this.appendField(a,k.BufferViewMat4f64,e);return this};a.prototype.vec4u8=function(a,e){this.appendField(a,k.BufferViewVec4u8,e);return this};a.prototype.f32=function(a,e){this.appendField(a,k.BufferViewFloat,e);return this};a.prototype.f64=function(a,e){this.appendField(a,
k.BufferViewFloat64,e);return this};a.prototype.u8=function(a,e){this.appendField(a,k.BufferViewUint8,e);return this};a.prototype.u16=function(a,e){this.appendField(a,k.BufferViewUint16,e);return this};a.prototype.i8=function(a,e){this.appendField(a,k.BufferViewInt8,e);return this};a.prototype.vec2i8=function(a,e){this.appendField(a,k.BufferViewVec2i8,e);return this};a.prototype.vec2i16=function(a,e){this.appendField(a,k.BufferViewVec2i16,e);return this};a.prototype.vec2u8=function(a,e){this.appendField(a,
k.BufferViewVec2u8,e);return this};a.prototype.vec4u16=function(a,e){this.appendField(a,k.BufferViewVec4u16,e);return this};a.prototype.u32=function(a,e){this.appendField(a,k.BufferViewUint32,e);return this};a.prototype.appendField=function(a,e,c){var b=e.ElementCount*m.elementTypeSize(e.ElementType);this.fields.set(a,{size:b,constructor:e,offset:this.stride,optional:c});this.stride+=b;this.fieldNames.push(a)};a.prototype.alignTo=function(a){this.stride=Math.floor((this.stride+a-1)/a)*a;return this};
a.prototype.hasField=function(a){return 0<=this.fieldNames.indexOf(a)};a.prototype.createBuffer=function(a){return new e(this,a)};a.prototype.createView=function(a){return new e(this,a)};a.prototype.clone=function(){var e=new a;e.stride=this.stride;e.fields=new Map;this.fields.forEach(function(a,c){return e.fields.set(c,a)});e.fieldNames=this.fieldNames.slice();e.BufferType=this.BufferType;return e};return a}();a.InterleavedLayout=f;a.newLayout=function(){return new f}})},"esri/views/3d/support/buffer/BufferView":function(){define("require exports ../../../../core/tsSupport/extendsHelper ./internals/Mat3 ./internals/Mat4 ./internals/Scalar ./internals/Vec2 ./internals/Vec3 ./internals/Vec4".split(" "),
function(p,a,k,m,e,f,g,h,l){Object.defineProperty(a,"__esModule",{value:!0});p=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Float32Array,b,a,e,f)||this;b.elementType="f32";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="f32";return b}(f.BufferViewScalarImpl);a.BufferViewFloat=p;p=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Float32Array,b,a,e,f)||this;b.elementType="f32";return b}k(b,
c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="f32";return b}(g.BufferViewVec2Impl);a.BufferViewVec2f=p;p=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Float32Array,b,a,e,f)||this;b.elementType="f32";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="f32";return b}(h.BufferViewVec3Impl);a.BufferViewVec3f=p;p=function(c){function b(b,a,e,f){void 0===
a&&(a=0);b=c.call(this,Float32Array,b,a,e,f)||this;b.elementType="f32";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="f32";return b}(l.BufferViewVec4Impl);a.BufferViewVec4f=p;p=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Float32Array,b,a,e,f)||this;b.elementType="f32";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="f32";
return b}(m.BufferViewMat3Impl);a.BufferViewMat3f=p;m=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Float64Array,b,a,e,f)||this;b.elementType="f64";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="f64";return b}(m.BufferViewMat3Impl);a.BufferViewMat3f64=m;m=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Float32Array,b,a,e,f)||this;b.elementType="f32";return b}k(b,c);b.fromTypedArray=function(c,
a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="f32";return b}(e.BufferViewMat4Impl);a.BufferViewMat4f=m;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Float64Array,b,a,e,f)||this;b.elementType="f64";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="f64";return b}(e.BufferViewMat4Impl);a.BufferViewMat4f64=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,
Float64Array,b,a,e,f)||this;b.elementType="f64";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="f64";return b}(f.BufferViewScalarImpl);a.BufferViewFloat64=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Float64Array,b,a,e,f)||this;b.elementType="f64";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="f64";return b}(g.BufferViewVec2Impl);
a.BufferViewVec2f64=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Float64Array,b,a,e,f)||this;b.elementType="f64";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="f64";return b}(h.BufferViewVec3Impl);a.BufferViewVec3f64=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Float64Array,b,a,e,f)||this;b.elementType="f64";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,
c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="f64";return b}(l.BufferViewVec4Impl);a.BufferViewVec4f64=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Uint8Array,b,a,e,f)||this;b.elementType="u8";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="u8";return b}(f.BufferViewScalarImpl);a.BufferViewUint8=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Uint8Array,b,a,e,f)||this;
b.elementType="u8";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="u8";return b}(g.BufferViewVec2Impl);a.BufferViewVec2u8=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Uint8Array,b,a,e,f)||this;b.elementType="u8";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="u8";return b}(h.BufferViewVec3Impl);a.BufferViewVec3u8=e;e=function(c){function b(b,
a,e,f){void 0===a&&(a=0);b=c.call(this,Uint8Array,b,a,e,f)||this;b.elementType="u8";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="u8";return b}(l.BufferViewVec4Impl);a.BufferViewVec4u8=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Uint16Array,b,a,e,f)||this;b.elementType="u16";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType=
"u16";return b}(f.BufferViewScalarImpl);a.BufferViewUint16=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Uint16Array,b,a,e,f)||this;b.elementType="u16";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="u16";return b}(g.BufferViewVec2Impl);a.BufferViewVec2u16=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Uint16Array,b,a,e,f)||this;b.elementType="u16";return b}k(b,c);b.fromTypedArray=
function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="u16";return b}(h.BufferViewVec3Impl);a.BufferViewVec3u16=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Uint16Array,b,a,e,f)||this;b.elementType="u16";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="u16";return b}(l.BufferViewVec4Impl);a.BufferViewVec4u16=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=
0);b=c.call(this,Uint32Array,b,a,e,f)||this;b.elementType="u32";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="u32";return b}(f.BufferViewScalarImpl);a.BufferViewUint32=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Uint32Array,b,a,e,f)||this;b.elementType="u32";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="u32";return b}(g.BufferViewVec2Impl);
a.BufferViewVec2u32=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Uint32Array,b,a,e,f)||this;b.elementType="u32";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="u32";return b}(h.BufferViewVec3Impl);a.BufferViewVec3u32=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Uint32Array,b,a,e,f)||this;b.elementType="u32";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,
c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="u32";return b}(l.BufferViewVec4Impl);a.BufferViewVec4u32=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Int8Array,b,a,e,f)||this;b.elementType="i8";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="i8";return b}(f.BufferViewScalarImpl);a.BufferViewInt8=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Int8Array,b,a,e,f)||this;
b.elementType="i8";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="i8";return b}(g.BufferViewVec2Impl);a.BufferViewVec2i8=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Int8Array,b,a,e,f)||this;b.elementType="i8";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="i8";return b}(h.BufferViewVec3Impl);a.BufferViewVec3i8=e;e=function(c){function b(b,
a,e,f){void 0===a&&(a=0);b=c.call(this,Int8Array,b,a,e,f)||this;b.elementType="i8";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="i8";return b}(l.BufferViewVec4Impl);a.BufferViewVec4i8=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Int16Array,b,a,e,f)||this;b.elementType="i16";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType=
"i16";return b}(f.BufferViewScalarImpl);a.BufferViewInt16=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Int16Array,b,a,e,f)||this;b.elementType="i16";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="i16";return b}(g.BufferViewVec2Impl);a.BufferViewVec2i16=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Int16Array,b,a,e,f)||this;b.elementType="i16";return b}k(b,c);b.fromTypedArray=
function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="i16";return b}(h.BufferViewVec3Impl);a.BufferViewVec3i16=e;e=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Int16Array,b,a,e,f)||this;b.elementType="i16";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="i16";return b}(l.BufferViewVec4Impl);a.BufferViewVec4i16=e;f=function(c){function b(b,a,e,f){void 0===a&&(a=0);
b=c.call(this,Int32Array,b,a,e,f)||this;b.elementType="i32";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="i32";return b}(f.BufferViewScalarImpl);a.BufferViewInt32=f;g=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Int32Array,b,a,e,f)||this;b.elementType="i32";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="i32";return b}(g.BufferViewVec2Impl);
a.BufferViewVec2i32=g;h=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Int32Array,b,a,e,f)||this;b.elementType="i32";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="i32";return b}(h.BufferViewVec3Impl);a.BufferViewVec3i32=h;l=function(c){function b(b,a,e,f){void 0===a&&(a=0);b=c.call(this,Int32Array,b,a,e,f)||this;b.elementType="i32";return b}k(b,c);b.fromTypedArray=function(c,a){return new b(c.buffer,
c.byteOffset,a,c.byteOffset+c.byteLength)};b.ElementType="i32";return b}(l.BufferViewVec4Impl);a.BufferViewVec4i32=l})},"esri/views/3d/support/buffer/internals/Mat3":function(){define(["require","exports"],function(p,a){Object.defineProperty(a,"__esModule",{value:!0});p=function(){function a(a,e,f,g,h){void 0===f&&(f=0);this.TypedArrayConstructor=a;this.elementCount=9;a=this.TypedArrayConstructor;void 0===g&&(g=9*a.BYTES_PER_ELEMENT);var l=0===e.byteLength?0:f;this.typedBuffer=null==h?new a(e,l):
new a(e,l,(h-f)/a.BYTES_PER_ELEMENT);this.typedBufferStride=g/a.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}a.prototype.getMat=function(a,e){a*=this.typedBufferStride;for(var f=0;9>f;f++)e[f]=this.typedBuffer[a+f];return e};a.prototype.setMat=function(a,e){a*=this.typedBufferStride;for(var f=0;9>f;f++)this.typedBuffer[a+f]=e[f]};a.prototype.get=function(a,e){return this.typedBuffer[a*
this.typedBufferStride+e]};a.prototype.set=function(a,e,f){this.typedBuffer[a*this.typedBufferStride+e]=f};a.prototype.copyFrom=function(a,e,f){var g=this.typedBuffer,h=e.typedBuffer;a*=this.typedBufferStride;e=f*e.typedBufferStride;for(f=0;9>f;++f)g[a+f]=h[e+f]};Object.defineProperty(a.prototype,"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});a.ElementCount=9;return a}();a.BufferViewMat3Impl=p})},"esri/views/3d/support/buffer/internals/Mat4":function(){define(["require",
"exports"],function(p,a){Object.defineProperty(a,"__esModule",{value:!0});p=function(){function a(a,e,f,g,h){void 0===f&&(f=0);this.TypedArrayConstructor=a;this.elementCount=16;a=this.TypedArrayConstructor;void 0===g&&(g=16*a.BYTES_PER_ELEMENT);var l=0===e.byteLength?0:f;this.typedBuffer=null==h?new a(e,l):new a(e,l,(h-f)/a.BYTES_PER_ELEMENT);this.typedBufferStride=g/a.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}
a.prototype.getMat=function(a,e){a*=this.typedBufferStride;for(var f=0;16>f;f++)e[f]=this.typedBuffer[a+f];return e};a.prototype.setMat=function(a,e){a*=this.typedBufferStride;for(var f=0;16>f;f++)this.typedBuffer[a+f]=e[f]};a.prototype.get=function(a,e){return this.typedBuffer[a*this.typedBufferStride+e]};a.prototype.set=function(a,e,f){this.typedBuffer[a*this.typedBufferStride+e]=f};a.prototype.copyFrom=function(a,e,f){var g=this.typedBuffer,h=e.typedBuffer;a*=this.typedBufferStride;e=f*e.typedBufferStride;
for(f=0;16>f;++f)g[a+f]=h[e+f]};Object.defineProperty(a.prototype,"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});a.ElementCount=16;return a}();a.BufferViewMat4Impl=p})},"esri/views/3d/support/buffer/internals/Scalar":function(){define(["require","exports"],function(p,a){Object.defineProperty(a,"__esModule",{value:!0});p=function(){function a(a,e,f,g,h){void 0===f&&(f=0);this.TypedArrayConstructor=a;this.elementCount=1;a=this.TypedArrayConstructor;void 0===
g&&(g=a.BYTES_PER_ELEMENT);var l=0===e.byteLength?0:f;this.typedBuffer=null==h?new a(e,l):new a(e,l,(h-f)/a.BYTES_PER_ELEMENT);this.typedBufferStride=g/a.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}a.prototype.get=function(a){return this.typedBuffer[a*this.typedBufferStride]};a.prototype.set=function(a,e){this.typedBuffer[a*this.typedBufferStride]=e};Object.defineProperty(a.prototype,
"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});a.ElementCount=1;return a}();a.BufferViewScalarImpl=p})},"esri/views/3d/support/buffer/internals/Vec2":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec2"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});p=function(){function a(a,f,g,h,l){void 0===g&&(g=0);this.TypedArrayConstructor=a;this.elementCount=2;a=this.TypedArrayConstructor;void 0===h&&(h=2*a.BYTES_PER_ELEMENT);
var c=0===f.byteLength?0:g;this.typedBuffer=null==l?new a(f,c):new a(f,c,(l-g)/a.BYTES_PER_ELEMENT);this.typedBufferStride=h/a.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}a.prototype.getVec=function(a,f){return k.vec2.set(f,this.typedBuffer[a*this.typedBufferStride],this.typedBuffer[a*this.typedBufferStride+1])};a.prototype.setVec=function(a,f){this.typedBuffer[a*this.typedBufferStride]=
f[0];this.typedBuffer[a*this.typedBufferStride+1]=f[1]};a.prototype.get=function(a,f){return this.typedBuffer[a*this.typedBufferStride+f]};a.prototype.set=function(a,f,g){this.typedBuffer[a*this.typedBufferStride+f]=g};a.prototype.setValues=function(a,f,g){this.typedBuffer[a*this.typedBufferStride]=f;this.typedBuffer[a*this.typedBufferStride+1]=g};a.prototype.copyFrom=function(a,f,g){var e=this.typedBuffer,l=f.typedBuffer;a*=this.typedBufferStride;f=g*f.typedBufferStride;e[a]=l[f];e[a+1]=l[f+1]};
Object.defineProperty(a.prototype,"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});a.ElementCount=2;return a}();a.BufferViewVec2Impl=p})},"esri/views/3d/support/buffer/internals/Vec3":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec3"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});p=function(){function a(a,f,g,h,l){void 0===g&&(g=0);this.TypedArrayConstructor=a;this.elementCount=3;a=this.TypedArrayConstructor;
void 0===h&&(h=3*a.BYTES_PER_ELEMENT);var c=0===f.byteLength?0:g;this.typedBuffer=null==l?new a(f,c):new a(f,c,(l-g)/a.BYTES_PER_ELEMENT);this.typedBufferStride=h/a.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}a.prototype.getVec=function(a,f){return k.vec3.set(f,this.typedBuffer[a*this.typedBufferStride],this.typedBuffer[a*this.typedBufferStride+1],this.typedBuffer[a*this.typedBufferStride+
2])};a.prototype.setVec=function(a,f){this.typedBuffer[a*this.typedBufferStride]=f[0];this.typedBuffer[a*this.typedBufferStride+1]=f[1];this.typedBuffer[a*this.typedBufferStride+2]=f[2]};a.prototype.get=function(a,f){return this.typedBuffer[a*this.typedBufferStride+f]};a.prototype.set=function(a,f,g){this.typedBuffer[a*this.typedBufferStride+f]=g};a.prototype.setValues=function(a,f,g,h){this.typedBuffer[a*this.typedBufferStride]=f;this.typedBuffer[a*this.typedBufferStride+1]=g;this.typedBuffer[a*
this.typedBufferStride+2]=h};a.prototype.copyFrom=function(a,f,g){var e=this.typedBuffer,l=f.typedBuffer;a*=this.typedBufferStride;f=g*f.typedBufferStride;e[a]=l[f];e[a+1]=l[f+1];e[a+2]=l[f+2]};Object.defineProperty(a.prototype,"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});a.ElementCount=3;return a}();a.BufferViewVec3Impl=p})},"esri/views/3d/support/buffer/internals/Vec4":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec4"],
function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});p=function(){function a(a,f,g,h,l){void 0===g&&(g=0);this.TypedArrayConstructor=a;this.elementCount=4;a=this.TypedArrayConstructor;void 0===h&&(h=4*a.BYTES_PER_ELEMENT);var c=0===f.byteLength?0:g;this.typedBuffer=null==l?new a(f,c):new a(f,c,(l-g)/a.BYTES_PER_ELEMENT);this.typedBufferStride=h/a.BYTES_PER_ELEMENT;this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride);this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}
a.prototype.getVec=function(a,f){return k.vec4.set(f,this.typedBuffer[a*this.typedBufferStride],this.typedBuffer[a*this.typedBufferStride+1],this.typedBuffer[a*this.typedBufferStride+2],this.typedBuffer[a*this.typedBufferStride+3])};a.prototype.setVec=function(a,f){this.typedBuffer[a*this.typedBufferStride]=f[0];this.typedBuffer[a*this.typedBufferStride+1]=f[1];this.typedBuffer[a*this.typedBufferStride+2]=f[2];this.typedBuffer[a*this.typedBufferStride+3]=f[3]};a.prototype.get=function(a,f){return this.typedBuffer[a*
this.typedBufferStride+f]};a.prototype.set=function(a,f,g){this.typedBuffer[a*this.typedBufferStride+f]=g};a.prototype.setValues=function(a,f,g,h,l){this.typedBuffer[a*this.typedBufferStride]=f;this.typedBuffer[a*this.typedBufferStride+1]=g;this.typedBuffer[a*this.typedBufferStride+2]=h;this.typedBuffer[a*this.typedBufferStride+3]=l};a.prototype.copyFrom=function(a,f,g){var e=this.typedBuffer,l=f.typedBuffer;a*=this.typedBufferStride;f=g*f.typedBufferStride;e[a]=l[f];e[a+1]=l[f+1];e[a+2]=l[f+2];e[a+
3]=l[f+3]};Object.defineProperty(a.prototype,"buffer",{get:function(){return this.typedBuffer.buffer},enumerable:!0,configurable:!0});a.ElementCount=4;return a}();a.BufferViewVec4Impl=p})},"esri/views/3d/support/buffer/types":function(){define(["require","exports","../../../../core/compilerUtils"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});a.elementTypeSize=function(a){switch(a){case "u8":return 1;case "u16":return 2;case "u32":return 4;case "i8":return 1;case "i16":return 2;
case "i32":return 4;case "f32":return 4;case "f64":return 8;default:k.neverReached(a)}};a.isSigned=function(a){switch(a){case "u8":case "u16":case "u32":return!1;case "i8":case "i16":case "i32":case "f32":case "f64":return!0;default:k.neverReached(a)}};a.isInteger=function(a){switch(a){case "u8":case "u16":case "u32":case "i8":case "i16":case "i32":return!0;case "f32":case "f64":return!1;default:k.neverReached(a)}};a.maximumValue=function(a){switch(a){case "u8":return 255;case "u16":return 65535;
case "u32":return 4294967295;case "i8":return 127;case "i16":return 32767;case "i32":return 2147483647;case "f32":return 3.402823E38;case "f64":return 1.79769E308;default:k.neverReached(a)}}})},"esri/views/3d/webgl-engine/lib/GLMaterial":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ./AutoDisposable".split(" "),function(p,a,k,m,e,f){Object.defineProperty(a,"__esModule",{value:!0});
p=function(a){function f(e){var c=a.call(this)||this;c.material=e.material;c.techniqueRep=e.techniqueRep;c.output=e.output;return c}k(f,a);f.prototype.getTechnique=function(){return this.technique};f.prototype.getPipelineState=function(a,c){return this.getTechnique().pipeline};f.prototype.ensureResources=function(a){return 2};f.prototype.ensureParameters=function(a){};return f=m([e.subclass("esri.views.3d.webgl-engine.lib.GLMaterial")],f)}(e.declared(f.AutoDisposable));a.GLMaterial=p})},"esri/views/3d/webgl-engine/lib/AutoDisposable":function(){define(["require",
"exports","../../../../core/tsSupport/declareExtendsHelper","../../../../core/tsSupport/decorateHelper","../../../../core/accessorSupport/decorators"],function(p,a,k,m,e){Object.defineProperty(a,"__esModule",{value:!0});a.AutoDisposableMixin=function(a){return function(a){function f(){var e=null!==a&&a.apply(this,arguments)||this;e._isDisposed=!1;return e}k(f,a);f.prototype.dispose=function(){for(var a=this.__proto__.__managedDisposables__||[],c=a.length-1;0<=c;c--){var b=a[c];this[b]&&"function"===
typeof this[b].dispose&&this[b].dispose();this[b]=null}this._isDisposed=!0};Object.defineProperty(f.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!0,configurable:!0});return f=m([e.subclass("esri.views.3d.webgl-engine.lib.AutoDisposableMixin")],f)}(e.declared(a))};p=function(a){function f(){return null!==a&&a.apply(this,arguments)||this}k(f,a);return f=m([e.subclass("esri.views.3d.webgl-engine.lib.AutoDisposable")],f)}(e.declared(a.AutoDisposableMixin(function(){return function(){}}())));
a.AutoDisposable=p;a.autoDispose=function(){return function(a,e){a.__managedDisposables__=a.__managedDisposables__||[];a.__managedDisposables__.push(e)}}})},"esri/views/3d/webgl-engine/lib/Material":function(){define(["require","exports","../../../../core/maybe","./IdGen"],function(p,a,k,m){Object.defineProperty(a,"__esModule",{value:!0});p=function(){function a(e){this.supportsEdges=!1;this._visible=!0;this._renderOccluded=1;this._renderPriority=0;this.id=a._idGen.gen(e)}a.prototype.dispose=function(){};
a.prototype.update=function(a){return!1};Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},set:function(a){a!==this._visible&&(this._visible=a,this.parametersChanged())},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"renderOccluded",{get:function(){return this._renderOccluded},set:function(a){a!==this._renderOccluded&&(this._renderOccluded=a,this.parametersChanged())},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"renderPriority",
{get:function(){return this._renderPriority},set:function(a){a!==this._renderPriority&&(this._renderPriority=a,this.parametersChanged())},enumerable:!0,configurable:!0});a.prototype.isVisibleInPass=function(a){return!0};a.prototype.isVisible=function(){return this._visible};a.prototype.parametersChanged=function(){k.isSome(this.materialRepository)&&this.materialRepository.materialChanged(this)};a._idGen=new m.IdGen;return a}();a.Material=p;a.materialPredicate=function(a,f){return a.isVisible()&&a.isVisibleInPass(f.pass)&&
0!==(a.renderOccluded&f.renderOccludedMask)}})},"esri/views/3d/webgl-engine/materials/VisualVariableMaterialParameters":function(){define(["require","exports","../../../../core/libs/gl-matrix-2/mat3f64","../../../../core/libs/gl-matrix-2/vec3f32"],function(p,a,k,m){var e;(e||(e={})).Default={vvSizeEnabled:!1,vvSizeMinSize:m.vec3f32.fromValues(1,1,1),vvSizeMaxSize:m.vec3f32.fromValues(100,100,100),vvSizeOffset:m.vec3f32.fromValues(0,0,0),vvSizeFactor:m.vec3f32.fromValues(1,1,1),vvSizeValue:m.vec3f32.fromValues(1,
1,1),vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvOpacityEnabled:!1,vvOpacityValues:[0,0,0,0,0,0,0,0],vvOpacityOpacities:[1,1,1,1,1,1,1,1],vvSymbolAnchor:[0,0,0],vvSymbolRotationMatrix:k.mat3f64.create()};return e})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["require","exports","./factories/vec3f32"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});a.vec3f32=k})},"esri/core/libs/gl-matrix-2/factories/vec3f32":function(){define(["require",
"exports"],function(p,a){function k(){return new Float32Array(3)}function m(a,c,b){var d=new Float32Array(3);d[0]=a;d[1]=c;d[2]=b;return d}function e(){return m(1,1,1)}function f(){return m(1,0,0)}function g(){return m(0,1,0)}function h(){return m(0,0,1)}Object.defineProperty(a,"__esModule",{value:!0});a.create=k;a.clone=function(a){var c=new Float32Array(3);c[0]=a[0];c[1]=a[1];c[2]=a[2];return c};a.fromValues=m;a.createView=function(a,c){return new Float32Array(a,c,3)};a.zeros=function(){return k()};
a.ones=e;a.unitX=f;a.unitY=g;a.unitZ=h;a.ZEROS=k();a.ONES=e();a.UNIT_X=f();a.UNIT_Y=g();a.UNIT_Z=h()})},"esri/views/3d/webgl-engine/materials/internal/MaterialUtil":function(){define("require exports ../../../../../core/tsSupport/assignHelper ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../core/libs/gl-matrix-2/vec4 ../../../../../geometry/support/aaBoundingBox ../../lib/ComponentUtils ../../lib/screenSizePerspectiveUtils ../../lib/Util".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n,t){function r(a,c,d,f,h,g){var l=q(c,d,C);b.setMin(A,a.getBBMin());b.setMax(A,a.getBBMax());e.isSome(h)&&h.applyToAABB(A);if(E(A,c,l,f)){var l=a.getPrimitiveIndices(),m=a.getIndices(),k=a.getPosition(),n=l?l.length:m.length/3;if(n>G&&(a=a.getChildren(),void 0!==a)){for(l=0;8>l;++l)void 0!==a[l]&&r(a[l],c,d,f,h,g);return}w(c,d,0,n,m,k,l,h,g)}}function w(b,a,c,d,f,h,g,l,m){var k,n,q;if(g){var r,t,p=h.data,v=h.offsetIdx;h=h.strideIdx;var w=b[0],D=b[1];b=b[2];var y=
a[0]-w,x=a[1]-D;for(a=a[2]-b;c<d;++c){var A=g[c],H=3*A;t=v+h*f[H++];var z=p[t++],B=p[t++];k=p[t];t=v+h*f[H++];var I=p[t++];n=p[t++];r=p[t];t=v+h*f[H];H=p[t++];q=p[t++];t=p[t];e.isSome(l)&&(k=l.applyToVertex(z,B,k),z=k[0],B=k[1],k=k[2],r=l.applyToVertex(I,n,r),I=r[0],n=r[1],r=r[2],t=l.applyToVertex(H,q,t),H=t[0],q=t[1],t=t[2]);I-=z;n-=B;r-=k;H-=z;q-=B;t-=k;var C=x*t-q*a,G=a*H-t*y,N=y*q-H*x,J=I*C+n*G+r*N;if(!(Math.abs(J)<=L)){z=w-z;B=D-B;k=b-k;C=z*C+B*G+k*N;if(0<J){if(0>C||C>J)continue}else if(0<C||
C<J)continue;G=B*r-n*k;k=k*I-r*z;B=z*n-I*B;z=y*G+x*k+a*B;if(0<J){if(0>z||C+z>J)continue}else if(0<z||C+z<J)continue;B=(H*G+q*k+t*B)/J;0<=B&&(I=u(I,n,r,H,q,t,R),m(B,I,A))}}}else for(g=h.data,p=h.offsetIdx,v=h.strideIdx,h=b[0],w=b[1],D=b[2],b=a[0]-h,y=a[1]-w,x=a[2]-D,a=c,c*=3;a<d;++a)if(q=p+v*f[c++],z=g[q++],B=g[q++],k=g[q],q=p+v*f[c++],A=g[q++],I=g[q++],n=g[q],q=p+v*f[c++],r=g[q++],H=g[q++],q=g[q],e.isSome(l)&&(k=l.applyToVertex(z,B,k),z=k[0],B=k[1],k=k[2],n=l.applyToVertex(A,I,n),A=n[0],I=n[1],n=
n[2],q=l.applyToVertex(r,H,q),r=q[0],H=q[1],q=q[2]),A-=z,I-=B,n-=k,r-=z,H-=B,q-=k,J=y*q-H*x,C=x*r-q*b,G=b*H-r*y,t=A*J+I*C+n*G,!(Math.abs(t)<=L)){z=h-z;B=w-B;k=D-k;J=z*J+B*C+k*G;if(0<t){if(0>J||J>t)continue}else if(0<J||J<t)continue;C=B*n-I*k;k=k*A-n*z;B=z*I-A*B;z=b*C+y*k+x*B;if(0<t){if(0>z||J+z>t)continue}else if(0<z||J+z<t)continue;B=(r*C+H*k+q*B)/t;0<=B&&(A=u(A,I,n,r,H,q,R),m(B,A,a))}}function u(b,a,c,d,e,f,g){h.vec3.set(K,b,a,c);h.vec3.set(D,d,e,f);h.vec3.cross(g,K,D);h.vec3.normalize(g,g);return g}
function q(b,a,c){return h.vec3.set(c,1/(a[0]-b[0]),1/(a[1]-b[1]),1/(a[2]-b[2]))}function E(b,a,c,d){return x(b,a,c,d,Infinity)}function x(b,a,c,d,e){var f=(b[0]-d-a[0])*c[0],h=(b[3]+d-a[0])*c[0],g=Math.min(f,h),f=Math.max(f,h),h=(b[1]-d-a[1])*c[1],l=(b[4]+d-a[1])*c[1],f=Math.min(f,Math.max(h,l));if(0>f)return!1;g=Math.max(g,Math.min(h,l));if(g>f)return!1;h=(b[2]-d-a[2])*c[2];b=(b[5]+d-a[2])*c[2];f=Math.min(f,Math.max(h,b));if(0>f)return!1;g=Math.max(g,Math.min(h,b));return g>f?!1:g<e}function z(b,
a){a=a?z(a):{};for(var c in b){var d=b[c];d&&d.forEach&&(d=y(d));null==d&&c in a||(a[c]=d)}return a}function y(b){var a=[];b.forEach(function(b){return a.push(b)});return a}Object.defineProperty(a,"__esModule",{value:!0});var v=g.mat4f64.create(),A=b.create(),B=t.VertexAttrConstants;a.intersectTriangleGeometry=function(a,c,f,h,g,l,k){c=c&&c.componentVisibilities;f=f.tolerance;if(1<a.componentCount)a:{var m=q(h,g,C),n=a.componentCount,p=a.componentOffsets,u=a.getIndices(B.POSITION),v=a.getAttribute(B.POSITION),
D=a.boundingInfo;if(D&&(b.setMin(A,D.getBBMin()),b.setMax(A,D.getBBMax()),e.isSome(l)&&l.applyToAABB(A),!E(A,h,m,f)))break a;for(D=0;D<n;D++)if(!c||d.getVisibility(c,D)){if(a.getComponentAABB){var y=a.getComponentAABB(D,A);e.isSome(l)&&l.applyToAABB(y);if(!E(y,h,m,f))continue}w(h,g,p[D]/3,p[D+1]/3,u,v,void 0,l,k)}}else if(!c||d.getVisibility(c,0))a.boundingInfo?(t.assert("triangle"===a.data.primitiveType),r(a.boundingInfo,h,g,f,l,k)):(c=a.getIndices(B.POSITION),a=a.getAttribute(B.POSITION),w(h,g,
0,c.length/3,c,a,void 0,l,k))};var C=l.vec3f64.create(),L=Math.pow(2,-52),R=l.vec3f64.create();a.intersectTriangles=w;var K=l.vec3f64.create(),D=l.vec3f64.create();a.computeNormal=u;a.computeInvDir=q;a.intersectAabbInvDir=E;a.intersectAabbInvDirBefore=x;a.transformToWorld=function(b,a,d){return c.vec4.set(d,b[0]-a[0],b[1]-a[1],b[2]-a[2],1)};a.transformToView=function(b,a,d,e){f.mat4.translate(v,d,a);return c.vec4.transformMat4(e,b,v)};a.transformToProjection=function(b,a,d,e){e[0]=b[0]+d[0];e[1]=
b[1]+d[1];e[2]=b[2]+d[2];e[3]=b[3];return c.vec4.transformMat4(e,e,a)};a.transformToNDC=function(b,a){return c.vec4.scale(a,b,1/Math.abs(b[3]))};a.verticalOffsetAtDistance=function(b,a,c,d,e){var f=(c.screenLength||0)*b.pixelRatio;e&&(f=n.scale(f,d,a,e));return m.glClamp(f*Math.tan(.5*b.fovY)/(.5*b.fullHeight)*a,c.minWorldLength||0,null!=c.maxWorldLength?c.maxWorldLength:Infinity)};a.acquireIfNotUndefined=function(b,a,c){if(void 0!==b)return a.acquire(b,c)};a.releaseIfNotUndefined=function(b,a){void 0!==
b&&a.release(b)};a.bindScreenSizePerspective=function(b,a,c){void 0===c&&(c="screenSizePerspectiveAlignment");if(b){var d=b.parameters;a.setUniform4f(c,d.divisor,d.offset,d.minPixelSize,b.paddingPixelsOverride)}};a.copyParameters=z;a.updateParameters=function(b,a){var c=!1,d;for(d in a){var e=a[d];void 0!==e&&(c=!0,Array.isArray(e)?b[d]=e.slice():b[d]=e)}return c};a.intersectDrapedRenderLineGeometry=function(b,a,c,d,e){if(a.options.selectionMode){a=b.getAttribute(B.POSITION).data;var f=b.getAttribute(B.SIZE),
h=c[0];c=c[1];b=(((f&&f.data[0])+d)/2+4)*b.pixelRatio;d=Number.MAX_VALUE;for(f=0;f<a.length-5;f+=3){var g=a[f],l=a[f+1],k=h-g,n=c-l,g=a[f+3]-g,l=a[f+4]-l,q=m.clamp((g*k+l*n)/(g*g+l*l),0,1),k=g*q-k,n=l*q-n,n=k*k+n*n;n<d&&(d=n)}d<b*b&&e()}};a.colorMixModes={multiply:1,ignore:2,replace:3,tint:4};var G=1E3})},"esri/views/3d/webgl-engine/lib/screenSizePerspectiveUtils":function(){define(["require","exports","../../../../core/mathUtils","../../support/earthUtils"],function(p,a,k,m){function e(b){return Math.abs(b*
b*b)}function f(b,a,c,f){void 0===f&&(f=d);var g=c.parameters;c=c.paddingPixelsOverride;f.scale=Math.min(g.divisor/(a-g.offset),1);f.factor=e(b);f.minPixelSize=g.minPixelSize;f.paddingPixels=c;return f}function g(b,a){return 0===b?a.minPixelSize:a.minPixelSize*(1+2*a.paddingPixels/b)}function h(b,a){return Math.max(k.lerp(b*a.scale,b,a.factor),g(b,a))}function l(b,a,c){b=f(b,a,c);b.minPixelSize=0;b.paddingPixels=0;return h(1,b)}Object.defineProperty(a,"__esModule",{value:!0});a.getSettings=function(b){return new c(b,
a.defaultDescription)};a.getLabelSettings=function(d){var e=a.defaultDescription.curvatureDependent;return new c(d,{curvatureDependent:{min:{curvature:e.min.curvature,tiltAngle:e.min.tiltAngle,scaleFallOffFactor:b.curvatureDependent.min.scaleFallOffFactor},max:{curvature:e.max.curvature,tiltAngle:e.max.tiltAngle,scaleFallOffFactor:b.curvatureDependent.max.scaleFallOffFactor}},scaleStart:a.defaultDescription.scaleStart,scaleFallOffRange:a.defaultDescription.scaleFallOffRange,minPixelSize:b.minPixelSize})};
a.perspectiveFactor=e;a.scaleFactor=f;a.applyScaleFactor=h;a.applyScaleFactorVec2=function(b,a,c){void 0===c&&(c=[0,0]);var d=Math.min(Math.max(a.scale,g(b[1],a)/b[1]),1);c[0]=k.lerp(b[0]*d,b[0],a.factor);c[1]=k.lerp(b[1]*d,b[1],a.factor);return c};a.precomputeScale=l;a.precomputeScaleFactor=function(b,a,c,d){d.scale=l(b,a,c);d.factor=0;d.minPixelSize=c.parameters.minPixelSize;d.paddingPixels=c.paddingPixelsOverride;return d};a.applyPrecomputedScaleFactorVec2=function(b,a,c){void 0===c&&(c=[0,0]);
a=Math.min(Math.max(a.scale,g(b[1],a)/b[1]),1);c[0]=b[0]*a;c[1]=b[1]*a;return c};a.scale=function(b,a,c,d){return h(b,f(a,c,d))};var c=function(){function b(b,a,c,d){void 0===c&&(c={camera:{distance:0,fovY:0},divisor:0,offset:0,minPixelSize:0,paddingPixels:0});this.viewingMode=b;this.description=a;this.parameters=c;this._paddingPixelsOverride=d;"local"===this.viewingMode?(this.coverageCompensation=this.surfaceCoverageCompensationLocal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersLocal):
(this.coverageCompensation=this.surfaceCoverageCompensationGlobal,this.calculateCurvatureDependentParameters=this.calculateCurvatureDependentParametersGlobal)}Object.defineProperty(b.prototype,"paddingPixelsOverride",{get:function(){return this._paddingPixelsOverride||this.parameters.paddingPixels},enumerable:!0,configurable:!0});b.prototype.update=function(b){if(this.parameters&&this.parameters.camera.fovY===b.fovY&&this.parameters.camera.distance===b.distance)return!1;this.calculateParameters(b,
this.parameters);return!0};b.prototype.overridePadding=function(a){return a!==this.paddingPixelsOverride?new b(this.viewingMode,this.description,this.parameters,a):this};b.prototype.calculateParameters=function(b,a){var c=this.description,d=c.scaleStart,e=c.scaleFallOffRange,c=c.minPixelSize,f=b.fovY,g=b.distance,h=this.calculateCurvatureDependentParameters(b),l=this.coverageCompensation(b,h),k=h.tiltAngle,h=h.scaleFallOffFactor,g=Math.sin(k)*g,k=.5*Math.PI-k-f*(.5-d*l),d=g/Math.cos(k),e=(d-g/Math.cos(k+
f*e*l)*h)/(1-h);a.camera.fovY=b.fovY;a.camera.distance=b.distance;a.offset=e;a.divisor=d-e;a.minPixelSize=c;return a};b.prototype.calculateCurvatureDependentParametersLocal=function(b,a){void 0===a&&(a=n);a.tiltAngle=this.description.curvatureDependent.min.tiltAngle;a.scaleFallOffFactor=this.description.curvatureDependent.min.scaleFallOffFactor;return a};b.prototype.calculateCurvatureDependentParametersGlobal=function(b,a){void 0===a&&(a=n);var c=this.description.curvatureDependent;b=1+b.distance/
m.earthRadius;var d=[c.min.curvature,c.max.curvature],e=d[0];b=k.clamp((Math.sqrt(b*b-1)-e)/(d[1]-e),0,1);d=[c.min,c.max];c=d[0];d=d[1];a.tiltAngle=k.lerp(c.tiltAngle,d.tiltAngle,b);a.scaleFallOffFactor=k.lerp(c.scaleFallOffFactor,d.scaleFallOffFactor,b);return a};b.prototype.surfaceCoverageCompensationLocal=function(b,a){return(b.fovY-a.tiltAngle)/b.fovY};b.prototype.surfaceCoverageCompensationGlobal=function(b,a){var c=m.earthRadius*m.earthRadius;a=a.tiltAngle+.5*Math.PI;var d=b.fovY;b=b.distance;
b=b*b+c-2*Math.cos(a)*b*m.earthRadius;var e=Math.sqrt(b);return(Math.acos(Math.sqrt(b-c)/e)-Math.asin(m.earthRadius/(e/Math.sin(a)))+.5*d)/d};return b}();a.defaultDescription={curvatureDependent:{min:{curvature:k.deg2rad(10),tiltAngle:k.deg2rad(12),scaleFallOffFactor:.5},max:{curvature:k.deg2rad(70),tiltAngle:k.deg2rad(40),scaleFallOffFactor:.8}},scaleStart:.3,scaleFallOffRange:.65,minPixelSize:0};var b={curvatureDependent:{min:{scaleFallOffFactor:.7},max:{scaleFallOffFactor:.95}},minPixelSize:14};
a.copyParameters=function(b,a){a.camera.distance=b.camera.distance;a.camera.fovY=b.camera.fovY;a.divisor=b.divisor;a.offset=b.offset;a.minPixelSize=b.minPixelSize;return a};var d={scale:0,factor:0,minPixelSize:0,paddingPixels:0},n={tiltAngle:0,scaleFallOffFactor:0}})},"esri/views/3d/webgl-engine/materials/renderers/MergedRenderer":function(){define("require exports ../../../../../core/MapUtils ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../../support/buffer/glUtil ../../lib/DefaultVertexAttributeLocations ../../lib/IntervalUtilities ../../lib/ResizableFloat32Array ../../lib/Util ../WaterGLMaterial ./Instance ./utils ../../../../webgl/BufferObject ../../../../webgl/Util ../../../../webgl/VertexArrayObject".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n,t,r,w,u){function q(b,a,c,d){for(var e=new Map,f=a.vertexBufferLayout.stride/4,g=function(c,d){var g=c.origin,h=b.get(g.id),l=e.get(g.id);null==l&&(l={optimalCount:null==h?0:h.optimalCount,sparseCount:null==h?0:h.buffer.size,toAdd:[],toRemove:[],origin:g.vec3},e.set(g.id,l));g=a.elementCount(c.data)*f;d?(l.optimalCount+=g,l.sparseCount+=g,l.toAdd.push(c)):(l.optimalCount-=g,l.toRemove.push(c))},h=0;h<c.length;h++){var l=c[h];g(l,!0)}for(c=0;c<d.length;c++)l=d[c],
g(l,!1);return e}p=function(){function a(b,a,c,d){void 0===d&&(d=h.Default3D);this.type="MergedRenderer";this._dataByOrigin=new Map;this._highlightCount=0;this._hasOccludees=!1;this._rctx=b;this._vertexAttributeLocations=d;this._material=c;this._materialRep=a;this._glMaterials=t.acquireMaterials(this._material,this._materialRep);this._bufferWriter=c.createBufferWriter()}a.prototype.dispose=function(){t.releaseMaterials(this._material,this._materialRep)};Object.defineProperty(a.prototype,"isEmpty",
{get:function(){return 0===this._dataByOrigin.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasHighlights",{get:function(){return 0<this._highlightCount},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasOccludees",{get:function(){return this._hasOccludees},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasWater",{get:function(){return!this.isEmpty&&k.someMap(this._glMaterials,function(b){return b instanceof d.WaterGLMaterial})},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"rendersOccluded",{get:function(){return!this.isEmpty&&1!==this._material.renderOccluded},enumerable:!0,configurable:!0});a.prototype.modify=function(b){var a=this,c=v;c.clear();this.updateGeometries(b.toUpdate,c);this.addAndRemoveGeometries(b.toAdd,b.toRemove,c);this.updateHighlightCount();this.updateOccludeeFlag();c.forEach(function(b){return a.updateDisplayedIndexRanges(b)})};a.prototype.addAndRemoveGeometries=function(a,c,d){var e=this,f=this._bufferWriter,
g=f.vertexBufferLayout,h=g.stride/4,l=this._dataByOrigin,k=q(l,f,a,c);k.forEach(function(a,c){k.delete(c);var f=a.optimalCount,m=a.sparseCount,n=l.get(c);null==n&&(b.assert(0<f),n=e.createData(g,f,a.origin),l.set(c,n));if(0===f)n.vao.dispose(!0),n.vao=null,l.delete(c);else{var q=f<a.sparseCount/2;c=E;var t=n.buffer.size,p=n.buffer.array,f=n.buffer.resize(q?f:m,!1);q||f?e.removeAndRebuild(n,a.toRemove,h,p,c):0<a.toRemove.length?(e.removeByErasing(n,a.toRemove,h,c),0<a.toAdd.length&&(c.end=t)):(c.begin=
t,c.end=t);f=x;b.setMatrixTranslation3(f,-a.origin[0],-a.origin[1],-a.origin[2]);e.append(n,a.toAdd,h,f,c);a=n.vao.vertexBuffers.geometry;a.byteSize!==n.buffer.array.buffer.byteLength?a.setData(n.buffer.array):(m=c.begin,f=c.end,m<f&&(m*=4,a.setSubData(n.buffer.array,m,m,4*f)));(c.updatedDisplayedIndexRange||n.displayedIndexRanges)&&d.add(n)}})};a.prototype.updateGeometries=function(a,c){for(var d=this._bufferWriter,e=d.vertexBufferLayout.stride/4,f=0;f<a.length;f++){var g=a[f],h=g.updateType,g=g.renderGeometry,
l=this._dataByOrigin.get(g.origin.id),k=l&&l.instances.get(g.uniqueName);if(!k)break;h&1&&(k.isHidden=t.checkIsHidden(g),c.add(l));h&9&&(k.highlightedIndexRanges=t.generateRenderGeometryHighlightRanges(g),l.highlightCount=null);h&16&&(k.hasOccludees=!!g.instanceParameters.occludees);h&6&&(h=l.buffer.array,l=l.vao,t.calculateTransformRelToOrigin(g,z,y),d.write({transformation:z,invTranspTransformation:y},g.data,d.vertexBufferLayout.createView(h.buffer),k.from),b.assert(k.from+d.elementCount(g.data)===
k.to,"material VBO layout has changed"),l.vertexBuffers.geometry.setSubData(h,k.from*e*4,k.from*e*4,k.to*e*4))}};a.prototype.updateDisplayedIndexRanges=function(b){b.displayedIndexRanges=[];var a=!0;b.instances.forEach(function(c){c.isHidden?a=!1:b.displayedIndexRanges.push([c.from,c.to-1])});b.displayedIndexRanges=a?null:l.mergeIntervals(b.displayedIndexRanges)};a.prototype.updateHighlightCount=function(){var b=this;this._highlightCount=0;this._dataByOrigin.forEach(function(a){if(null==a.highlightCount){var c=
0;a.instances.forEach(function(b){b.highlightedIndexRanges&&++c});a.highlightCount=c}b._highlightCount+=a.highlightCount})};a.prototype.updateOccludeeFlag=function(){this._hasOccludees=k.someMap(this._dataByOrigin,function(b){b.hasOccludees=k.someMap(b.instances,function(b){return b.hasOccludees});return b.hasOccludees})};a.prototype.updateLogic=function(b){return this._material.update(b)};a.prototype.render=function(b,a,c,d){var e=this,g=this._rctx,h=this._glMaterials.get(a.pass),l=4===a.pass,k=
b;2===a.pass&&null===k&&(k=22);if(!h||2!==h.ensureResources(g)||null!=k&&!h.beginSlot(k)||l&&0===this._highlightCount)return!1;h.ensureParameters(c);var m=h.getTechnique(),n=h.getPipelineState(k,!1);g.setPipelineState(n);h.bind(g,c);m.program.setUniformMatrix4fv("model",f.mat4f64.IDENTITY);m.program.hasUniform("modelNormal")&&m.program.setUniformMatrix4fv("modelNormal",f.mat4f64.IDENTITY);var q=!1;this._dataByOrigin.forEach(function(b){if(!l||0!==b.highlightCount)if(c.origin=b.origin,m.bindDraw(c),
m.ensureAttributeLocations(b.vao),g.bindVAO(b.vao),l)q=e.renderHighlightPass(m,b,d)||q;else if(b.hasOccludees){var a=h.getPipelineState(k,!0);q=e.renderDefaultPassWithOccludees(m,b,n,a,d)||q}else q=e.renderDefaultPass(m,b,d)||q});return q};a.prototype.renderDefaultPass=function(b,a,c){var d=this._rctx,e=a.displayedIndexRanges;if(e&&0===e.length)return!1;e?t.drawArraysFaceRange(d,e,0,b.primitiveType,c):(a=4*a.buffer.size/w.getStride(a.vao.layout.geometry),t.drawArrays(d,b.primitiveType,0,a,c));return!0};
a.prototype.renderDefaultPassWithOccludees=function(b,a,c,d,e){var f=this._rctx,g=a.displayedIndexRanges;if(g&&0===g.length)return!1;a.instances.forEach(function(a){a.isHidden||(a.hasOccludees&&f.setPipelineState(d),t.drawArrays(f,b.primitiveType,a.from,a.to-a.from,e),a.hasOccludees&&f.setPipelineState(c))});return!0};a.prototype.renderHighlightPass=function(b,a,c){var d=this._rctx,e=!1;a.instances.forEach(function(a){var f=a.highlightedIndexRanges;if(f&&0!==f.length)for(var g=0;g<f.length;g++){var h=
f[g];t.drawArrays(d,b.primitiveType,h?h[0]+a.from:a.from,h?h[1]-h[0]+1:a.to-a.from,c);e=!0}});return e};a.prototype.createData=function(b,a,d){return{instances:new Map,vao:new u(this._rctx,this._vertexAttributeLocations,{geometry:g.glLayout(b)},{geometry:r.createVertex(this._rctx,35044)}),buffer:new c.ResizableFloat32Array(a),optimalCount:0,origin:d,highlightCount:0,hasOccludees:!1}};a.prototype.removeAndRebuild=function(b,a,c,d,e){for(var f=0;f<a.length;f++){var g=a[f].uniqueName,h=b.instances.get(g);
b.optimalCount-=(h.to-h.from)*c;b.instances.delete(g)}var l=0,k=b.buffer.array;e.begin=0;e.end=0;var m=-1,n=-1,q=0;b.instances.forEach(function(b){var a=b.from*c,e=b.to*c,f=e-a;m!==n&&n!==a?(k.set(d.subarray(m,n),q),q+=n-m,m=a):-1===m&&(m=a);n=e;b.from=l/c;l+=f;b.to=l/c});m!==n&&k.set(d.subarray(m,n),q);e.end=l};a.prototype.removeByErasing=function(b,a,c,d){d.begin=Infinity;d.end=-Infinity;for(var e=-1,f=-1,g=0;g<a.length;g++){var h=a[g].uniqueName,l=b.instances.get(h),k=l.from*c,l=l.to*c;e!==f&&
f!==k?(b.buffer.erase(e,f),e=k):-1===e&&(e=k);f=l;b.instances.delete(h);b.optimalCount-=l-k;k<d.begin&&(d.begin=k);l>d.end&&(d.end=l)}e!==f&&b.buffer.erase(e,f)};a.prototype.append=function(a,c,d,f,g){g.updatedDisplayedIndexRange=!1;for(var h=this._bufferWriter,l=0;l<c.length;l++){var k=c[l],q=k.data,p=m.isSome(k.transformation)?e.mat4.multiply(z,f,k.transformation):f;e.mat4.invert(y,p);e.mat4.transpose(y,y);var r=g.end;h.write({transformation:p,invTranspTransformation:y},q,h.vertexBufferLayout.createView(a.buffer.array.buffer),
g.end/d);var q=h.elementCount(q)*d,v=r+q;b.assert(null==a.instances.get(k.uniqueName));var p=t.checkIsHidden(k),u=t.generateRenderGeometryHighlightRanges(k),w=!!k.instanceParameters.occludees;u&&(a.highlightCount=null);w&&(a.hasOccludees=a.hasOccludees||!0);r=new n.Instance(r/d,v/d,p,u,w);a.instances.set(k.uniqueName,r);p&&(g.updatedDisplayedIndexRange=!0);a.optimalCount+=q;g.end+=q}};Object.defineProperty(a.prototype,"test",{get:function(){return{material:this._material}},enumerable:!0,configurable:!0});
return a}();var E={updatedDisplayedIndexRange:!1,begin:0,end:0},x=f.mat4f64.create(),z=f.mat4f64.create(),y=f.mat4f64.create(),v=new Set;return p})},"esri/views/3d/support/buffer/glUtil":function(){define(["require","exports","../../../../core/tsSupport/assignHelper"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});var m={divisor:0};a.glLayout=function(a,g){void 0===g&&(g={});g=k({},m,g);var f=a.stride;return a.fieldNames.filter(function(e){e=a.fields.get(e).optional;return!(e&&e.glPadding)}).map(function(h){var c=
a.fields.get(h),b=c.constructor.ElementCount;var d=e[c.constructor.ElementType];if(!d)throw Error("BufferType not supported in WebGL");return{name:h,stride:f,count:b,type:d,offset:c.offset,normalized:!(!c.optional||!c.optional.glNormalized),divisor:g.divisor}})};var e={u8:5121,u16:5123,u32:5125,i8:5120,i16:5122,i32:5124,f32:5126}})},"esri/views/3d/webgl-engine/lib/DefaultVertexAttributeLocations":function(){define(["require","exports"],function(p,a){Object.defineProperty(a,"__esModule",{value:!0});
a.Default3D={position:0,normal:1,normalCompressed:1,uv0:2,color:3,size:4,tangent:4,auxpos1:5,symbolColor:5,componentIndex:5,auxpos2:6,featureAttribute:6,instanceFeatureAttribute:6,region:7,instanceColor:7,model:8,modelNormal:12,modelOriginHi:11,modelOriginLo:15}})},"esri/views/3d/webgl-engine/lib/IntervalUtilities":function(){define(["require","exports"],function(p,a){return function(){function a(){}a.copyIntervals=function(a){for(var e=[],f=0;f<a.length;f++){var g=a[f];e.push([g[0],g[1]])}return e};
a.convertFaceToIndexRange=function(a,e){for(var f=0;f<a.length;f++){var g=a[f];g[0]*=e;g[1]=g[1]*e+(e-1)}};a.sortIntervals=function(a){return a.sort(function(a,f){return a[0]===f[0]?a[1]>f[1]?1:a[1]<f[1]?-1:0:a[0]>f[0]?1:a[0]<f[0]?-1:0})};a.intersectIntervals=function(a,e){if(0>=a.length)return[];for(var f=[],g=0;g<a.length;g++){var h=a[g];h[1]<e[0]||h[0]>e[1]||(h=[h[0],h[1]],h[0]<e[0]&&(h[0]=e[0]),h[1]>e[1]&&(h[1]=e[1]),f.push(h))}return f};a.mergeIntervals=function(a){if(0>=a.length)return[];var e=
[];a=this.sortIntervals(a);e.push(a[0]);for(var f=1;f<a.length;f++){var g=e[e.length-1];g[1]+1<a[f][0]?e.push(a[f]):g[1]<a[f][1]&&(g[1]=a[f][1],e.pop(),e.push(g))}return e};a.invertIntervals=function(a,e){for(var f=[],g=0,h=0;h<a.length;h++){var l=a[h];l[0]>g&&f.push([g,l[0]-1]);g=l[1]+1}g<=e&&f.push([g,e]);return f};a.offsetIntervals=function(a,e){for(var f=[],g=0;g<a.length;g++){var h=a[g];f.push([h[0]+e,h[1]+e])}return f};return a}()})},"esri/views/3d/webgl-engine/lib/ResizableFloat32Array":function(){define(["require",
"exports","../../../../core/mathUtils"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});p=function(){function a(a){null==a?a=16:65536>a&&(a=k.nextHighestPowerOfTwo(a));this._array=new Float32Array(a);this._size=0}a.prototype.resize=function(a,f){this._size=a;if(this._size>this._array.length){for(a=this._array.length||1;a<this._size;)a*=2;var e=new Float32Array(a);f&&e.set(this._array);this._array=e;return!0}e=2*this._size;if(e<=this._array.length){for(a=this._array.length;a>=e;)a=
Math.floor(a/2);e=new Float32Array(a);f&&e.set(this._array.subarray(0,a));this._array=e;return!0}return!1};a.prototype.append=function(a){var e=this._size;this.resize(this._size+a.length,!0);this._array.set(a,e)};a.prototype.erase=function(a,f){for(;a<f;++a)this._array[a]=0};Object.defineProperty(a.prototype,"array",{get:function(){return this._array},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});return a}();
a.ResizableFloat32Array=p})},"esri/views/3d/webgl-engine/materials/WaterGLMaterial":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../lib/GLMaterial ./WaterTechnique ./internal/MaterialUtil ./internal/waterMaterialUtils".split(" "),function(p,a,k,m,e,f,g,h){Object.defineProperty(a,"__esModule",{value:!0});p=function(a){function c(b){b=a.call(this,b)||this;b.updateParameters();return b}k(c,a);c.prototype.updateParameters=function(){this.params=
g.copyParameters(this.material.getParameters());this.technique=this.techniqueRep.acquireAndReleaseExisting(f.WaterTechnique,this.material.getTechniqueConfig(this.output),this.technique)};c.prototype.beginSlot=function(b){if(2===this.output)return 22===b;if(5===this.output)return null==b;var a=3;this.params.transparent&&(a=this.params.writeDepth?5:8);return b===a};c.prototype.setElapsedTimeUniform=function(b){b.setUniform1f("timeElapsed",.001*this.material.animation.time*this.params.animationSpeed)};
c.prototype._updateShadowState=function(b){b.shadowMappingEnabled!==this.params.receiveShadows&&(this.material.setParameterValues({receiveShadows:b.shadowMappingEnabled}),this.updateParameters())};c.prototype.ensureResources=function(b){h.waterTextureRepo.ready()||h.waterTextureRepo.loading()||h.waterTextureRepo.initialize(b);return h.waterTextureRepo.ready()?2:1};c.prototype.ensureParameters=function(b){0===this.output&&this._updateShadowState(b)};c.prototype.bind=function(b,a){b.bindProgram(this.technique.program);
this.technique.bindPass(b,this.params);if(2===this.output||0===this.output)h.waterTextureRepo.bindRepo(b),this.setElapsedTimeUniform(this.technique.program)};return c}(e.GLMaterial);a.WaterGLMaterial=p})},"esri/views/3d/webgl-engine/materials/WaterTechnique":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/shading/ReadShadowMap.glsl ../core/shaderLibrary/shading/WaterDistortion.glsl ../core/shaderLibrary/util/Camera.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultTextureUnits ../lib/DefaultVertexAttributeLocations ../shaders/WaterSurface.glsl ../../../webgl/Program ../../../webgl/renderState".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n,t,r,w,u,q){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}k(d,a);d.prototype.initializeProgram=function(b){var a=d.shader.get(),c=this.configuration,a=a.build({output:c.output,viewingMode:b.viewingMode,slicePlaneEnabled:c.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,receiveShadows:c.receiveShadows,pbrMode:3,useCustomDTRExponentForWater:!0});return new u(b.rctx,
a.generateSource("vertex"),a.generateSource("fragment"),r.Default3D)};d.prototype.bindPass=function(b,a){0!==this.configuration.output&&2!==this.configuration.output||l.WaterDistortion.bindUniforms(this.program,a);0!==this.configuration.output&&5!==this.configuration.output||this.program.setUniform4fv("waterColor",a.color)};d.prototype.bindDraw=function(b){g.Transform.bindUniforms(this.program,b);0===this.configuration.output&&(c.Camera.bindUniforms(this.program,b),f.Slice.bindUniformsWithOrigin(this.program,
this.configuration,b),h.ReadShadowMap.bindUniforms(this.program,b,t.DefaultTextureUnits.SHADOW_MAP))};d.prototype.initializePipeline=function(){var b=this.configuration;return 2===b.output?q.makePipelineState({depthTest:{func:513},depthWrite:b.writeDepth&&q.defaultDepthWriteParams,colorWrite:q.defaultColorWriteParams}):q.makePipelineState({blending:b.transparent&&q.separateBlendingParams(770,1,771,771),depthTest:{func:513},depthWrite:b.writeDepth&&q.defaultDepthWriteParams,colorWrite:q.defaultColorWriteParams})};
d.shader=new b.ReloadableShaderModule(w,"../shaders/WaterSurface.glsl",p);return d}(d.ShaderTechnique);a.WaterTechnique=e;e=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;a.output=0;a.receiveShadows=!1;a.slicePlaneEnabled=!1;a.transparent=!1;a.writeDepth=!1;return a}k(a,b);m([n.parameter({count:7})],a.prototype,"output",void 0);m([n.parameter()],a.prototype,"receiveShadows",void 0);m([n.parameter()],a.prototype,"slicePlaneEnabled",void 0);m([n.parameter()],a.prototype,"transparent",
void 0);m([n.parameter()],a.prototype,"writeDepth",void 0);return a}(n.ShaderTechniqueConfiguration);a.WaterTechniqueConfiguration=e})},"esri/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl":function(){define("require exports ../../../../../core/tsSupport/makeTemplateObjectHelper ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../shaderModules/interfaces".split(" "),function(p,a,k,m,e,f,g){function h(a,e){if(e.slicePlaneEnabled){a.extensions.add("GL_OES_standard_derivatives");
e.sliceEnabledForVertexPrograms&&(a.vertex.uniforms.add("slicePlaneOrigin","vec3"),a.vertex.uniforms.add("slicePlaneBasis1","vec3"),a.vertex.uniforms.add("slicePlaneBasis2","vec3"));a.fragment.uniforms.add("slicePlaneOrigin","vec3");a.fragment.uniforms.add("slicePlaneBasis1","vec3");a.fragment.uniforms.add("slicePlaneBasis2","vec3");var f=g.glsl(c||(c=k(["\n      struct SliceFactors {\n        float front;\n        float side0;\n        float side1;\n        float side2;\n        float side3;\n      };\n\n      SliceFactors calculateSliceFactors(vec3 pos) {\n        vec3 rel \x3d pos - slicePlaneOrigin;\n\n        vec3 slicePlaneNormal \x3d -cross(slicePlaneBasis1, slicePlaneBasis2);\n        float slicePlaneW \x3d -dot(slicePlaneNormal, slicePlaneOrigin);\n\n        float basis1Len2 \x3d dot(slicePlaneBasis1, slicePlaneBasis1);\n        float basis2Len2 \x3d dot(slicePlaneBasis2, slicePlaneBasis2);\n\n        float basis1Dot \x3d dot(slicePlaneBasis1, rel);\n        float basis2Dot \x3d dot(slicePlaneBasis2, rel);\n\n        return SliceFactors(\n          dot(slicePlaneNormal, pos) + slicePlaneW,\n          -basis1Dot - basis1Len2,\n          basis1Dot - basis1Len2,\n          -basis2Dot - basis2Len2,\n          basis2Dot - basis2Len2\n        );\n      }\n\n      bool sliceByFactors(SliceFactors factors) {\n        return factors.front \x3c 0.0\n          \x26\x26 factors.side0 \x3c 0.0\n          \x26\x26 factors.side1 \x3c 0.0\n          \x26\x26 factors.side2 \x3c 0.0\n          \x26\x26 factors.side3 \x3c 0.0;\n      }\n      \n      bool sliceEnabled() {\n        // a slicePlaneBasis1 vector of zero length is used to disable slicing in the shader during draped rendering.\n        return dot(slicePlaneBasis1, slicePlaneBasis1) !\x3d 0.0;\n      }\n\n      bool sliceByPlane(vec3 pos) {\n        return sliceEnabled() \x26\x26 sliceByFactors(calculateSliceFactors(pos));\n      }\n\n      #define rejectBySlice(_pos_) sliceByPlane(_pos_)\n      #define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }\n    "],
["\n      struct SliceFactors {\n        float front;\n        float side0;\n        float side1;\n        float side2;\n        float side3;\n      };\n\n      SliceFactors calculateSliceFactors(vec3 pos) {\n        vec3 rel \x3d pos - slicePlaneOrigin;\n\n        vec3 slicePlaneNormal \x3d -cross(slicePlaneBasis1, slicePlaneBasis2);\n        float slicePlaneW \x3d -dot(slicePlaneNormal, slicePlaneOrigin);\n\n        float basis1Len2 \x3d dot(slicePlaneBasis1, slicePlaneBasis1);\n        float basis2Len2 \x3d dot(slicePlaneBasis2, slicePlaneBasis2);\n\n        float basis1Dot \x3d dot(slicePlaneBasis1, rel);\n        float basis2Dot \x3d dot(slicePlaneBasis2, rel);\n\n        return SliceFactors(\n          dot(slicePlaneNormal, pos) + slicePlaneW,\n          -basis1Dot - basis1Len2,\n          basis1Dot - basis1Len2,\n          -basis2Dot - basis2Len2,\n          basis2Dot - basis2Len2\n        );\n      }\n\n      bool sliceByFactors(SliceFactors factors) {\n        return factors.front \x3c 0.0\n          \x26\x26 factors.side0 \x3c 0.0\n          \x26\x26 factors.side1 \x3c 0.0\n          \x26\x26 factors.side2 \x3c 0.0\n          \x26\x26 factors.side3 \x3c 0.0;\n      }\n      \n      bool sliceEnabled() {\n        // a slicePlaneBasis1 vector of zero length is used to disable slicing in the shader during draped rendering.\n        return dot(slicePlaneBasis1, slicePlaneBasis1) !\x3d 0.0;\n      }\n\n      bool sliceByPlane(vec3 pos) {\n        return sliceEnabled() \x26\x26 sliceByFactors(calculateSliceFactors(pos));\n      }\n\n      #define rejectBySlice(_pos_) sliceByPlane(_pos_)\n      #define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }\n    "]))),
h=g.glsl(b||(b=k(["\n      vec4 applySliceHighlight(vec4 color, vec3 pos) {\n        SliceFactors factors \x3d calculateSliceFactors(pos);\n\n        if (sliceByFactors(factors)) {\n          return color;\n        }\n\n        const float HIGHLIGHT_WIDTH \x3d 1.0;\n        const vec4 HIGHLIGHT_COLOR \x3d vec4(0.0, 0.0, 0.0, 0.3);\n\n        factors.front /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\n        factors.side0 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\n        factors.side1 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\n        factors.side2 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\n        factors.side3 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\n\n        float highlightFactor \x3d (1.0 - step(0.5, factors.front))\n          * (1.0 - step(0.5, factors.side0))\n          * (1.0 - step(0.5, factors.side1))\n          * (1.0 - step(0.5, factors.side2))\n          * (1.0 - step(0.5, factors.side3));\n\n        return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n      }\n    "],
["\n      vec4 applySliceHighlight(vec4 color, vec3 pos) {\n        SliceFactors factors \x3d calculateSliceFactors(pos);\n\n        if (sliceByFactors(factors)) {\n          return color;\n        }\n\n        const float HIGHLIGHT_WIDTH \x3d 1.0;\n        const vec4 HIGHLIGHT_COLOR \x3d vec4(0.0, 0.0, 0.0, 0.3);\n\n        factors.front /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\n        factors.side0 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\n        factors.side1 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\n        factors.side2 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\n        factors.side3 /\x3d (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\n\n        float highlightFactor \x3d (1.0 - step(0.5, factors.front))\n          * (1.0 - step(0.5, factors.side0))\n          * (1.0 - step(0.5, factors.side1))\n          * (1.0 - step(0.5, factors.side2))\n          * (1.0 - step(0.5, factors.side3));\n\n        return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n      }\n    "]))),
h=e.sliceHighlightDisabled?g.glsl(d||(d=k(["#define highlightSlice(_color_, _pos_) (_color_)"],["#define highlightSlice(_color_, _pos_) (_color_)"]))):g.glsl(n||(n=k(["\n        "," \n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      "],["\n        "," \n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      "])),h);e.sliceEnabledForVertexPrograms&&a.vertex.code.add(f);
a.fragment.code.add(f);a.fragment.code.add(h)}else f=g.glsl(t||(t=k(["\n      #define rejectBySlice(_pos_) false\n      #define discardBySlice(_pos_) {}\n      #define highlightSlice(_color_, _pos_) (_color_)\n    "],["\n      #define rejectBySlice(_pos_) false\n      #define discardBySlice(_pos_) {}\n      #define highlightSlice(_color_, _pos_) (_color_)\n    "]))),e.sliceEnabledForVertexPrograms&&a.vertex.code.add(f),a.fragment.code.add(f)}Object.defineProperty(a,"__esModule",{value:!0});a.Slice=
h;(function(b){b.bindUniformsWithOrigin=function(a,c,d){b.bindUniforms(a,c,d.slicePlane,d.origin)};b.bindUniforms=function(b,a,c,d){a.slicePlaneEnabled&&(m.isSome(c)?(d?(e.vec3.subtract(l,c.origin,d),b.setUniform3fv("slicePlaneOrigin",l)):b.setUniform3fv("slicePlaneOrigin",c.origin),b.setUniform3fv("slicePlaneBasis1",c.basis1),b.setUniform3fv("slicePlaneBasis2",c.basis2)):(b.setUniform3fv("slicePlaneBasis1",f.vec3f64.ZEROS),b.setUniform3fv("slicePlaneBasis2",f.vec3f64.ZEROS),b.setUniform3fv("slicePlaneOrigin",
f.vec3f64.ZEROS)))}})(h=a.Slice||(a.Slice={}));var l=f.vec3f64.create(),c,b,d,n,t})},"esri/core/tsSupport/makeTemplateObjectHelper":function(){define([],function(){return function(p,a){if(Object.defineProperty)return Object.defineProperty(p,"raw",{value:a});p.raw=a;return p}})},"esri/views/3d/webgl-engine/core/shaderModules/interfaces":function(){define(["require","exports"],function(p,a){function k(a){for(var e=[],f=1;f<arguments.length;f++)e[f-1]=arguments[f];for(var f="",g=0;g<e.length;g++)f+=
a[g]+e[g];return f+=a[a.length-1]}Object.defineProperty(a,"__esModule",{value:!0});a.glsl=k;(function(a){a.int=function(a){return Math.round(a).toString()};a.float=function(a){return a.toPrecision(8)}})(k=a.glsl||(a.glsl={}))})},"esri/views/3d/webgl-engine/core/shaderLibrary/Transform.glsl":function(){define("require exports ../../../../../core/tsSupport/makeTemplateObjectHelper ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f32 ../shaderModules/interfaces".split(" "),
function(p,a,k,m,e,f){function g(b,a){a.linearDepth?b.vertex.code.add(f.glsl(l||(l=k(["\n    vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {\n      vec4 eye \x3d view * vec4(pos, 1.0);\n      depth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\n      return proj * eye;\n    }\n    "],["\n    vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {\n      vec4 eye \x3d view * vec4(pos, 1.0);\n      depth \x3d (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\n      return proj * eye;\n    }\n    "])))):
b.vertex.code.add(f.glsl(c||(c=k(["\n    vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {\n      // Make sure the order of operations is the same as in transformPositionWithDepth.\n      return proj * (view * vec4(pos, 1.0));\n    }\n    "],["\n    vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {\n      // Make sure the order of operations is the same as in transformPositionWithDepth.\n      return proj * (view * vec4(pos, 1.0));\n    }\n    "]))))}Object.defineProperty(a,"__esModule",
{value:!0});a.Transform=g;(function(b){function a(b,a,c){m.mat4.translate(h,c,a);b.setUniform3fv("localOrigin",a);b.setUniformMatrix4fv("view",h)}b.bindUniformsCustomOrigin=a;b.bindUniforms=function(b,c){a(b,c.origin,c.view)}})(g=a.Transform||(a.Transform={}));var h=e.mat4f32.create(),l,c})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["require","exports","./factories/mat4f32"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});a.mat4f32=k})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["require",
"exports"],function(p,a){function k(){var a=new Float32Array(16);a[0]=1;a[5]=1;a[10]=1;a[15]=1;return a}Object.defineProperty(a,"__esModule",{value:!0});a.create=k;a.clone=function(a){var e=new Float32Array(16);e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];e[9]=a[9];e[10]=a[10];e[11]=a[11];e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];return e};a.fromValues=function(a,e,f,g,h,l,c,b,d,k,t,p,w,u,q,E){var n=new Float32Array(16);n[0]=a;n[1]=e;n[2]=f;n[3]=
g;n[4]=h;n[5]=l;n[6]=c;n[7]=b;n[8]=d;n[9]=k;n[10]=t;n[11]=p;n[12]=w;n[13]=u;n[14]=q;n[15]=E;return n};a.createView=function(a,e){return new Float32Array(a,e,16)};a.IDENTITY=k()})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/ReadShadowMap.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../util/RgbaFloatEncoding.glsl","../../shaderModules/interfaces"],function(p,a,k,m,e){function f(a){a.include(m.RgbaFloatEncoding);a.fragment.uniforms.add("depthTex",
"sampler2D");a.fragment.uniforms.add("shadowMapNum","int");a.fragment.uniforms.add("shadowMapDistance","vec4");a.fragment.uniforms.add("shadowMapMatrix","mat4",4);a.fragment.uniforms.add("depthHalfPixelSz","float");a.fragment.code.add(e.glsl(g||(g=k(["\n    float readShadowMap(const in vec3 _vpos, float _linearDepth) {\n      float halfPixelSize \x3d depthHalfPixelSz;\n      vec4 distance \x3d shadowMapDistance;\n      float depth \x3d _linearDepth;\n\n      //choose correct cascade\n      int i \x3d depth \x3c distance[1] ? 0 : depth \x3c distance[2] ? 1 : depth \x3c distance[3] ? 2 : 3;\n\n      if (i \x3e\x3d shadowMapNum) { return 0.0; }\n\n      mat4 mat \x3d i \x3d\x3d 0 ? shadowMapMatrix[0] : i \x3d\x3d 1 ? shadowMapMatrix[1] : i \x3d\x3d 2 ? shadowMapMatrix[2] : shadowMapMatrix[3];\n\n      vec4 lv \x3d mat * vec4(_vpos, 1.0);\n      lv.xy /\x3d lv.w;\n\n      // vertex completely outside? -\x3e no shadow\n      vec3 lvpos \x3d 0.5 * lv.xyz + vec3(0.5);\n      if (lvpos.z \x3e\x3d 1.0) { return 0.0; }\n      if (lvpos.x \x3c 0.0 || lvpos.x \x3e 1.0 || lvpos.y \x3c 0.0 || lvpos.y \x3e 1.0) { return 0.0; }\n\n      // calc coord in cascade texture\n      vec2 uv \x3d vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;\n\n      float texSize \x3d 0.5 / halfPixelSize;\n\n      // filter, offset by half pixels\n      vec2 st \x3d fract((vec2(halfPixelSize) + uv) * texSize);\n\n      float s00 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, -halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s10 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, -halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s11 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s01 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n\n      return mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\n    }\n  "],
["\n    float readShadowMap(const in vec3 _vpos, float _linearDepth) {\n      float halfPixelSize \x3d depthHalfPixelSz;\n      vec4 distance \x3d shadowMapDistance;\n      float depth \x3d _linearDepth;\n\n      //choose correct cascade\n      int i \x3d depth \x3c distance[1] ? 0 : depth \x3c distance[2] ? 1 : depth \x3c distance[3] ? 2 : 3;\n\n      if (i \x3e\x3d shadowMapNum) { return 0.0; }\n\n      mat4 mat \x3d i \x3d\x3d 0 ? shadowMapMatrix[0] : i \x3d\x3d 1 ? shadowMapMatrix[1] : i \x3d\x3d 2 ? shadowMapMatrix[2] : shadowMapMatrix[3];\n\n      vec4 lv \x3d mat * vec4(_vpos, 1.0);\n      lv.xy /\x3d lv.w;\n\n      // vertex completely outside? -\x3e no shadow\n      vec3 lvpos \x3d 0.5 * lv.xyz + vec3(0.5);\n      if (lvpos.z \x3e\x3d 1.0) { return 0.0; }\n      if (lvpos.x \x3c 0.0 || lvpos.x \x3e 1.0 || lvpos.y \x3c 0.0 || lvpos.y \x3e 1.0) { return 0.0; }\n\n      // calc coord in cascade texture\n      vec2 uv \x3d vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;\n\n      float texSize \x3d 0.5 / halfPixelSize;\n\n      // filter, offset by half pixels\n      vec2 st \x3d fract((vec2(halfPixelSize) + uv) * texSize);\n\n      float s00 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, -halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s10 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, -halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s11 \x3d rgba2float(texture2D(depthTex, uv + vec2(halfPixelSize, halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n      float s01 \x3d rgba2float(texture2D(depthTex, uv + vec2(-halfPixelSize, halfPixelSize))) \x3c lvpos.z ? 1.0 : 0.0;\n\n      return mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\n    }\n  "]))))}
Object.defineProperty(a,"__esModule",{value:!0});a.ReadShadowMap=f;(function(a){a.bindUniforms=function(a,c,b){c.shadowMappingEnabled&&(c.shadowMap.bind(a,b),c.shadowMap.bindView(a,c.origin))};a.bindViewCustomOrigin=function(a,c,b){c.shadowMappingEnabled&&c.shadowMap.bindView(a,b)};a.bindView=function(a,c){c.shadowMappingEnabled&&c.shadowMap.bindView(a,c.origin)}})(f=a.ReadShadowMap||(a.ReadShadowMap={}));var g})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/RgbaFloatEncoding.glsl":function(){define(["require",
"exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(p,a,k,m){Object.defineProperty(a,"__esModule",{value:!0});a.RgbaFloatEncoding=function(a){var f=m.glsl(e||(e=k(["\n    // This is the maximum float value representable as 32bit fixed point,\n    // it is rgba2float(vec4(1)) inlined.\n    const float MAX_RGBA_FLOAT \x3d\n      255.0 / 256.0 +\n      255.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n    // Factors to convert to fixed point, i.e. factors (256^0, 256^1, 256^2, 256^3)\n    const vec4 FIXED_POINT_FACTORS \x3d vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n    vec4 float2rgba(const float value) {\n      // Make sure value is in the domain we can represent\n      float valueInValidDomain \x3d clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n      // Decompose value in 32bit fixed point parts represented as\n      // uint8 rgba components. Decomposition uses the fractional part after multiplying\n      // by a power of 256 (this removes the bits that are represented in the previous\n      // component) and then converts the fractional part to 8bits.\n      vec4 fixedPointU8 \x3d floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n      // Convert uint8 values (from 0 to 255) to floating point representation for\n      // the shader\n      const float toU8AsFloat \x3d 1.0 / 255.0;\n\n      return fixedPointU8 * toU8AsFloat;\n    }\n\n    // Factors to convert rgba back to float\n    const vec4 RGBA_2_FLOAT_FACTORS \x3d vec4(\n      255.0 / (256.0),\n      255.0 / (256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n    );\n\n    float rgba2float(vec4 rgba) {\n      // Convert components from 0-\x3e1 back to 0-\x3e255 and then\n      // add the components together with their corresponding\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n      return dot(rgba, RGBA_2_FLOAT_FACTORS);\n    }\n  "],
["\n    // This is the maximum float value representable as 32bit fixed point,\n    // it is rgba2float(vec4(1)) inlined.\n    const float MAX_RGBA_FLOAT \x3d\n      255.0 / 256.0 +\n      255.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n    // Factors to convert to fixed point, i.e. factors (256^0, 256^1, 256^2, 256^3)\n    const vec4 FIXED_POINT_FACTORS \x3d vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n    vec4 float2rgba(const float value) {\n      // Make sure value is in the domain we can represent\n      float valueInValidDomain \x3d clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n      // Decompose value in 32bit fixed point parts represented as\n      // uint8 rgba components. Decomposition uses the fractional part after multiplying\n      // by a power of 256 (this removes the bits that are represented in the previous\n      // component) and then converts the fractional part to 8bits.\n      vec4 fixedPointU8 \x3d floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n      // Convert uint8 values (from 0 to 255) to floating point representation for\n      // the shader\n      const float toU8AsFloat \x3d 1.0 / 255.0;\n\n      return fixedPointU8 * toU8AsFloat;\n    }\n\n    // Factors to convert rgba back to float\n    const vec4 RGBA_2_FLOAT_FACTORS \x3d vec4(\n      255.0 / (256.0),\n      255.0 / (256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n    );\n\n    float rgba2float(vec4 rgba) {\n      // Convert components from 0-\x3e1 back to 0-\x3e255 and then\n      // add the components together with their corresponding\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n      return dot(rgba, RGBA_2_FLOAT_FACTORS);\n    }\n  "])));
a.fragment.code.add(f);a.vertex.code.add(f)};var e})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/WaterDistortion.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(p,a,k,m){function e(a){a.fragment.uniforms.add("texWaveNormal","sampler2D");a.fragment.uniforms.add("texWavePerturbation","sampler2D");a.fragment.uniforms.add("waveParams","vec4");a.fragment.uniforms.add("waveDirection","vec2");
a.fragment.code.add(m.glsl(f||(f=k(["\n      const vec2  FLOW_JUMP \x3d vec2(6.0/25.0, 5.0/24.0);\n\n      vec2 textureDenormalized2D(sampler2D _tex, vec2 _uv) {\n        return 2.0 * texture2D(_tex, _uv).rg - 1.0;\n      }\n\n      float sampleNoiseTexture(vec2 _uv) {\n        return texture2D(texWavePerturbation, _uv).b;\n      }\n\n      vec3 textureDenormalized3D(sampler2D _tex, vec2 _uv) {\n        return 2.0 * texture2D(_tex, _uv).rgb - 1.0;\n      }\n\n      float computeProgress(vec2 uv, float time) {\n        return fract(time);\n      }\n\n      float computeWeight(vec2 uv, float time) {\n        float progress \x3d computeProgress(uv, time);\n        return 1.0 - abs(1.0 - 2.0 * progress);\n      }\n\n      vec3 computeUVPerturbedWeigth(sampler2D texFlow, vec2 uv, float time, float phaseOffset) {\n        float flowStrength \x3d waveParams[2];\n        float flowOffset \x3d waveParams[3];\n\n        vec2 flowVector \x3d textureDenormalized2D(texFlow, uv) * flowStrength;\n\n        float progress \x3d computeProgress(uv, time + phaseOffset);\n        float weight \x3d computeWeight(uv, time + phaseOffset);\n\n        vec2 result \x3d uv;\n        result -\x3d flowVector * (progress + flowOffset);\n        result +\x3d phaseOffset;\n        result +\x3d (time - progress) * FLOW_JUMP;\n\n        return vec3(result, weight);\n      }\n\n      const float TIME_NOISE_TEXTURE_REPEAT \x3d 0.3737;\n      const float TIME_NOISE_STRENGTH \x3d 7.77;\n\n      vec3 getWaveLayer(sampler2D _texNormal, sampler2D _dudv, vec2 _uv, vec2 _waveDir, float time) {\n        float waveStrength \x3d waveParams[0];\n\n        // overall directional shift in uv's for directional wave movement for\n        // now we do a hard coded scale for wave speed such that a unit length\n        // direction is not too fast.\n        vec2 waveMovement \x3d time * -_waveDir;\n\n        float timeNoise \x3d sampleNoiseTexture(_uv * TIME_NOISE_TEXTURE_REPEAT) * TIME_NOISE_STRENGTH;\n\n        // compute two perturbed uvs and blend weights\n        // then sample the wave normals at the two positions and blend\n        vec3 uv_A \x3d computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.0);\n        vec3 uv_B \x3d computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.5);\n\n        vec3 normal_A \x3d textureDenormalized3D(_texNormal, uv_A.xy) * uv_A.z;\n        vec3 normal_B \x3d textureDenormalized3D(_texNormal, uv_B.xy) * uv_B.z;\n\n        // logic to flatten the wave pattern\n        // scale xy components of the normal, then adjust z (up) component\n        vec3 mixNormal \x3d normalize(normal_A + normal_B);\n        mixNormal.xy *\x3d waveStrength;\n        mixNormal.z \x3d sqrt(1.0 - dot(mixNormal.xy, mixNormal.xy));\n\n        return mixNormal;\n      }\n\n      vec3 getSurfaceNormal(vec2 _uv, float _time) {\n        float waveTextureRepeat \x3d waveParams[1];\n        return getWaveLayer(texWaveNormal, texWavePerturbation, _uv * waveTextureRepeat, waveDirection, _time);\n      }\n    "],
["\n      const vec2  FLOW_JUMP \x3d vec2(6.0/25.0, 5.0/24.0);\n\n      vec2 textureDenormalized2D(sampler2D _tex, vec2 _uv) {\n        return 2.0 * texture2D(_tex, _uv).rg - 1.0;\n      }\n\n      float sampleNoiseTexture(vec2 _uv) {\n        return texture2D(texWavePerturbation, _uv).b;\n      }\n\n      vec3 textureDenormalized3D(sampler2D _tex, vec2 _uv) {\n        return 2.0 * texture2D(_tex, _uv).rgb - 1.0;\n      }\n\n      float computeProgress(vec2 uv, float time) {\n        return fract(time);\n      }\n\n      float computeWeight(vec2 uv, float time) {\n        float progress \x3d computeProgress(uv, time);\n        return 1.0 - abs(1.0 - 2.0 * progress);\n      }\n\n      vec3 computeUVPerturbedWeigth(sampler2D texFlow, vec2 uv, float time, float phaseOffset) {\n        float flowStrength \x3d waveParams[2];\n        float flowOffset \x3d waveParams[3];\n\n        vec2 flowVector \x3d textureDenormalized2D(texFlow, uv) * flowStrength;\n\n        float progress \x3d computeProgress(uv, time + phaseOffset);\n        float weight \x3d computeWeight(uv, time + phaseOffset);\n\n        vec2 result \x3d uv;\n        result -\x3d flowVector * (progress + flowOffset);\n        result +\x3d phaseOffset;\n        result +\x3d (time - progress) * FLOW_JUMP;\n\n        return vec3(result, weight);\n      }\n\n      const float TIME_NOISE_TEXTURE_REPEAT \x3d 0.3737;\n      const float TIME_NOISE_STRENGTH \x3d 7.77;\n\n      vec3 getWaveLayer(sampler2D _texNormal, sampler2D _dudv, vec2 _uv, vec2 _waveDir, float time) {\n        float waveStrength \x3d waveParams[0];\n\n        // overall directional shift in uv's for directional wave movement for\n        // now we do a hard coded scale for wave speed such that a unit length\n        // direction is not too fast.\n        vec2 waveMovement \x3d time * -_waveDir;\n\n        float timeNoise \x3d sampleNoiseTexture(_uv * TIME_NOISE_TEXTURE_REPEAT) * TIME_NOISE_STRENGTH;\n\n        // compute two perturbed uvs and blend weights\n        // then sample the wave normals at the two positions and blend\n        vec3 uv_A \x3d computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.0);\n        vec3 uv_B \x3d computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.5);\n\n        vec3 normal_A \x3d textureDenormalized3D(_texNormal, uv_A.xy) * uv_A.z;\n        vec3 normal_B \x3d textureDenormalized3D(_texNormal, uv_B.xy) * uv_B.z;\n\n        // logic to flatten the wave pattern\n        // scale xy components of the normal, then adjust z (up) component\n        vec3 mixNormal \x3d normalize(normal_A + normal_B);\n        mixNormal.xy *\x3d waveStrength;\n        mixNormal.z \x3d sqrt(1.0 - dot(mixNormal.xy, mixNormal.xy));\n\n        return mixNormal;\n      }\n\n      vec3 getSurfaceNormal(vec2 _uv, float _time) {\n        float waveTextureRepeat \x3d waveParams[1];\n        return getWaveLayer(texWaveNormal, texWavePerturbation, _uv * waveTextureRepeat, waveDirection, _time);\n      }\n    "]))))}
Object.defineProperty(a,"__esModule",{value:!0});a.WaterDistortion=e;(function(a){a.bindUniforms=function(a,e){a.setUniform1i("texWaveNormal",0);a.setUniform1i("texWavePerturbation",1);a.setUniform4f("waveParams",e.waveStrength,e.waveTextureRepeat,e.flowStrength,e.flowOffset);a.setUniform2f("waveDirection",e.waveDirection[0]*e.waveVelocity,e.waveDirection[1]*e.waveVelocity)}})(e=a.WaterDistortion||(a.WaterDistortion={}));var f})},"esri/views/3d/webgl-engine/core/shaderLibrary/util/Camera.glsl":function(){define(["require",
"exports"],function(p,a){Object.defineProperty(a,"__esModule",{value:!0});(function(a){function k(a,f,g){a.setUniform3f("camPos",g[3]-f[0],g[7]-f[1],g[11]-f[2])}a.bindUniformsCustomOrigin=k;a.bindUniforms=function(a,f){k(a,f.origin,f.viewInvTransp)}})(a.Camera||(a.Camera={}));(function(a){a.bindUniforms=function(a,e){a.setUniform1f("pixelRatio",e.pixelRatio||1);a.setUniform4fv("viewport",e.viewport)}})(a.Viewport||(a.Viewport={}))})},"esri/views/3d/webgl-engine/core/shaderTechnique/ReloadableShaderModule":function(){define(["require",
"exports","../../../../../core/promiseUtils"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});p=function(){function a(a,f,g){this._relativePath=f;this._moduleRequire=g;this._module=a}a.prototype.get=function(){return this._module};a.prototype.reload=function(){var a=this,f=this._moduleRequire.toUrl(this._relativePath),f=f.slice(f.indexOf("esri/"));this._recursivelyInvalidateModuleCache(f);return k.create(function(e){a._moduleRequire([a._relativePath],function(f){a._module=f;e()})})};
a.prototype._recursivelyInvalidateModuleCache=function(a){if(-1!==a.search("shader")||-1!==a.search("shading")){var e=this._moduleRequire.modules,g=e[a];if(g)for(g=g.deps,delete e[a],a=0;a<g.length;a++)e=g[a],"esri"===e.pid&&this._recursivelyInvalidateModuleCache(e.mid)}};return a}();a.ReloadableShaderModule=p})},"esri/views/3d/webgl-engine/core/shaderTechnique/ShaderTechnique":function(){define(["require","exports"],function(p,a){Object.defineProperty(a,"__esModule",{value:!0});p=function(){function a(a,
e){if(e){var f=e.__proto__.__configurationParameters||[],g={};g.key=e.key;for(var h=0;h<f.length;h++){var l=f[h];g[l]=e[l]}this._config=g}this._program=this.initializeProgram(a);a.commonUniformStore&&(this._commonUniformStore=a.commonUniformStore,this._commonUniformStore.subscribeProgram(this._program));this._pipeline=this.initializePipeline(a)}a.prototype.dispose=function(){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose(),
this._program=null)};a.prototype.reload=function(a){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose());this._program=this.initializeProgram(a);this._commonUniformStore&&this._commonUniformStore.subscribeProgram(this._program)};Object.defineProperty(a.prototype,"program",{get:function(){return this._program},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"pipeline",{get:function(){return this._pipeline},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"key",{get:function(){return this._config.key},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"configuration",{get:function(){return this._config},enumerable:!0,configurable:!0});a.prototype.bindPass=function(a,e,f){};a.prototype.bindMaterial=function(a,e,f){};a.prototype.bindDraw=function(a,e,f){};a.prototype.bindInstance=function(a){};a.prototype.bindPipelineState=function(a){a.setPipelineState(this.pipeline)};a.prototype.ensureAttributeLocations=
function(a){this.program.assertCompatibleVertexAttributeLocations(a)};Object.defineProperty(a.prototype,"primitiveType",{get:function(){return 4},enumerable:!0,configurable:!0});return a}();a.ShaderTechnique=p})},"esri/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueConfiguration":function(){define(["require","exports","../../../../../core/mathUtils"],function(p,a,k){Object.defineProperty(a,"__esModule",{value:!0});p=function(){return function(){this.key=0}}();a.ShaderTechniqueConfiguration=
p;a.parameter=function(a){void 0===a&&(a={});return function(e,f){e.__configurationParameters=e.__configurationParameters||[];e.__configurationParameters.push(f);var g="_"+f;void 0===e.__configurationParameters__offset&&(e.__configurationParameters__offset=0);var h=e.__configurationParameters__offset,l=Math.ceil(k.log2(a.count||2)),c=(1<<l)-1<<h;e.__configurationParameters__offset+=l;if(32<=e.__configurationParameters__offset)throw Error("ShaderTechniqueConfiguration is too complex, requiring more than 32 bits to encode.\n      Either the configuration must be simplified, or this restriction must be relaxed.(Currently used: "+
e.__configurationParameters__offset+")");Object.defineProperty(e,f,{get:function(){return this[g]},set:function(b){this.key=this.key&~c|b<<h&c;this[g]=b}})}}})},"esri/views/3d/webgl-engine/lib/DefaultTextureUnits":function(){define(["require","exports"],function(p,a){Object.defineProperty(a,"__esModule",{value:!0});a.DefaultTextureUnits={DIFFUSE:0,NORMAL:1,EMISSION:2,OCCLUSION:3,METALLIC_ROUGHNESS:4,SSAO:6,SHADOW_MAP:7}})},"esri/views/3d/webgl-engine/shaders/WaterSurface.glsl":function(){define("require exports ../../../../core/tsSupport/makeTemplateObjectHelper ../core/shaderLibrary/ForwardLinearDepth.glsl ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/shading/NormalUtils.glsl ../core/shaderLibrary/shading/ReadShadowMap.glsl ../core/shaderLibrary/shading/Water.glsl ../core/shaderLibrary/shading/WaterDistortion.glsl ../core/shaderModules/interfaces ../core/shaderModules/ShaderBuilder".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d){Object.defineProperty(a,"__esModule",{value:!0});a.build=function(a){var p=new d.ShaderBuilder;p.include(f.Transform,{linearDepth:!1});p.attributes.add("position","vec3");p.attributes.add("uv0","vec2");p.vertex.uniforms.add("proj","mat4").add("view","mat4").add("model","mat4").add("localOrigin","vec3");0===a.output&&(p.include(g.NormalUtils,a),p.include(m.ForwardLinearDepth,a),p.varyings.add("vuv","vec2"),p.varyings.add("vpos","vec3"),p.varyings.add("vnormal","vec3"),
p.varyings.add("vtbnMatrix","mat3"),p.vertex.code.add(b.glsl(n||(n=k(["\n      void main(void) {\n        vuv \x3d uv0;\n        vpos \x3d (model * vec4(position, 1.0)).xyz;\n\n        vnormal \x3d getLocalUp(vpos, localOrigin);\n        vtbnMatrix \x3d getTBNMatrix(vnormal);\n\n        gl_Position \x3d transformPosition(proj, view, vpos);\n        forwardLinearDepth();\n      }\n    "],["\n      void main(void) {\n        vuv \x3d uv0;\n        vpos \x3d (model * vec4(position, 1.0)).xyz;\n\n        vnormal \x3d getLocalUp(vpos, localOrigin);\n        vtbnMatrix \x3d getTBNMatrix(vnormal);\n\n        gl_Position \x3d transformPosition(proj, view, vpos);\n        forwardLinearDepth();\n      }\n    "])))),
p.include(c.WaterDistortion,a),p.include(e.Slice,a),a.receiveShadows&&p.include(h.ReadShadowMap,a),p.include(l.Water,a),p.fragment.uniforms.add("waterColor","vec4").add("lightingMainDirection","vec3").add("lightingMainIntensity","vec3").add("camPos","vec3").add("timeElapsed","float"),p.fragment.code.add(b.glsl(t||(t=k(["\n      void main() {\n        discardBySlice(vpos);\n        vec3 localUp \x3d vnormal;\n        // the created normal is in tangent space\n        vec3 tangentNormal \x3d getSurfaceNormal(vuv, timeElapsed);\n\n        // we rotate the normal according to the tangent-bitangent-normal-Matrix\n        vec3 n \x3d normalize(vtbnMatrix * tangentNormal);\n        vec3 v \x3d -normalize(vpos - camPos);\n        vec3 l \x3d normalize(-lightingMainDirection);\n        "],
["\n      void main() {\n        discardBySlice(vpos);\n        vec3 localUp \x3d vnormal;\n        // the created normal is in tangent space\n        vec3 tangentNormal \x3d getSurfaceNormal(vuv, timeElapsed);\n\n        // we rotate the normal according to the tangent-bitangent-normal-Matrix\n        vec3 n \x3d normalize(vtbnMatrix * tangentNormal);\n        vec3 v \x3d -normalize(vpos - camPos);\n        vec3 l \x3d normalize(-lightingMainDirection);\n        "])))),a.receiveShadows?p.fragment.code.add(b.glsl(r||
(r=k(["\n        float shadow \x3d 1.0 - readShadowMap(vpos, linearDepth);\n      "],["\n        float shadow \x3d 1.0 - readShadowMap(vpos, linearDepth);\n      "])))):p.fragment.code.add(b.glsl(w||(w=k(["\n        float shadow \x3d 1.0;\n      "],["\n        float shadow \x3d 1.0;\n      "])))),p.fragment.code.add(b.glsl(u||(u=k(["\n        vec4 final \x3d vec4(getSeaColor(n, v, l, waterColor.rgb, lightingMainIntensity, localUp, shadow), waterColor.w);\n\n        // gamma correction\n        gl_FragColor \x3d delinearizeGamma(final);\n        gl_FragColor \x3d highlightSlice(gl_FragColor, vpos);\n      }\n    "],
["\n        vec4 final \x3d vec4(getSeaColor(n, v, l, waterColor.rgb, lightingMainIntensity, localUp, shadow), waterColor.w);\n\n        // gamma correction\n        gl_FragColor \x3d delinearizeGamma(final);\n        gl_FragColor \x3d highlightSlice(gl_FragColor, vpos);\n      }\n    "])))));2===a.output&&(p.include(g.NormalUtils,a),p.include(c.WaterDistortion,a),p.include(e.Slice,a),p.varyings.add("vpos","vec3"),p.varyings.add("vuv","vec2"),p.vertex.code.add(b.glsl(q||(q=k(["\n        void main(void) {\n          vuv \x3d uv0;\n          vpos \x3d (model * vec4(position, 1.0)).xyz;\n          gl_Position \x3d transformPosition(proj, view, vpos);\n        }\n    "],
["\n        void main(void) {\n          vuv \x3d uv0;\n          vpos \x3d (model * vec4(position, 1.0)).xyz;\n          gl_Position \x3d transformPosition(proj, view, vpos);\n        }\n    "])))),p.fragment.uniforms.add("timeElapsed","float"),p.fragment.code.add(b.glsl(E||(E=k(["\n        void main() {\n          discardBySlice(vpos);\n          // the created normal is in tangent space\n          vec3 tangentNormal \x3d getSurfaceNormal(vuv, timeElapsed);\n          tangentNormal \x3d normalize(tangentNormal);\n          gl_FragColor \x3d vec4((tangentNormal + vec3(1.0)) * 0.5, 0.0);\n        }\n    "],
["\n        void main() {\n          discardBySlice(vpos);\n          // the created normal is in tangent space\n          vec3 tangentNormal \x3d getSurfaceNormal(vuv, timeElapsed);\n          tangentNormal \x3d normalize(tangentNormal);\n          gl_FragColor \x3d vec4((tangentNormal + vec3(1.0)) * 0.5, 0.0);\n        }\n    "])))));5===a.output&&(p.include(g.NormalUtils,a),p.varyings.add("vpos","vec3"),p.vertex.code.add(b.glsl(x||(x=k(["\n        void main(void) {\n          vpos \x3d (model * vec4(position, 1.0)).xyz;\n          gl_Position \x3d transformPosition(proj, view, vpos);\n        }\n    "],
["\n        void main(void) {\n          vpos \x3d (model * vec4(position, 1.0)).xyz;\n          gl_Position \x3d transformPosition(proj, view, vpos);\n        }\n    "])))),p.fragment.uniforms.add("waterColor","vec4"),p.fragment.code.add(b.glsl(z||(z=k(["\n        void main() {\n          gl_FragColor \x3d waterColor;\n        }\n    "],["\n        void main() {\n          gl_FragColor \x3d waterColor;\n        }\n    "])))));return p};var n,t,r,w,u,q,E,x,z})},"esri/views/3d/webgl-engine/core/shaderLibrary/ForwardLinearDepth.glsl":function(){define(["require",
"exports","../../../../../core/tsSupport/makeTemplateObjectHelper","../shaderModules/interfaces"],function(p,a,k,m){Object.defineProperty(a,"__esModule",{value:!0});a.ForwardLinearDepth=function(a,l){0===l.output&&l.receiveShadows?(a.varyings.add("linearDepth","float"),a.vertex.code.add(m.glsl(e||(e=k(["\n      void forwardLinearDepth() { linearDepth \x3d gl_Position.w; }\n    "],["\n      void forwardLinearDepth() { linearDepth \x3d gl_Position.w; }\n    "]))))):1===l.output||3===l.output?(a.varyings.add("linearDepth",
"float"),a.vertex.uniforms.add("uCameraNearFar","vec2"),a.vertex.code.add(m.glsl(f||(f=k(["\n      void forwardLinearDepth() {\n        linearDepth \x3d (-position_view().z - uCameraNearFar[0]) / (uCameraNearFar[1] - uCameraNearFar[0]);\n      }\n    "],["\n      void forwardLinearDepth() {\n        linearDepth \x3d (-position_view().z - uCameraNearFar[0]) / (uCameraNearFar[1] - uCameraNearFar[0]);\n      }\n    "]))))):a.vertex.code.add(m.glsl(g||(g=k(["\n      void forwardLinearDepth() {}\n    "],
["\n      void forwardLinearDepth() {}\n    "]))))};var e,f,g})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/NormalUtils.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(p,a,k,m){Object.defineProperty(a,"__esModule",{value:!0});a.NormalUtils=function(a,c){0===c.viewingMode?a.vertex.code.add(m.glsl(e||(e=k(["\n      vec3 getLocalUp(in vec3 pos, in vec3 origin) {\n          return normalize(pos + origin);\n      }\n    "],
["\n      vec3 getLocalUp(in vec3 pos, in vec3 origin) {\n          return normalize(pos + origin);\n      }\n    "])))):a.vertex.code.add(m.glsl(f||(f=k(["\n      vec3 getLocalUp(in vec3 pos, in vec3 origin) {\n          return vec3(0.0, 0.0, 1.0); // WARNING: up-axis dependent code\n      }\n    "],["\n      vec3 getLocalUp(in vec3 pos, in vec3 origin) {\n          return vec3(0.0, 0.0, 1.0); // WARNING: up-axis dependent code\n      }\n    "]))));0===c.viewingMode?a.vertex.code.add(m.glsl(g||(g=
k(["\n        mat3 getTBNMatrix(in vec3 n) {\n            vec3 t \x3d normalize(cross(vec3(0.0, 0.0, 1.0), n));\n            vec3 b \x3d normalize(cross(n, t));\n            return mat3(t, b, n);\n        }\n    "],["\n        mat3 getTBNMatrix(in vec3 n) {\n            vec3 t \x3d normalize(cross(vec3(0.0, 0.0, 1.0), n));\n            vec3 b \x3d normalize(cross(n, t));\n            return mat3(t, b, n);\n        }\n    "])))):a.vertex.code.add(m.glsl(h||(h=k(["\n        mat3 getTBNMatrix(in vec3 n) {\n            vec3 t \x3d vec3(1.0, 0.0, 0.0);\n            vec3 b \x3d normalize(cross(n, t));\n            return mat3(t, b, n);\n        }\n    "],
["\n        mat3 getTBNMatrix(in vec3 n) {\n            vec3 t \x3d vec3(1.0, 0.0, 0.0);\n            vec3 b \x3d normalize(cross(n, t));\n            return mat3(t, b, n);\n        }\n    "]))))};var e,f,g,h})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/Water.glsl":function(){define("require exports ../../../../../../core/tsSupport/makeTemplateObjectHelper ./Gamma.glsl ./PhysicallyBasedRendering.glsl ../../shaderModules/interfaces".split(" "),function(p,a,k,m,e,f){Object.defineProperty(a,
"__esModule",{value:!0});a.Water=function(a,l){a.include(e.PhysicallyBasedRendering,l);a.include(m.Gamma);a.fragment.code.add(f.glsl(g||(g=k(["\n    const vec3 fresnelSky \x3d  vec3(0.02, 1.0, 5.0); // f0, f0max, exp\n    const vec2 fresnelMaterial \x3d  vec2(0.02, 0.1); // f0, f0max for specular term\n    const float roughness \x3d 0.06;\n\n    const vec3 skyZenitColor \x3d vec3(0, 0.6, 0.9);\n    const vec3 skyColor \x3d vec3(0.72, 0.92, 1.0);\n\n    PBRShadingWater shadingInfo;\n\n    /*\n    *   This function is an approximation for the sky gradient reflected\n    *   the water surface and describes a combination of two fresnel terms.\n    *   @parameter: cosTheta \x3d is the result of max(dot(n,v), 0.0)\n    *   @parameter: horizon \x3d the dominant color of the sky horizon\n    *   @parameter: cosTheta \x3d the dominant color of the sky zenit\n    */\n    vec3 getSkyGradientColor(in float cosTheta, in vec3 horizon, in vec3 zenit) {\n      float exponent \x3d pow((1.0 - cosTheta), fresnelSky[2]);\n      return mix(zenit, horizon, exponent);\n    }\n\n    /*\n    *   This function determines the water color per pixel.\n    *   @parameter: n \x3d normal facing away from the surface\n    *   @parameter: v \x3d view direction facing away from the surface.\n    *   @parameter: l \x3d light direction facing away from the surface\n    *   @parameter: lightIntensity \x3d light intensity, currently between 0...PI\n    *   @parameter: localUp \x3d a normal for the general direction of the surface\n    *   @parameter: shadow \x3d the amount of shadow at this pixel (0 \x3d no shadow)\n    */\n    vec3 getSeaColor(in vec3 n, in vec3 v, in vec3 l, vec3 color, in vec3 lightIntensity, in vec3 localUp, in float shadow) {\n\n      vec3 seaWaterColor \x3d linearizeGamma(color);\n      // using half vector to determine the specular light\n      vec3 h \x3d normalize(l + v);\n      shadingInfo.NdotL \x3d clamp(dot(n, l), 0.0, 1.0);\n      shadingInfo.NdotV \x3d clamp(dot(n, v), 0.001, 1.0);\n      shadingInfo.VdotN \x3d clamp(dot(v, n), 0.001, 1.0);\n      shadingInfo.NdotH \x3d clamp(dot(n, h), 0.0, 1.0);\n      shadingInfo.VdotH \x3d clamp(dot(v, h), 0.0, 1.0);\n      shadingInfo.LdotH \x3d clamp(dot(l, h), 0.0, 1.0);\n\n      // angle between vertex normal and view direction\n      float upDotV \x3d max(dot(localUp,v), 0.0);\n      // reflected sky color: the reflected sky color consists of two main colors, the\n      // reflected color at the horizon and the reflected color of the zenit.\n      // the reflected sky color is then an approximation based on the fresnel term.\n      vec3 skyHorizon \x3d linearizeGamma(skyColor);\n      vec3 skyZenit \x3d linearizeGamma(skyZenitColor);\n      vec3 skyColor \x3d getSkyGradientColor(upDotV, skyHorizon, skyZenit );\n\n      // we use the upDotL to smoothen out the\n      // reflected color of the water\n      float upDotL \x3d max(dot(localUp,l),0.0);\n\n      // The approximated sky color is adjusted according to the sun position.\n      // This is done as approximation for e.g. night views.\n      skyColor *\x3d 0.1 + upDotL * 0.9;\n\n      // If a water surface is in shadow we just use a slight darkening of the\n      // water surface expressed with this shadowModifier.\n      float shadowModifier \x3d clamp(shadow, 0.8, 1.0);\n\n      // The reflected sky color consists of the fresnel reflection multiplied with the approximated sky color.\n      // The shadow is influencing the frensel term to keep the shadow impression for really near views. As long\n      // as reflection are absent there is a need to have a slight shadow for depth perception.\n      vec3 reflSky \x3d fresnelReflection(shadingInfo.VdotN, vec3(fresnelSky[0]), fresnelSky[1]) * skyColor * shadowModifier;\n\n      // The reflected sea color is the input water color combined with the reflected sky color.\n      // The reflected sky color is modified by the incoming light.\n      vec3 reflSea \x3d seaWaterColor * mix(skyColor, upDotL * lightIntensity * LIGHT_NORMALIZATION, 2.0 / 3.0) * shadowModifier;\n\n      vec3 specular \x3d vec3(0.0);\n      // This prevents the specular light to be rendered when:\n      // - sun is behind a polygon (e.g. sundown for elevated polygons where nDotL might be still ok)\n      // - viewer is under water (for this localUp is better than n)\n      if(upDotV \x3e 0.0 \x26\x26 upDotL \x3e 0.0) {\n        // calculate the cook torrance BRDF but with simplified occlusion\n        vec3 specularSun \x3d brdfWater(shadingInfo, roughness, vec3(fresnelMaterial[0]), fresnelMaterial[1]);\n        // Normalize light intensity to be between 0...1. Shadow cancels out specular light here\n        vec3 incidentLight \x3d lightIntensity * LIGHT_NORMALIZATION * shadow;\n\n        specular \x3d shadingInfo.NdotL * incidentLight * specularSun;\n      }\n      // combining reflected sky, reflected sea and specular highlight.\n      return tonemapACES(reflSky + reflSea + specular);\n    }\n  "],
["\n    const vec3 fresnelSky \x3d  vec3(0.02, 1.0, 5.0); // f0, f0max, exp\n    const vec2 fresnelMaterial \x3d  vec2(0.02, 0.1); // f0, f0max for specular term\n    const float roughness \x3d 0.06;\n\n    const vec3 skyZenitColor \x3d vec3(0, 0.6, 0.9);\n    const vec3 skyColor \x3d vec3(0.72, 0.92, 1.0);\n\n    PBRShadingWater shadingInfo;\n\n    /*\n    *   This function is an approximation for the sky gradient reflected\n    *   the water surface and describes a combination of two fresnel terms.\n    *   @parameter: cosTheta \x3d is the result of max(dot(n,v), 0.0)\n    *   @parameter: horizon \x3d the dominant color of the sky horizon\n    *   @parameter: cosTheta \x3d the dominant color of the sky zenit\n    */\n    vec3 getSkyGradientColor(in float cosTheta, in vec3 horizon, in vec3 zenit) {\n      float exponent \x3d pow((1.0 - cosTheta), fresnelSky[2]);\n      return mix(zenit, horizon, exponent);\n    }\n\n    /*\n    *   This function determines the water color per pixel.\n    *   @parameter: n \x3d normal facing away from the surface\n    *   @parameter: v \x3d view direction facing away from the surface.\n    *   @parameter: l \x3d light direction facing away from the surface\n    *   @parameter: lightIntensity \x3d light intensity, currently between 0...PI\n    *   @parameter: localUp \x3d a normal for the general direction of the surface\n    *   @parameter: shadow \x3d the amount of shadow at this pixel (0 \x3d no shadow)\n    */\n    vec3 getSeaColor(in vec3 n, in vec3 v, in vec3 l, vec3 color, in vec3 lightIntensity, in vec3 localUp, in float shadow) {\n\n      vec3 seaWaterColor \x3d linearizeGamma(color);\n      // using half vector to determine the specular light\n      vec3 h \x3d normalize(l + v);\n      shadingInfo.NdotL \x3d clamp(dot(n, l), 0.0, 1.0);\n      shadingInfo.NdotV \x3d clamp(dot(n, v), 0.001, 1.0);\n      shadingInfo.VdotN \x3d clamp(dot(v, n), 0.001, 1.0);\n      shadingInfo.NdotH \x3d clamp(dot(n, h), 0.0, 1.0);\n      shadingInfo.VdotH \x3d clamp(dot(v, h), 0.0, 1.0);\n      shadingInfo.LdotH \x3d clamp(dot(l, h), 0.0, 1.0);\n\n      // angle between vertex normal and view direction\n      float upDotV \x3d max(dot(localUp,v), 0.0);\n      // reflected sky color: the reflected sky color consists of two main colors, the\n      // reflected color at the horizon and the reflected color of the zenit.\n      // the reflected sky color is then an approximation based on the fresnel term.\n      vec3 skyHorizon \x3d linearizeGamma(skyColor);\n      vec3 skyZenit \x3d linearizeGamma(skyZenitColor);\n      vec3 skyColor \x3d getSkyGradientColor(upDotV, skyHorizon, skyZenit );\n\n      // we use the upDotL to smoothen out the\n      // reflected color of the water\n      float upDotL \x3d max(dot(localUp,l),0.0);\n\n      // The approximated sky color is adjusted according to the sun position.\n      // This is done as approximation for e.g. night views.\n      skyColor *\x3d 0.1 + upDotL * 0.9;\n\n      // If a water surface is in shadow we just use a slight darkening of the\n      // water surface expressed with this shadowModifier.\n      float shadowModifier \x3d clamp(shadow, 0.8, 1.0);\n\n      // The reflected sky color consists of the fresnel reflection multiplied with the approximated sky color.\n      // The shadow is influencing the frensel term to keep the shadow impression for really near views. As long\n      // as reflection are absent there is a need to have a slight shadow for depth perception.\n      vec3 reflSky \x3d fresnelReflection(shadingInfo.VdotN, vec3(fresnelSky[0]), fresnelSky[1]) * skyColor * shadowModifier;\n\n      // The reflected sea color is the input water color combined with the reflected sky color.\n      // The reflected sky color is modified by the incoming light.\n      vec3 reflSea \x3d seaWaterColor * mix(skyColor, upDotL * lightIntensity * LIGHT_NORMALIZATION, 2.0 / 3.0) * shadowModifier;\n\n      vec3 specular \x3d vec3(0.0);\n      // This prevents the specular light to be rendered when:\n      // - sun is behind a polygon (e.g. sundown for elevated polygons where nDotL might be still ok)\n      // - viewer is under water (for this localUp is better than n)\n      if(upDotV \x3e 0.0 \x26\x26 upDotL \x3e 0.0) {\n        // calculate the cook torrance BRDF but with simplified occlusion\n        vec3 specularSun \x3d brdfWater(shadingInfo, roughness, vec3(fresnelMaterial[0]), fresnelMaterial[1]);\n        // Normalize light intensity to be between 0...1. Shadow cancels out specular light here\n        vec3 incidentLight \x3d lightIntensity * LIGHT_NORMALIZATION * shadow;\n\n        specular \x3d shadingInfo.NdotL * incidentLight * specularSun;\n      }\n      // combining reflected sky, reflected sea and specular highlight.\n      return tonemapACES(reflSky + reflSea + specular);\n    }\n  "]))))};
var g})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/Gamma.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(p,a,k,m){Object.defineProperty(a,"__esModule",{value:!0});a.Gamma=function(a){a.fragment.code.add(m.glsl(e||(e=k(["\n    const float GAMMA \x3d 2.2;\n    const float INV_GAMMA \x3d 0.4545454545;\n\n    vec4 delinearizeGamma(vec4 color) {\n      return vec4(pow(color.rgb, vec3(INV_GAMMA)), color.w);\n    }\n\n    vec3 linearizeGamma(vec3 color) {\n      return pow(color, vec3(GAMMA));\n    }\n  "],
["\n    const float GAMMA \x3d 2.2;\n    const float INV_GAMMA \x3d 0.4545454545;\n\n    vec4 delinearizeGamma(vec4 color) {\n      return vec4(pow(color.rgb, vec3(INV_GAMMA)), color.w);\n    }\n\n    vec3 linearizeGamma(vec3 color) {\n      return pow(color, vec3(GAMMA));\n    }\n  "]))))};var e})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRendering.glsl":function(){define("require exports ../../../../../../core/tsSupport/makeTemplateObjectHelper ./AnalyticalSkyModel.glsl ./PiUtils.glsl ../../shaderModules/interfaces".split(" "),
function(p,a,k,m,e,f){Object.defineProperty(a,"__esModule",{value:!0});a.PhysicallyBasedRendering=function(a,p){var q=a.fragment.code;a.include(e.PiUtils);if(3===p.pbrMode||4===p.pbrMode)q.add(f.glsl(g||(g=k(["\n    struct PBRShadingWater\n    {\n        float NdotL;   // cos angle between normal and light direction\n        float NdotV;   // cos angle between normal and view direction\n        float NdotH;   // cos angle between normal and half vector\n        float VdotH;   // cos angle between view direction and half vector\n        float LdotH;   // cos angle between light direction and half vector\n        float VdotN;   // cos angle between view direction and normal vector\n    };\n\n    float dtrExponent \x3d ",
";\n    "],["\n    struct PBRShadingWater\n    {\n        float NdotL;   // cos angle between normal and light direction\n        float NdotV;   // cos angle between normal and view direction\n        float NdotH;   // cos angle between normal and half vector\n        float VdotH;   // cos angle between view direction and half vector\n        float LdotH;   // cos angle between light direction and half vector\n        float VdotN;   // cos angle between view direction and normal vector\n    };\n\n    float dtrExponent \x3d ",
";\n    "])),p.useCustomDTRExponentForWater?"2.2":"2.0")),q.add(f.glsl(h||(h=k(["\n    vec3 fresnelReflection(float angle, vec3 f0, float f90) {\n      return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);\n    }\n    "],["\n    vec3 fresnelReflection(float angle, vec3 f0, float f90) {\n      return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);\n    }\n    "])))),q.add(f.glsl(l||(l=k(["\n    float normalDistributionWater(float NdotH, float roughness)\n    {\n      float r2 \x3d roughness * roughness;\n      float NdotH2 \x3d NdotH * NdotH;\n      float denom \x3d pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;\n      return r2 / denom;\n    }\n    "],
["\n    float normalDistributionWater(float NdotH, float roughness)\n    {\n      float r2 \x3d roughness * roughness;\n      float NdotH2 \x3d NdotH * NdotH;\n      float denom \x3d pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;\n      return r2 / denom;\n    }\n    "])))),q.add(f.glsl(c||(c=k(["\n    float geometricOcclusionKelemen(float LoH)\n    {\n        return 0.25 / (LoH * LoH);\n    }\n    "],["\n    float geometricOcclusionKelemen(float LoH)\n    {\n        return 0.25 / (LoH * LoH);\n    }\n    "])))),
q.add(f.glsl(b||(b=k(["\n    vec3 brdfWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)\n    {\n      vec3  F \x3d fresnelReflection(props.VdotH, F0, F0Max);\n      float D \x3d normalDistributionWater(props.NdotH, roughness);\n      float V \x3d geometricOcclusionKelemen(props.LdotH);\n      return (D * V) * F;\n    }\n\n    vec3 tonemapACES(const vec3 x) {\n      return (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);\n    }\n    "],["\n    vec3 brdfWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)\n    {\n      vec3  F \x3d fresnelReflection(props.VdotH, F0, F0Max);\n      float D \x3d normalDistributionWater(props.NdotH, roughness);\n      float V \x3d geometricOcclusionKelemen(props.LdotH);\n      return (D * V) * F;\n    }\n\n    vec3 tonemapACES(const vec3 x) {\n      return (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);\n    }\n    "]))));
else if(1===p.pbrMode||2===p.pbrMode)a.include(m.AnalyticalSkyModel),q.add(f.glsl(d||(d=k(["\n    struct PBRShadingInfo\n    {\n        float NdotL;                  // cos angle between normal and light direction\n        float NdotV;                  // cos angle between normal and view direction\n        float NdotH;                  // cos angle between normal and half vector\n        float VdotH;                  // cos angle between view direction and half vector\n        float LdotH;                  // cos angle between view light direction and half vector\n        float NdotNG;                 // cos angle between normal and normal of the ground\n        float RdotNG;                 // cos angle between view direction reflected of the normal and normal of the ground\n        float NdotAmbDir;             // cos angle between view direction and the fill light in ambient illumination\n        float NdotH_Horizon;          // cos angle between normal and half vector defined with horizon illumination\n        vec3 skyRadianceToSurface;         // integrated radiance of the sky based on the surface roughness (used for specular reflection)\n        vec3 groundRadianceToSurface;      // integrated radiance of the ground based on the surface roughness (used for specular reflection)\n        vec3 skyIrradianceToSurface;       // irradiance of the sky (used for diffuse reflection)\n        vec3 groundIrradianceToSurface;    // irradiance of the ground (used for diffuse reflection)\n\n        float averageAmbientRadiance;      // average ambient radiance used to deduce black level in gamut mapping\n        float ssao;                   // ssao coefficient\n        vec3 albedoLinear;            // linear color of the albedo\n        vec3 f0;                      // fresnel value at normal incident light\n        vec3 f90;                     // fresnel value at 90o of incident light\n\n        vec3 diffuseColor;            // diffuse color of the material used in environment illumination\n        float metalness;              // metalness of the material\n        float roughness;              // roughness of the material\n    };\n    "],
["\n    struct PBRShadingInfo\n    {\n        float NdotL;                  // cos angle between normal and light direction\n        float NdotV;                  // cos angle between normal and view direction\n        float NdotH;                  // cos angle between normal and half vector\n        float VdotH;                  // cos angle between view direction and half vector\n        float LdotH;                  // cos angle between view light direction and half vector\n        float NdotNG;                 // cos angle between normal and normal of the ground\n        float RdotNG;                 // cos angle between view direction reflected of the normal and normal of the ground\n        float NdotAmbDir;             // cos angle between view direction and the fill light in ambient illumination\n        float NdotH_Horizon;          // cos angle between normal and half vector defined with horizon illumination\n        vec3 skyRadianceToSurface;         // integrated radiance of the sky based on the surface roughness (used for specular reflection)\n        vec3 groundRadianceToSurface;      // integrated radiance of the ground based on the surface roughness (used for specular reflection)\n        vec3 skyIrradianceToSurface;       // irradiance of the sky (used for diffuse reflection)\n        vec3 groundIrradianceToSurface;    // irradiance of the ground (used for diffuse reflection)\n\n        float averageAmbientRadiance;      // average ambient radiance used to deduce black level in gamut mapping\n        float ssao;                   // ssao coefficient\n        vec3 albedoLinear;            // linear color of the albedo\n        vec3 f0;                      // fresnel value at normal incident light\n        vec3 f90;                     // fresnel value at 90o of incident light\n\n        vec3 diffuseColor;            // diffuse color of the material used in environment illumination\n        float metalness;              // metalness of the material\n        float roughness;              // roughness of the material\n    };\n    "])))),
q.add(f.glsl(n||(n=k(["\n    float normalDistribution(float NdotH, float roughness)\n    {\n        float a \x3d NdotH * roughness;\n        float b \x3d roughness / (1.0 - NdotH * NdotH + a * a);\n        return b * b * INV_PI;\n    }\n    "],["\n    float normalDistribution(float NdotH, float roughness)\n    {\n        float a \x3d NdotH * roughness;\n        float b \x3d roughness / (1.0 - NdotH * NdotH + a * a);\n        return b * b * INV_PI;\n    }\n    "])))),q.add(f.glsl(t||(t=k(["\n    const vec4 c0 \x3d vec4(-1.0, -0.0275, -0.572,  0.022);\n    const vec4 c1 \x3d vec4( 1.0,  0.0425,  1.040, -0.040);\n    const vec2 c2 \x3d vec2(-1.04, 1.04);\n\n    vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {\n        vec4 r \x3d roughness * c0 + c1;\n        float a004 \x3d min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;\n        return c2 * a004 + r.zw;\n    }\n    "],
["\n    const vec4 c0 \x3d vec4(-1.0, -0.0275, -0.572,  0.022);\n    const vec4 c1 \x3d vec4( 1.0,  0.0425,  1.040, -0.040);\n    const vec2 c2 \x3d vec2(-1.04, 1.04);\n\n    vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {\n        vec4 r \x3d roughness * c0 + c1;\n        float a004 \x3d min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;\n        return c2 * a004 + r.zw;\n    }\n    "])))),q.add(f.glsl(r||(r=k(["\n    vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {\n      vec3 indirectDiffuse \x3d evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);\n      vec3 indirectSpecular \x3d evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);\n\n      // From diffuse illumination calculate reflected color\n      vec3 diffuseComponent \x3d inputs.diffuseColor * indirectDiffuse * INV_PI;\n\n      // From specular illumination calculate reflected color\n      vec2 dfg \x3d prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);\n      vec3 specularColor \x3d inputs.f0 * dfg.x + inputs.f90 * dfg.y;\n      vec3 specularComponent \x3d specularColor * indirectSpecular;\n\n      return (diffuseComponent + specularComponent);\n    }\n    "],
["\n    vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {\n      vec3 indirectDiffuse \x3d evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);\n      vec3 indirectSpecular \x3d evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);\n\n      // From diffuse illumination calculate reflected color\n      vec3 diffuseComponent \x3d inputs.diffuseColor * indirectDiffuse * INV_PI;\n\n      // From specular illumination calculate reflected color\n      vec2 dfg \x3d prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);\n      vec3 specularColor \x3d inputs.f0 * dfg.x + inputs.f90 * dfg.y;\n      vec3 specularComponent \x3d specularColor * indirectSpecular;\n\n      return (diffuseComponent + specularComponent);\n    }\n    "])))),
q.add(f.glsl(w||(w=k(["\n    float gamutMapChanel(float x, vec2 p){\n      return (x \x3c p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );\n    }"],["\n    float gamutMapChanel(float x, vec2 p){\n      return (x \x3c p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );\n    }"])))),q.add(f.glsl(u||(u=k(["\n    vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){\n      vec3 outColor;\n      vec2 p \x3d vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));\n      outColor.x \x3d gamutMapChanel(inColor.x, p) ;\n      outColor.y \x3d gamutMapChanel(inColor.y, p) ;\n      outColor.z \x3d gamutMapChanel(inColor.z, p) ;\n      return outColor;\n    }\n    "],
["\n    vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){\n      vec3 outColor;\n      vec2 p \x3d vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));\n      outColor.x \x3d gamutMapChanel(inColor.x, p) ;\n      outColor.y \x3d gamutMapChanel(inColor.y, p) ;\n      outColor.z \x3d gamutMapChanel(inColor.z, p) ;\n      return outColor;\n    }\n    "]))))};var g,h,l,c,b,d,n,t,r,w,u})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/AnalyticalSkyModel.glsl":function(){define(["require",
"exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(p,a,k,m){Object.defineProperty(a,"__esModule",{value:!0});a.AnalyticalSkyModel=function(a){a=a.fragment.code;a.add(m.glsl(e||(e=k(["\n    vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)\n    {\n      return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;\n    }\n    "],["\n    vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)\n    {\n      return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;\n    }\n    "]))));
a.add(m.glsl(f||(f=k(["\n    float integratedRadiance(float cosTheta2, float roughness)\n    {\n      return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);\n    }\n    "],["\n    float integratedRadiance(float cosTheta2, float roughness)\n    {\n      return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);\n    }\n    "]))));a.add(m.glsl(g||(g=k(["\n    vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)\n    {\n      float cosTheta2 \x3d 1.0 - RdotNG * RdotNG;\n      float intRadTheta \x3d integratedRadiance(cosTheta2, roughness);\n\n      // Calculate the integrated directional radiance of the ground and the sky\n      float ground \x3d RdotNG \x3c 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;\n      float sky \x3d 2.0 - ground;\n      return (ground * ambientGround + sky * ambientSky) * 0.5;\n    }\n    "],
["\n    vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)\n    {\n      float cosTheta2 \x3d 1.0 - RdotNG * RdotNG;\n      float intRadTheta \x3d integratedRadiance(cosTheta2, roughness);\n\n      // Calculate the integrated directional radiance of the ground and the sky\n      float ground \x3d RdotNG \x3c 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;\n      float sky \x3d 2.0 - ground;\n      return (ground * ambientGround + sky * ambientSky) * 0.5;\n    }\n    "]))))};
var e,f,g})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/PiUtils.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(p,a,k,m){Object.defineProperty(a,"__esModule",{value:!0});a.PiUtils=function(a){a.vertex.code.add(m.glsl(e||(e=k(["\n    const float PI \x3d 3.141592653589793;\n  "],["\n    const float PI \x3d 3.141592653589793;\n  "]))));a.fragment.code.add(m.glsl(f||(f=k(["\n    const float PI \x3d 3.141592653589793;\n    const float LIGHT_NORMALIZATION \x3d 1.0 / PI;\n    const float INV_PI \x3d 0.3183098861837907;\n    const float HALF_PI \x3d 1.570796326794897;\n    "],
["\n    const float PI \x3d 3.141592653589793;\n    const float LIGHT_NORMALIZATION \x3d 1.0 / PI;\n    const float INV_PI \x3d 0.3183098861837907;\n    const float HALF_PI \x3d 1.570796326794897;\n    "]))))};var e,f})},"esri/views/3d/webgl-engine/core/shaderModules/ShaderBuilder":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/MapUtils","../../../../../core/SetUtils"],function(p,a,k,m,e){Object.defineProperty(a,"__esModule",{value:!0});var f=k.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");
p=function(){function a(){this.vertex=new l;this.fragment=new l;this.attributes=new c;this.varyings=new b;this.extensions=new d;this.defines=new n;this._includedModules=new Map}a.prototype.include=function(b,a){this._includedModules.has(b)?this._includedModules.get(b)!==a&&f.error("Trying to include shader module multiple times with different sets of options."):(this._includedModules.set(b,a),"shaderModule"in b?b.shaderModule(this,a):b(this,a))};a.prototype.generateSource=function(b){var a=this.extensions.generateSource(b),
c=this.attributes.generateSource(b),d=this.varyings.generateSource(),e="vertex"===b?this.vertex:this.fragment,f=e.uniforms.generateSource(),g=e.code.generateSource();b="vertex"===b?r:t;e=this.defines.generateSource().concat(e.defines.generateSource());return"\n"+a.join("\n")+"\n\n"+e.join("\n")+"\n\n"+b+"\n\n"+f.join("\n")+"\n\n"+c.join("\n")+"\n\n"+d.join("\n")+"\n\n"+g.join("\n")};return a}();a.ShaderBuilder=p;var g=function(){function b(){this._entries=[];this._set=new Set}b.prototype.add=function(b,
a,c){var d=b+"_"+a+"_"+c;this._set.has(d)||(this._entries.push([b,a,c]),this._set.add(d));return this};b.prototype.generateSource=function(){return this._entries.map(function(b){var a=b[2];return"uniform "+b[1]+" "+b[0]+(a?"["+a+"]":"")+";"})};return b}(),h=function(){function b(){this._entries=[]}b.prototype.add=function(b){this._entries.push(b)};b.prototype.generateSource=function(){return this._entries};return b}(),l=function(){return function(){this.uniforms=new g;this.code=new h;this.defines=
new n}}(),c=function(){function b(){this._entries=[]}b.prototype.add=function(b,a){this._entries.push([b,a])};b.prototype.generateSource=function(b){return"fragment"===b?[]:this._entries.map(function(b){return"attribute "+b[1]+" "+b[0]+";"})};return b}(),b=function(){function b(){this._entries=[]}b.prototype.add=function(b,a){this._entries.push([b,a])};b.prototype.generateSource=function(){return this._entries.map(function(b){return"varying "+b[1]+" "+b[0]+";"})};return b}(),d=function(){function b(){this._entries=
new Set}b.prototype.add=function(b){this._entries.add(b)};b.prototype.generateSource=function(a){var c="vertex"===a?b.WHITELIST_VERTEX:b.WHITELIST_FRAGMENT;return e.valuesOfSet(this._entries).filter(function(b){return 0<=c.indexOf(b)}).map(function(b){return"#extension "+b+" : enable"})};b.WHITELIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"];b.WHITELIST_VERTEX=[];return b}(),n=function(){function b(){this._entries=new Map}b.prototype.addInt=function(b,a){a=0===a%1?a.toFixed(0):
a.toString();this._entries.set(b,a)};b.prototype.addFloat=function(b,a){a=0===a%1?a.toFixed(1):a.toString();this._entries.set(b,a)};b.prototype.generateSource=function(){return m.pairsOfMap(this._entries).map(function(b){return"#define "+b[0]+" "+b[1]})};return b}(),t="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",r="precision highp float;\nprecision highp sampler2D;"})},"esri/views/webgl/Program":function(){define(["require",
"exports","../../core/has","../../core/maybe","./ShaderTranspiler"],function(p,a,k,m,e){function f(a,e){if(m.isNone(a)||a.length!==e.length)return!0;for(var f=0;f<a.length;++f)if(a[f]!==e[f])return!0;return!1}return function(){function a(e,f,c,b,d){void 0===d&&(d={});this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=!1;this._fShader=this._vShader=null;this._defines={};this._nameToUniformLocation={};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform1v=
{};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};e||console.error("RenderingContext isn't initialized!");0===f.length&&console.error("Shaders source should not be empty!");this._context=e;this._vertexShaderSource=f;this._fragmentShaderSource=c;if(Array.isArray(d))for(f=0;f<d.length;f++)this._defines[d[f]]="1";else this._defines=d;this._id=a._nextId++;this._locations=b;k("esri-webgl-debug")&&e.instanceCounter.incrementCount(3)}
Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});a.prototype.getDefine=function(a){return this._defines[a]};a.prototype.dispose=function(){if(this._context){var a=this._context.gl;this._vShader&&(a.deleteShader(this._vShader),
this._vShader=null);this._fShader&&(a.deleteShader(this._fShader),this._fShader=null);this._glName&&(a.deleteProgram(this._glName),this._glName=null);k("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(3);this._context=null}};a.prototype.initialize=function(){if(!this._initialized){this._vShader=this._loadShader(35633);this._fShader=this._loadShader(35632);this._vShader&&this._fShader||console.error("Error loading shaders!");var a=this._context.gl,e=a.createProgram();a.attachShader(e,
this._vShader);a.attachShader(e,this._fShader);for(var c in this._locations)a.bindAttribLocation(e,this._locations[c],c);a.linkProgram(e);k("esri-validate-shaders")&&!a.getProgramParameter(e,a.LINK_STATUS)&&console.error("Could not initialize shader\nVALIDATE_STATUS: "+a.getProgramParameter(e,a.VALIDATE_STATUS)+", gl error ["+a.getError()+"]infoLog: "+a.getProgramInfoLog(e));this._glName=e;this._initialized=!0}};a.prototype.getUniformLocation=function(a){this.initialize();void 0===this._nameToUniformLocation[a]&&
(this._nameToUniformLocation[a]=this._context.gl.getUniformLocation(this._glName,a));return this._nameToUniformLocation[a]};a.prototype.hasUniform=function(a){return null!==this.getUniformLocation(a)};a.prototype.getAttribLocation=function(a){this.initialize();void 0===this._nameToAttribLocation[a]&&(this._nameToAttribLocation[a]=this._context.gl.getAttribLocation(this._glName,a));return this._nameToAttribLocation[a]};a.prototype.setUniform1i=function(a,e){var c=this._nameToUniform1[a];if(void 0===
c||e!==c)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(a),e),this._nameToUniform1[a]=e};a.prototype.setUniform1iv=function(e,g){var c=this._nameToUniform1v[e];f(c,g)&&(this._context.bindProgram(this),this._context.gl.uniform1iv(this.getUniformLocation(e),g),void 0===c?this._nameToUniform1v[e]=a._arrayCopy(g):a._arrayAssign(g,c))};a.prototype.setUniform2iv=function(e,g){var c=this._nameToUniform2[e];f(c,g)&&(this._context.bindProgram(this),this._context.gl.uniform2iv(this.getUniformLocation(e),
g),void 0===c?this._nameToUniform2[e]=a._arrayCopy(g):a._arrayAssign(g,c))};a.prototype.setUniform3iv=function(e,g){var c=this._nameToUniform3[e];f(c,g)&&(this._context.bindProgram(this),this._context.gl.uniform3iv(this.getUniformLocation(e),g),void 0===c?this._nameToUniform3[e]=a._arrayCopy(g):a._arrayAssign(g,c))};a.prototype.setUniform4iv=function(e,g){var c=this._nameToUniform4[e];f(c,g)&&(this._context.bindProgram(this),this._context.gl.uniform4iv(this.getUniformLocation(e),g),void 0===c?this._nameToUniform4[e]=
a._arrayCopy(g):a._arrayAssign(g,c))};a.prototype.setUniform1f=function(a,e){var c=this._nameToUniform1[a];if(void 0===c||e!==c)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(a),e),this._nameToUniform1[a]=e};a.prototype.setUniform1fv=function(e,g){var c=this._nameToUniform1v[e];f(c,g)&&(this._context.bindProgram(this),this._context.gl.uniform1fv(this.getUniformLocation(e),g),void 0===c?this._nameToUniform1v[e]=a._arrayCopy(g):a._arrayAssign(g,c))};a.prototype.setUniform2f=
function(a,e,c){var b=this._nameToUniform2[a];if(void 0===b||e!==b[0]||c!==b[1])this._context.bindProgram(this),this._context.gl.uniform2f(this.getUniformLocation(a),e,c),void 0===b?this._nameToUniform2[a]=[e,c]:(b[0]=e,b[1]=c)};a.prototype.setUniform2fv=function(e,g){var c=this._nameToUniform2[e];f(c,g)&&(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(e),g),void 0===c?this._nameToUniform2[e]=a._arrayCopy(g):a._arrayAssign(g,c))};a.prototype.setUniform3f=function(a,
e,c,b){var d=this._nameToUniform3[a];if(void 0===d||e!==d[0]||c!==d[1]||b!==d[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(a),e,c,b),void 0===d?this._nameToUniform3[a]=[e,c,b]:(d[0]=e,d[1]=c,d[2]=b)};a.prototype.setUniform3fv=function(e,g){var c=this._nameToUniform3[e];f(c,g)&&(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(e),g),void 0===c?this._nameToUniform3[e]=a._arrayCopy(g):a._arrayAssign(g,c))};a.prototype.setUniform4f=
function(a,e,c,b,d){var f=this._nameToUniform4[a];if(void 0===f||e!==f[0]||c!==f[1]||b!==f[2]||d!==f[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(a),e,c,b,d),void 0===f?this._nameToUniform4[a]=[e,c,b,d]:(f[0]=e,f[1]=c,f[2]=b,f[3]=d)};a.prototype.setUniform4fv=function(e,g){var c=this._nameToUniform4[e];f(c,g)&&(this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(e),g),void 0===c?this._nameToUniform4[e]=a._arrayCopy(g):a._arrayAssign(g,
c))};a.prototype.setUniformMatrix3fv=function(e,g,c){void 0===c&&(c=!1);var b=this._nameToUniformMatrix3[e],d;d=m.isNone(b)?!0:9!==b.length?f(b,g):9!==b.length||b[0]!==g[0]||b[1]!==g[1]||b[2]!==g[2]||b[3]!==g[3]||b[4]!==g[4]||b[5]!==g[5]||b[6]!==g[6]||b[7]!==g[7]||b[8]!==g[8];d&&(this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(e),c,g),void 0===b?this._nameToUniformMatrix3[e]=a._arrayCopy(g):a._arrayAssign(g,b))};a.prototype.setUniformMatrix4fv=function(e,
g,c){void 0===c&&(c=!1);var b=this._nameToUniformMatrix4[e],d;d=m.isNone(b)?!0:16!==b.length?f(b,g):16!==b.length||b[0]!==g[0]||b[1]!==g[1]||b[2]!==g[2]||b[3]!==g[3]||b[4]!==g[4]||b[5]!==g[5]||b[6]!==g[6]||b[7]!==g[7]||b[8]!==g[8]||b[9]!==g[9]||b[10]!==g[10]||b[11]!==g[11]||b[12]!==g[12]||b[13]!==g[13]||b[14]!==g[14]||b[15]!==g[15];d&&(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(e),c,g),void 0===b?this._nameToUniformMatrix4[e]=a._arrayCopy(g):a._arrayAssign(g,
b))};a.prototype.assertCompatibleVertexAttributeLocations=function(a){(a=a.locations===this.locations)||console.error("VertexAttributeLocations are incompatible");return a};a._padToThree=function(a){var e=a.toString();1E3>a&&(e=("  "+a).slice(-3));return e};a.prototype._addLineNumbers=function(e){var f=2;return e.replace(/\n/g,function(){return"\n"+a._padToThree(f++)+":"})};a.prototype._loadShader=function(a){var f=35633===a,c=f?this._vertexShaderSource:this._fragmentShaderSource,b;b="";for(var d in this._defines)b+=
"#define "+d+" "+this._defines[d]+"\n";b+=c;"webgl2"===this._context.contextVersion&&(b=e.transpileShader(b,f?"vertex":"fragment"));d=this._context.gl;a=d.createShader(a);d.shaderSource(a,b);d.compileShader(a);d.getShaderParameter(a,d.COMPILE_STATUS)||(console.error("Compile error in ".concat(f?"vertex":"fragment"," shader")),console.error(d.getShaderInfoLog(a)),console.error(this._addLineNumbers(b)),"webgl2"===this._context.contextVersion&&(console.log("Shader source before transpilation:"),console.log(c)));
return a};a._arrayCopy=function(a){for(var e=[],c=0;c<a.length;++c)e.push(a[c]);return e};a._arrayAssign=function(a,e){for(var c=0;c<a.length;++c)e[c]=a[c]};a._nextId=0;return a}()})},"esri/views/webgl/ShaderTranspiler":function(){define(["require","exports","./reservedWordsGLSL3","./lib/glsl-tokenizer/string"],function(p,a,k,m){function e(a){return a.map(function(a){return"eof"!==a.type?a.data:""}).join("")}function f(a,c,b,d){d=d||b;for(var e=0;e<a.length;e++){var g=a[e];if("ident"===g.type&&g.data===
b)return d in c?c[d]++:c[d]=0,f(a,c,d+"_"+c[d],d)}return b}function g(a,c,b){void 0===b&&(b="afterVersion");var d={data:"\n",type:"whitespace"},e=function(b){return b<a.length?/[^\r\n]$/.test(a[b].data):!1},f=function(a){for(var c=-1,d=0,e=-1,f=0;f<a.length;f++){var g=a[f];"preprocessor"===g.type&&(g.data.match(/\#(if|ifdef|ifndef)\s+.+/)?++d:g.data.match(/\#endif\s*.*/)&&--d);("afterVersion"===b||"afterPrecision"===b)&&"preprocessor"===g.type&&/^#version/.test(g.data)&&(e=Math.max(e,f));if("afterPrecision"===
b&&"keyword"===g.type&&"precision"===g.data){a:{for(g=f;g<a.length;g++){var h=a[g];if("operator"===h.type&&";"===h.data)break a}g=null}if(null===g)throw Error("precision statement not followed by any semicolons!");e=Math.max(e,g)}c<e&&0===d&&(c=f)}return c+1}(a);e(f-1)&&a.splice(f++,0,d);for(var g=0;g<c.length;g++){var h=c[g];a.splice(f++,0,h)}e(f-1)&&e(f)&&a.splice(f,0,d)}Object.defineProperty(a,"__esModule",{value:!0});var h=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers",
"GL_EXT_shader_texture_lod"];a.transpileShader=function(a,c){a=m(a);var b;a:{b="100";var d="300 es";void 0===b&&(b="100");void 0===d&&(d="300 es");for(var l=/^\s*\#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/,p=0;p<a.length;p++){var r=a[p];if("preprocessor"===r.type){var w=l.exec(r.data);if(w){l=w[1].replace(/\s\s+/g," ");if(l===d){b=l;break a}if(l===b){r.data="#version "+d;break a}throw Error("unknown glsl version: "+l);}}}a.splice(0,0,{type:"preprocessor",data:"#version "+d},{type:"whitespace",data:"\n"});
b=null}if("300 es"===b)throw Error("shader is already glsl 300 es");l=r=null;p={};w={};for(b=0;b<a.length;++b)switch(d=a[b],d.type){case "keyword":"vertex"===c&&"attribute"===d.data?d.data="in":"varying"===d.data&&(d.data="vertex"===c?"out":"in");break;case "builtin":/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(d.data.trim())&&(d.data=d.data.replace(/(2D|Cube|EXT)/g,""));if("fragment"===c&&"gl_FragColor"===d.data){if(!r){var r=f(a,p,"fragColor"),u=void 0;void 0===u&&(u="lowp");g(a,[{type:"keyword",
data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:u},{type:"whitespace",data:" "},{type:"keyword",data:"vec4"},{type:"whitespace",data:" "},{type:"ident",data:r},{type:"operator",data:";"}],"afterPrecision")}d.data=r}else"fragment"===c&&"gl_FragDepthEXT"===d.data&&(l||(l=f(a,p,"gl_FragDepth")),d.data=l);break;case "ident":if(0<=k.indexOf(d.data)){if(u="vertex"===c)a:{for(u=b-1;0<=u;u--){var q=a[u];if("whitespace"!==q.type&&"block-comment"!==q.type)if("keyword"===q.type){if("attribute"===
q.data||"in"===q.data){u=!0;break a}}else break}u=!1}if(u)throw Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");d.data in w||(w[d.data]=f(a,p,d.data));d.data=w[d.data]}}for(b=a.length-1;0<=b;--b)d=a[b],"preprocessor"===d.type&&((c=d.data.match(/\#extension\s+(.*)\:/))&&c[1]&&0<=h.indexOf(c[1].trim())&&(c=a[b+1],a.splice(b,c&&"whitespace"===c.type?2:1)),(c=d.data.match(/\#ifdef\s+(.*)/))&&c[1]&&0<=h.indexOf(c[1].trim())&&(d.data="#if 1"),(c=d.data.match(/\#ifndef\s+(.*)/))&&
c[1]&&0<=h.indexOf(c[1].trim())&&(d.data="#if 0"));return e(a)}})},"esri/views/webgl/reservedWordsGLSL3":function(){define(["require","exports"],function(p,a){return"layout centroid smooth case mat2x2 mat2x3 mat2x4 mat3x2 mat3x3 mat3x4 mat4x2 mat4x3 mat4x4 uint uvec2 uvec3 uvec4 samplerCubeShadow sampler2DArray sampler2DArrayShadow isampler2D isampler3D isamplerCube isampler2DArray usampler2D usampler3D usamplerCube usampler2DArray coherent restrict readonly writeonly resource atomic_uint noperspective patch sample subroutine common partition active filter image1D image2D image3D imageCube iimage1D iimage2D iimage3D iimageCube uimage1D uimage2D uimage3D uimageCube image1DArray image2DArray iimage1DArray iimage2DArray uimage1DArray uimage2DArray image1DShadow image2DShadow image1DArrayShadow image2DArrayShadow imageBuffer iimageBuffer uimageBuffer sampler1DArray sampler1DArrayShadow isampler1D isampler1DArray usampler1D usampler1DArray isampler2DRect usampler2DRect samplerBuffer isamplerBuffer usamplerBuffer sampler2DMS isampler2DMS usampler2DMS sampler2DMSArray isampler2DMSArray usampler2DMSArray trunc round roundEven isnan isinf floatBitsToInt floatBitsToUint intBitsToFloat uintBitsToFloat packSnorm2x16 unpackSnorm2x16 packUnorm2x16 unpackUnorm2x16 packHalf2x16 unpackHalf2x16 outerProduct transpose determinant inverse texture textureSize textureProj textureLod textureOffset texelFetch texelFetchOffset textureProjOffset textureLodOffset textureProjLod textureProjLodOffset textureGrad textureGradOffset textureProjGrad textureProjGradOffset".split(" ")})},
"esri/views/webgl/lib/glsl-tokenizer/string":function(){define(["./index"],function(p){"use strict;";return function(a){var k=p(),m=[],m=m.concat(k(a));return m=m.concat(k(null))}})},"esri/views/webgl/lib/glsl-tokenizer/index":function(){define(["./lib/literals","./lib/operators","./lib/builtins"],function(p,a,k){"use strict;";var m="block-comment line-comment preprocessor operator integer float ident builtin keyword whitespace eof integer".split(" ");return function(){function e(a){a.length&&q.push({type:m[t],
data:a,position:z,line:E,column:x})}function f(){u=u.length?[]:u;if("/"===w&&"*"===r)return z=n+d-1,t=0,w=r,d+1;if("/"===w&&"/"===r)return z=n+d-1,t=1,w=r,d+1;if("#"===r)return t=2,z=n+d,d;if(/\s/.test(r))return t=9,z=n+d,d;y=/\d/.test(r);v=/[^\w_]/.test(r);z=n+d;t=y?4:v?3:9999;return d}function g(){if(("\r"===r||"\n"===r)&&"\\"!==w)return e(u.join("")),t=999,d;u.push(r);w=r;return d+1}function h(){if("."===w&&/\d/.test(r))return t=5,d;if("/"===w&&"*"===r)return t=0,d;if("/"===w&&"/"===r)return t=
1,d;if("."===r&&u.length){for(;l(u););t=5;return d}if(";"===r||")"===r||"("===r){if(u.length)for(;l(u););e(r);t=999;return d+1}var a=2===u.length&&"\x3d"!==r;if(/[\w_\d\s]/.test(r)||a){for(;l(u););t=999;return d}u.push(r);w=r;return d+1}function l(b){var c=0,d,f;do{d=a.indexOf(b.slice(0,b.length+c).join(""));f=a[d];if(-1===d){if(0<c--+b.length)continue;f=b.slice(0,1).join("")}e(f);z+=f.length;u=u.slice(f.length);return u.length}while(1)}function c(){if("."===r||/[eE]/.test(r))return u.push(r),t=5,
w=r,d+1;if("x"===r&&1===u.length&&"0"===u[0])return t=11,u.push(r),w=r,d+1;if(/[^\d]/.test(r))return e(u.join("")),t=999,d;u.push(r);w=r;return d+1}function b(){"f"===r&&(u.push(r),w=r,d+=1);if(/[eE]/.test(r)||"-"===r&&/[eE]/.test(w))return u.push(r),w=r,d+1;if(/[^\d]/.test(r))return e(u.join("")),t=999,d;u.push(r);w=r;return d+1}var d=0,n=0,t=999,r,w,u=[],q=[],E=1,x=0,z=0,y=!1,v=!1,A="",B;return function(a){q=[];if(null!==a){a=a.replace?a.replace(/\r\n/g,"\n"):a;d=0;A+=a;for(B=A.length;r=A[d],d<
B;){a=d;switch(t){case 0:"/"===r&&"*"===w?(u.push(r),e(u.join("")),t=999):(u.push(r),w=r);d+=1;break;case 1:d=g();break;case 2:d=g();break;case 3:d=h();break;case 4:d=c();break;case 11:/[^a-fA-F0-9]/.test(r)?(e(u.join("")),t=999):(u.push(r),w=r,d+=1);break;case 5:d=b();break;case 9999:if(/[^\d\w_]/.test(r)){var l=u.join("");t=-1<p.indexOf(l)?8:-1<k.indexOf(l)?7:6;e(u.join(""));t=999}else u.push(r),w=r,d+=1;break;case 9:/[^\s]/g.test(r)?(e(u.join("")),t=999):(u.push(r),w=r,d+=1);break;case 999:d=f()}if(a!==
d)switch(A[a]){case "\n":x=0;++E;break;default:++x}}n+=d;A=A.slice(d);return q}u.length&&e(u.join(""));t=10;e("(eof)");return q}}})},"esri/views/webgl/lib/glsl-tokenizer/lib/literals":function(){define([],function(){return"precision highp mediump lowp attribute const uniform varying break continue do for while if else in out inout float int void bool true false discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow struct asm class union enum typedef template this packed goto switch default inline noinline volatile public static extern external interface long short double half fixed unsigned input output hvec2 hvec3 hvec4 dvec2 dvec3 dvec4 fvec2 fvec3 fvec4 sampler2DRect sampler3DRect sampler2DRectShadow sizeof cast namespace using".split(" ")})},
"esri/views/webgl/lib/glsl-tokenizer/lib/operators":function(){define([],function(){"use strict;";return"\x3c\x3c\x3d \x3e\x3e\x3d ++ -- \x3c\x3c \x3e\x3e \x3c\x3d \x3e\x3d \x3d\x3d !\x3d \x26\x26 || +\x3d -\x3d *\x3d /\x3d %\x3d \x26\x3d ^^ ^\x3d |\x3d ( ) [ ] . ! ~ * / % + - \x3c \x3e \x26 ^ | ? : \x3d , ; { }".split(" ")})},"esri/views/webgl/lib/glsl-tokenizer/lib/builtins":function(){define([],function(){return"abs acos all any asin atan ceil clamp cos cross dFdx dFdy degrees distance dot equal exp exp2 faceforward floor fract gl_BackColor gl_BackLightModelProduct gl_BackLightProduct gl_BackMaterial gl_BackSecondaryColor gl_ClipPlane gl_ClipVertex gl_Color gl_DepthRange gl_DepthRangeParameters gl_EyePlaneQ gl_EyePlaneR gl_EyePlaneS gl_EyePlaneT gl_Fog gl_FogCoord gl_FogFragCoord gl_FogParameters gl_FragColor gl_FragCoord gl_FragData gl_FragDepth gl_FragDepthEXT gl_FrontColor gl_FrontFacing gl_FrontLightModelProduct gl_FrontLightProduct gl_FrontMaterial gl_FrontSecondaryColor gl_LightModel gl_LightModelParameters gl_LightModelProducts gl_LightProducts gl_LightSource gl_LightSourceParameters gl_MaterialParameters gl_MaxClipPlanes gl_MaxCombinedTextureImageUnits gl_MaxDrawBuffers gl_MaxFragmentUniformComponents gl_MaxLights gl_MaxTextureCoords gl_MaxTextureImageUnits gl_MaxTextureUnits gl_MaxVaryingFloats gl_MaxVertexAttribs gl_MaxVertexTextureImageUnits gl_MaxVertexUniformComponents gl_ModelViewMatrix gl_ModelViewMatrixInverse gl_ModelViewMatrixInverseTranspose gl_ModelViewMatrixTranspose gl_ModelViewProjectionMatrix gl_ModelViewProjectionMatrixInverse gl_ModelViewProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixTranspose gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_Normal gl_NormalMatrix gl_NormalScale gl_ObjectPlaneQ gl_ObjectPlaneR gl_ObjectPlaneS gl_ObjectPlaneT gl_Point gl_PointCoord gl_PointParameters gl_PointSize gl_Position gl_ProjectionMatrix gl_ProjectionMatrixInverse gl_ProjectionMatrixInverseTranspose gl_ProjectionMatrixTranspose gl_SecondaryColor gl_TexCoord gl_TextureEnvColor gl_TextureMatrix gl_TextureMatrixInverse gl_TextureMatrixInverseTranspose gl_TextureMatrixTranspose gl_Vertex greaterThan greaterThanEqual inversesqrt length lessThan lessThanEqual log log2 matrixCompMult max min mix mod normalize not notEqual pow radians reflect refract sign sin smoothstep sqrt step tan texture2D texture2DLod texture2DProj texture2DProjLod textureCube textureCubeLod texture2DLodEXT texture2DProjLodEXT textureCubeLodEXT texture2DGradEXT texture2DProjGradEXT textureCubeGradEXT".split(" ")})},
"esri/views/webgl/renderState":function(){define(["require","exports","../../core/tsSupport/assignHelper"],function(p,a,k){function m(a){return z.intern(a)}function e(a){return y.intern(a)}function f(a){return v.intern(a)}function g(a){return A.intern(a)}function h(a){return B.intern(a)}function l(a){return C.intern(a)}function c(a){return L.intern(a)}function b(a){return R.intern(a)}function d(a){return"["+a.join(",")+"]"}function n(a){return a?d([a.srcRgb,a.srcAlpha,a.dstRgb,a.dstAlpha,a.opRgb,
a.opAlpha,a.color.r,a.color.g,a.color.b,a.color.a]):null}function t(a){return a?d([a.face,a.mode]):null}function r(a){return a?d([a.factor,a.units]):null}function w(a){return a?d([a.func]):null}function u(a){return a?d([a.function.func,a.function.ref,a.function.mask,a.operation.fail,a.operation.zFail,a.operation.zPass]):null}function q(a){return a?d([a.zNear,a.zFar]):null}function E(a){return a?d([a.r,a.g,a.b,a.a]):null}function x(a){return a?d([a.mask]):null}Object.defineProperty(a,"__esModule",
{value:!0});a.simpleBlendingParams=function(a,b,c,d){void 0===c&&(c=32774);void 0===d&&(d=[0,0,0,0]);return{srcRgb:a,srcAlpha:a,dstRgb:b,dstAlpha:b,opRgb:c,opAlpha:c,color:{r:d[0],g:d[1],b:d[2],a:d[3]}}};a.separateBlendingParams=function(a,b,c,d,e,f,g){void 0===e&&(e=32774);void 0===f&&(f=32774);void 0===g&&(g=[0,0,0,0]);return{srcRgb:a,srcAlpha:b,dstRgb:c,dstAlpha:d,opRgb:e,opAlpha:f,color:{r:g[0],g:g[1],b:g[2],a:g[3]}}};a.backFaceCullingParams={face:1029,mode:2305};a.defaultDepthWriteParams={zNear:0,
zFar:1};a.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};a.makeBlending=m;a.makeCulling=e;a.makePolygonOffset=f;a.makeDepthTest=g;a.makeStencilTest=h;a.makeDepthWrite=l;a.makeColorWrite=c;a.makeStencilWrite=b;a.makePipelineState=function(a){return K.intern(a)};p=function(){function a(a,b){this.makeKey=a;this.makeRef=b;this.interns=new Map}a.prototype.intern=function(a){if(!a)return null;var b=this.makeKey(a),c=this.interns;c.has(b)||c.set(b,this.makeRef(a));return c.get(b)};return a}();var z=new p(n,
function(a){return k({__tag:"Blending"},a)}),y=new p(t,function(a){return k({__tag:"Culling"},a)}),v=new p(r,function(a){return k({__tag:"PolygonOffset"},a)}),A=new p(w,function(a){return k({__tag:"DepthTest"},a)}),B=new p(u,function(a){return k({__tag:"StencilTest"},a)}),C=new p(q,function(a){return k({__tag:"DepthWrite"},a)}),L=new p(E,function(a){return k({__tag:"ColorWrite"},a)}),R=new p(x,function(a){return k({__tag:"StencilWrite"},a)}),K=new p(function(a){return a?d([n(a.blending),t(a.culling),
r(a.polygonOffset),w(a.depthTest),u(a.stencilTest),q(a.depthWrite),E(a.colorWrite),x(a.stencilWrite)]):null},function(a){return{blending:m(a.blending),culling:e(a.culling),polygonOffset:f(a.polygonOffset),depthTest:g(a.depthTest),stencilTest:h(a.stencilTest),depthWrite:l(a.depthWrite),colorWrite:c(a.colorWrite),stencilWrite:b(a.stencilWrite)}});p=function(){function a(a){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=this._stencilTestInvalid=this._depthTestInvalid=this._polygonOffsetInvalid=
this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=a}a.prototype.setPipeline=function(a){if(this._pipelineInvalid||a!==this._pipeline)this.setBlending(a.blending),this.setCulling(a.culling),this.setPolygonOffset(a.polygonOffset),this.setDepthTest(a.depthTest),this.setStencilTest(a.stencilTest),this.setDepthWrite(a.depthWrite),this.setColorWrite(a.colorWrite),this.setStencilWrite(a.stencilWrite),this._pipeline=a;this._pipelineInvalid=!1};a.prototype.invalidateBlending=
function(){this._pipelineInvalid=this._blendingInvalid=!0};a.prototype.invalidateCulling=function(){this._pipelineInvalid=this._cullingInvalid=!0};a.prototype.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};a.prototype.invalidateDepthTest=function(){this._pipelineInvalid=this._depthTestInvalid=!0};a.prototype.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};a.prototype.invalidateDepthWrite=function(){this._pipelineInvalid=
this._depthWriteInvalid=!0};a.prototype.invalidateColorWrite=function(){this._pipelineInvalid=this._colorWriteInvalid=!0};a.prototype.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};a.prototype.setBlending=function(a){this._blending=this.setSubState(a,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=!1};a.prototype.setCulling=function(a){this._culling=this.setSubState(a,this._culling,this._cullingInvalid,this._stateSetters.setCulling);
this._cullingInvalid=!1};a.prototype.setPolygonOffset=function(a){this._polygonOffset=this.setSubState(a,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};a.prototype.setDepthTest=function(a){this._depthTest=this.setSubState(a,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=!1};a.prototype.setStencilTest=function(a){this._stencilTest=this.setSubState(a,this._stencilTest,this._stencilTestInvalid,
this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};a.prototype.setDepthWrite=function(a){this._depthWrite=this.setSubState(a,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};a.prototype.setColorWrite=function(a){this._colorWrite=this.setSubState(a,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=!1};a.prototype.setStencilWrite=function(a){this._stencilWrite=this.setSubState(a,this._stencilWrite,
this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=!1};a.prototype.setSubState=function(a,b,c,d){if(c||a!==b)d(a),this._pipelineInvalid=!0;return a};return a}();a.StateTracker=p})},"esri/views/3d/webgl-engine/materials/internal/waterMaterialUtils":function(){define("require exports ../../../../../core/Logger ../../../../../core/promiseUtils ../../../../../core/libs/gl-matrix-2/vec2f64 ../../../support/imageUtils ../../../../webgl/Texture".split(" "),function(p,
a,k,m,e,f,g){Object.defineProperty(a,"__esModule",{value:!0});var h=k.getLogger("esri.views.3d.webgl-engine.materials.internal.waterMaterialUtils");a.waveAndPertubationTextureUrls=[p.toUrl("../../../../../images/materials/water/normals.jpg"),p.toUrl("../../../../../images/materials/water/perturbation.jpg")];a.defaultWaterMaterialParameters={waveStrength:.06,waveTextureRepeat:32,waveDirection:e.vec2f64.fromValues(1,0),waveVelocity:.05,flowStrength:.015,flowOffset:-.5,animationSpeed:.35,color:[0,.35686,
.4,1],transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,isDraped:!1,receiveShadows:!0};a.wavePresets={"calm-small":{waveStrength:.005,perturbationStrength:.02,textureRepeat:12,waveVelocity:.01},"rippled-small":{waveStrength:.02,perturbationStrength:.09,textureRepeat:32,waveVelocity:.07},"slight-small":{waveStrength:.05,perturbationStrength:.07,textureRepeat:28,waveVelocity:.1},"moderate-small":{waveStrength:.075,perturbationStrength:.07,textureRepeat:24,waveVelocity:.1},"calm-medium":{waveStrength:.003125,
perturbationStrength:.01,textureRepeat:8,waveVelocity:.02},"rippled-medium":{waveStrength:.035,perturbationStrength:.015,textureRepeat:12,waveVelocity:.07},"slight-medium":{waveStrength:.06,perturbationStrength:.015,textureRepeat:8,waveVelocity:.12},"moderate-medium":{waveStrength:.09,perturbationStrength:.03,textureRepeat:4,waveVelocity:.12},"calm-large":{waveStrength:.01,perturbationStrength:0,textureRepeat:4,waveVelocity:.05},"rippled-large":{waveStrength:.025,perturbationStrength:.01,textureRepeat:8,
waveVelocity:.11},"slight-large":{waveStrength:.06,perturbationStrength:.02,textureRepeat:3,waveVelocity:.13},"moderate-large":{waveStrength:.14,perturbationStrength:.03,textureRepeat:2,waveVelocity:.15}};p=function(){function e(){this.loadingState=0;this.data=[]}e.prototype.getTextureProps=function(a,b,d){void 0===d&&(d=!1);return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:10497,samplingMode:9987,hasMipmap:d,maxAnisotropy:8,width:a,height:b}};e.prototype.ready=function(){return 2===this.loadingState};
e.prototype.loading=function(){return 1===this.loadingState};e.prototype.initialize=function(c){var b=this;this.loadingState=1;m.all(a.waveAndPertubationTextureUrls.map(function(a){return f.requestImage(a)})).then(function(a){a.forEach(function(a,d){b.data[d]=new g(c,b.getTextureProps(a.width,a.height,!0),a)});b.loadingState=2}).catch(function(a){h.error("Failed to load textures for water material.",a);b.loadingState=0})};e.prototype.bindRepo=function(a){for(var b=0;b<this.data.length;b++)a.bindTexture(this.data[b],
b)};return e}();a.waterTextureRepo=new p})},"esri/views/3d/support/imageUtils":function(){define(["require","exports","../../../core/tsSupport/assignHelper","../../../request"],function(p,a,k,m){Object.defineProperty(a,"__esModule",{value:!0});a.dataURItoBlob=function(a){var e=atob(a.split(",")[1]);a=a.split(",")[0].split(":")[1].split(";")[0];for(var g=new ArrayBuffer(e.length),h=new Uint8Array(g),l=0;l<e.length;l++)h[l]=e.charCodeAt(l);return new Blob([g],{type:a})};a.requestImage=function(a,f){return m(a,
k({responseType:"image"},f)).then(function(a){return a.data})}})},"esri/views/webgl/Texture":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/has","../../core/mathUtils"],function(p,a,k,m,e){return function(){function a(e,f,l){this._glName=this._context=null;this._id=-1;this._descriptor=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._boundToUnits=new Set;this._context=e;this._descriptor=k({target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,
isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1},f);this._id=++a._nextId;m("esri-webgl-debug")&&e.instanceCounter.incrementCount(0);this.setData(l)}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._descriptor},enumerable:!0,configurable:!0});a.prototype.dispose=
function(){var a=this;if(this._context&&this._context.gl){if(this._glName){var e=this._context.gl;this._boundToUnits.forEach(function(e){a._context.bindTexture(null,e)});e.deleteTexture(this._glName);this._glName=null}m("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(0);this._context=null}};a.prototype.release=function(){this.dispose()};a.prototype.resize=function(a,e){var f=this._descriptor;if(f.width!==a||f.height!==e)f.width=a,f.height=e,this.setData(null)};a.prototype.setData=
function(e){var f=this._context.gl;this._glName||(this._glName=f.createTexture());void 0===e&&(e=null);null===e&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=this._descriptor.height||4);var g=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var c=this._descriptor;a._validateTexture(c);f.pixelStorei(f.UNPACK_ALIGNMENT,c.unpackAlignment);f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,c.flipped?1:0);f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c.preMultiplyAlpha?
1:0);var b=c.pixelFormat,d=c.internalFormat?c.internalFormat:b;if(e instanceof ImageData||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement){var k=e.width,m=e.height;e instanceof HTMLVideoElement&&(k=e.videoWidth,m=e.videoHeight);c.width&&c.height&&console.assert(k===c.width&&m===c.height);f.texImage2D(f.TEXTURE_2D,0,d,b,c.dataType,e);c.hasMipmap&&this.generateMipmap();void 0===c.width&&(c.width=k);void 0===c.height&&(c.height=m)}else if(null!=c.width&&null!=
c.height||console.error("Width and height must be specified!"),f.DEPTH24_STENCIL8&&d===f.DEPTH_STENCIL&&(d=f.DEPTH24_STENCIL8),k=c.width,m=c.height,null!=e&&"type"in e&&"compressed"===e.type){b=Math.round(Math.log(Math.max(k,m))/Math.LN2)+1;c.hasMipmap=c.hasMipmap&&b===e.levels.length;for(var p=0;;++p){f.compressedTexImage2D(f.TEXTURE_2D,p,d,k,m,0,e.levels[Math.min(p,e.levels.length-1)]);if(1===k&&1===m||!c.hasMipmap)break;k=Math.max(1,k>>1);m=Math.max(1,m>>1)}}else if(e)f.texImage2D(f.TEXTURE_2D,
0,d,k,m,0,b,c.dataType,e),c.hasMipmap&&this.generateMipmap();else for(p=0;;++p){f.texImage2D(f.TEXTURE_2D,p,d,k,m,0,b,c.dataType,null);if(1===k&&1===m||!c.hasMipmap)break;k=Math.max(1,k>>1);m=Math.max(1,m>>1)}a._applySamplingMode(f,this._descriptor);a._applyWrapMode(f,this._descriptor);a._applyAnisotropicFilteringParameters(this._context,this._descriptor);this._context.bindTexture(g,0)};a.prototype.updateData=function(a,e,f,c,b,d){d||console.error("An attempt to use uninitialized data!");this._glName||
console.error("An attempt to update uninitialized texture!");var g=this._context.gl,h=this._descriptor,l=this._context.getBoundTexture(0);this._context.bindTexture(this,0);(0>e||0>f||c>h.width||b>h.height||e+c>h.width||f+b>h.height)&&console.error("An attempt to update out of bounds of the texture!");g.pixelStorei(g.UNPACK_ALIGNMENT,h.unpackAlignment);g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,h.flipped?1:0);g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h.preMultiplyAlpha?1:0);d instanceof ImageData||d instanceof
HTMLImageElement||d instanceof HTMLCanvasElement||d instanceof HTMLVideoElement?g.texSubImage2D(g.TEXTURE_2D,a,e,f,h.pixelFormat,h.dataType,d):g.texSubImage2D(g.TEXTURE_2D,a,e,f,c,b,h.pixelFormat,h.dataType,d);this._context.bindTexture(l,0)};a.prototype.generateMipmap=function(){var e=this._descriptor;e.hasMipmap||(e.hasMipmap=!0,a._validateTexture(e));9729===e.samplingMode?(this._samplingModeDirty=!0,e.samplingMode=9985):9728===e.samplingMode&&(this._samplingModeDirty=!0,e.samplingMode=9984);e=this._context.getBoundTexture(0);
this._context.bindTexture(this,0);var f=this._context.gl;f.generateMipmap(f.TEXTURE_2D);this._context.bindTexture(e,0)};a.prototype.setSamplingMode=function(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,a._validateTexture(this._descriptor),this._samplingModeDirty=!0)};a.prototype.setWrapMode=function(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,a._validateTexture(this._descriptor),this._wrapModeDirty=!0)};a.prototype.applyChanges=function(){var e=this._context.gl,
f=this._descriptor;this._samplingModeDirty&&(a._applySamplingMode(e,f),this._samplingModeDirty=!1);this._wrapModeDirty&&(a._applyWrapMode(e,f),this._wrapModeDirty=!1)};a.prototype.setBoundToUnit=function(a,e){e?this._boundToUnits.add(a):this._boundToUnits.delete(a)};a._validateTexture=function(a){(0>a.width||0>a.height)&&console.error("Negative dimension parameters are not allowed!");e.isPowerOfTwo(a.width)&&e.isPowerOfTwo(a.height)||("number"===typeof a.wrapMode?33071!==a.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):
33071===a.wrapMode.s&&33071===a.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),a.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};a._applySamplingMode=function(a,e){var f=e.samplingMode,c=e.samplingMode;if(9985===f||9987===f)f=9729,e.hasMipmap||(c=9729);else if(9984===f||9986===f)f=9728,e.hasMipmap||(c=9728);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,f);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,c)};a._applyWrapMode=
function(a,e){"number"===typeof e.wrapMode?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,e.wrapMode),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,e.wrapMode)):(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,e.wrapMode.s),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,e.wrapMode.t))};a._applyAnisotropicFilteringParameters=function(a,e){if(null!=e.maxAnisotropy){var f=a.capabilities.textureFilterAnisotropic;f&&(a=a.gl,a.texParameterf(a.TEXTURE_2D,f.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy))}};a._nextId=
0;return a}()})},"esri/views/3d/webgl-engine/materials/renderers/Instance":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/mat4","../../../../../core/libs/gl-matrix-2/mat4f64"],function(p,a,k,m){Object.defineProperty(a,"__esModule",{value:!0});p=function(){return function(a,f,g,h,l,c,b){this.from=a;this.to=f;this.isHidden=g;this.highlightedIndexRanges=h;this.hasOccludees=l;this.transformation=c;this.instanceParameters=b;null!=c&&(this.transformationNormal=m.mat4f64.clone(c),
k.mat4.invert(this.transformationNormal,this.transformationNormal),k.mat4.transpose(this.transformationNormal,this.transformationNormal))}}();a.Instance=p})},"esri/views/3d/webgl-engine/materials/renderers/utils":function(){define("require exports ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../lib/ComponentUtils ../../lib/doublePrecisionUtils ../../lib/Util ../../../../webgl/Util".split(" "),function(p,a,k,m,e,f,g,h,l){Object.defineProperty(a,
"__esModule",{value:!0});a.checkIsHidden=function(a){return a.instanceParameters.hidden||f.generateVisibleIndexRanges(a.instanceParameters.componentVisibilities,a.componentOffsets)?!0:!1};a.generateRenderGeometryHighlightRanges=function(a){return a.instanceParameters.hidden?null:f.generateHighlightedIndexRanges(a.instanceParameters.componentVisibilities,a.instanceParameters.componentHighlights,a.componentOffsets)};a.doesRenderGeometryHaveHighlights=function(a){return a.instanceParameters.hidden?!1:
f.hasHighlights(a.instanceParameters.componentVisibilities,a.instanceParameters.componentHighlights,a.componentOffsets)};a.isRenderGeometryHidden=function(a){return a.instanceParameters.hidden?!0:f.isAllHidden(a.instanceParameters.componentVisibilities,a.componentOffsets)};a.drawArrays=function(a,b,c,d,e){a.drawArrays(b,c,d);e&&(e.drawCalls++,4===b&&(e.triangles+=d))};a.drawElements=function(a,b,c,d,e,f){var g=l.getBytesPerElement(c);a.drawElements(b,e,c,d*g);f&&(f.drawCalls++,4===b&&(f.triangles+=
e))};a.drawArraysFaceRange=function(a,b,c,d,e){for(var f=0,g=0;g<b.length;g++){var h=b[g],l=h[0]+c,h=h[1]-h[0]+1,f=f+h;a.drawArrays(d,l,h)}e&&(e.drawCalls+=b.length,4===d&&(e.triangles=f/3))};a.drawElementsFaceRange=function(a,b,c,d,e,f){for(var g=l.getBytesPerElement(e),h=0,k=0;k<b.length;k++){var m=b[k],n=m[0]+c,m=m[1]-m[0]+1,h=h+m;a.drawElements(d,m,e,n*g)}f&&(f.drawCalls+=b.length,4===d&&(f.triangles+=h/3))};a.acquireMaterials=function(a,b){var c=new Map;c.set(0,b.acquire(a,0));c.set(3,b.acquire(a,
3));c.set(2,b.acquire(a,2));c.set(1,b.acquire(a,1));c.set(4,b.acquire(a,4));return c};a.releaseMaterials=function(a,b){b.release(a,0);b.release(a,3);b.release(a,2);b.release(a,1);b.release(a,4)};a.calculateTransformRelToOrigin=function(a,b,c){var e=a.origin.vec3;h.setMatrixTranslation3(d,-e[0],-e[1],-e[2]);k.isSome(a.transformation)?m.mat4.multiply(b,d,a.transformation):m.mat4.copy(b,d);c&&(m.mat4.invert(c,b),m.mat4.transpose(c,c))};a.encodeDoubleVec3=function(a,d,e,f,h){c[0]=a.get(d,0);c[1]=a.get(d,
1);c[2]=a.get(d,2);g.encodeDoubleArray(c,b,3);e.set(h,0,b[0]);f.set(h,0,b[1]);e.set(h,1,b[2]);f.set(h,1,b[3]);e.set(h,2,b[4]);f.set(h,2,b[5])};var c=new Float64Array(3),b=new Float32Array(6),d=e.mat4f64.create()})},"esri/views/3d/webgl-engine/lib/doublePrecisionUtils":function(){define(["require","exports"],function(p,a){function k(a,e,h){for(var f=0;f<h;++f)e[2*f]=a[f],e[2*f+1]=a[f]-e[2*f]}Object.defineProperty(a,"__esModule",{value:!0});a.encodeDouble=function(a,g){e[0]=a;e[1]=a-e[0];g[0]=e[0];
g[1]=e[1]};a.encodeDoubleArray=k;a.decodeDoubleArray=function(a,e,h){for(var f=0;f<h;++f)e[f]=a[2*f]+a[2*f+1]};a.encodeDoubleArraySplit=function(a,g,h,l){for(var c=0;c<l;++c)m[0]=a[c],k(m,e,1),g[c]=e[0],h[c]=e[1]};var m=new Float64Array(1),e=new Float32Array(2)})},"esri/views/webgl/Util":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/compilerUtils"],function(p,a,k,m){function e(a){return a[0].stride}function f(a){switch(a){case 5126:return 4;case 5124:return 4;
case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1;default:throw m.neverReached(a),Error("Unknown data type");}}function g(a){switch(a){case 6406:case 6409:return 1;case 6410:return 2;case 6407:return 3;case 6408:return 4;case 34041:return 4;case 33325:return 2;case 33326:return 4;case 35898:return 4;case 33327:return 4;case 33328:return 8;case 34842:return 8;case 34836:return 16;case 33189:return 2;case 34041:return 4;case 32854:return 2;case 36168:return 1;
default:m.neverReached(a)}return 0}function h(a){if(!a)return 0;if("colorAttachment"in a)return a.glName?h(a.colorAttachment)+h(a.depthStencilAttachment):0;if("descriptor"in a)return a.glName?h(a.descriptor):0;var c=a.internalFormat||"pixelFormat"in a&&a.pixelFormat;if(!c)return 0;var b="hasMipmap"in a&&a.hasMipmap?1.3:1;a=a.width*a.height;return g(c)*a*b}Object.defineProperty(a,"__esModule",{value:!0});a.vertexCount=function(a,c){return a.vertexBuffers[c].size/e(a.layout[c])};a.getStride=e;a.getBytesPerElement=
f;a.getTypedArrayConstructor=function(a){switch(a){case 5120:return Int8Array;case 5126:return Float32Array;case 5124:return Int32Array;case 5122:return Int16Array;case 5121:return Uint8Array;case 5125:return Uint32Array;case 5123:return Uint16Array;default:throw m.neverReached(a),Error("Unknown data type");}};a.addDescriptor=function(a,c,b,d,e,g){var h=f(d);if(0<a.length){var l=a[0].stride,k=l+h*b;a.forEach(function(a){return a.stride=k});a.push({name:c,count:b,type:d,offset:l,stride:k,normalized:e,
divisor:g})}else a.push({name:c,count:b,type:d,offset:0,stride:h*b,normalized:e,divisor:g})};a.hasAttribute=function(a,c){for(var b=0;b<a.length;b++)if(a[b].name===c)return!0;return!1};a.findAttribute=function(a,c){for(var b=0;b<a.length;b++)if(a[b].name===c)return a[b];return null};a.copyFramebufferToTexture=function(a,c,b,d,e){void 0===e&&(e=0);var f=a.getBoundFramebufferObject(),g=a.getBoundTexture(0);a.bindFramebuffer(c);a.bindTexture(b,0);a.gl.copyTexImage2D(a.gl.TEXTURE_2D,e,b.descriptor.pixelFormat,
d[0],d[1],d[2],d[3],0);a.gl.flush();a.bindFramebuffer(f);a.bindTexture(g,0)};a.setBaseInstanceOffset=function(a,c){var b={},d;for(d in a)b[d]=a[d].map(function(a){return a.divisor?k({},a,{baseInstance:c}):a});return b};a.bindVertexBufferLayout=function(a,c,b,d,e){var f=a.gl,g=a.capabilities.instancing;a.bindBuffer(b);for(a=0;a<d.length;a++){b=d[a];var h=c[b.name],l=(e?e:0+b.baseInstance?b.baseInstance:0)*b.stride;void 0===h&&console.error("There is no location for vertex attribute '"+b.name+"' defined.");
b.baseInstance&&!b.divisor&&console.error("Vertex attribute '"+b.name+"' uses baseInstanceOffset without divisor.");if(4>=b.count)f.vertexAttribPointer(h,b.count,b.type,b.normalized,b.stride,b.offset+l),f.enableVertexAttribArray(h),b.divisor&&0<b.divisor&&g&&g.vertexAttribDivisor(h,b.divisor);else if(9===b.count)for(var k=0;3>k;k++)f.vertexAttribPointer(h+k,3,b.type,b.normalized,b.stride,b.offset+12*k+l),f.enableVertexAttribArray(h+k),b.divisor&&0<b.divisor&&g&&g.vertexAttribDivisor(h+k,b.divisor);
else if(16===b.count)for(k=0;4>k;k++)f.vertexAttribPointer(h+k,4,b.type,b.normalized,b.stride,b.offset+16*k+l),f.enableVertexAttribArray(h+k),b.divisor&&0<b.divisor&&g&&g.vertexAttribDivisor(h+k,b.divisor);else console.error("Unsupported vertex attribute element count: "+b.count)}};a.unbindVertexBufferLayout=function(a,c,b,d){var e=a.gl,f=a.capabilities.instancing;a.bindBuffer(b);for(b=0;b<d.length;b++){var g=d[b],h=c[g.name];if(4>=g.count)e.disableVertexAttribArray(h),g.divisor&&0<g.divisor&&f&&
f.vertexAttribDivisor(h,0);else if(9===g.count)for(var k=0;3>k;k++)e.disableVertexAttribArray(h+k),g.divisor&&0<g.divisor&&f&&f.vertexAttribDivisor(h+k,0);else if(16===g.count)for(k=0;4>k;k++)e.disableVertexAttribArray(h+k),g.divisor&&0<g.divisor&&f&&f.vertexAttribDivisor(h+k,0);else console.error("Unsupported vertex attribute element count: "+g.count)}a.unbindBuffer(34962)};a.getBytesPerElementFormat=g;a.getGpuMemoryUsage=h})},"esri/views/webgl/BufferObject":function(){define(["require","exports",
"../../core/has","../../core/typedArrayUtil"],function(p,a,k,m){return function(){function a(e,g,h,l,c){this._glName=this._context=null;this._bufferType=void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=e;this._bufferType=g;this._usage=h;this._id=a._nextId++;this._glName=this._context.gl.createBuffer();k("esri-webgl-debug")&&e.instanceCounter.incrementCount(1);l&&this.setData(l,c)}a.createIndex=function(e,g,h,k){return new a(e,34963,g,h,k)};a.createVertex=function(e,g,h){return new a(e,
34962,g,h)};Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"bufferType",{get:function(){return this._bufferType},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),k("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(1),
this._context=null)};a.prototype.setData=function(a,e){if(a){if("number"===typeof a){if(0>a&&console.error("Buffer size cannot be negative!"),34963===this._bufferType&&e)switch(this._indexType=e,this._size=a,e){case 5123:a*=2;break;case 5125:a*=4}}else e=a.byteLength,m.isUint16Array(a)&&(e/=2,this._indexType=5123),m.isUint32Array(a)&&(e/=4,this._indexType=5125),this._size=e;e=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,
a,this._usage);this._context.bindVAO(e)}};a.prototype.setSubData=function(a,e,h,k){void 0===e&&(e=0);void 0===h&&(h=0);if(a){(0>e||e>=this._size)&&console.error("offset is out of range!");var c=e,b=h,d=k,f=a.byteLength;m.isUint16Array(a)&&(f/=2,c*=2,b*=2,d*=2);m.isUint32Array(a)&&(f/=4,c*=4,b*=4,d*=4);void 0===k&&(k=f-1);h>=k&&console.error("end must be bigger than start!");e+h-k>this._size&&console.error("An attempt to write beyond the end of the buffer!");e=this._context.getBoundVAO();this._context.bindVAO(null);
this._context.bindBuffer(this);h=this._context.gl;a=ArrayBuffer.isView(a)?a.buffer:a;h.bufferSubData(this._bufferType,c,a.slice(b,d));this._context.bindVAO(e)}};a._nextId=0;return a}()})},"esri/views/webgl/VertexArrayObject":function(){define(["require","exports","../../core/has","./Util"],function(p,a,k,m){return function(){function a(e,g,h,l,c){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=this._buffers=void 0;this._initialized=!1;this._context=e;this._layout=h;
this._buffers=l;this._locations=g;c&&(this._indexBuffer=c);this._id=a._nextId++;k("esri-webgl-debug")&&e.instanceCounter.incrementCount(2)}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){var a=this;return Object.keys(this._buffers).reduce(function(e,f){return e+a._buffers[f].size},this._indexBuffer?this._indexBuffer.size:0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"layout",{get:function(){return this._layout},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},
enumerable:!0,configurable:!0});a.prototype.dispose=function(a){void 0===a&&(a=!0);if(this._context){var e=this._context.capabilities.vao;e&&this._glName&&(e.deleteVertexArray(this._glName),this._glName=null);this._context.getBoundVAO()===this&&this._context.bindVAO(null);if(a){for(var f in this._buffers)this._buffers[f].dispose(),delete this._buffers[f];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}k("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(2);this._context=
null}};a.prototype.initialize=function(){if(!this._initialized){var a=this._context.capabilities.vao;if(a){var e=a.createVertexArray();a.bindVertexArray(e);this._bindLayout();a.bindVertexArray(null);this._glName=e}this._initialized=!0}};a.prototype.bind=function(){this.initialize();var a=this._context.capabilities.vao;a?a.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())};a.prototype._bindLayout=function(){var a=this._buffers,e=!!this._context.capabilities.vao,h=this._layout,
k=this._indexBuffer;a||console.error("Vertex buffer dictionary is empty!");var c=this._context.gl,b;for(b in a){var d=a[b];d||console.error("Vertex buffer is uninitialized!");var n=h[b];n||console.error("Vertex element descriptor is empty!");m.bindVertexBufferLayout(this._context,this._locations,d,n)}k&&(e?c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,k.glName):this._context.bindBuffer(k))};a.prototype.unbind=function(){this.initialize();var a=this._context.capabilities.vao;a?a.bindVertexArray(null):this._unbindLayout()};
a.prototype._unbindLayout=function(){var a=this._buffers,e=this._layout;a||console.error("Vertex buffer dictionary is empty!");for(var h in a){var k=a[h];k||console.error("Vertex buffer is uninitialized!");m.unbindVertexBufferLayout(this._context,this._locations,k,e[h])}(a=this._indexBuffer)&&this._context.unbindBuffer(a.bufferType)};a._nextId=0;return a}()})},"esri/views/3d/webgl-engine/shaders/RibbonLineTechnique":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../../../core/maybe ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/Transform.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../core/shaderLibrary/shading/VisualVariables.glsl ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/StencilUtils ./RibbonLine.glsl ../../../webgl/Program ../../../webgl/renderState".split(" "),
function(p,a,k,m,e,f,g,h,l,c,b,d,n,t,r,w,u,q){Object.defineProperty(a,"__esModule",{value:!0});a.RibbonVertexAttributeConstants={POSITION:"position",SUBDIVISIONFACTOR:"subdivisionFactor",UV0:"uv0",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",SUBDIVISIONS:"subdivisions",COLOR:"color",COLORFEATUREATTRIBUTE:"colorFeatureAttribute",SIZE:"size",SIZEFEATUREATTRIBUTE:"sizeFeatureAttribute",OPACITYFEATUREATTRIBUTE:"opacityFeatureAttribute"};a.ribbonVertexAttributeLocations={position:0,subdivisionFactor:1,uv0:2,auxpos1:3,
auxpos2:4,size:6,sizeFeatureAttribute:6,color:5,colorFeatureAttribute:5,opacityFeatureAttribute:7};e=function(e){function m(a,b){b=e.call(this,a,b)||this;b.stipplePattern=null;b.stippleTextureBind=null;b.stippleTextureRepository=a.stippleTextureRepository;return b}k(m,e);m.prototype.initializeProgram=function(b){var c=m.shader.get(),d=this.configuration,c=c.build({output:d.output,slicePlaneEnabled:d.slicePlaneEnabled,sliceHighlightDisabled:d.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,
stippleEnabled:d.stippleEnabled,stippleOffColorEnabled:d.stippleOffColorEnabled,stippleUVMaxEnabled:d.stippleIntegerRepeatsEnabled,stippleIntegerRepeatsEnabled:d.stippleIntegerRepeatsEnabled,roundCaps:d.roundCaps,roundJoins:d.roundJoins,vvColor:d.vvColor,vvSize:d.vvSize,vvInstancingEnabled:!0,vvOpacity:d.vvOpacity,falloffEnabled:d.falloffEnabled,innerColorEnabled:d.innerColorEnabled});return new u(b.rctx,c.generateSource("vertex"),c.generateSource("fragment"),a.ribbonVertexAttributeLocations)};m.prototype.dispose=
function(){e.prototype.dispose.call(this);this.stippleTextureRepository.release(this.stipplePattern);this.stippleTextureBind=this.stipplePattern=null};m.prototype.bindPass=function(a,d,e){4===this.configuration.output&&c.OutputHighlight.bindOutputHighlight(a,this.program,e);this.program.setUniform1f("intrinsicWidth",d.width);this.program.setUniform4fv("intrinsicColor",d.color);this.program.setUniform1f("miterLimit","miter"!==d.join?0:d.miterLimit);this.program.setUniform1f("nearPlane",e.nearFar[0]);
this.program.setUniform1f("pixelRatio",e.pixelRatio);this.program.setUniform2fv("screenSize",[e.viewport[2],e.viewport[3]]);b.VisualVariables.bindUniformsWithOpacity(this.program,d);if(this.stipplePattern!==d.stipplePattern){var h=d.stipplePattern;this.stippleTextureBind=this.stippleTextureRepository.swap(this.stipplePattern,h);this.stipplePattern=h}this.configuration.stippleEnabled&&(a=g.isSome(this.stippleTextureBind)?this.stippleTextureBind(a,0)*e.pixelRatio:1,this.program.setUniform1i("stipplePatternTexture",
0),this.program.setUniform1f("stipplePatternPixelSizeInv",1/a),this.configuration.stippleOffColorEnabled&&(a=f.expect(d.stippleOffColor),this.program.setUniform4f("stippleOffColor",a[0],a[1],a[2],3<a.length?a[3]:1)));this.configuration.falloffEnabled&&this.program.setUniform1f("falloff",d.falloff);this.configuration.innerColorEnabled&&(this.program.setUniform4fv("innerColor",f.unwrapOr(d.innerColor,d.color)),this.program.setUniform1f("innerWidth",d.innerWidth*e.pixelRatio))};m.prototype.bindDraw=
function(a){l.Transform.bindUniforms(this.program,a);h.Slice.bindUniformsWithOrigin(this.program,this.configuration,a)};m.prototype.initializePipeline=function(){var a=this.configuration,b=q.separateBlendingParams(770,1,771,771),c=a.polygonOffset&&E;a.occluder&&(this._occluderPipelineTransparent=q.makePipelineState({blending:b,polygonOffset:c,depthTest:r.depthCompareAlways,depthWrite:null,colorWrite:q.defaultColorWriteParams,stencilWrite:null,stencilTest:r.stencilToolTransparentOccluderParams}),this._occluderPipelineOpaque=
q.makePipelineState({polygonOffset:c,depthTest:r.depthCompareAlways,depthWrite:null,colorWrite:q.defaultColorWriteParams,stencilWrite:r.stencilWriteMaskOff,stencilTest:r.stencilToolMaskOccluderParams}),this._occluderPipelineMaskWrite=q.makePipelineState({polygonOffset:c,depthTest:r.depthCompareLess,depthWrite:null,colorWrite:null,stencilWrite:r.stencilWriteMaskOn,stencilTest:r.stencilToolMaskBaseParams}));if(0===a.output){var d=function(d){return q.makePipelineState({blending:b,polygonOffset:c,depthTest:r.depthCompareLess,
depthWrite:!a.transparent&&a.writeDepth&&q.defaultDepthWriteParams,colorWrite:q.defaultColorWriteParams,stencilWrite:a.sceneHasOcludees?r.stencilWriteMaskOn:null,stencilTest:a.sceneHasOcludees?d?r.stencilToolMaskBaseParams:a.sceneHasOcludees?r.stencilBaseAllZerosParams:null:null})};this._occludeePipeline=d(!0);return d(!1)}return q.makePipelineState({polygonOffset:c,depthTest:r.depthCompareLess,depthWrite:!a.transparent&&a.writeDepth&&q.defaultDepthWriteParams,colorWrite:q.defaultColorWriteParams})};
Object.defineProperty(m.prototype,"occluderPipelineTransparent",{get:function(){return this._occluderPipelineTransparent},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"occluderPipelineOpaque",{get:function(){return this._occluderPipelineOpaque},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"occludeePipeline",{get:function(){return this._occludeePipeline},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"occluderPipelineMaskWrite",{get:function(){return this._occluderPipelineMaskWrite},
enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"primitiveType",{get:function(){return 5},enumerable:!0,configurable:!0});m.shader=new d.ReloadableShaderModule(w,"./RibbonLine.glsl",p);return m}(n.ShaderTechnique);a.RibbonLineTechnique=e;var E={factor:0,units:-4};e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.output=0;b.occluder=!1;b.slicePlaneEnabled=!1;b.sliceHighlightDisabled=!1;b.vertexColors=!1;b.transparent=!1;b.polygonOffset=!1;b.writeDepth=!1;
b.stippleEnabled=!1;b.stippleOffColorEnabled=!1;b.stippleIntegerRepeatsEnabled=!1;b.roundCaps=!1;b.roundJoins=!1;b.vvSize=!1;b.vvColor=!1;b.vvOpacity=!1;b.falloffEnabled=!1;b.innerColorEnabled=!1;b.sceneHasOcludees=!1;return b}k(b,a);m([t.parameter({count:7})],b.prototype,"output",void 0);m([t.parameter()],b.prototype,"occluder",void 0);m([t.parameter()],b.prototype,"slicePlaneEnabled",void 0);m([t.parameter()],b.prototype,"sliceHighlightDisabled",void 0);m([t.parameter()],b.prototype,"vertexColors",
void 0);m([t.parameter()],b.prototype,"transparent",void 0);m([t.parameter()],b.prototype,"polygonOffset",void 0);m([t.parameter()],b.prototype,"writeDepth",void 0);m([t.parameter()],b.prototype,"stippleEnabled",void 0);m([t.parameter()],b.prototype,"stippleOffColorEnabled",void 0);m([t.parameter()],b.prototype,"stippleIntegerRepeatsEnabled",void 0);m([t.parameter()],b.prototype,"roundCaps",void 0);m([t.parameter()],b.prototype,"roundJoins",void 0);m([t.parameter()],b.prototype,"vvSize",void 0);m([t.parameter()],
b.prototype,"vvColor",void 0);m([t.parameter()],b.prototype,"vvOpacity",void 0);m([t.parameter()],b.prototype,"falloffEnabled",void 0);m([t.parameter()],b.prototype,"innerColorEnabled",void 0);m([t.parameter()],b.prototype,"sceneHasOcludees",void 0);return b}(t.ShaderTechniqueConfiguration);a.RibbonLineTechniqueConfiguration=e})},"esri/views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper",
"../../shaderModules/interfaces"],function(p,a,k,m){function e(a){a.fragment.uniforms.add("depthTex","sampler2D");a.fragment.uniforms.add("highlightViewportPixelSz","vec4");a.fragment.code.add(m.glsl(f||(f=k(["\n    void outputHighlight() {\n      vec4 fragCoord \x3d gl_FragCoord;\n\n      float sceneDepth \x3d texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\n      if (fragCoord.z \x3e sceneDepth + 5e-7) {\n        gl_FragColor \x3d vec4(1.0, 1.0, 0.0, 1.0);\n      }\n      else {\n        gl_FragColor \x3d vec4(1.0, 0.0, 1.0, 1.0);\n      }\n    }\n  "],
["\n    void outputHighlight() {\n      vec4 fragCoord \x3d gl_FragCoord;\n\n      float sceneDepth \x3d texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\n      if (fragCoord.z \x3e sceneDepth + 5e-7) {\n        gl_FragColor \x3d vec4(1.0, 1.0, 0.0, 1.0);\n      }\n      else {\n        gl_FragColor \x3d vec4(1.0, 0.0, 1.0, 1.0);\n      }\n    }\n  "]))))}Object.defineProperty(a,"__esModule",{value:!0});a.OutputHighlight=e;(function(a){a.bindOutputHighlight=
function(a,e,c){a.bindTexture(c.highlightDepthTexture,5);e.setUniform1i("depthTex",5);e.setUniform4f("highlightViewportPixelSz",0,0,1/c.viewport[2],1/c.viewport[3])}})(e=a.OutputHighlight||(a.OutputHighlight={}));var f})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(p,a,k,m){function e(a,e){e.vvInstancingEnabled&&(e.vvSize||e.vvColor)&&
a.attributes.add("instanceFeatureAttribute","vec4");e.vvSize?(a.vertex.uniforms.add("vvSizeMinSize","vec3"),a.vertex.uniforms.add("vvSizeMaxSize","vec3"),a.vertex.uniforms.add("vvSizeOffset","vec3"),a.vertex.uniforms.add("vvSizeFactor","vec3"),a.vertex.uniforms.add("vvSymbolRotationMatrix","mat3"),a.vertex.uniforms.add("vvSymbolAnchor","vec3"),a.vertex.code.add(m.glsl(f||(f=k(["\n      vec3 vvScale(vec4 _featureAttribute) {\n        return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n      }\n\n      vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\n        return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n      }\n    "],
["\n      vec3 vvScale(vec4 _featureAttribute) {\n        return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n      }\n\n      vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\n        return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n      }\n    "])))),a.vertex.code.add(m.glsl(h||(h=k(["\n      const float eps \x3d 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale \x3d clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ",
"\n    "],["\n      const float eps \x3d 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale \x3d clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ","\n    "])),e.vvInstancingEnabled?m.glsl(g||(g=k(["\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }"],
["\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }"]))):""))):a.vertex.code.add(m.glsl(l||(l=k(["\n      vec4 localPosition() { return vec4(position, 1.0); }\n\n      vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }\n    "],["\n      vec4 localPosition() { return vec4(position, 1.0); }\n\n      vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }\n    "]))));
e.vvColor?(a.vertex.defines.addInt("VV_COLOR_N",8),a.vertex.code.add(m.glsl(b||(b=k(["\n      uniform float vvColorValues[VV_COLOR_N];\n      uniform vec4 vvColorColors[VV_COLOR_N];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[VV_COLOR_N], vec4 colors[VV_COLOR_N]) {\n        float value \x3d featureAttribute.y;\n        if (value \x3c\x3d values[0]) {\n          return colors[0];\n        }\n\n        for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n          if (values[i] \x3e\x3d value) {\n            float f \x3d (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[VV_COLOR_N - 1];\n      }\n\n      ",
"\n    "],["\n      uniform float vvColorValues[VV_COLOR_N];\n      uniform vec4 vvColorColors[VV_COLOR_N];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[VV_COLOR_N], vec4 colors[VV_COLOR_N]) {\n        float value \x3d featureAttribute.y;\n        if (value \x3c\x3d values[0]) {\n          return colors[0];\n        }\n\n        for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n          if (values[i] \x3e\x3d value) {\n            float f \x3d (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[VV_COLOR_N - 1];\n      }\n\n      ",
"\n    "])),e.vvInstancingEnabled?m.glsl(c||(c=k(["\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }"],["\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }"]))):""))):a.vertex.code.add(m.glsl(d||(d=k(["\n      vec4 vvColor() { return vec4(1.0); }\n    "],["\n      vec4 vvColor() { return vec4(1.0); }\n    "]))))}Object.defineProperty(a,"__esModule",{value:!0});a.VisualVariables=
e;(function(a){function b(a,b){b.vvSizeEnabled&&(a.setUniform3fv("vvSizeMinSize",b.vvSizeMinSize),a.setUniform3fv("vvSizeMaxSize",b.vvSizeMaxSize),a.setUniform3fv("vvSizeOffset",b.vvSizeOffset),a.setUniform3fv("vvSizeFactor",b.vvSizeFactor));b.vvColorEnabled&&(a.setUniform1fv("vvColorValues",b.vvColorValues),a.setUniform4fv("vvColorColors",b.vvColorColors))}a.bindUniforms=b;a.bindUniformsWithOpacity=function(a,c){b(a,c);c.vvOpacityEnabled&&(a.setUniform1fv("vvOpacityValues",c.vvOpacityValues),a.setUniform1fv("vvOpacityOpacities",
c.vvOpacityOpacities))};a.bindUniformsForSymbols=function(a,c){b(a,c);c.vvSizeEnabled&&(a.setUniform3fv("vvSymbolAnchor",c.vvSymbolAnchor),a.setUniformMatrix3fv("vvSymbolRotationMatrix",c.vvSymbolRotationMatrix))}})(e=a.VisualVariables||(a.VisualVariables={}));var f,g,h,l,c,b,d})},"esri/views/3d/webgl-engine/lib/StencilUtils":function(){define(["require","exports"],function(p,a){Object.defineProperty(a,"__esModule",{value:!0});a.depthCompareLess={func:513};a.depthCompareAlways={func:519};a.stencilWriteMaskOn=
{mask:255};a.stencilWriteMaskOff={mask:0};a.renderWhenBitIsNotSet=function(a){return{function:{func:517,ref:a,mask:a},operation:{fail:7680,zFail:7680,zPass:7680}}};a.replaceBitWhenDepthTestPasses=function(a){return{function:{func:519,ref:a,mask:a},operation:{fail:7680,zFail:7680,zPass:7681}}};a.stencilBaseAllZerosParams={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}};a.stencilToolMaskBaseParams={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}};
a.stencilToolMaskOccluderParams={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}};a.stencilToolTransparentOccluderParams={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}}})},"esri/views/3d/webgl-engine/shaders/RibbonLine.glsl":function(){define("require exports ../../../../core/tsSupport/makeTemplateObjectHelper ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/attributes/RibbonVertexPosition.glsl ../core/shaderLibrary/shading/LineStipple.glsl ../core/shaderLibrary/shading/PiUtils.glsl ../core/shaderModules/interfaces ../core/shaderModules/ShaderBuilder".split(" "),
function(p,a,k,m,e,f,g,h,l){Object.defineProperty(a,"__esModule",{value:!0});a.build=function(a){var p=new l.ShaderBuilder;p.extensions.add("GL_OES_standard_derivatives");p.include(g.PiUtils);p.include(e.RibbonVertexPosition,a);p.include(f.LineStipple,a);p.vertex.uniforms.add("proj","mat4").add("view","mat4").add("model","mat4").add("nearPlane","float").add("pixelRatio","float").add("miterLimit","float").add("screenSize","vec2");p.attributes.add("position","vec3");p.attributes.add("subdivisionFactor",
"float");p.attributes.add("uv0","vec2");p.attributes.add("auxpos1","vec3");p.attributes.add("auxpos2","vec3");p.varyings.add("vColor","vec4");p.varyings.add("vpos","vec3");var M=a.falloffEnabled,N=a.innerColorEnabled;N&&p.varyings.add("vLineDistance","float");M&&p.varyings.add("vLineDistanceNorm","float");a.falloffEnabled&&p.fragment.uniforms.add("falloff","float");a.innerColorEnabled&&(p.fragment.uniforms.add("innerColor","vec4"),p.fragment.uniforms.add("innerWidth","float"));p.vertex.code.add(h.glsl(c||
(c=k(["\n\t\t#define PERPENDICULAR(v) vec2(v.y, -v.x);\n\t\t#define ISOUTSIDE (left.x * right.y - left.y * right.x)*uv0.y \x3e 0.0\n\n\t\tfloat interp(float ncp, vec4 a, vec4 b) {\n\t\t\treturn (-ncp - a.z) / (b.z - a.z);\n\t\t}\n\n\t\tvec2 rotate(vec2 v, float a) {\n\t\t\tfloat s \x3d sin(a);\n\t\t\tfloat c \x3d cos(a);\n\t\t\tmat2 m \x3d mat2(c, -s, s, c);\n\t\t\treturn m * v;\n\t\t}\n"],["\n\t\t#define PERPENDICULAR(v) vec2(v.y, -v.x);\n\t\t#define ISOUTSIDE (left.x * right.y - left.y * right.x)*uv0.y \x3e 0.0\n\n\t\tfloat interp(float ncp, vec4 a, vec4 b) {\n\t\t\treturn (-ncp - a.z) / (b.z - a.z);\n\t\t}\n\n\t\tvec2 rotate(vec2 v, float a) {\n\t\t\tfloat s \x3d sin(a);\n\t\t\tfloat c \x3d cos(a);\n\t\t\tmat2 m \x3d mat2(c, -s, s, c);\n\t\t\treturn m * v;\n\t\t}\n"]))));
p.vertex.code.add(h.glsl(b||(b=k(["\n    vec4 projectAndScale(vec4 pos) {\n      vec4 posNdc \x3d proj * pos;\n\n      // Note that posNdc is in -1:1, scaling by screenSize converts this to a coordinate system\n      // that is twice scaled (going from -size:size).\n      posNdc.xy *\x3d screenSize / posNdc.w;\n      return posNdc;\n    }\n"],["\n    vec4 projectAndScale(vec4 pos) {\n      vec4 posNdc \x3d proj * pos;\n\n      // Note that posNdc is in -1:1, scaling by screenSize converts this to a coordinate system\n      // that is twice scaled (going from -size:size).\n      posNdc.xy *\x3d screenSize / posNdc.w;\n      return posNdc;\n    }\n"]))));
p.vertex.code.add(h.glsl(d||(d=k(["\n    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {\n      float vnp \x3d nearPlane*0.99;\n\n      //current pos behind ncp --\x3e we need to clip\n      if(pos.z \x3e -nearPlane) {\n        if (!isStartVertex) {\n          //previous in front of ncp\n          if(prev.z \x3c -nearPlane) {\n            pos \x3d mix(prev, pos, interp(vnp, prev, pos));\n            next \x3d pos;\n          } else {\n            pos \x3d vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n        //next in front of ncp\n        if(isStartVertex) {\n          if(next.z \x3c -nearPlane) {\n            pos \x3d mix(pos, next, interp(vnp, pos, next));\n            prev \x3d pos;\n          } else {\n            pos \x3d vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n      } else {\n        //current position visible\n        //previous behind ncp\n        if (prev.z \x3e -nearPlane) {\n          prev \x3d mix(pos, prev, interp(vnp, pos, prev));\n        }\n        //next behind ncp\n        if (next.z \x3e -nearPlane) {\n          next \x3d mix(next, pos, interp(vnp, next, pos));\n        }\n      }\n\n      pos \x3d projectAndScale(pos);\n      next \x3d projectAndScale(next);\n      prev \x3d projectAndScale(prev);\n    }\n"],
["\n    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {\n      float vnp \x3d nearPlane*0.99;\n\n      //current pos behind ncp --\x3e we need to clip\n      if(pos.z \x3e -nearPlane) {\n        if (!isStartVertex) {\n          //previous in front of ncp\n          if(prev.z \x3c -nearPlane) {\n            pos \x3d mix(prev, pos, interp(vnp, prev, pos));\n            next \x3d pos;\n          } else {\n            pos \x3d vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n        //next in front of ncp\n        if(isStartVertex) {\n          if(next.z \x3c -nearPlane) {\n            pos \x3d mix(pos, next, interp(vnp, pos, next));\n            prev \x3d pos;\n          } else {\n            pos \x3d vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n      } else {\n        //current position visible\n        //previous behind ncp\n        if (prev.z \x3e -nearPlane) {\n          prev \x3d mix(pos, prev, interp(vnp, pos, prev));\n        }\n        //next behind ncp\n        if (next.z \x3e -nearPlane) {\n          next \x3d mix(next, pos, interp(vnp, next, pos));\n        }\n      }\n\n      pos \x3d projectAndScale(pos);\n      next \x3d projectAndScale(next);\n      prev \x3d projectAndScale(prev);\n    }\n"]))));
p.vertex.code.add(h.glsl(n||(n=k(["\n  void main(void) {\n    float coverage \x3d 1.0;\n    vpos \x3d (model * vec4(position, 1.0)).xyz;\n\n    // Check for special value of uv0.y which is used by the Renderer when graphics\n    // are removed before the VBO is recompacted. If this is the case, then we just\n    // project outside of clip space.\n    if (uv0.y \x3d\x3d 0.0) {\n      // Project out of clip space\n      gl_Position \x3d vec4(1e038, 1e038, 1e038, 1.0);\n    }\n    else {\n      bool isStartVertex \x3d abs(abs(uv0.y)-3.0) \x3d\x3d 1.0;\n      bool isJoin \x3d abs(uv0.y)-3.0 \x3c 0.0;\n\n      float lineWidth \x3d getSize() * pixelRatio;\n\n      // convert sub-pixel coverage to alpha\n      if (lineWidth \x3c 1.0) {\n        coverage \x3d lineWidth;\n        lineWidth \x3d 1.0;\n      }\n\n      vec4 pos  \x3d view * vec4((model * vec4(position.xyz, 1.0)).xyz, 1.0);\n      vec4 prev \x3d view * vec4((model * vec4(auxpos1.xyz, 1.0)).xyz, 1.0);\n      vec4 next \x3d view * vec4((model * vec4(auxpos2.xyz, 1.0)).xyz, 1.0);\n\n      clipAndTransform(pos, prev, next, isStartVertex);\n\n      vec2 left \x3d (pos.xy - prev.xy);\n      vec2 right \x3d (next.xy - pos.xy);\n\n      float leftLen \x3d length(left);\n      float rightLen \x3d length(right);\n  "],
["\n  void main(void) {\n    float coverage \x3d 1.0;\n    vpos \x3d (model * vec4(position, 1.0)).xyz;\n\n    // Check for special value of uv0.y which is used by the Renderer when graphics\n    // are removed before the VBO is recompacted. If this is the case, then we just\n    // project outside of clip space.\n    if (uv0.y \x3d\x3d 0.0) {\n      // Project out of clip space\n      gl_Position \x3d vec4(1e038, 1e038, 1e038, 1.0);\n    }\n    else {\n      bool isStartVertex \x3d abs(abs(uv0.y)-3.0) \x3d\x3d 1.0;\n      bool isJoin \x3d abs(uv0.y)-3.0 \x3c 0.0;\n\n      float lineWidth \x3d getSize() * pixelRatio;\n\n      // convert sub-pixel coverage to alpha\n      if (lineWidth \x3c 1.0) {\n        coverage \x3d lineWidth;\n        lineWidth \x3d 1.0;\n      }\n\n      vec4 pos  \x3d view * vec4((model * vec4(position.xyz, 1.0)).xyz, 1.0);\n      vec4 prev \x3d view * vec4((model * vec4(auxpos1.xyz, 1.0)).xyz, 1.0);\n      vec4 next \x3d view * vec4((model * vec4(auxpos2.xyz, 1.0)).xyz, 1.0);\n\n      clipAndTransform(pos, prev, next, isStartVertex);\n\n      vec2 left \x3d (pos.xy - prev.xy);\n      vec2 right \x3d (next.xy - pos.xy);\n\n      float leftLen \x3d length(left);\n      float rightLen \x3d length(right);\n  "]))));
a.stippleEnabled&&p.vertex.code.add(h.glsl(t||(t=k(["\n      // uv0.x is either 0 or 1, depending on whether this is considered the start of a line segment\n      // or the end. If start, then use pos-\x3enext, otherwise use prev-\x3epos to define the line segment\n      // vector\n      vec4 stippleSegmentInfo \x3d mix(vec4(pos.xy, right), vec4(prev.xy, left), uv0.x);\n      vec2 stippleSegmentOrigin \x3d stippleSegmentInfo.xy;\n\n      // Scale s.t. it's in units of stipple pattern size.\n      vec2 stippleSegmentDirection \x3d stippleSegmentInfo.zw;\n    "],
["\n      // uv0.x is either 0 or 1, depending on whether this is considered the start of a line segment\n      // or the end. If start, then use pos-\x3enext, otherwise use prev-\x3epos to define the line segment\n      // vector\n      vec4 stippleSegmentInfo \x3d mix(vec4(pos.xy, right), vec4(prev.xy, left), uv0.x);\n      vec2 stippleSegmentOrigin \x3d stippleSegmentInfo.xy;\n\n      // Scale s.t. it's in units of stipple pattern size.\n      vec2 stippleSegmentDirection \x3d stippleSegmentInfo.zw;\n    "]))));
p.vertex.code.add(h.glsl(r||(r=k(['\n    left \x3d (leftLen \x3e 0.001) ? left/leftLen : vec2(0.0, 0.0);\n    right \x3d (rightLen \x3e 0.001) ? right/rightLen : vec2(0.0, 0.0);\n\n    vec2 capDisplacementDir \x3d vec2(0, 0);\n    vec2 joinDisplacementDir \x3d vec2(0, 0);\n    float displacementLen \x3d lineWidth;\n\n    if (isJoin) {\n\n      // JOIN handling ---------------------------------------------------\n      // determine if vertex is on the "outside or "inside" of the join\n      bool isOutside \x3d ISOUTSIDE;\n\n      // compute miter join position first\n      joinDisplacementDir \x3d normalize(left + right);\n      joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n\n      // compute miter stretch\n      if (leftLen \x3e 0.001 \x26\x26 rightLen \x3e 0.001) {\n        float nDotSeg \x3d dot(joinDisplacementDir, left);\n        displacementLen /\x3d length(nDotSeg * left - joinDisplacementDir);\n\n        // limit displacement of inner vertices\n        if (!isOutside) {\n          displacementLen \x3d min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\n        }\n      }\n\n      if (isOutside \x26\x26 (displacementLen \x3e miterLimit * lineWidth)) {\n    '],
['\n    left \x3d (leftLen \x3e 0.001) ? left/leftLen : vec2(0.0, 0.0);\n    right \x3d (rightLen \x3e 0.001) ? right/rightLen : vec2(0.0, 0.0);\n\n    vec2 capDisplacementDir \x3d vec2(0, 0);\n    vec2 joinDisplacementDir \x3d vec2(0, 0);\n    float displacementLen \x3d lineWidth;\n\n    if (isJoin) {\n\n      // JOIN handling ---------------------------------------------------\n      // determine if vertex is on the "outside or "inside" of the join\n      bool isOutside \x3d ISOUTSIDE;\n\n      // compute miter join position first\n      joinDisplacementDir \x3d normalize(left + right);\n      joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n\n      // compute miter stretch\n      if (leftLen \x3e 0.001 \x26\x26 rightLen \x3e 0.001) {\n        float nDotSeg \x3d dot(joinDisplacementDir, left);\n        displacementLen /\x3d length(nDotSeg * left - joinDisplacementDir);\n\n        // limit displacement of inner vertices\n        if (!isOutside) {\n          displacementLen \x3d min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\n        }\n      }\n\n      if (isOutside \x26\x26 (displacementLen \x3e miterLimit * lineWidth)) {\n    ']))));
a.roundJoins?p.vertex.code.add(h.glsl(w||(w=k(["\n        vec2 startDir;\n        vec2 endDir;\n\n        if (leftLen \x3c 0.001) {\n          startDir \x3d right;\n        }\n        else{\n          startDir \x3d left;\n        }\n        startDir \x3d normalize(startDir);\n        startDir \x3d PERPENDICULAR(startDir);\n\n        if (rightLen \x3c 0.001) {\n          endDir \x3d left;\n        }\n        else{\n          endDir \x3d right;\n        }\n        endDir \x3d normalize(endDir);\n        endDir \x3d PERPENDICULAR(endDir);\n\n        float rotationAngle \x3d acos(clamp(dot(startDir, endDir), -1.0, 1.0));\n        joinDisplacementDir \x3d rotate(startDir, -sign(uv0.y) * subdivisionFactor * rotationAngle);\n      "],
["\n        vec2 startDir;\n        vec2 endDir;\n\n        if (leftLen \x3c 0.001) {\n          startDir \x3d right;\n        }\n        else{\n          startDir \x3d left;\n        }\n        startDir \x3d normalize(startDir);\n        startDir \x3d PERPENDICULAR(startDir);\n\n        if (rightLen \x3c 0.001) {\n          endDir \x3d left;\n        }\n        else{\n          endDir \x3d right;\n        }\n        endDir \x3d normalize(endDir);\n        endDir \x3d PERPENDICULAR(endDir);\n\n        float rotationAngle \x3d acos(clamp(dot(startDir, endDir), -1.0, 1.0));\n        joinDisplacementDir \x3d rotate(startDir, -sign(uv0.y) * subdivisionFactor * rotationAngle);\n      "])))):
p.vertex.code.add(h.glsl(u||(u=k(["\n        // convert to bevel join if miterLimit is exceeded\n        if (leftLen \x3c 0.001) {\n          joinDisplacementDir \x3d right;\n        }\n        else if (rightLen \x3c 0.001) {\n          joinDisplacementDir \x3d left;\n        }\n        else {\n          joinDisplacementDir \x3d isStartVertex ? right : left;\n        }\n        joinDisplacementDir \x3d normalize(joinDisplacementDir);\n        joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n  "],
["\n        // convert to bevel join if miterLimit is exceeded\n        if (leftLen \x3c 0.001) {\n          joinDisplacementDir \x3d right;\n        }\n        else if (rightLen \x3c 0.001) {\n          joinDisplacementDir \x3d left;\n        }\n        else {\n          joinDisplacementDir \x3d isStartVertex ? right : left;\n        }\n        joinDisplacementDir \x3d normalize(joinDisplacementDir);\n        joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n  "]))));p.vertex.code.add(h.glsl(q||
(q=k(["\n        displacementLen \x3d lineWidth;\n      }\n    } else {\n    // CAP handling ---------------------------------------------------\n    if (leftLen \x3c 0.001) {\n      joinDisplacementDir \x3d right;\n    }\n    else if (rightLen \x3c 0.001) {\n      joinDisplacementDir \x3d left;\n    }\n    else {\n      joinDisplacementDir \x3d isStartVertex ? right : left;\n    }\n    joinDisplacementDir \x3d normalize(joinDisplacementDir);\n    joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n    displacementLen \x3d lineWidth;\n\n    capDisplacementDir \x3d isStartVertex ? -right : left;\n  "],
["\n        displacementLen \x3d lineWidth;\n      }\n    } else {\n    // CAP handling ---------------------------------------------------\n    if (leftLen \x3c 0.001) {\n      joinDisplacementDir \x3d right;\n    }\n    else if (rightLen \x3c 0.001) {\n      joinDisplacementDir \x3d left;\n    }\n    else {\n      joinDisplacementDir \x3d isStartVertex ? right : left;\n    }\n    joinDisplacementDir \x3d normalize(joinDisplacementDir);\n    joinDisplacementDir \x3d PERPENDICULAR(joinDisplacementDir);\n    displacementLen \x3d lineWidth;\n\n    capDisplacementDir \x3d isStartVertex ? -right : left;\n  "]))));
a.roundCaps?p.vertex.code.add(h.glsl(E||(E=k(["\n    float angle \x3d subdivisionFactor*PI*0.5;\n    joinDisplacementDir *\x3d cos(angle);\n    capDisplacementDir *\x3d sin(angle);\n    "],["\n    float angle \x3d subdivisionFactor*PI*0.5;\n    joinDisplacementDir *\x3d cos(angle);\n    capDisplacementDir *\x3d sin(angle);\n    "])))):p.vertex.code.add(h.glsl(x||(x=k(["\n    capDisplacementDir *\x3d subdivisionFactor;\n    "],["\n    capDisplacementDir *\x3d subdivisionFactor;\n    "]))));p.vertex.code.add(h.glsl(A||
(A=k(["\n  }\n\n  // Displacement (in pixels) caused by join/or cap\n  vec2 dpos \x3d joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;\n\n  ","\n\n  ","\n  ","\n\n  pos.xy +\x3d dpos;\n  "],["\n  }\n\n  // Displacement (in pixels) caused by join/or cap\n  vec2 dpos \x3d joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;\n\n  ","\n\n  ","\n  ","\n\n  pos.xy +\x3d dpos;\n  "])),M||N?h.glsl(z||(z=k(["float lineDist \x3d lineWidth * sign(uv0.y) * pos.w;"],
["float lineDist \x3d lineWidth * sign(uv0.y) * pos.w;"]))):"",N?h.glsl(y||(y=k(["vLineDistance \x3d lineDist;"],["vLineDistance \x3d lineDist;"]))):"",M?h.glsl(v||(v=k(["vLineDistanceNorm \x3d lineDist / lineWidth;"],["vLineDistanceNorm \x3d lineDist / lineWidth;"]))):""));a.stippleEnabled&&(p.vertex.code.add(h.glsl(B||(B=k(["\n    {\n      // Compute the stipple pattern UV coordinate from the actual position, based on the origin\n      // and direction of the line segment on which the stipple pattern is based.\n\n      // Project the vector from the origin of the segment to the vertex onto the line segment.\n      // Note the 0.5 factor due to projected positions being at twice the screen size scale (see projectAndScale)\n      vec2 posVec \x3d pos.xy - stippleSegmentOrigin;\n\n      float stippleSegmentDirectionLength \x3d length(stippleSegmentDirection);\n    "],
["\n    {\n      // Compute the stipple pattern UV coordinate from the actual position, based on the origin\n      // and direction of the line segment on which the stipple pattern is based.\n\n      // Project the vector from the origin of the segment to the vertex onto the line segment.\n      // Note the 0.5 factor due to projected positions being at twice the screen size scale (see projectAndScale)\n      vec2 posVec \x3d pos.xy - stippleSegmentOrigin;\n\n      float stippleSegmentDirectionLength \x3d length(stippleSegmentDirection);\n    "])))),
a.stippleIntegerRepeatsEnabled&&p.vertex.code.add(h.glsl(C||(C=k(["\n      float numberOfPatternRepeats \x3d stippleSegmentDirectionLength * 0.5 * stipplePatternPixelSizeInv;\n      float roundedNumberOfPatternRepeats \x3d max(1.0, floor(numberOfPatternRepeats + 0.5));\n      stipplePatternUvMax \x3d roundedNumberOfPatternRepeats;\n      "],["\n      float numberOfPatternRepeats \x3d stippleSegmentDirectionLength * 0.5 * stipplePatternPixelSizeInv;\n      float roundedNumberOfPatternRepeats \x3d max(1.0, floor(numberOfPatternRepeats + 0.5));\n      stipplePatternUvMax \x3d roundedNumberOfPatternRepeats;\n      "])))),
p.vertex.code.add(h.glsl(L||(L=k(["\n      if (stippleSegmentDirectionLength \x3e\x3d 0.001) {\n        // Project the vertex position onto the line segment.\n        float projectedLength \x3d dot(stippleSegmentDirection, posVec) / stippleSegmentDirectionLength * 0.5;\n     ","\n        stipplePatternUv \x3d projectedLength * wholeNumberOfRepeatsScale * stipplePatternPixelSizeInv * pos.w;\n        } else {\n          stipplePatternUv \x3d 1.0;\n        }\n      }\n    "],["\n      if (stippleSegmentDirectionLength \x3e\x3d 0.001) {\n        // Project the vertex position onto the line segment.\n        float projectedLength \x3d dot(stippleSegmentDirection, posVec) / stippleSegmentDirectionLength * 0.5;\n     ",
"\n        stipplePatternUv \x3d projectedLength * wholeNumberOfRepeatsScale * stipplePatternPixelSizeInv * pos.w;\n        } else {\n          stipplePatternUv \x3d 1.0;\n        }\n      }\n    "])),a.stippleIntegerRepeatsEnabled?"float wholeNumberOfRepeatsScale \x3d roundedNumberOfPatternRepeats / numberOfPatternRepeats;":"float wholeNumberOfRepeatsScale \x3d 1.0;")));p.vertex.code.add(h.glsl(R||(R=k(["\n      // Convert back into NDC\n      pos.xy \x3d pos.xy / screenSize * pos.w;\n\n      vColor \x3d getColor();\n      vColor.a *\x3d coverage;\n\n      gl_Position \x3d pos;\n    }\n  }\n  "],
["\n      // Convert back into NDC\n      pos.xy \x3d pos.xy / screenSize * pos.w;\n\n      vColor \x3d getColor();\n      vColor.a *\x3d coverage;\n\n      gl_Position \x3d pos;\n    }\n  }\n  "]))));p.include(m.Slice,a);0===a.output&&(p.fragment.uniforms.add("intrinsicColor","vec4"),p.fragment.code.add(h.glsl(K||(K=k(["\n    void main() {\n      discardBySlice(vpos);\n      float stippleAlpha \x3d getStippleAlpha();\n      discardByStippleAlpha(stippleAlpha, STIPPLE_ALPHA_COLOR_DISCARD);\n\n      vec4 color \x3d intrinsicColor * vColor;\n    "],
["\n    void main() {\n      discardBySlice(vpos);\n      float stippleAlpha \x3d getStippleAlpha();\n      discardByStippleAlpha(stippleAlpha, STIPPLE_ALPHA_COLOR_DISCARD);\n\n      vec4 color \x3d intrinsicColor * vColor;\n    "])))),a.innerColorEnabled&&(p.fragment.uniforms.add("pixelRatio","float"),p.fragment.code.add(h.glsl(D||(D=k(["\n      float distToInner \x3d abs(vLineDistance * gl_FragCoord.w) - innerWidth;\n      float innerAA \x3d clamp(0.5 - distToInner, 0.0, 1.0);\n      float innerAlpha \x3d innerColor.a + color.a * (1.0 - innerColor.a);\n      color \x3d mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);\n      "],
["\n      float distToInner \x3d abs(vLineDistance * gl_FragCoord.w) - innerWidth;\n      float innerAA \x3d clamp(0.5 - distToInner, 0.0, 1.0);\n      float innerAlpha \x3d innerColor.a + color.a * (1.0 - innerColor.a);\n      color \x3d mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);\n      "]))))),p.fragment.code.add(h.glsl(G||(G=k(["\n      vec4 finalColor \x3d blendStipple(color, stippleAlpha);\n    "],["\n      vec4 finalColor \x3d blendStipple(color, stippleAlpha);\n    "])))),a.falloffEnabled&&
p.fragment.code.add(h.glsl(H||(H=k(["\n      finalColor.a *\x3d pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);\n      "],["\n      finalColor.a *\x3d pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);\n      "])))),p.fragment.code.add(h.glsl(I||(I=k(["\n      gl_FragColor \x3d highlightSlice(finalColor, vpos);\n    }\n    "],["\n      gl_FragColor \x3d highlightSlice(finalColor, vpos);\n    }\n    "])))));4===a.output&&p.fragment.code.add(h.glsl(J||(J=k(["\n      void main() {\n        discardBySlice(vpos);\n        discardByStippleAlpha(getStippleAlpha(), STIPPLE_ALPHA_HIGHLIGHT_DISCARD);\n        gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n      }\n    "],
["\n      void main() {\n        discardBySlice(vpos);\n        discardByStippleAlpha(getStippleAlpha(), STIPPLE_ALPHA_HIGHLIGHT_DISCARD);\n        gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n      }\n    "]))));return p};var c,b,d,n,t,r,w,u,q,E,x,z,y,v,A,B,C,L,R,K,D,G,H,I,J})},"esri/views/3d/webgl-engine/core/shaderLibrary/attributes/RibbonVertexPosition.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(p,
a,k,m){Object.defineProperty(a,"__esModule",{value:!0});a.RibbonVertexPosition=function(a,d){a.vertex.uniforms.add("intrinsicWidth","float");d.vvSize?(a.attributes.add("sizeFeatureAttribute","float"),a.vertex.uniforms.add("vvSizeMinSize","vec3"),a.vertex.uniforms.add("vvSizeMaxSize","vec3"),a.vertex.uniforms.add("vvSizeOffset","vec3"),a.vertex.uniforms.add("vvSizeFactor","vec3"),a.vertex.code.add(m.glsl(e||(e=k(["\n    float getSize() {\n      return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;\n    }\n    "],
["\n    float getSize() {\n      return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;\n    }\n    "]))))):(a.attributes.add("size","float"),a.vertex.code.add(m.glsl(f||(f=k(["\n    float getSize(){\n      return intrinsicWidth * size;\n    }\n    "],["\n    float getSize(){\n      return intrinsicWidth * size;\n    }\n    "])))));d.vvOpacity?(a.attributes.add("opacityFeatureAttribute","float"),a.vertex.defines.addInt("VV_OPACITY_N",8),
a.vertex.code.add(m.glsl(g||(g=k(["\n    uniform float vvOpacityValues[VV_OPACITY_N];\n    uniform float vvOpacityOpacities[VV_OPACITY_N];\n\n    float interpolateOpacity( float value ){\n      if (value \x3c\x3d vvOpacityValues[0]) {\n        return vvOpacityOpacities[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n        if (vvOpacityValues[i] \x3e\x3d value) {\n          float f \x3d (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);\n          return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);\n        }\n      }\n\n      return vvOpacityOpacities[VV_OPACITY_N - 1];\n    }\n\n    vec4 applyOpacity( vec4 color ){\n      return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));\n    }\n    "],
["\n    uniform float vvOpacityValues[VV_OPACITY_N];\n    uniform float vvOpacityOpacities[VV_OPACITY_N];\n\n    float interpolateOpacity( float value ){\n      if (value \x3c\x3d vvOpacityValues[0]) {\n        return vvOpacityOpacities[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n        if (vvOpacityValues[i] \x3e\x3d value) {\n          float f \x3d (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);\n          return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);\n        }\n      }\n\n      return vvOpacityOpacities[VV_OPACITY_N - 1];\n    }\n\n    vec4 applyOpacity( vec4 color ){\n      return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));\n    }\n    "]))))):
a.vertex.code.add(m.glsl(h||(h=k(["\n    vec4 applyOpacity( vec4 color ){\n      return color;\n    }\n    "],["\n    vec4 applyOpacity( vec4 color ){\n      return color;\n    }\n    "]))));d.vvColor?(a.attributes.add("colorFeatureAttribute","float"),a.vertex.defines.addInt("VV_COLOR_N",8),a.vertex.code.add(m.glsl(l||(l=k(["\n    uniform float vvColorValues[VV_COLOR_N];\n    uniform vec4 vvColorColors[VV_COLOR_N];\n\n    vec4 interpolateColor( float value ) {\n      if (value \x3c\x3d vvColorValues[0]) {\n        return vvColorColors[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n        if (vvColorValues[i] \x3e\x3d value) {\n          float f \x3d (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\n          return mix(vvColorColors[i-1], vvColorColors[i], f);\n        }\n      }\n\n      return vvColorColors[VV_COLOR_N - 1];\n    }\n\n    vec4 getColor(){\n      return applyOpacity(interpolateColor(colorFeatureAttribute));\n    }\n    "],
["\n    uniform float vvColorValues[VV_COLOR_N];\n    uniform vec4 vvColorColors[VV_COLOR_N];\n\n    vec4 interpolateColor( float value ) {\n      if (value \x3c\x3d vvColorValues[0]) {\n        return vvColorColors[0];\n      }\n\n      for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n        if (vvColorValues[i] \x3e\x3d value) {\n          float f \x3d (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\n          return mix(vvColorColors[i-1], vvColorColors[i], f);\n        }\n      }\n\n      return vvColorColors[VV_COLOR_N - 1];\n    }\n\n    vec4 getColor(){\n      return applyOpacity(interpolateColor(colorFeatureAttribute));\n    }\n    "]))))):
(a.attributes.add("color","vec4"),a.vertex.code.add(m.glsl(c||(c=k(["\n    vec4 getColor(){\n      return applyOpacity(color);\n    }\n    "],["\n    vec4 getColor(){\n      return applyOpacity(color);\n    }\n    "])))))};var e,f,g,h,l,c})},"esri/views/3d/webgl-engine/core/shaderLibrary/shading/LineStipple.glsl":function(){define(["require","exports","../../../../../../core/tsSupport/makeTemplateObjectHelper","../../shaderModules/interfaces"],function(p,a,k,m){Object.defineProperty(a,"__esModule",
{value:!0});a.LineStipple=function(a,c){a.defines.addFloat("STIPPLE_ALPHA_COLOR_DISCARD",.001);a.defines.addFloat("STIPPLE_ALPHA_HIGHLIGHT_DISCARD",.5);c.stippleEnabled?(a.vertex.uniforms.add("stipplePatternPixelSizeInv","float"),c.stippleUVMaxEnabled&&a.varyings.add("stipplePatternUvMax","float"),a.varyings.add("stipplePatternUv","float"),a.fragment.uniforms.add("stipplePatternTexture","sampler2D"),c.stippleOffColorEnabled&&a.fragment.uniforms.add("stippleOffColor","vec4"),a.fragment.code.add(m.glsl(e||
(e=k(["\n  float getStippleAlpha() {\n    float stipplePatternUvClamped \x3d stipplePatternUv * gl_FragCoord.w;\n    ","\n\n    return texture2D(stipplePatternTexture, vec2(mod(stipplePatternUvClamped, 1.0), 0.5)).a;\n  }"],["\n  float getStippleAlpha() {\n    float stipplePatternUvClamped \x3d stipplePatternUv * gl_FragCoord.w;\n    ","\n\n    return texture2D(stipplePatternTexture, vec2(mod(stipplePatternUvClamped, 1.0), 0.5)).a;\n  }"])),c.stippleUVMaxEnabled?"stipplePatternUvClamped \x3d clamp(stipplePatternUvClamped, 0.0, stipplePatternUvMax);":
"")),c.stippleOffColorEnabled?a.fragment.code.add(m.glsl(f||(f=k(["\n    #define discardByStippleAlpha(stippleAlpha, threshold) {}\n    #define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)\n    "],["\n    #define discardByStippleAlpha(stippleAlpha, threshold) {}\n    #define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)\n    "])))):a.fragment.code.add(m.glsl(g||(g=k(["\n    #define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha \x3c threshold) { discard; }\n    #define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)\n    "],
["\n    #define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha \x3c threshold) { discard; }\n    #define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)\n    "]))))):a.fragment.code.add(m.glsl(h||(h=k(["\n  float getStippleAlpha() { return 1.0; }\n\n  #define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}\n  #define blendStipple(color, _stippleAlpha_) color\n  "],["\n  float getStippleAlpha() { return 1.0; }\n\n  #define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}\n  #define blendStipple(color, _stippleAlpha_) color\n  "]))))};
var e,f,g,h})},"fx3d/views/3d/webgl-engine-extensions/GLVerTexture":function(){define(["dojo/_base/declare","../support/fx3dUtils"],function(p,a){var k=0;return p(null,{declaredClass:"esri.views.3d.webgl-engine-extensions.GLVerTexture",constructor:function(a){this.id=k++;this._gl=a;this._ready=!1;this._pixelDataType=null;this._gl&&(this._textureHandle=this._gl.createTexture())},_initParams:function(){this._gl.texParameteri(3553,10242,33071);this._gl.texParameteri(3553,10243,33071);this._gl.texParameteri(3553,
10240,9728);this._gl.texParameteri(3553,10241,9728)},_reset:function(k,e){this._width=k;this._height=e;this._pixelSize=window.parseInt(this._width*this._height*4);(this._isPowerOfTwo=a.isPowerOfTwo(k)&&a.isPowerOfTwo(e))||console.warn("Width and height are not power of 2, and the rendering may be incorrect.")},setData:function(a,e,f){if(this._textureHandle){if(f instanceof Uint8Array)this._pixelDataType=5121;else{if(!(f instanceof Float32Array))return;this._pixelDataType=5126}if(this._reset(a,e),
isNaN(this._pixelSize)||this._pixelSize!==f.length)return void console.warn("The pixel size is invalid.");a=this._gl.getParameter(32873);this._gl.bindTexture(3553,this._textureHandle);this._initParams();this._gl.texImage2D(3553,0,window.WebGLRenderingContext&&this._gl instanceof window.WebGLRenderingContext?this._gl.RGBA:this._gl.RGBA32F,this._width,this._height,0,this._gl.RGBA,this._pixelDataType,f);this._gl.bindTexture(3553,a)}},bind:function(a){this._textureHandle&&("number"==typeof a&&this._gl.activeTexture(33984+
a),this._gl.bindTexture(3553,this._textureHandle))},unbind:function(){this._gl.bindTexture(3553,null)},release:function(){this._gl.bindTexture(3553,null)},getTextureHandle:function(){return this._textureHandle},dispose:function(){this._textureHandle.__deleted__=!0;this._gl.deleteTexture(this._textureHandle)}})})},"fx3d/views/3d/effects/FxEffectFactory":function(){define(["dojo/Deferred","../support/fx3dUtils"],function(p,a){return{make:function(k){var m=new p;if(k instanceof Object&&k.layer&&k.view&&
k.layerView){var e=k.layer.vizType;if("string"!=typeof e)m.reject("No viz type specified.");else{var f=e+"Effect",e=k._test&&a.enableAddTesting?"fx3d/views/3d/effects/_test/"+f:"fx3d/views/3d/effects/"+e+"/"+f;try{require([e],function(a){a=new a(k);m.resolve(a)})}catch(g){m.reject(g)}}}else m.reject("No FxLayer object found.");return m}}})},"url:fx3d/views/3d/effects/config.json":'{"point":[{"name":"Bounce","icon":"Bounce.png","requireTimeInfo": true,"status": null,"renderingInfo":[{"name":"visible","displayName":"Visible","dataType":"Boolean","defaultValue": true},{"name":"repeat","displayName":"Repeat","dataType":"Integer","defaultValue": 1000,"scope":[0, 10000000000]},{"name":"animationInterval","displayName":"Interval","dataType":"Speed","defaultValue": 1,"scope":[1, 5],"unit":"esriSecond"},{"name":"radius","displayName":"Radius","dataType":"Size","defaultValue": 30,"scope":[10, 50],"unit":"esriPixels"},{"name":"dashHeight","displayName":"DashHeight","dataType":"Size","defaultValue": 80000,"scope":[100, 500000],"unit":"esriMeters"},{"name":"transparency","displayName":"Transparency","dataType":"Transparency","defaultValue": 100,"scope":[0, 100],"unit":"esriPercentage"},{"name":"haloColors","displayName":"HaloColors","dataType":"MultiRGBColors","defaultValue":[[95, 158, 160],[154, 205, 50],[255, 182, 193],[255, 69, 0],[0, 128, 0],[205, 92, 92]]}]},{"name":"PointExtrude","icon":"PointExtrude.png","renderingInfo":[{"name":"visible","displayName":"Visible","dataType":"Boolean","defaultValue": true},{"name":"repeat","displayName":"Repeat","dataType":"Integer","defaultValue": 5,"scope":[0, 10000000000]},{"name":"animationInterval","displayName":"Interval","dataType":"Speed","defaultValue": 5,"scope":[2, 20],"unit":"esriSecond"},{"name":"shapeType","displayName":"Shape","dataType":"Shape","scope":["Cuboid","Cylinder","Hexahedron"],"defaultValue":"Cylinder"},{"name":"radius","displayName":"Radius","dataType":"Size","defaultValue": 60000,"scope":[1, 120000],"unit":"esriMeters"},{"name":"height","displayName":"Height","dataType":"Size","defaultValue": 800000,"scope":[100, 2000000],"unit":"esriMeters"},{"name":"transparency","displayName":"Transparency","dataType":"Transparency","defaultValue": 100,"scope":[0, 100],"unit":"esriPercentage"},{"name":"topColors","displayName":"TopColors","dataType":"MultiRGBColor","defaultValue":[[95, 158, 160],[154, 205, 50],[255, 182, 193],[255, 69, 0],[0, 128, 0],[205, 92, 92]]},{"name":"bottomColor","displayName":"BottomColor","dataType":"SingleRGBColor","defaultValue":[0, 255, 0]}]},{"name":"Pulse","icon":"Pulse.png","renderingInfo":[{"name":"visible","displayName":"Visible","dataType":"Boolean","defaultValue": true},{"name":"repeat","displayName":"Repeat","dataType":"Integer","defaultValue": 5,"scope":[0, 10000000000]},{"name":"animationInterval","displayName":"Interval","dataType":"Speed","defaultValue": 5,"scope":[2, 20],"unit":"esriSecond"},{"name":"shapeType","displayName":"Shape","dataType":"Shape","scope":["Circle","Triangle","Square","Hexagon"],"defaultValue":"Circle"},{"name":"radius","displayName":"InnerRadius","dataType":"Size","defaultValue": 50000,"scope":[1, 120000],"unit":"esriMeters"},{"name":"transparency","displayName":"Transparency","dataType":"Transparency","defaultValue": 100,"scope":[0, 100],"unit":"esriPercentage"},{"name":"solidColor","displayName":"SolidColor","dataType":"SingleRGBColor","defaultValue":[255, 255, 20]},{"name":"haloColors","displayName":"HaloColors","dataType":"MultiRGBColor","defaultValue":[[95, 158, 160],[154, 205, 50],[255, 182, 193],[255, 69, 0],[0, 128, 0],[205, 92, 92]]}]}],"polyline":[{"name":"Fireball","icon":"Fireball.png","renderingInfo":[{"name":"visible","displayName":"Visible","dataType":"Boolean","defaultValue": true},{"name":"repeat","displayName":"Repeat","dataType":"Integer","defaultValue": 10,"scope":[0, 10000000000]},{"name":"animationInterval","displayName":"Interval","dataType":"Speed","defaultValue": 5,"scope":[2, 20],"unit":"esriSecond"},{"name":"transparency","displayName":"Transparency","dataType":"Transparency","defaultValue": 100,"scope":[0, 100],"unit":"esriPercentage"},{"name":"radius","displayName":"Radius","dataType":"Size","defaultValue": 40,"scope":[30, 120],"unit":"esriPixels"},{"name":"colors","displayName":"Colors","dataType":"MultiRGBColors","defaultValue":[[95, 158, 160],[154, 205, 50],[255, 182, 193],[255, 69, 0],[0, 128, 0],[205, 92, 92]]}]},{"name":"JetTrail","icon":"JetTrail.png","renderingInfo":[{"name":"visible","displayName":"Visible","dataType":"Boolean","defaultValue": true},{"name":"repeat","displayName":"Repeat","dataType":"Integer","defaultValue": 1000,"scope":[0, 10000000000]},{"name":"animationInterval","displayName":"Interval","dataType":"Speed","defaultValue": 5,"scope":[2, 20],"unit":"esriSecond"},{"name":"transparency","displayName":"Transparency","dataType":"Transparency","defaultValue": 100,"scope":[0, 100],"unit":"esriPercentage"},{"name":"radius","displayName":"Radius","dataType":"Size","defaultValue": 20,"scope":[10, 50],"unit":"esriPixels"},{"name":"pulseRadius","displayName":"PulseRadius","dataType":"Size","defaultValue": 100000,"scope":[20000, 400000],"unit":"esriMeters"},{"name":"colors","displayName":"Colors","dataType":"MultiRGBColors","defaultValue":[[95, 158, 160],[154, 205, 50],[255, 182, 193],[255, 69, 0],[0, 128, 0],[205, 92, 92]]}]}],"polygon":[{"name":"AreaExtrude","icon":"AreaExtrude.png","renderingInfo":[{"name":"visible","displayName":"Visible","dataType":"Boolean","defaultValue": true},{"name":"repeat","displayName":"Repeat","dataType":"Integer","defaultValue": 5,"scope":[0, 10000000000]},{"name":"animationInterval","displayName":"Interval","dataType":"Speed","defaultValue": 5,"scope":[2, 20],"unit":"esriSecond"},{"name":"height","displayName":"Height","dataType":"Size","defaultValue": 10000,"scope":[1, 3000000],"unit":"esriMeters"},{"name":"transparency","displayName":"Transparency","dataType":"Transparency","defaultValue": 100,"scope":[0, 100],"unit":"esriPercentage"},{"name":"topColors","displayName":"TopColors","dataType":"MultiRGBColor","defaultValue":[[95, 158, 160],[154, 205, 50],[255, 182, 193],[255, 69, 0],[0, 128, 0],[205, 92, 92]]},{"name":"bottomColor","displayName":"BottomColor","dataType":"SingleRGBColor","defaultValue":[0, 255, 0]}]}]}',
"url:fx3d/views/3d/effects/CommonShaders.xml":'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\x3c!-- Copyright @ 2020 Esri. All rights reserved under the copyright laws of the United States and applicable international laws, treaties, and conventions. --\x3e\x3csnippets\x3e\x3csnippet name\x3d"backEaseIn"\x3e\x3c![CDATA[float getBackEaseInValue(float a,float b,float c,float d){float e\x3dc-b;float f\x3d1.70158;float g\x3da/d;return e*(g*g)*((f+1.0)*g-f)+b;}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"bounceEaseOut"\x3e\x3c![CDATA[float getBounceEaseOutValue(float a,float b,float c,float d){float e\x3dc-b;if((a/\x3dd)\x3c(1.0/2.75)) return e*(7.5625*a*a)+b;else if(a\x3c(2.0/2.75)) return e*(7.5625*(a-\x3d(1.5/2.75))*a+0.75)+b;else if(a\x3c(2.5/2.75)) return e*(7.5625*(a-\x3d(2.25/2.75))*a+0.9375)+b;else return e*(7.5625*(a-\x3d(2.625/2.75))*a+0.984375)+b;}float getBounceEaseInValue(float a,float b,float c,float d){return c-getBounceEaseOutValue(d-a,0.0,c,d)+b;}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"circEaseOut"\x3e\x3c![CDATA[float getCircEaseOutValue(float a,float b,float c,float d){float e\x3dc-b;float f\x3da/d-1.0;return e*sqrt(1.0-f*f)+b;}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"convertHSLtoRGB"\x3e\x3c![CDATA[vec4 a(vec4 b){const float c\x3d1.0/3.0;const float d\x3d2.0/3.0;const float e\x3d6.0;float f\x3db.x;float g\x3db.y;float h\x3db.z;vec3 i\x3dvec3(e*(f-d),0.0,e*(1.0-f));if(f\x3cd){i.r\x3d0.0;i.g\x3de*(d-f);i.b\x3de*(f-c);}if(f\x3cc){i.r\x3de*(c-f);i.g\x3de*f;i.b\x3d0.0;}i\x3dmin(i,1.0);float j\x3d2.0*g;float k\x3d1.0-g;float l\x3d1.0-h;float m\x3d(2.0*h)-1.0;vec3 n\x3d(j*i)+k;vec3 o;if(h\x3e\x3d0.5) o\x3d(l*n)+m;else o\x3dh*n;return vec4(o,b.a);}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"cubicEaseOut"\x3e\x3c![CDATA[float getCubicEaseInOutValue(float a,float b,float c,float d){float e\x3dc-b;if((a/\x3dd/2.0)\x3c1.0) return e/2.0*pow(a,3.0)+b;return e/2.0*((a-\x3d2.0)*pow(a,2.0)+2.0)+b;}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"curveInter"\x3e\x3c![CDATA[float b3p0(float a,float b){float c\x3d1.0-a;return pow(c,3.0)*b;}float b3p1(float a,float b){float c\x3d1.0-a;return 3.0*pow(c,2.0)*a*b;}float b3p2(float a,float b){float c\x3d1.0-a;return 3.0*c*pow(a,2.0)*b;}float b3p3(float a,float b){return pow(a,3.0)*b;}float b3(float a,float d,float e,float f,float g){return b3p0(a,d)+b3p1(a,e)+b3p2(a,f)+b3p3(a,g);}vec3 getPoint(float a,vec3 h,vec3 i,vec3 j,vec3 k){float l,m,n;l\x3db3(a,h.x,i.x,j.x,k.x);m\x3db3(a,h.y,i.y,j.y,k.y);n\x3db3(a,h.z,i.z,j.z,k.z);return vec3(l,m,n);}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"defines"\x3e\x3c![CDATA[\r\n#ifdef GL_ES\r\nprecision mediump float;\r\n#endif\r\n#define Epsilon \t\t1e-6\r\n#define PI \t\t\t\t\t3.14159265358979323846264338327950288\r\n#define EarthRadius 6378137.0\r\n#define DegPerRad \t57.295779513082320\r\n#define RadPerDeg \t0.017453292519943\r\n]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"defines2"\x3e\x3c![CDATA[\r\n#ifdef GL_ES\r\nprecision mediump float;\r\n#endif\r\n]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"elasticEaseIn"\x3e\x3c![CDATA[float getElasticEaseInValue(float a,float b,float c,float d){float e\x3dc-b;float f\x3dd*0.3;float g\x3de;float h\x3df/4.0;float i\x3da-1.0;return -(g*pow(2.0,10.0*i)*sin((i*d-h)*(2.0*PI)/f))+b;}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"expoEaseOut"\x3e\x3c![CDATA[float getExpoEaseOutValue(float a,float b,float c,float d){float e\x3dc-b;return (abs(a-d)\x3cEpsilon)?c:(e*(-pow(2.0,-10.0*a/d)+1.0)+b);}float getExpoEaseInValue(float a,float b,float c,float d){float e\x3dc-b;return (abs(a)\x3cEpsilon)?b:(e*pow(2.0,10.0*(a/d-1.0))+b);}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"float2rgba"\x3e\x3c![CDATA[vec4 a(float v){float b\x3dfloor(v*256.0)/255.0;float c\x3dfloor(fract(v*256.0)*256.0)/255.0;float d\x3dfloor(fract(v*65536.0)*256.0)/255.0;float e\x3d1.0;return vec4(b,c,d,e);}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"getHSVColor"\x3e\x3c![CDATA[vec4 getHSVColor(float a,float b,float c){vec3 d\x3dvec3(1.0,1.0,0.0);float e\x3da/60.0;float f\x3dfloor(e);float g\x3de-f;float h\x3dc*(1.0-b);float i\x3dc*(1.0-b*g);float j\x3dc*(1.0-b*(1.0-g));if(f\x3c0.5) d\x3dvec3(c,j,h);else if(f\x3c1.5) d\x3dvec3(i,c,h);else if(f\x3c2.5) d\x3dvec3(h,c,j);else if(f\x3c3.5) d\x3dvec3(h,i,c);else if(f\x3c4.5) d\x3dvec3(j,h,c);else d\x3dvec3(c,h,i);return vec4(d,0.7);}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"linearInterpolator"\x3e\x3c![CDATA[float getLinearValue(vec2 a,float b){if(a[1]\x3d\x3da[0]) return 0.0;else{return (b-a[0])/(a[1]-a[0]);}}float getScope(vec2 c,float d){return c[0]+(c[1]-c[0])*d;}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"localTrans"\x3e\x3c![CDATA[vec3 wgs84ToWebMerc(vec3 a){float b\x3d0.4999999*PI;float c\x3da[1]*RadPerDeg;c\x3dclamp(c,-b,b);float d\x3dsin(c);float e\x3dRadPerDeg*a[0]*EarthRadius;float f\x3dEarthRadius*0.5*log((1.0+d)/(1.0-d));float g\x3da[2];return vec3(e,f,g);}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"lonlat2position"\x3e\x3c![CDATA[vec3 lonlat2position(vec3 a){float b\x3dRadPerDeg*(a.x);float c\x3dRadPerDeg*(a.y);float d\x3dcos(c);float e\x3dEarthRadius+a.z;float f\x3dcos(b)*d*e;float g\x3dsin(b)*d*e;float h\x3dsin(c)*e;return vec3(f,g,h);}vec3 position2lonlat(vec3 i){float j\x3dlength(i);float k\x3dasin(i.z/j);float d\x3dcos(k);float l\x3d-1.0;if(i.y\x3e0.0){l\x3d1.0;}float m\x3dl*acos(i.x/(d*j));float b\x3dDegPerRad*(m);float c\x3dDegPerRad*(k);return vec3(b,c,j-EarthRadius);}mat4 toRotationMat(mat4 n){mat4 o\x3dmat4(1.0);o[0]\x3dn[0];o[1]\x3dn[1];o[2]\x3dn[2];return o;}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"lonlatDistance"\x3e\x3c![CDATA[float a(vec2 b,vec2 c){float d\x3dRadPerDeg*(b.y);float e\x3dRadPerDeg*(c.y);float f\x3dRadPerDeg*(c.y-b.y);float g\x3dRadPerDeg*(c.x-b.x);float h\x3dsin(f/2.0)*sin(f/2.0)+cos(d)*cos(e)*sin(g/2.0)*sin(g/2.0);float i\x3d2.0*atan2(sqrt(h),sqrt(1.0-h));return EarthRadius*i;}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"packDepth"\x3e\x3c![CDATA[\r\n#ifdef GL_ES\r\nprecision mediump float;\r\n#endif\r\nvec4 packDepth(const in mediump float a){const mediump vec4 b\x3dvec4(256.0,256.0*256.0,256.0*256.0*256.0,256.0*256.0*256.0*256.0);vec4 c\x3da*b;c.x\x3dmin(c.x+1.0,255.0);c\x3dfract(floor(c)/256.0);return c;}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"quintEaseOut"\x3e\x3c![CDATA[float getQuintEaseInOutValue(float a,float b,float c,float d){float e\x3dc-b;if((a/\x3d(d/2.0))\x3c1.0){return e/2.0*a*a*a*a*a+b;}return e/2.0*((a-\x3d2.0)*a*a*a*a+2.0)+b;}float getQuintEaseOut(float a,float b,float c,float d){float e\x3dc-b;return e*((a\x3da/d-1.0)*a*a*a*a+1.0)+b;}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"rotateFromToMat"\x3e\x3c![CDATA[mat4 rotateFromTo(vec3 a,vec3 b){mat4 c\x3dmat4(1.0);vec3 d\x3dnormalize(a);vec3 e\x3dnormalize(b);float f\x3ddot(d,e);float g\x3dsqrt(1.0-f*f);float h\x3d1.0-f;vec3 i\x3dcross(d,e);i\x3dnormalize(i);float j\x3di.x,k\x3di.y,l\x3di.z;float m\x3dc[0].x,n\x3dc[0].y,o\x3dc[0].z,p\x3dc[0].w,q\x3dc[1].x,r\x3dc[1].y,s\x3dc[1].z,t\x3dc[1].w,u\x3dc[2].x,v\x3dc[2].y,w\x3dc[2].z,x\x3dc[2].w;float y\x3dj*j*h+f,z\x3dk*j*h+l*g,A\x3dl*j*h-k*g,B\x3dj*k*h-l*g,C\x3dk*k*h+f,D\x3dl*k*h+j*g,E\x3dj*l*h+k*g,F\x3dk*l*h-j*g,G\x3dl*l*h+f;c[0].x\x3dm*y+q*z+u*A;c[0].y\x3dn*y+r*z+v*A;c[0].z\x3do*y+s*z+w*A;c[0].w\x3dp*y+t*z+x*A;c[1].x\x3dm*B+q*C+u*D;c[1].y\x3dn*B+r*C+v*D;c[1].z\x3do*B+s*C+w*D;c[1].w\x3dp*B+t*C+x*D;c[2].x\x3dm*E+q*F+u*G;c[2].y\x3dn*E+r*F+v*G;c[2].z\x3do*E+s*F+w*G;c[2].w\x3dp*E+t*F+x*G;return c;}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"translationMat"\x3e\x3c![CDATA[mat4 rotateX(mat4 a,float b){mat4 c\x3da;float d\x3dsin(b);float e\x3dcos(b);float f\x3da[1].x,g\x3da[1].y,h\x3da[1].z,i\x3da[1].w,j\x3da[2].x,k\x3da[2].y,l\x3da[2].z,m\x3da[2].w;c[1].x\x3df*e+j*d;c[1].y\x3dg*e+k*d;c[1].z\x3dh*e+l*d;c[1].w\x3di*e+m*d;c[2].x\x3df*(-d)+j*e;c[2].y\x3dg*(-d)+k*e;c[2].z\x3dh*(-d)+l*e;c[2].w\x3di*(-d)+m*e;return c;}mat4 rotateY(mat4 a,float b){mat4 c\x3da;float d\x3dsin(b);float e\x3dcos(b);float n\x3da[0].x,o\x3da[0].y,p\x3da[0].z,q\x3da[0].w,j\x3da[2].x,k\x3da[2].y,l\x3da[2].z,m\x3da[2].w;c[0].x\x3dn*e+j*(-d);c[0].y\x3do*e+k*(-d);c[0].z\x3dp*e+l*(-d);c[0].w\x3dq*e+m*(-d);c[2].x\x3dn*d+j*e;c[2].y\x3do*d+k*e;c[2].z\x3dp*d+l*e;c[2].w\x3dq*d+m*e;return c;}mat4 getTransMat(vec3 r){mat4 s\x3dmat4(1.0);float t\x3dRadPerDeg*(r.x);float u\x3dRadPerDeg*(r.y);float v\x3dsin(t),w\x3dcos(t),x\x3dsin(u),y\x3dcos(u);s[0].x\x3d-v;s[1].x\x3d-x*w;s[2].x\x3dy*w;s[0].y\x3dw;s[1].y\x3d-x*v;s[2].y\x3dy*v;s[0].z\x3d0.0;s[1].z\x3dy;s[2].z\x3dx;s[0].w\x3d0.0;s[1].w\x3d0.0;s[2].w\x3d0.0;s[3].xyz\x3dlonlat2position(r);s[3].w\x3d1.0;return s;}vec3 rotateOnAxis(vec3 z,float b,vec3 A){vec3 B;float C\x3db*0.5;float d\x3dsin(C);float D\x3dcos(C);float E\x3dd*z[0];float F\x3dd*z[1];float G\x3dd*z[2];float H\x3dA[0],I\x3dA[1],J\x3dA[2];float K\x3dD*H+F*J-G*I,L\x3dD*I+G*H-E*J,M\x3dD*J+E*I-F*H,N\x3d-E*H-F*I-G*J;B[0]\x3dK*D+N*-E+L*-G-M*-F;B[1]\x3dL*D+N*-F+M*-E-K*-G;B[2]\x3dM*D+N*-G+K*-F-L*-E;return B;}]]\x3e\x3c/snippet\x3e\x3csnippet name\x3d"transparentFunc"\x3e\x3c![CDATA[\r\n#extension GL_OES_standard_derivatives : enable\r\nfloat edgeFactor(float a,float b){vec3 b\x3dfwidth(a);vec3 c\x3dsmoothstep(vec3(0.0),b*1.5,a);return min(min(c.x,c.y),c.z);}]]\x3e\x3c/snippet\x3e\x3c/snippets\x3e'}});
define("dojo/_base/lang esri/core/has dojo/_base/array dojo/Deferred esri/core/declare esri/request esri/PopupTemplate esri/core/lang esri/core/MultiOriginJSONSupport esri/tasks/support/Query esri/layers/Layer esri/layers/FeatureLayer esri/layers/support/fieldUtils esri/renderers/support/styleUtils esri/layers/mixins/PortalLayer esri/layers/support/arcgisLayerUrl esri/core/promiseUtils esri/geometry/SpatialReference ../views/3d/support/fx3dUtils ../views/3d/layers/FxLayerView3D".split(" "),function(p,
a,k,m,e,f,g,h,l,c,b,d,n,t,r,w,u,q,E,x){function z(a,b){return f(a,{query:p.mixin({f:"json"},null),responseType:"json",callbackParamName:"callback"}).then(function(c){if(c._ssl&&(delete c._ssl,a=a.replace(/^http:/i,"https:")),"Feature Layer"===c.data.type){var d={};d.availableVizTypes=E.availableVizTypes(c.data.geometryType,c.data.timeInfo);p.mixin(d,y(c.data.fields));b(null,d)}else b("FxLayer can only accecpt a feature service.")})}function y(a){var b=[],c=[],d=["small-integer","integer","single",
"long","double"],e="lat latitude y ycenter latitude83 latdecdeg POINT-Y lon lng long longitude x xcenter longitude83 longdecdeg POINT-X alt altitude z POINT-Z zcenter altitude83 altdecdeg".split(" ");return k.forEach(a,function(a){b.push(a.name);var f=a.name.toLowerCase();-1<d.indexOf(a.type)&&-1===e.indexOf(f)&&c.push(a.name)}),{displayFields:b,vizFields:c}}e=e([d],{declaredClass:"esri.layers.FxLayer",viewModulePaths:{"3d":"fx3d/views/3d/layers/FxLayerView3D"},properties:{renderingInfo:{value:null,
set:function(a){var b=this._get("renderingInfo");p.isObject(a)&&!E.isEqual(a,b)&&this._set("renderingInfo",a)}},vizType:{value:null,set:function(a){var b=this._get("vizType");p.isString(a)&&!E.isEqual(a,b)&&this._set("vizType",a)}},displayField:{type:String,value:null,json:{ignore:!0},set:function(a){var b=this._get("displayField");p.isString(a)&&!E.isEqual(a,b)&&this._set("displayField",a)}},vizFields:{value:null,set:function(a){a=p.isString(a)?[a]:a;var b=this._get("vizFields");p.isArray(a)&&!E.isEqual(a,
b)&&this._set("vizFields",a)}},spinTag:{value:!1,set:function(a){var b=this._get("spinTag");"boolean"==typeof a&&a!==b&&this._set("spinTag",a)}},pauseTag:{value:!1,set:function(a){var b=this._get("pauseTag");"boolean"==typeof a&&a!==b&&this._set("pauseTag",a)}}},constructor:function(a,b){this.inherited(arguments);this.importLayerViewModule(b.view);this.url=a;Object.keys(b).forEach(function(a){this[a]=b[a]}.bind(this));this.outFields=["*"];this.listMode="hide"},normalizeCtorArgs:function(a,b){return p.isString(a)&&
E.isUrl(a)?(a=w.parse(a),a&&null!=a.sublayer&&null==this.layerId&&(this.layerId=a.sublayer),p.mixin({},{url:a.url.path},b)):(console.warn("Data source must be a FeatureService url."),null)},remove:function(){this.pauseAnimation();this.pauseSpinning();this.fxLayerView&&!1===this.fxLayerView.destroyed&&(this.fxLayerView.destroy(),this.fxLayerView=null);this.emit("destroy-fxlayer")},_initLayerProperties:function(b){this.source||(this.source=b);b.url&&(this.url=b.url);var c=this.source.relatedFeaturesInfo,
d=h.mixin({},b.sourceJSON,c?{objectIdField:c.joinField}:{});if(c&&(this.source.relatedFeaturesInfo.outFields=this.outFields?this.outFields.splice(0):null),this.sourceJSON=b.sourceJSON,this.read(d,{origin:"service",url:this.parsedUrl}),c&&c.outFields&&"*"!==c.outFields[0]&&(c.outFields=c.outFields.map(function(a){return a.toLowerCase()})),this._verifySource(),this._verifyFields(),this.useQueryTimestamp=a("ie")||a("safari"),n.fixRendererFields(this.renderer,this.fields),this.listMode="hide",this.disablePopup=
!0,this.visible=!0,this.declaredClass="esri.layers.FxLayer",!p.isArray(this.fields))return void console.warn("Fileds from source is invalid.");b=y(this.fields);var e=b.vizFields;b=b.displayFields;var f=null,l=null;if(p.isString(this.displayField)&&0!==this.displayField.length?(l=null,f=k.some(b,function(a){if(a.toLowerCase()===this.displayField.toLowerCase())return l=a,!0}.bind(this)),f?this.set("displayField",l):this.set("displayField",b[0])):this.set("displayField",b[0]),p.isArray(this.vizFields)&&
0!==this.vizFields.length){var m=[];k.forEach(e,function(a){m.push(a.toLowerCase())});f=[];k.forEach(this.vizFields,function(a){a=m.indexOf(a.toLowerCase());-1<a&&f.push(e[a])}.bind(this));0<f.length?this.set("vizFields",f):this.set("vizFields",e[0])}else this.set("vizFields",e[0]);return this.availableVizTypes=E.availableVizTypes(this.geometryType,this.timeInfo),p.isString(this.vizType)&&0!==this.vizType.length?(l=null,f=k.some(this.availableVizTypes,function(a){if(a.name.toLowerCase()===this.vizType.toLowerCase())return l=
a.name,!0}.bind(this)),f?this.vizType=l:this.vizType=this.availableVizTypes[0]?this.availableVizTypes[0].name:null):this.vizType=this.availableVizTypes[0]?this.availableVizTypes[0].name:null,this.popupTemplate||(this.popupTemplate=new g({title:this.name,fieldInfos:this.fields?k.map(this.fields,function(a){return{fieldName:a.name,label:a.name,visible:!0}}):[],content:"{*}"})),this.vizType&&0!=this.vizType.length&&this.displayField&&0!=this.displayField.length&&p.isArray(this.vizFields)&&0!=this.vizFields.length?
(this.set("visible",!0),t.loadStyleRenderer(this,{origin:"service"})):(this.set("visible",!1),this.set("loaded",!1),this.emit("fxlayer-error",{msg:"Properties of vizType, displayField, vizFields, renderingInfo, or popupTemplate is missing."}),void console.warn("Properties of vizType, displayField, vizFields, renderingInfo, or popupTemplate is missing."))},createQuery:function(){var a=new c,b=this.get("capabilities.data");return a.returnGeometry=!0,a.returnZ=b&&b.supportsZ&&this.returnZ||null,a.returnM=
b&&b.supportsM&&this.returnM||null,a.outFields=this.outFields,a.where=this.definitionExpression||"1\x3d1",a.multipatchOption="multipatch"===this.geometryType?"xyFootprint":null,a},createQueryParameters:function(){var a=new c;return a.outSpatialReference=q.WGS84,Object.defineProperty(a,"outSpatialReference",{configurable:!0,writable:!1}),a.returnGeometry=!0,a.returnZ=this.hasZ&&this.returnZ||null,a.returnM=this.hasM&&this.returnM||null,a.outFields=this.outFields,a.where=this.definitionExpression||
"1\x3d1",a.multipatchOption="multipatch"===this.geometryType?"xyFootprint":null,a},importLayerViewModule:function(a){"3d"===a.type&&(this.fxLayerView=new x({layer:this,view:a}))},showLabel:function(a){a&&this.emit("show-feature-label",{feature:a})},hideLabel:function(){this.emit("hide-feature-label")},startAnimation:function(){return this.visible?void(this.pauseTag=!1):void console.warn("The FxLayer is invisible now.")},pauseAnimation:function(){this.pauseTag=!0},startSpinning:function(){return this.visible?
void(this.spinTag=!0):void console.warn("The FxLayer is invisible now.")},pauseSpinning:function(){this.spinTag=!1},switchVizField:function(a,b){function c(a){-1<a&&a<d.vizFields.length?(d.emit("hide-feature-label"),d.emit("fx3d-active-viz-field",{currentVizPage:a,newRenderingInfo:b})):console.warn("invalid viz page in switchVizField(vizField).")}if(!this.visible)return void console.warn("The FxLayer is invisible now.");var d=this;if(p.isString(a)){var e=[];k.forEach(this.vizFields,function(a){e.push(a.toLowerCase())});
a=e.indexOf(a.toLowerCase());c(a)}else"number"==typeof a?c(a):console.warn("switchVizField(vizField) needs a integer id or string name as parameter.")}});return p.mixin(e,{getFieldsAndVizTypes:function(a){var b=new m;return p.isString(a)?E.isUrl(a)&&z(a,function(a,c){a?b.reject(a):b.resolve(c)}):b.reject("FxLayer can only accecpt a feature service url now."),b}}),p.mixin(e,E.EffectType),e});