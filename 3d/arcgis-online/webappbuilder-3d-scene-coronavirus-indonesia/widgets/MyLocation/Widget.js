// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Locate":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!../nls/common dojo/i18n!./Locate/nls/Locate ../core/accessorSupport/decorators ./Widget ./Locate/LocateViewModel ./support/widget".split(" "),function(p,r,h,a,n,l,e,k,t,m){return function(k){function f(c){c=k.call(this,c)||this;c.geolocationOptions=null;c.goToLocationEnabled=null;c.goToOverride=null;c.graphic=null;c.iconClass="esri-icon-north-navigation";
c.label=l.widgetLabel;c.scale=null;c.useHeadingEnabled=null;c.view=null;c.viewModel=new t;return c}h(f,k);f.prototype.cancelLocate=function(){};f.prototype.locate=function(){};f.prototype.render=function(){var c,a,e=this.get("viewModel.state"),f="locating"===e,g=(c={},c["esri-disabled"]="disabled"===e,c["esri-hidden"]="feature-unsupported"===e,c);c=(a={},a["esri-icon-loading-indicator"]=f,a["esri-rotating"]=f,a["esri-icon-locate"]=!f,a);a="locating"===e?n.cancel:l.title;return m.tsx("div",{bind:this,
class:this.classes("esri-locate esri-widget--button esri-widget",g),hidden:"feature-unsupported"===e,onclick:this._locate,onkeydown:this._locate,role:"button",tabIndex:0,"aria-label":a,title:a},m.tsx("span",{"aria-hidden":"true",class:this.classes("esri-icon",c)}),m.tsx("span",{class:"esri-icon-font-fallback-text"},l.title))};f.prototype._locate=function(){var a=this.viewModel;"locating"===a.state?a.cancelLocate():a.locate()};a([e.aliasOf("viewModel.geolocationOptions")],f.prototype,"geolocationOptions",
void 0);a([e.aliasOf("viewModel.goToLocationEnabled")],f.prototype,"goToLocationEnabled",void 0);a([e.aliasOf("viewModel.goToOverride")],f.prototype,"goToOverride",void 0);a([e.aliasOf("viewModel.graphic")],f.prototype,"graphic",void 0);a([e.property()],f.prototype,"iconClass",void 0);a([e.property()],f.prototype,"label",void 0);a([e.aliasOf("viewModel.scale")],f.prototype,"scale",void 0);a([e.aliasOf("viewModel.useHeadingEnabled")],f.prototype,"useHeadingEnabled",void 0);a([e.aliasOf("viewModel.view")],
f.prototype,"view",void 0);a([e.property({type:t}),m.renderable("viewModel.state"),m.vmEvent(["locate","locate-error"])],f.prototype,"viewModel",void 0);a([e.aliasOf("viewModel.cancelLocate")],f.prototype,"cancelLocate",null);a([e.aliasOf("viewModel.locate")],f.prototype,"locate",null);a([m.accessibleHandler()],f.prototype,"_locate",null);return f=a([e.subclass("esri.widgets.Locate")],f)}(e.declared(k))})},"esri/widgets/Locate/LocateViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper dojo/i18n!./nls/Locate ../../PopupTemplate ../../core/Error ../../core/geolocationUtils ../../core/Handles ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../Popup/actions ../support/GeolocationPositioning".split(" "),
function(p,r,h,a,n,l,e,k,t,m,w,f,c,q,u,v){var g={title:e.currentLocation,fieldInfos:[{fieldName:"timestamp",label:e.timestamp,format:{dateFormat:"short-date-short-time"}},{fieldName:"latitude",label:e.latitude,format:{places:4,digitSeparator:!0}},{fieldName:"longitude",label:e.longitude,format:{places:4,digitSeparator:!0}},{fieldName:"accuracy",label:e.accuracy,format:{places:0,digitSeparator:!0}},{fieldName:"altitude",label:e.altitude,format:{places:0,digitSeparator:!0}},{fieldName:"altitudeAccuracy",
label:e.altitudeAccuracy,format:{places:0,digitSeparator:!0}},{fieldName:"heading",label:e.heading,format:{places:0,digitSeparator:!0}},{fieldName:"speed",label:e.speed,format:{places:0,digitSeparator:!0}}],actions:[u.removeSelectedFeature.clone()],content:[{type:"fields"}]};return function(b){function d(d){var a=b.call(this,d)||this;a._locateController=null;a._handles=new w;a.locate=a.locate.bind(a);a.graphic&&(a.graphic.popupTemplate=new k(g));a._handles.add(c.on(a,"view.popup","trigger-action",
function(b){return u.triggerAction({event:b,view:a.view})}));return a}h(d,b);d.prototype.destroy=function(){this.cancelLocate();this._handles.destroy();this._handles=null};Object.defineProperty(d.prototype,"state",{get:function(){return this._geolocationUsable?this.get("view.ready")?this._locateController?"locating":"ready":"disabled":"feature-unsupported"},enumerable:!0,configurable:!0});d.prototype.locate=function(){return l(this,void 0,void 0,function(){var b,d,a;return n(this,function(c){switch(c.label){case 0:this.cancelLocate();
if("disabled"===this.state)throw new t("locate:disabled-state","Cannot locate when disabled.");if("feature-unsupported"===this.state)throw new t("locate:feature-unsupported-state","Cannot locate in unsecure domain.");this._locateController=b=f.createAbortController();c.label=1;case 1:return c.trys.push([1,4,,5]),[4,m.getCurrentPosition(this.geolocationOptions)];case 2:return d=c.sent(),[4,this._setPosition(d,{signal:b.signal})];case 3:d=c.sent();if(this._locateController!==b)return[2,null];this.graphic&&
(this.graphic=this.graphic.clone(),this.view.graphics.push(this.graphic));this.emit("locate",{position:d});this._locateController=null;return[2,d];case 4:throw a=c.sent(),this._locateController=null,this.emit("locate-error",{error:a}),a;case 5:return[2]}})})};d.prototype.cancelLocate=function(){this._clear();this._locateController&&this._locateController.abort();this._locateController=null};a([q.property()],d.prototype,"_locateController",void 0);a([q.property({dependsOn:["view.ready","_locateController",
"_geolocationUsable"],readOnly:!0})],d.prototype,"state",null);a([q.property()],d.prototype,"locate",null);a([q.property()],d.prototype,"cancelLocate",null);return d=a([q.subclass("esri.widgets.Locate.LocateViewModel")],d)}(q.declared(v))})},"esri/core/geolocationUtils":function(){define("require exports ./tsSupport/assignHelper ../config ./Error ./has ./Logger ./promiseUtils ../geometry/Point ../geometry/support/webMercatorUtils ../portal/Portal ../tasks/GeometryService ../tasks/support/ProjectParameters".split(" "),
function(p,r,h,a,n,l,e,k,t,m,w,f,c){function q(b,d,a){if(!d)return k.resolve(b);var e=d.spatialReference;return e.isWGS84?k.resolve(b):e.isWebMercator?k.resolve(m.geographicToWebMercator(b)):u(a).then(function(d){if(!d)throw new n("geometry-service:missing-url","Geometry service URL is missing");d=new f({url:d});var x=new c({geometries:[b],outSR:e});return d.project(x,a).then(function(b){return b[0]})})}function u(b){if(a.geometryServiceUrl)return k.resolve(a.geometryServiceUrl);var d=w.getDefault();
return d.load(b).catch(function(){}).then(function(){return d.get("helperServices.geometry.url")})}Object.defineProperty(r,"__esModule",{value:!0});var v=e.getLogger("esri.core.geolocationUtils"),g={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};r.supported=function(){var b=l("esri-geolocation");b||v.warn("geolocation-unsupported","Geolocation unsupported.");b&&((b=l("esri-secure-context"))||v.warn("insecure-context","Geolocation requires a secure origin."));return b};r.getCurrentPosition=function(b){b||
(b=g);return k.create(function(d,a){setTimeout(function(){return a(new n("geolocation:timeout","getting the current geolocation position timed out"))},15E3);navigator.geolocation.getCurrentPosition(d,a,b)})};r.positionToPoint=function(b,d){var a=b.position;b=b.view;var c=a&&a.coords||{},c={accuracy:c.accuracy,altitude:c.altitude,altitudeAccuracy:c.altitudeAccuracy,heading:c.heading,latitude:c.latitude,longitude:c.longitude,speed:c.speed},a=a?{coords:c,timestamp:a.timestamp}:a;a=(a=a&&a.coords)?new t({longitude:a.longitude,
latitude:a.latitude,z:a.altitude||null,spatialReference:{wkid:4326}}):null;return q(a,b,d)}})},"esri/widgets/support/GeolocationPositioning":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../Graphic ../../core/Accessor ../../core/Error ../../core/Evented ../../core/geolocationUtils ../../core/promiseUtils ../../core/accessorSupport/decorators ../../symbols/PictureMarkerSymbol ./GoTo".split(" "),
function(p,r,h,a,n,l,e,k,t,m,w,f,c,q,u){return function(k){function g(){var b=null!==k&&k.apply(this,arguments)||this;b._geolocationUsable=!0;b._iconPath=p.toUrl("../../images/support/sdk_gps_location.png");b.geolocationOptions=null;b.goToLocationEnabled=!0;b.graphic=new e({symbol:new q({url:b._iconPath,width:21,height:21})});b.scale=null;b.useHeadingEnabled=!0;b.view=null;return b}h(g,k);g.prototype.initialize=function(){w.supported()||(this._geolocationUsable=!1)};g.prototype.destroy=function(){this._clear();
this.view=null};g.prototype._clear=function(){this.view&&this.view.graphics.remove(this.graphic)};g.prototype._getScaleWithinConstraints=function(b,a){return a?"2d"===a.type?(a=a.constraints,Math.min(a.effectiveMinScale,Math.max(a.effectiveMaxScale,b))):b:b};g.prototype._getScale=function(b){var a=this.scale;return this._getScaleWithinConstraints("number"===typeof a?a:2500,b)};g.prototype._getHeading=function(a,d){d=d&&d.spatialReference;a=a.coords&&a.coords.heading;if(!(!d||!d.isWebMercator&&!d.isGeographic||
"number"!==typeof a||isNaN(a)||0>a||360<a))return a};g.prototype._addHeading=function(a){var b=a.heading,c=a.target;(a=a.view)&&"number"===typeof b&&!isNaN(b)&&("3d"===a.type?c.heading=b:"2d"===a.type&&(c.rotation=360-b))};g.prototype._animatePoint=function(a,d,c,e){var b=this.view;if(!this.goToLocationEnabled||!b)return f.resolve(d);var g=this.useHeadingEnabled?this._getHeading(d,b):void 0;a={target:a,scale:c};this._addHeading({heading:g,target:a,view:b});return this.callGoTo({target:a,options:e}).then(function(){return d})};
g.prototype._setPosition=function(a,d){return l(this,void 0,void 0,function(){var b,c,e,f,g,h,k,l,m,p,q,r,u,v;return n(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,w.positionToPoint({position:a,view:this.view},d)];case 1:return b=n.sent(),c=this.graphic,e=a.timestamp,f=a.coords,g=f.accuracy,h=f.altitude,k=f.altitudeAccuracy,l=f.heading,m=f.latitude,p=f.longitude,q=f.speed,r={timestamp:e,accuracy:g,altitude:h,altitudeAccuracy:k,heading:l,latitude:m,longitude:p,speed:q},c&&
(c.geometry=b,c.attributes=r),u=this._getScale(this.view),[2,this._animatePoint(b,a,u,d)];case 2:throw v=n.sent(),new t("positioning:invalid-point","Cannot position invalid point",{error:v});case 3:return[2]}})})};a([c.property()],g.prototype,"_geolocationUsable",void 0);a([c.property()],g.prototype,"geolocationOptions",void 0);a([c.property()],g.prototype,"goToLocationEnabled",void 0);a([c.property()],g.prototype,"graphic",void 0);a([c.property()],g.prototype,"scale",void 0);a([c.property()],g.prototype,
"useHeadingEnabled",void 0);a([c.property()],g.prototype,"view",void 0);return g=a([c.subclass("esri.widgets.support.GeolocationPositioning")],g)}(c.declared(u.GoToMixin(m.EventedMixin(k))))})},"widgets/MyLocation/_build-generate_module":function(){define(["dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/MyLocation/css/style.css":'.jimu-widget-mylocation {background-color: #fff; opacity: 0.8; color: rgba(0, 0, 0, 0.8);}.jimu-widget-mylocation:hover {opacity: 1;}.jimu-widget-mylocation.nohttps:hover{opacity: 0.8;}.jimu-widget-mylocation.onCenter {background-color: #000;}.jimu-widget-mylocation .esri-locate-node {display: none;}.jimu-widget-mylocation .place-holder {width: 32px; height: 32px; background-color: #666; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: pointer; border: 1px solid rgba(0, 0, 0, 0.3); text-align: center; line-height: 30px; font-size: 14px; background-position: center center; background-repeat: no-repeat;}.jimu-widget-mylocation .place-holder:before {font-family: \'Themefont\'; content: "\\a907";}.jimu-widget-mylocation .place-holder.locating:before {content: "";}.jimu-widget-mylocation .place-holder.locating {background-image: url("images/loading_black.gif"); background-repeat: no-repeat; background-position: center;}.jimu-widget-mylocation .place-holder.nohttps{color: #bcbcbc;}.jimu-widget-mylocation .place-holder.tracking:before {content: "\\a913" !important; color: rgba(255, 255, 255, 0.8);}.jimu-widget-mylocation .place-holder {background-color: rgba(0, 0, 0, 0);}.jimu-widget-mylocation.onCenter .place-holder {color: #fff;}.jimu-widget-mylocation.onLocate .place-holder {background-color: rgba(0, 0, 0, 0.4);}',
"*now":function(p){p(['dojo/i18n!*preload*widgets/MyLocation/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","uk","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare jimu/BaseWidget dojo/_base/html dojo/on dojo/when dojo/_base/lang esri/layers/GraphicsLayer esri/widgets/Locate esri/widgets/Locate/LocateViewModel esri/symbols/PictureMarkerSymbol esri/geometry/Point esri/geometry/SpatialReference esri/geometry/support/webMercatorUtils esri/tasks/support/ProjectParameters esri/Graphic esri/config jimu/utils".split(" "),function(p,r,h,a,n,l,e,k,t,m,w,f,c,q,u,v,g){p=p([r],{name:"MyLocation",baseClass:"jimu-widget-mylocation",startup:function(){this.inherited(arguments);
this.placehoder=h.create("div",{"class":"place-holder",title:this.label},this.domNode);this.isNeedHttpsButNot=g.isNeedHttpsButNot();!0===this.isNeedHttpsButNot?(console.log("LocateButton::navigator.geolocation requires a secure origin."),h.addClass(this.domNode,"nohttps"),h.addClass(this.placehoder,"nohttps"),h.setAttr(this.placehoder,"title",this.nls.httpNotSupportError)):window.navigator.geolocation?this.own(a(this.placehoder,"click",l.hitch(this,this.onLocationClick))):h.setAttr(this.placehoder,
"title",this.nls.browserError)},onLocationClick:function(){h.hasClass(this.domNode,"onCenter")||h.hasClass(this.domNode,"locating")?this._destroyGeoLocate():(this._destroyGeoLocate(),this._createGeoLocateAndLocate())},_createGeoLocateAndLocate:function(){this.getGeoLocateInstance();this.geoLocate.viewModel.locate();h.addClass(this.placehoder,"locating")},getGeoLocateInstance:function(){var b=this.config.locateButton,d={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};b.geolocationOptions&&l.mixin(d,
b.geolocationOptions);this.graphicsLayer=new e;this.sceneView.map.add(this.graphicsLayer);var c=h.create("div",{"class":"esri-locate-node"},this.domNode),d={view:this.sceneView,graphicsLayer:this.graphicsLayer,geolocationOptions:d,scale:b.scale,tracking:b.useTracking,clearOnTrackingStopEnabled:!1};b.highlightLocation||(d.graphic=null);this.geoLocate=new k({viewModel:new t(d),container:c,visible:!1});this.geoLocate.own(a(this.geoLocate.viewModel,"locate",l.hitch(this,this.onLocate)));this.geoLocate.own(a(this.geoLocate.viewModel,
"locate-error",l.hitch(this,this.onLocateError)));this.geoLocate.startup();return this.geoLocate},onLocate:function(a){h.removeClass(this.placehoder,"locating");this.graphicsLayer.removeAll();this.geoLocate.viewModel.tracking&&h.addClass(this.placehoder,"tracking");if(a.error)this.onLocateError(a.error);else h.addClass(this.domNode,"onCenter"),this.neverLocate=!1},onLocateError:function(a){console.error(a.error);h.removeClass(this.placehoder,"locating");h.removeClass(this.domNode,"onCenter");h.removeClass(this.placehoder,
"tracking")},_destroyGeoLocate:function(){this.graphicsLayer&&(this.graphicsLayer.removeAll(),this.sceneView.map.remove(this.graphicsLayer));this.geoLocate&&(this.geoLocate.viewModel.cancelLocate(),this.geoLocate.viewModel.graphicsLayer.removeAll(),this.geoLocate.destroy(),this.geoLocate=null);h.removeClass(this.domNode,"onCenter");h.removeClass(this.placehoder,"tracking")},destroy:function(){this._destroyGeoLocate();this.inherited(arguments)},_pointMarkerManualy:function(a){"undefined"!==typeof this.config.locateButton.highlightLocation&&
!1!==this.config.locateButton.highlightLocation&&(this.highlightSymbol=new m({url:this.folderUrl+"css/images/sdk_gps_location.png",size:28,width:28,height:28,xoffset:14,yoffset:14}),a=new w({longitude:a.position.coords.longitude,latitude:a.position.coords.latitude,spatialReference:new f({wkid:4326})}),this._project(a).then(l.hitch(this,function(a){a=new u({geometry:a[0],symbol:this.highlightSymbol});this.config.locateButton.highlightLocation&&this.graphicsLayer.add(a)}),l.hitch(this,function(a){this.onLocateError(a)})))},
_project:function(a){var b=this.sceneView.spatialReference;if(a.spatialReference.equals(b))return n([a]);if(c.canProject(a,b))return n([c.project(a,b)]);var e=new q;e.geometries=[a];e.outSR=b;return v.geometryService.project(e)}});p.inPanel=!1;p.hasUIFile=!1;return p});